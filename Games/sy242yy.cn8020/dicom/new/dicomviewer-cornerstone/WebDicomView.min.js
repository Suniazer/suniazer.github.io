! function(e, t) {
    "object" == typeof exports && "object" == typeof module ? module.exports = t() : "function" == typeof define && define.amd ? define("WebDicomView", [], t) : "object" == typeof exports ? exports.WebDicomView = t() : e.WebDicomView = t()
}("undefined" != typeof self ? self : this, (() => (() => {
    var __webpack_modules__ = {
            76: e => {
                "use strict";
                e.exports = Function.prototype.call
            },
            226: (e, t, n) => {
                "use strict";
                n.d(t, {
                    $: () => a,
                    O: () => s
                });
                var o = n(2117);
                const r = new(n(9473).PC),
                    a = ["fasM", "staM", "majM"],
                    i = () => {
                        const {
                            speed: e,
                            standard: t,
                            major: n
                        } = (0, o.Tl)("tools.modes");
                        return [e, t, n]
                    },
                    s = () => r.get(i)
            },
            281: e => {
                /*! cornerstone-tools - 6.0.10 - 2023-07-21 | (c) 2017 Chris Hafey | https://github.com/cornerstonejs/cornerstoneTools */
                window,
                e.exports = function(e) {
                    var t = {};

                    function n(o) {
                        if (t[o]) return t[o].exports;
                        var r = t[o] = {
                            i: o,
                            l: !1,
                            exports: {}
                        };
                        return e[o].call(r.exports, r, r.exports, n), r.l = !0, r.exports
                    }
                    return n.m = e, n.c = t, n.d = function(e, t, o) {
                        n.o(e, t) || Object.defineProperty(e, t, {
                            enumerable: !0,
                            get: o
                        })
                    }, n.r = function(e) {
                        "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {
                            value: "Module"
                        }), Object.defineProperty(e, "__esModule", {
                            value: !0
                        })
                    }, n.t = function(e, t) {
                        if (1 & t && (e = n(e)), 8 & t) return e;
                        if (4 & t && "object" == typeof e && e && e.__esModule) return e;
                        var o = Object.create(null);
                        if (n.r(o), Object.defineProperty(o, "default", {
                                enumerable: !0,
                                value: e
                            }), 2 & t && "string" != typeof e)
                            for (var r in e) n.d(o, r, function(t) {
                                return e[t]
                            }.bind(null, r));
                        return o
                    }, n.n = function(e) {
                        var t = e && e.__esModule ? function() {
                            return e.default
                        } : function() {
                            return e
                        };
                        return n.d(t, "a", t), t
                    }, n.o = function(e, t) {
                        return Object.prototype.hasOwnProperty.call(e, t)
                    }, n.p = "", n(n.s = 25)
                }([function(e, t) {
                    e.exports = function(e, t) {
                        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                    }
                }, function(e, t) {
                    function n(e, t) {
                        for (var n = 0; n < t.length; n++) {
                            var o = t[n];
                            o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o)
                        }
                    }
                    e.exports = function(e, t, o) {
                        return t && n(e.prototype, t), o && n(e, o), e
                    }
                }, function(e, t, n) {
                    var o = n(8),
                        r = n(5);
                    e.exports = function(e, t) {
                        return !t || "object" !== o(t) && "function" != typeof t ? r(e) : t
                    }
                }, function(e, t) {
                    function n(t) {
                        return e.exports = n = Object.setPrototypeOf ? Object.getPrototypeOf : function(e) {
                            return e.__proto__ || Object.getPrototypeOf(e)
                        }, n(t)
                    }
                    e.exports = n
                }, function(e, t, n) {
                    var o = n(14);
                    e.exports = function(e, t) {
                        if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function");
                        e.prototype = Object.create(t && t.prototype, {
                            constructor: {
                                value: e,
                                writable: !0,
                                configurable: !0
                            }
                        }), t && o(e, t)
                    }
                }, function(e, t) {
                    e.exports = function(e) {
                        if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return e
                    }
                }, function(e, t, n) {
                    var o = n(16),
                        r = n(17),
                        a = n(18);
                    e.exports = function(e) {
                        return o(e) || r(e) || a()
                    }
                }, function(e, t, n) {
                    var o = n(20),
                        r = n(21),
                        a = n(22);
                    e.exports = function(e, t) {
                        return o(e) || r(e, t) || a()
                    }
                }, function(e, t) {
                    function n(e) {
                        return (n = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                            return typeof e
                        } : function(e) {
                            return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
                        })(e)
                    }

                    function o(t) {
                        return "function" == typeof Symbol && "symbol" === n(Symbol.iterator) ? e.exports = o = function(e) {
                            return n(e)
                        } : e.exports = o = function(e) {
                            return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : n(e)
                        }, o(t)
                    }
                    e.exports = o
                }, function(e, t) {
                    e.exports = function(e, t, n) {
                        return t in e ? Object.defineProperty(e, t, {
                            value: n,
                            enumerable: !0,
                            configurable: !0,
                            writable: !0
                        }) : e[t] = n, e
                    }
                }, function(e, t, n) {
                    "use strict";
                    (function(e) {
                        var o = n(12),
                            r = {
                                formatArgs: function(e) {
                                    if (e[0] = "".concat((this.useColors ? "%c" : "") + this.namespace + (this.useColors ? " %c" : " ") + e[0] + (this.useColors ? "%c " : " "), "+").concat(a.humanize(this.diff)), this.useColors) {
                                        var t = "color: ".concat(this.color);
                                        e.splice(1, 0, t, "color: inherit");
                                        var n = 0,
                                            o = 0;
                                        e[0].replace(/%[a-zA-Z%]/g, (function(e) {
                                            "%%" !== e && (n++, "%c" === e && (o = n))
                                        })), e.splice(o, 0, t)
                                    }
                                },
                                save: function(e) {
                                    try {
                                        e ? r.storage.setItem("debug", e) : r.storage.removeItem("debug")
                                    } catch (e) {}
                                },
                                load: function() {
                                    var t;
                                    try {
                                        t = r.storage.getItem("debug")
                                    } catch (e) {}
                                    return !t && void 0 !== e && "env" in e && (t = e.env.DEBUG), t
                                },
                                useColors: function() {
                                    return !("undefined" == typeof window || !window.process || "renderer" !== window.process.type && !window.process.__nwjs) || ("undefined" == typeof navigator || !navigator.userAgent || !navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)) && ("undefined" != typeof document && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance || "undefined" != typeof window && window.console && (window.console.firebug || window.console.exception && window.console.table) || "undefined" != typeof navigator && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/) && parseInt(RegExp.$1, 10) >= 31 || "undefined" != typeof navigator && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))
                                },
                                storage: function() {
                                    try {
                                        return localStorage
                                    } catch (e) {}
                                }(),
                                colors: ["#0000CC", "#0000FF", "#0033CC", "#0033FF", "#0066CC", "#0066FF", "#0099CC", "#0099FF", "#00CC00", "#00CC33", "#00CC66", "#00CC99", "#00CCCC", "#00CCFF", "#3300CC", "#3300FF", "#3333CC", "#3333FF", "#3366CC", "#3366FF", "#3399CC", "#3399FF", "#33CC00", "#33CC33", "#33CC66", "#33CC99", "#33CCCC", "#33CCFF", "#6600CC", "#6600FF", "#6633CC", "#6633FF", "#66CC00", "#66CC33", "#9900CC", "#9900FF", "#9933CC", "#9933FF", "#99CC00", "#99CC33", "#CC0000", "#CC0033", "#CC0066", "#CC0099", "#CC00CC", "#CC00FF", "#CC3300", "#CC3333", "#CC3366", "#CC3399", "#CC33CC", "#CC33FF", "#CC6600", "#CC6633", "#CC9900", "#CC9933", "#CCCC00", "#CCCC33", "#FF0000", "#FF0033", "#FF0066", "#FF0099", "#FF00CC", "#FF00FF", "#FF3300", "#FF3333", "#FF3366", "#FF3399", "#FF33CC", "#FF33FF", "#FF6600", "#FF6633", "#FF9900", "#FF9933", "#FFCC00", "#FFCC33"]
                            };
                        r.log = console.debug || console.log || function() {};
                        var a = Object(o.a)(r);
                        a.formatters.j = function(e) {
                            try {
                                return JSON.stringify(e)
                            } catch (e) {
                                return "[UnexpectedJSONParseError]: ".concat(e.message)
                            }
                        }, t.a = a
                    }).call(this, n(15))
                }, function(e, t, n) {
                    e.exports = n(23)
                }, function(e, t, n) {
                    "use strict";
                    var o = n(6),
                        r = n.n(o);
                    t.a = function(e) {
                        function t(e) {
                            for (var t = 0, n = 0; n < e.length; n++) t = (t << 5) - t + e.charCodeAt(n), t |= 0;
                            return o.colors[Math.abs(t) % o.colors.length]
                        }

                        function o(e) {
                            var n;

                            function r() {
                                for (var e = arguments.length, t = new Array(e), a = 0; a < e; a++) t[a] = arguments[a];
                                if (r.enabled) {
                                    var i = r,
                                        s = Number(new Date),
                                        l = s - (n || s);
                                    i.diff = l, i.prev = n, i.curr = s, n = s, t[0] = o.coerce(t[0]), "string" != typeof t[0] && t.unshift("%O");
                                    var c = 0;
                                    t[0] = t[0].replace(/%([a-zA-Z%])/g, (function(e, n) {
                                        if ("%%" === e) return e;
                                        c++;
                                        var r = o.formatters[n];
                                        if ("function" == typeof r) {
                                            var a = t[c];
                                            e = r.call(i, a), t.splice(c, 1), c--
                                        }
                                        return e
                                    })), o.formatArgs.call(i, t), (i.log || o.log).apply(i, t)
                                }
                            }
                            return r.namespace = e, r.enabled = o.enabled(e), r.useColors = o.useColors(), r.color = t(e), r.destroy = a, r.extend = i, "function" == typeof o.init && o.init(r), o.instances.push(r), r
                        }

                        function a() {
                            var e = o.instances.indexOf(this);
                            return -1 !== e && (o.instances.splice(e, 1), !0)
                        }

                        function i(e, t) {
                            var n = o(this.namespace + (void 0 === t ? ":" : t) + e);
                            return n.log = this.log, n
                        }

                        function s(e) {
                            return e.toString().substring(2, e.toString().length - 2).replace(/\.\*\?$/, "*")
                        }
                        return o.debug = o, o.default = o, o.coerce = function(e) {
                            return e instanceof Error ? e.stack || e.message : e
                        }, o.disable = function() {
                            var e = [].concat(r()(o.names.map(s)), r()(o.skips.map(s).map((function(e) {
                                return "-".concat(e)
                            })))).join(",");
                            return o.enable(""), e
                        }, o.enable = function(e) {
                            var t;
                            o.save(e), o.names = [], o.skips = [];
                            var n = ("string" == typeof e ? e : "").split(/[\s,]+/),
                                r = n.length;
                            for (t = 0; t < r; t++) n[t] && ("-" === (e = n[t].replace(/\*/g, ".*?"))[0] ? o.skips.push(new RegExp("^".concat(e.substr(1), "$"))) : o.names.push(new RegExp("^".concat(e, "$"))));
                            for (t = 0; t < o.instances.length; t++) {
                                var a = o.instances[t];
                                a.enabled = o.enabled(a.namespace)
                            }
                        }, o.enabled = function(e) {
                            if ("*" === e[e.length - 1]) return !0;
                            var t, n;
                            for (t = 0, n = o.skips.length; t < n; t++)
                                if (o.skips[t].test(e)) return !1;
                            for (t = 0, n = o.names.length; t < n; t++)
                                if (o.names[t].test(e)) return !0;
                            return !1
                        }, o.humanize = n(19), Object.keys(e).forEach((function(t) {
                            o[t] = e[t]
                        })), o.instances = [], o.names = [], o.skips = [], o.formatters = {}, o.selectColor = t, o.enable(o.load()), o
                    }
                }, function(e, t) {
                    function n(e, t, n, o, r, a, i) {
                        try {
                            var s = e[a](i),
                                l = s.value
                        } catch (e) {
                            return void n(e)
                        }
                        s.done ? t(l) : Promise.resolve(l).then(o, r)
                    }
                    e.exports = function(e) {
                        return function() {
                            var t = this,
                                o = arguments;
                            return new Promise((function(r, a) {
                                var i = e.apply(t, o);

                                function s(e) {
                                    n(i, r, a, s, l, "next", e)
                                }

                                function l(e) {
                                    n(i, r, a, s, l, "throw", e)
                                }
                                s(void 0)
                            }))
                        }
                    }
                }, function(e, t) {
                    function n(t, o) {
                        return e.exports = n = Object.setPrototypeOf || function(e, t) {
                            return e.__proto__ = t, e
                        }, n(t, o)
                    }
                    e.exports = n
                }, function(e, t) {
                    var n, o, r = e.exports = {};

                    function a() {
                        throw new Error("setTimeout has not been defined")
                    }

                    function i() {
                        throw new Error("clearTimeout has not been defined")
                    }

                    function s(e) {
                        if (n === setTimeout) return setTimeout(e, 0);
                        if ((n === a || !n) && setTimeout) return n = setTimeout, setTimeout(e, 0);
                        try {
                            return n(e, 0)
                        } catch (t) {
                            try {
                                return n.call(null, e, 0)
                            } catch (t) {
                                return n.call(this, e, 0)
                            }
                        }
                    }! function() {
                        try {
                            n = "function" == typeof setTimeout ? setTimeout : a
                        } catch (e) {
                            n = a
                        }
                        try {
                            o = "function" == typeof clearTimeout ? clearTimeout : i
                        } catch (e) {
                            o = i
                        }
                    }();
                    var l, c = [],
                        u = !1,
                        d = -1;

                    function h() {
                        u && l && (u = !1, l.length ? c = l.concat(c) : d = -1, c.length && f())
                    }

                    function f() {
                        if (!u) {
                            var e = s(h);
                            u = !0;
                            for (var t = c.length; t;) {
                                for (l = c, c = []; ++d < t;) l && l[d].run();
                                d = -1, t = c.length
                            }
                            l = null, u = !1,
                                function(e) {
                                    if (o === clearTimeout) return clearTimeout(e);
                                    if ((o === i || !o) && clearTimeout) return o = clearTimeout, clearTimeout(e);
                                    try {
                                        o(e)
                                    } catch (t) {
                                        try {
                                            return o.call(null, e)
                                        } catch (t) {
                                            return o.call(this, e)
                                        }
                                    }
                                }(e)
                        }
                    }

                    function m(e, t) {
                        this.fun = e, this.array = t
                    }

                    function g() {}
                    r.nextTick = function(e) {
                        var t = new Array(arguments.length - 1);
                        if (arguments.length > 1)
                            for (var n = 1; n < arguments.length; n++) t[n - 1] = arguments[n];
                        c.push(new m(e, t)), 1 !== c.length || u || s(f)
                    }, m.prototype.run = function() {
                        this.fun.apply(null, this.array)
                    }, r.title = "browser", r.browser = !0, r.env = {}, r.argv = [], r.version = "", r.versions = {}, r.on = g, r.addListener = g, r.once = g, r.off = g, r.removeListener = g, r.removeAllListeners = g, r.emit = g, r.prependListener = g, r.prependOnceListener = g, r.listeners = function(e) {
                        return []
                    }, r.binding = function(e) {
                        throw new Error("process.binding is not supported")
                    }, r.cwd = function() {
                        return "/"
                    }, r.chdir = function(e) {
                        throw new Error("process.chdir is not supported")
                    }, r.umask = function() {
                        return 0
                    }
                }, function(e, t) {
                    e.exports = function(e) {
                        if (Array.isArray(e)) {
                            for (var t = 0, n = new Array(e.length); t < e.length; t++) n[t] = e[t];
                            return n
                        }
                    }
                }, function(e, t) {
                    e.exports = function(e) {
                        if (Symbol.iterator in Object(e) || "[object Arguments]" === Object.prototype.toString.call(e)) return Array.from(e)
                    }
                }, function(e, t) {
                    e.exports = function() {
                        throw new TypeError("Invalid attempt to spread non-iterable instance")
                    }
                }, function(e, t) {
                    var n = 1e3,
                        o = 6e4,
                        r = 60 * o,
                        a = 24 * r;

                    function i(e, t, n, o) {
                        var r = t >= 1.5 * n;
                        return Math.round(e / n) + " " + o + (r ? "s" : "")
                    }
                    e.exports = function(e, t) {
                        t = t || {};
                        var s = typeof e;
                        if ("string" === s && e.length > 0) return function(e) {
                            if (!((e = String(e)).length > 100)) {
                                var t = /^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);
                                if (t) {
                                    var i = parseFloat(t[1]);
                                    switch ((t[2] || "ms").toLowerCase()) {
                                        case "years":
                                        case "year":
                                        case "yrs":
                                        case "yr":
                                        case "y":
                                            return 315576e5 * i;
                                        case "weeks":
                                        case "week":
                                        case "w":
                                            return 6048e5 * i;
                                        case "days":
                                        case "day":
                                        case "d":
                                            return i * a;
                                        case "hours":
                                        case "hour":
                                        case "hrs":
                                        case "hr":
                                        case "h":
                                            return i * r;
                                        case "minutes":
                                        case "minute":
                                        case "mins":
                                        case "min":
                                        case "m":
                                            return i * o;
                                        case "seconds":
                                        case "second":
                                        case "secs":
                                        case "sec":
                                        case "s":
                                            return i * n;
                                        case "milliseconds":
                                        case "millisecond":
                                        case "msecs":
                                        case "msec":
                                        case "ms":
                                            return i;
                                        default:
                                            return
                                    }
                                }
                            }
                        }(e);
                        if ("number" === s && isFinite(e)) return t.long ? function(e) {
                            var t = Math.abs(e);
                            return t >= a ? i(e, t, a, "day") : t >= r ? i(e, t, r, "hour") : t >= o ? i(e, t, o, "minute") : t >= n ? i(e, t, n, "second") : e + " ms"
                        }(e) : function(e) {
                            var t = Math.abs(e);
                            return t >= a ? Math.round(e / a) + "d" : t >= r ? Math.round(e / r) + "h" : t >= o ? Math.round(e / o) + "m" : t >= n ? Math.round(e / n) + "s" : e + "ms"
                        }(e);
                        throw new Error("val is not a non-empty string or a valid number. val=" + JSON.stringify(e))
                    }
                }, function(e, t) {
                    e.exports = function(e) {
                        if (Array.isArray(e)) return e
                    }
                }, function(e, t) {
                    e.exports = function(e, t) {
                        var n = [],
                            o = !0,
                            r = !1,
                            a = void 0;
                        try {
                            for (var i, s = e[Symbol.iterator](); !(o = (i = s.next()).done) && (n.push(i.value), !t || n.length !== t); o = !0);
                        } catch (e) {
                            r = !0, a = e
                        } finally {
                            try {
                                o || null == s.return || s.return()
                            } finally {
                                if (r) throw a
                            }
                        }
                        return n
                    }
                }, function(e, t) {
                    e.exports = function() {
                        throw new TypeError("Invalid attempt to destructure non-iterable instance")
                    }
                }, function(e, t, n) {
                    var o = function() {
                            return this || "object" == typeof self && self
                        }() || Function("return this")(),
                        r = o.regeneratorRuntime && Object.getOwnPropertyNames(o).indexOf("regeneratorRuntime") >= 0,
                        a = r && o.regeneratorRuntime;
                    if (o.regeneratorRuntime = void 0, e.exports = n(24), r) o.regeneratorRuntime = a;
                    else try {
                        delete o.regeneratorRuntime
                    } catch (e) {
                        o.regeneratorRuntime = void 0
                    }
                }, function(e, t) {
                    ! function(t) {
                        "use strict";
                        var n = Object.prototype,
                            o = n.hasOwnProperty,
                            r = "function" == typeof Symbol ? Symbol : {},
                            a = r.iterator || "@@iterator",
                            i = r.asyncIterator || "@@asyncIterator",
                            s = r.toStringTag || "@@toStringTag",
                            l = "object" == typeof e,
                            c = t.regeneratorRuntime;
                        if (c) l && (e.exports = c);
                        else {
                            (c = t.regeneratorRuntime = l ? e.exports : {}).wrap = g;
                            var u = {},
                                d = {};
                            d[a] = function() {
                                return this
                            };
                            var h = Object.getPrototypeOf,
                                f = h && h(h(A([])));
                            f && f !== n && o.call(f, a) && (d = f);
                            var m = b.prototype = v.prototype = Object.create(d);
                            y.prototype = m.constructor = b, b.constructor = y, b[s] = y.displayName = "GeneratorFunction", c.isGeneratorFunction = function(e) {
                                var t = "function" == typeof e && e.constructor;
                                return !!t && (t === y || "GeneratorFunction" === (t.displayName || t.name))
                            }, c.mark = function(e) {
                                return Object.setPrototypeOf ? Object.setPrototypeOf(e, b) : (e.__proto__ = b, s in e || (e[s] = "GeneratorFunction")), e.prototype = Object.create(m), e
                            }, c.awrap = function(e) {
                                return {
                                    __await: e
                                }
                            }, w(x.prototype), x.prototype[i] = function() {
                                return this
                            }, c.AsyncIterator = x, c.async = function(e, t, n, o) {
                                var r = new x(g(e, t, n, o));
                                return c.isGeneratorFunction(t) ? r : r.next().then((function(e) {
                                    return e.done ? e.value : r.next()
                                }))
                            }, w(m), m[s] = "Generator", m[a] = function() {
                                return this
                            }, m.toString = function() {
                                return "[object Generator]"
                            }, c.keys = function(e) {
                                var t = [];
                                for (var n in e) t.push(n);
                                return t.reverse(),
                                    function n() {
                                        for (; t.length;) {
                                            var o = t.pop();
                                            if (o in e) return n.value = o, n.done = !1, n
                                        }
                                        return n.done = !0, n
                                    }
                            }, c.values = A, S.prototype = {
                                constructor: S,
                                reset: function(e) {
                                    if (this.prev = 0, this.next = 0, this.sent = this._sent = void 0, this.done = !1, this.delegate = null, this.method = "next", this.arg = void 0, this.tryEntries.forEach(E), !e)
                                        for (var t in this) "t" === t.charAt(0) && o.call(this, t) && !isNaN(+t.slice(1)) && (this[t] = void 0)
                                },
                                stop: function() {
                                    this.done = !0;
                                    var e = this.tryEntries[0].completion;
                                    if ("throw" === e.type) throw e.arg;
                                    return this.rval
                                },
                                dispatchException: function(e) {
                                    if (this.done) throw e;
                                    var t = this;

                                    function n(n, o) {
                                        return i.type = "throw", i.arg = e, t.next = n, o && (t.method = "next", t.arg = void 0), !!o
                                    }
                                    for (var r = this.tryEntries.length - 1; r >= 0; --r) {
                                        var a = this.tryEntries[r],
                                            i = a.completion;
                                        if ("root" === a.tryLoc) return n("end");
                                        if (a.tryLoc <= this.prev) {
                                            var s = o.call(a, "catchLoc"),
                                                l = o.call(a, "finallyLoc");
                                            if (s && l) {
                                                if (this.prev < a.catchLoc) return n(a.catchLoc, !0);
                                                if (this.prev < a.finallyLoc) return n(a.finallyLoc)
                                            } else if (s) {
                                                if (this.prev < a.catchLoc) return n(a.catchLoc, !0)
                                            } else {
                                                if (!l) throw new Error("try statement without catch or finally");
                                                if (this.prev < a.finallyLoc) return n(a.finallyLoc)
                                            }
                                        }
                                    }
                                },
                                abrupt: function(e, t) {
                                    for (var n = this.tryEntries.length - 1; n >= 0; --n) {
                                        var r = this.tryEntries[n];
                                        if (r.tryLoc <= this.prev && o.call(r, "finallyLoc") && this.prev < r.finallyLoc) {
                                            var a = r;
                                            break
                                        }
                                    }
                                    a && ("break" === e || "continue" === e) && a.tryLoc <= t && t <= a.finallyLoc && (a = null);
                                    var i = a ? a.completion : {};
                                    return i.type = e, i.arg = t, a ? (this.method = "next", this.next = a.finallyLoc, u) : this.complete(i)
                                },
                                complete: function(e, t) {
                                    if ("throw" === e.type) throw e.arg;
                                    return "break" === e.type || "continue" === e.type ? this.next = e.arg : "return" === e.type ? (this.rval = this.arg = e.arg, this.method = "return", this.next = "end") : "normal" === e.type && t && (this.next = t), u
                                },
                                finish: function(e) {
                                    for (var t = this.tryEntries.length - 1; t >= 0; --t) {
                                        var n = this.tryEntries[t];
                                        if (n.finallyLoc === e) return this.complete(n.completion, n.afterLoc), E(n), u
                                    }
                                },
                                catch: function(e) {
                                    for (var t = this.tryEntries.length - 1; t >= 0; --t) {
                                        var n = this.tryEntries[t];
                                        if (n.tryLoc === e) {
                                            var o = n.completion;
                                            if ("throw" === o.type) {
                                                var r = o.arg;
                                                E(n)
                                            }
                                            return r
                                        }
                                    }
                                    throw new Error("illegal catch attempt")
                                },
                                delegateYield: function(e, t, n) {
                                    return this.delegate = {
                                        iterator: A(e),
                                        resultName: t,
                                        nextLoc: n
                                    }, "next" === this.method && (this.arg = void 0), u
                                }
                            }
                        }

                        function g(e, t, n, o) {
                            var r = t && t.prototype instanceof v ? t : v,
                                a = Object.create(r.prototype),
                                i = new S(o || []);
                            return a._invoke = function(e, t, n) {
                                var o = "suspendedStart";
                                return function(r, a) {
                                    if ("executing" === o) throw new Error("Generator is already running");
                                    if ("completed" === o) {
                                        if ("throw" === r) throw a;
                                        return C()
                                    }
                                    for (n.method = r, n.arg = a;;) {
                                        var i = n.delegate;
                                        if (i) {
                                            var s = T(i, n);
                                            if (s) {
                                                if (s === u) continue;
                                                return s
                                            }
                                        }
                                        if ("next" === n.method) n.sent = n._sent = n.arg;
                                        else if ("throw" === n.method) {
                                            if ("suspendedStart" === o) throw o = "completed", n.arg;
                                            n.dispatchException(n.arg)
                                        } else "return" === n.method && n.abrupt("return", n.arg);
                                        o = "executing";
                                        var l = p(e, t, n);
                                        if ("normal" === l.type) {
                                            if (o = n.done ? "completed" : "suspendedYield", l.arg === u) continue;
                                            return {
                                                value: l.arg,
                                                done: n.done
                                            }
                                        }
                                        "throw" === l.type && (o = "completed", n.method = "throw", n.arg = l.arg)
                                    }
                                }
                            }(e, n, i), a
                        }

                        function p(e, t, n) {
                            try {
                                return {
                                    type: "normal",
                                    arg: e.call(t, n)
                                }
                            } catch (e) {
                                return {
                                    type: "throw",
                                    arg: e
                                }
                            }
                        }

                        function v() {}

                        function y() {}

                        function b() {}

                        function w(e) {
                            ["next", "throw", "return"].forEach((function(t) {
                                e[t] = function(e) {
                                    return this._invoke(t, e)
                                }
                            }))
                        }

                        function x(e) {
                            var t;
                            this._invoke = function(n, r) {
                                function a() {
                                    return new Promise((function(t, a) {
                                        ! function t(n, r, a, i) {
                                            var s = p(e[n], e, r);
                                            if ("throw" !== s.type) {
                                                var l = s.arg,
                                                    c = l.value;
                                                return c && "object" == typeof c && o.call(c, "__await") ? Promise.resolve(c.__await).then((function(e) {
                                                    t("next", e, a, i)
                                                }), (function(e) {
                                                    t("throw", e, a, i)
                                                })) : Promise.resolve(c).then((function(e) {
                                                    l.value = e, a(l)
                                                }), (function(e) {
                                                    return t("throw", e, a, i)
                                                }))
                                            }
                                            i(s.arg)
                                        }(n, r, t, a)
                                    }))
                                }
                                return t = t ? t.then(a, a) : a()
                            }
                        }

                        function T(e, t) {
                            var n = e.iterator[t.method];
                            if (void 0 === n) {
                                if (t.delegate = null, "throw" === t.method) {
                                    if (e.iterator.return && (t.method = "return", t.arg = void 0, T(e, t), "throw" === t.method)) return u;
                                    t.method = "throw", t.arg = new TypeError("The iterator does not provide a 'throw' method")
                                }
                                return u
                            }
                            var o = p(n, e.iterator, t.arg);
                            if ("throw" === o.type) return t.method = "throw", t.arg = o.arg, t.delegate = null, u;
                            var r = o.arg;
                            return r ? r.done ? (t[e.resultName] = r.value, t.next = e.nextLoc, "return" !== t.method && (t.method = "next", t.arg = void 0), t.delegate = null, u) : r : (t.method = "throw", t.arg = new TypeError("iterator result is not an object"), t.delegate = null, u)
                        }

                        function I(e) {
                            var t = {
                                tryLoc: e[0]
                            };
                            1 in e && (t.catchLoc = e[1]), 2 in e && (t.finallyLoc = e[2], t.afterLoc = e[3]), this.tryEntries.push(t)
                        }

                        function E(e) {
                            var t = e.completion || {};
                            t.type = "normal", delete t.arg, e.completion = t
                        }

                        function S(e) {
                            this.tryEntries = [{
                                tryLoc: "root"
                            }], e.forEach(I, this), this.reset(!0)
                        }

                        function A(e) {
                            if (e) {
                                var t = e[a];
                                if (t) return t.call(e);
                                if ("function" == typeof e.next) return e;
                                if (!isNaN(e.length)) {
                                    var n = -1,
                                        r = function t() {
                                            for (; ++n < e.length;)
                                                if (o.call(e, n)) return t.value = e[n], t.done = !1, t;
                                            return t.value = void 0, t.done = !0, t
                                        };
                                    return r.next = r
                                }
                            }
                            return {
                                next: C
                            }
                        }

                        function C() {
                            return {
                                value: void 0,
                                done: !0
                            }
                        }
                    }(function() {
                        return this || "object" == typeof self && self
                    }() || Function("return this")())
                }, function(e, t, n) {
                    "use strict";
                    n.r(t);
                    var o = {};
                    n.r(o), n.d(o, "drawBrushPixels", (function() {
                        return te
                    })), n.d(o, "eraseIfSegmentIndex", (function() {
                        return ee
                    })), n.d(o, "eraseOutsideBoundingBox", (function() {
                        return ne
                    })), n.d(o, "eraseInsideShape", (function() {
                        return se
                    })), n.d(o, "eraseOutsideShape", (function() {
                        return le
                    })), n.d(o, "fillOutsideBoundingBox", (function() {
                        return ce
                    })), n.d(o, "fillInsideShape", (function() {
                        return he
                    })), n.d(o, "fillOutsideShape", (function() {
                        return fe
                    })), n.d(o, "floodFill", (function() {
                        return me
                    })), n.d(o, "getBoundingBoxAroundCircle", (function() {
                        return be
                    })), n.d(o, "getBoundingBoxAroundPolygon", (function() {
                        return we
                    })), n.d(o, "getCircle", (function() {
                        return xe
                    })), n.d(o, "getPixelPathBetweenPixels", (function() {
                        return Ee
                    })), n.d(o, "isSameSegment", (function() {
                        return ae
                    })), n.d(o, "triggerLabelmapModifiedEvent", (function() {
                        return _e
                    })), n.d(o, "getDiffBetweenPixelData", (function() {
                        return Le
                    }));
                    var r = {};
                    n.r(r), n.d(r, "angleCursor", (function() {
                        return wr
                    })), n.d(r, "arrowAnnotateCursor", (function() {
                        return xr
                    })), n.d(r, "bidirectionalCursor", (function() {
                        return Tr
                    })), n.d(r, "cobbAngleCursor", (function() {
                        return Ir
                    })), n.d(r, "circleRoiCursor", (function() {
                        return Er
                    })), n.d(r, "ellipticalRoiCursor", (function() {
                        return Sr
                    })), n.d(r, "freehandRoiCursor", (function() {
                        return Ar
                    })), n.d(r, "freehandRoiSculptorCursor", (function() {
                        return Cr
                    })), n.d(r, "lengthCursor", (function() {
                        return Mr
                    })), n.d(r, "probeCursor", (function() {
                        return Dr
                    })), n.d(r, "rectangleRoiCursor", (function() {
                        return Pr
                    })), n.d(r, "textMarkerCursor", (function() {
                        return kr
                    })), n.d(r, "crosshairsCursor", (function() {
                        return _r
                    })), n.d(r, "eraserCursor", (function() {
                        return Lr
                    })), n.d(r, "magnifyCursor", (function() {
                        return Or
                    })), n.d(r, "panCursor", (function() {
                        return Rr
                    })), n.d(r, "rotateCursor", (function() {
                        return Nr
                    })), n.d(r, "stackScrollCursor", (function() {
                        return Ur
                    })), n.d(r, "wwwcRegionCursor", (function() {
                        return Br
                    })), n.d(r, "wwwcCursor", (function() {
                        return Vr
                    })), n.d(r, "zoomCursor", (function() {
                        return Fr
                    })), n.d(r, "freehandEraseInsideCursor", (function() {
                        return Yr
                    })), n.d(r, "freehandFillInsideCursor", (function() {
                        return Zr
                    })), n.d(r, "freehandEraseOutsideCursor", (function() {
                        return Kr
                    })), n.d(r, "freehandFillOutsideCursor", (function() {
                        return Xr
                    })), n.d(r, "segRectangleEraseInsideCursor", (function() {
                        return Jr
                    })), n.d(r, "segRectangleFillInsideCursor", (function() {
                        return Qr
                    })), n.d(r, "segRectangleEraseOutsideCursor", (function() {
                        return $r
                    })), n.d(r, "segRectangleFillOutsideCursor", (function() {
                        return ea
                    })), n.d(r, "segCircleEraseInsideCursor", (function() {
                        return ta
                    })), n.d(r, "segCircleFillInsideCursor", (function() {
                        return na
                    })), n.d(r, "segCircleEraseOutsideCursor", (function() {
                        return oa
                    })), n.d(r, "segCircleFillOutsideCursor", (function() {
                        return ra
                    }));
                    var a = n(0),
                        i = n.n(a),
                        s = n(1),
                        l = n.n(s),
                        c = n(2),
                        u = n.n(c),
                        d = n(3),
                        h = n.n(d),
                        f = n(4),
                        m = n.n(f),
                        g = window.cornerstone,
                        p = window.cornerstoneMath,
                        v = window.Hammer,
                        y = {
                            set cornerstone(e) {
                                g = e
                            },
                            get cornerstone() {
                                return g
                            },
                            set cornerstoneMath(e) {
                                p = e
                            },
                            get cornerstoneMath() {
                                return p
                            },
                            set Hammer(e) {
                                v = e
                            },
                            get Hammer() {
                                return v
                            }
                        },
                        b = n(8),
                        w = n.n(b),
                        x = {
                            MOUSE_DOWN: "cornerstonetoolsmousedown",
                            MOUSE_UP: "cornerstonetoolsmouseup",
                            MOUSE_DOWN_ACTIVATE: "cornerstonetoolsmousedownactivate",
                            MOUSE_DRAG: "cornerstonetoolsmousedrag",
                            MOUSE_MOVE: "cornerstonetoolsmousemove",
                            MOUSE_CLICK: "cornerstonetoolsmouseclick",
                            MOUSE_DOUBLE_CLICK: "cornerstonetoolsmousedoubleclick",
                            MOUSE_WHEEL: "cornerstonetoolsmousewheel",
                            TOUCH_START: "cornerstonetoolstouchstart",
                            TOUCH_START_ACTIVE: "cornerstonetoolstouchstartactive",
                            TOUCH_END: "cornerstonetoolstouchend",
                            TOUCH_DRAG: "cornerstonetoolstouchdrag",
                            TOUCH_DRAG_END: "cornerstonetoolstouchdragend",
                            TOUCH_PINCH: "cornerstonetoolstouchpinch",
                            TOUCH_ROTATE: "cornerstonetoolstouchrotate",
                            TOUCH_PRESS: "cornerstonetoolstouchpress",
                            TAP: "cornerstonetoolstap",
                            DOUBLE_TAP: "cornerstonetoolsdoubletap",
                            MULTI_TOUCH_START: "cornerstonetoolsmultitouchstart",
                            MULTI_TOUCH_START_ACTIVE: "cornerstonetoolsmultitouchstartactive",
                            MULTI_TOUCH_DRAG: "cornerstonetoolsmultitouchdrag",
                            KEY_DOWN: "cornerstonetoolskeydown",
                            KEY_UP: "cornerstonetoolskeyup",
                            KEY_PRESS: "cornerstonetoolskeypress",
                            MEASUREMENT_ADDED: "cornerstonetoolsmeasurementadded",
                            MEASUREMENT_MODIFIED: "cornerstonetoolsmeasurementmodified",
                            MEASUREMENT_COMPLETED: "cornerstonetoolsmeasurementcompleted",
                            MEASUREMENT_REMOVED: "cornerstonetoolsmeasurementremoved",
                            TOOL_DEACTIVATED: "cornerstonetoolstooldeactivated",
                            CLIP_STOPPED: "cornerstonetoolsclipstopped",
                            STACK_SCROLL: "cornerstonetoolsstackscroll",
                            STACK_PREFETCH_IMAGE_LOADED: "cornerstonetoolsstackprefetchimageloaded",
                            STACK_PREFETCH_DONE: "cornerstonetoolsstackprefetchdone",
                            LABELMAP_MODIFIED: "cornersontetoolslabelmapmodified"
                        };

                    function T(e, t) {
                        var n, o = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : null;
                        return "function" == typeof window.CustomEvent ? n = new CustomEvent(t, {
                            detail: o,
                            cancelable: !0
                        }) : (n = document.createEvent("CustomEvent")).initCustomEvent(t, !0, !0, o), e.dispatchEvent(n)
                    }

                    function I(e) {
                        return e instanceof HTMLElement ? e : yt.enabledElementByUID(e)
                    }
                    var E = {
                            UINT_16_ARRAY: 0,
                            FLOAT_32_ARRAY: 1
                        },
                        S = E.UINT_16_ARRAY,
                        A = E.FLOAT_32_ARRAY;

                    function C(e, t, n) {
                        var o, r = wt("segmentation").configuration;
                        switch (r.arrayType) {
                            case S:
                                o = 2;
                                break;
                            case A:
                                o = 4;
                                break;
                            default:
                                throw new Error("Unsupported Array Type ".concat(r.arrayType))
                        }
                        e.labelmaps3D[t] = {
                            buffer: new ArrayBuffer(n * o),
                            labelmaps2D: [],
                            metadata: [],
                            activeSegmentIndex: 1,
                            colorLUTIndex: 0,
                            segmentsHidden: [],
                            undo: [],
                            redo: []
                        }
                    }

                    function M() {
                        var e = {};

                        function t(t, n, o) {
                            !1 === e.hasOwnProperty(t) && (e[t] = {});
                            var r = e[t];
                            !1 === r.hasOwnProperty(n) && (r[n] = {
                                data: []
                            }), r[n].data.push(o)
                        }

                        function n(t, n) {
                            if (!1 !== e.hasOwnProperty(t)) {
                                var o = e[t];
                                if (!1 !== o.hasOwnProperty(n)) return o[n]
                            }
                        }

                        function o(t, n, o) {
                            e[t][n] = o
                        }

                        function r(t) {
                            !1 !== e.hasOwnProperty(t) && delete e[t]
                        }
                        return {
                            get: function(e, t) {
                                var o = y.cornerstone.getEnabledElement(e);
                                if (o.image) return n(o.image.imageId, t)
                            },
                            add: function(e, n, o) {
                                var r = y.cornerstone.getEnabledElement(e);
                                r.image && t(r.image.imageId, n, o)
                            },
                            set: function(e, t, n) {
                                var r = y.cornerstone.getEnabledElement(e);
                                r.image && o(r.image.imageId, t, n)
                            },
                            clear: function(e) {
                                var t = y.cornerstone.getEnabledElement(e);
                                t.image && r(t.image.imageId)
                            },
                            getImageIdToolState: n,
                            addImageIdToolState: t,
                            setImageIdToolState: o,
                            clearImageIdToolState: r,
                            saveImageIdToolState: function(t) {
                                return e[t]
                            },
                            restoreImageIdToolState: function(t, n) {
                                e[t] = n
                            },
                            saveToolState: function() {
                                return e
                            },
                            restoreToolState: function(t) {
                                e = t
                            },
                            toolState: e
                        }
                    }
                    var D = M();

                    function P(e) {
                        var t = y.cornerstone.getEnabledElement(e);
                        return void 0 === t.toolStateManager && (t.toolStateManager = D), t.toolStateManager
                    }

                    function k(e, t, n) {
                        var o = P(e);
                        n.uuid = n.uuid || "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, (function(e) {
                            var t = 16 * Math.random() | 0;
                            return ("x" === e ? t : 3 & t | 8).toString(16)
                        })), o.add(e, t, n), T(e, x.MEASUREMENT_ADDED, {
                            toolName: t,
                            toolType: t,
                            element: e,
                            measurementData: n
                        })
                    }

                    function _(e, t) {
                        return P(e).get(e, t)
                    }

                    function L(e, t, n) {
                        var o = P(e).get(e, t);
                        if (o && o.data && o.data.length) {
                            for (var r = -1, a = 0; a < o.data.length; a++) o.data[a] === n && (r = a); - 1 !== r && (o.data.splice(r, 1), T(e, x.MEASUREMENT_REMOVED, {
                                toolName: t,
                                toolType: t,
                                element: e,
                                measurementData: n
                            }))
                        }
                    }

                    function O(e, t) {
                        var n = P(e).get(e, t);
                        void 0 !== n && (n.data = [])
                    }

                    function R(e, t) {
                        y.cornerstone.getEnabledElement(e).toolStateManager = t
                    }
                    var N = n(10),
                        U = Object(N.a)("cornerstoneTools"),
                        B = function(e) {
                            var t = U.extend(e);
                            return {
                                log: t,
                                warn: t,
                                error: void 0
                            }
                        },
                        V = function() {
                            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "".concat("cornerstoneTools", ":*");
                            return N.a.enable(e)
                        },
                        F = function() {
                            return N.a.disable()
                        },
                        H = {
                            series: {},
                            colorLutTables: []
                        },
                        q = B("store:modules:segmentationModule:metadata");

                    function j(e) {
                        var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : "increase",
                            n = wt("segmentation").configuration,
                            o = _(e, "stack").data[0].imageIds[0],
                            r = H.series[o];
                        if (r) {
                            var a = r.activeLabelmapIndex,
                                i = r.labelmaps3D[a];
                            switch (t) {
                                case "increase":
                                    i.activeSegmentIndex++, i.activeSegmentIndex > n.segmentsPerLabelmap && (i.activeSegmentIndex = 1);
                                    break;
                                case "decrease":
                                    i.activeSegmentIndex--, i.activeSegmentIndex <= 0 && (i.activeSegmentIndex = n.segmentsPerLabelmap)
                            }
                        }
                    }
                    var z = B("store:modules:segmentationModule:segmentVisibility"),
                        W = B("store:modules:segmentationModule:getLabelmaps3D");

                    function G(e) {
                        var t = I(e);
                        if (t) {
                            var n = _(t, "stack");
                            if (n) {
                                var o, r, a = n.data[0],
                                    i = a.imageIds[0],
                                    s = H.series[i];
                                return s && (o = s.labelmaps3D, r = s.activeLabelmapIndex), {
                                    labelmaps3D: o,
                                    activeLabelmapIndex: r,
                                    currentImageIdIndex: a.currentImageIdIndex
                                }
                            }
                            W.error("Consumers must define stacks in their application if using segmentations in cornerstoneTools.")
                        }
                    }

                    function Y(e, t) {
                        var n = G(e),
                            o = n.labelmaps3D,
                            r = n.activeLabelmapIndex;
                        return o[t = void 0 !== t ? t : r]
                    }
                    var Z = E.UINT_16_ARRAY,
                        K = E.FLOAT_32_ARRAY;

                    function X(e, t) {
                        var n = I(e);
                        if (n) {
                            var o = G(n).labelmaps3D;
                            if (!o) return [];
                            var r, a, i = wt("segmentation").configuration;
                            switch (i.arrayType) {
                                case Z:
                                    r = "Uint16Array", a = "2";
                                    break;
                                case K:
                                    r = "Float32Array", a = "4";
                                    break;
                                default:
                                    throw new Error("Unsupported Array Type ".concat(i.arrayType))
                            }
                            var s = H.colorLutTables;
                            if (void 0 !== t) {
                                var l = o[t];
                                return l ? {
                                    labelmapIndex: t,
                                    bytesPerVoxel: a,
                                    type: r,
                                    buffer: l.buffer,
                                    colorLUT: s[l.colorLUTIndex]
                                } : void 0
                            }
                            for (var c = [], u = 0; u < o.length; u++) {
                                var d = o[u];
                                d && c.push({
                                    labelmapIndex: u,
                                    bytesPerVoxel: 2,
                                    buffer: d.buffer,
                                    colorLUT: s[d.colorLUTIndex]
                                })
                            }
                            return c
                        }
                    }
                    var J = n(6),
                        Q = n.n(J);

                    function $(e) {
                        return Q()(new Set(e))
                    }

                    function ee(e, t, n) {
                        t[e] === n && (t[e] = 0)
                    }

                    function te(e, t, n, o) {
                        var r = arguments.length > 4 && void 0 !== arguments[4] && arguments[4],
                            a = function(e, t) {
                                return t * o + e
                            };
                        e.forEach((function(e) {
                            var o = a.apply(void 0, Q()(e));
                            r ? ee(o, t, n) : t[o] = n
                        }))
                    }

                    function ne(e, t, n, o) {
                        for (var r = e.detail, a = t.pixelData, i = t.segmentIndex, s = r.image, l = s.width, c = s.height, u = 0; u < l; u++)
                            for (var d = 0; d < n[1]; d++) ee(d * l + u, a, i);
                        for (var h = 0; h < n[0]; h++)
                            for (var f = n[1]; f < o[1]; f++) ee(f * l + h, a, i);
                        for (var m = o[0]; m < l; m++)
                            for (var g = n[1]; g < o[1]; g++) ee(g * l + m, a, i);
                        for (var p = 0; p < l; p++)
                            for (var v = o[1]; v < c; v++) ee(v * l + p, a, i)
                    }
                    var oe = n(7),
                        re = n.n(oe);

                    function ae(e, t, n) {
                        return t[e] === n
                    }

                    function ie(e, t, n, o, r) {
                        var a = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : "inside",
                            i = e.detail.image.width,
                            s = t.pixelData,
                            l = t.segmentIndex,
                            c = re()(o, 2),
                            u = c[0],
                            d = c[1],
                            h = re()(r, 2),
                            f = h[0],
                            m = h[1];
                        "outside" === a && ne(e, t, o, r);
                        for (var g = u; g < f; g++)
                            for (var p = d; p < m; p++) {
                                var v = p * i + g;
                                ae(v, s, l) && n({
                                    x: g,
                                    y: p
                                }) && (s[v] = 0)
                            }
                    }

                    function se(e, t, n, o, r) {
                        ie(e, t, n, o, r, "inside")
                    }

                    function le(e, t, n, o, r) {
                        ie(e, t, (function(e) {
                            return !n(e)
                        }), o, r, "outside")
                    }

                    function ce(e, t, n, o) {
                        for (var r = t.pixelData, a = t.segmentIndex, i = e.detail.image, s = i.width, l = i.height, c = 0; c < s; c++)
                            for (var u = 0; u < n[1]; u++) r[u * s + c] = a;
                        for (var d = 0; d < n[0]; d++)
                            for (var h = n[1]; h < o[1]; h++) r[h * s + d] = a;
                        for (var f = o[0]; f < s; f++)
                            for (var m = n[1]; m < o[1]; m++) r[m * s + f] = a;
                        for (var g = 0; g < s; g++)
                            for (var p = o[1]; p < l; p++) r[p * s + g] = a
                    }
                    B("util:segmentation:operations:eraseOutsideCircle");
                    var ue = B("util:segmentation:operations:helpers:fillShape");

                    function de(e, t, n, o, r) {
                        var a = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : "inside",
                            i = t.pixelData,
                            s = t.segmentIndex;
                        if (void 0 !== i && void 0 !== s) {
                            var l = e.detail.image.width,
                                c = re()(o, 2),
                                u = c[0],
                                d = c[1],
                                h = re()(r, 2),
                                f = h[0],
                                m = h[1];
                            "outside" === a && ce(e, t, o, r);
                            for (var g = u; g < f; g++)
                                for (var p = d; p < m; p++) {
                                    var v = p * l + g;
                                    n({
                                        x: g,
                                        y: p
                                    }) && (i[v] = s)
                                }
                        } else ue.error("fillInsideShape requires operationData to contain pixelData and segmentIndex")
                    }

                    function he(e, t, n, o, r) {
                        de(e, t, n, o, r, "inside")
                    }

                    function fe(e, t, n, o, r) {
                        de(e, t, (function(e) {
                            return !n(e)
                        }), o, r, "outside")
                    }
                    var me = function(e, t) {
                        var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                            o = n.onFlood || function() {},
                            r = n.onBoundary || function() {},
                            a = n.equals || ge,
                            i = n.diagonals || !1,
                            s = w(t),
                            l = T(),
                            c = [],
                            u = [],
                            d = {},
                            h = {};
                        for (c.push({
                                currentArgs: t
                            }); c.length > 0;) f(c.pop());
                        return {
                            flooded: u,
                            boundaries: E()
                        };

                        function f(e) {
                            var t = e.currentArgs,
                                n = e.previousArgs;
                            m(t) || (g(t), p(t) ? (v(t), b(t)) : y(n))
                        }

                        function m(e) {
                            return !0 === d[e]
                        }

                        function g(e) {
                            d[e] = !0
                        }

                        function p(e) {
                            var t = x(w, [e]);
                            return x(a, [t, s])
                        }

                        function v(e) {
                            u.push(e), o.apply(void 0, Q()(e))
                        }

                        function y(e) {
                            h[e] = e, r.apply(void 0, Q()(e))
                        }

                        function b(e) {
                            for (var t = 0; t < l.length; t += 1) {
                                for (var n = l[t], o = e.slice(0), r = 0; r < e.length; r += 1) o[r] += n[r];
                                c.push({
                                    currentArgs: o,
                                    previousArgs: e
                                })
                            }
                        }

                        function w(t) {
                            return e.apply(void 0, Q()(t))
                        }

                        function x(e, t) {
                            try {
                                return e.apply(void 0, Q()(t))
                            } catch (e) {
                                return
                            }
                        }

                        function T() {
                            return I(t.length).filter((function(e) {
                                var t = pe(e);
                                return 0 !== t && (1 === t || i)
                            }))
                        }

                        function I(e) {
                            for (var t = [], n = function(e) {
                                    return e.split("").map((function(e) {
                                        return parseInt(e, 10) - 1
                                    }))
                                }, o = 0; o < Math.pow(3, e); o += 1) {
                                var r = ve(o.toString(3), "0", e);
                                t.push(n(r))
                            }
                            return t
                        }

                        function E() {
                            var e = [];
                            for (var t in h) h.hasOwnProperty(t) && e.unshift(h[t]);
                            return e
                        }
                    };

                    function ge(e, t) {
                        return e === t
                    }

                    function pe(e) {
                        for (var t = 0, n = 0; n < e.length; n += 1) 0 !== e[n] && (t += 1);
                        return t
                    }

                    function ve(e, t, n) {
                        return (new Array(n + 1).join(t) + e).slice(-n)
                    }

                    function ye(e, t) {
                        var n = (0, y.cornerstoneMath.point.distance)(e, t);
                        return {
                            left: Math.floor(Math.min(e.x - n, t.x)),
                            top: Math.floor(Math.min(e.y - n, t.y)),
                            width: 2 * n,
                            height: 2 * n
                        }
                    }

                    function be(e) {
                        var t = e.detail.handles,
                            n = e.detail.image,
                            o = n.width,
                            r = n.height,
                            a = ye(t.start, t.end),
                            i = a.width + a.left,
                            s = a.left,
                            l = a.top + a.height,
                            c = a.top;
                        return s = Math.floor(s), c = Math.floor(c), i = Math.floor(i), l = Math.floor(l), i = Math.min(o, i), s = Math.max(0, s), l = Math.min(r, l), [
                            [s, c = Math.max(0, c)],
                            [i, l]
                        ]
                    }

                    function we(e, t) {
                        var n = 1 / 0,
                            o = 0,
                            r = 1 / 0,
                            a = 0,
                            i = t.width,
                            s = t.height;
                        return e.forEach((function(e) {
                            n = Math.min(e[0], n), o = Math.max(e[0], o), r = Math.min(e[1], r), a = Math.max(e[1], a)
                        })), n = Math.floor(n), r = Math.floor(r), o = Math.floor(o), a = Math.floor(a), o = Math.min(i, o), n = Math.max(0, n), a = Math.min(s, a), r = Math.max(0, r), [
                            [n, r],
                            [o, a]
                        ]
                    }

                    function xe(e, t, n) {
                        var o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 0,
                            r = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : 0,
                            a = Math.floor(o),
                            i = Math.floor(r);
                        if (1 === e) return [
                            [a, i]
                        ];
                        for (var s = [], l = 0, c = -e; c <= e; c++) {
                            var u = i + c;
                            if (!(u > t || u < 0))
                                for (var d = -e; d <= e; d++) {
                                    var h = a + d;
                                    h >= n || h < 0 || d * d + c * c < e * e && (s[l++] = [a + d, i + c])
                                }
                        }
                        return s
                    }
                    var Te = 1 / Math.sqrt(2),
                        Ie = {
                            up: {
                                x: 0,
                                y: 1
                            },
                            upRight: {
                                x: Te,
                                y: Te
                            },
                            right: {
                                x: 1,
                                y: 0
                            },
                            downRight: {
                                x: Te,
                                y: -Te
                            },
                            down: {
                                x: 0,
                                y: 1
                            },
                            downLeft: {
                                x: -Te,
                                y: -Te
                            },
                            left: {
                                x: -1,
                                y: 0
                            },
                            upLeft: {
                                x: -Te,
                                y: Te
                            }
                        },
                        Ee = function(e, t) {
                            for (var n = {
                                    x: e.x,
                                    y: e.y
                                }, o = []; t.x !== n.x || t.y !== n.y;) t.x === n.x ? t.y > n.y ? n.y++ : n.y-- : t.y === n.y ? t.x > n.x ? n.x++ : n.x-- : t.y > n.y ? t.x > n.x ? Se(n, t) : Ae(n, t) : t.x > n.x ? Ce(n, t) : Me(n, t), o.push({
                                x: n.x,
                                y: n.y
                            });
                            return o.pop(), o
                        };

                    function Se(e, t) {
                        var n = De(e, t);
                        switch (ke([Pe(n, Ie.up), Pe(n, Ie.right), Pe(n, Ie.upRight)])) {
                            case 0:
                                e.y++;
                                break;
                            case 1:
                                e.x++;
                                break;
                            case 2:
                                e.y++, e.x++
                        }
                    }

                    function Ae(e, t) {
                        var n = De(e, t);
                        switch (ke([Pe(n, Ie.up), Pe(n, Ie.left), Pe(n, Ie.upLeft)])) {
                            case 0:
                                e.y++;
                                break;
                            case 1:
                                e.x--;
                                break;
                            case 2:
                                e.y++, e.x--
                        }
                    }

                    function Ce(e, t) {
                        var n = De(e, t);
                        switch (ke([Pe(n, Ie.down), Pe(n, Ie.right), Pe(n, Ie.downRight)])) {
                            case 0:
                                e.y--;
                                break;
                            case 1:
                                e.x++;
                                break;
                            case 2:
                                e.y--, e.x++
                        }
                    }

                    function Me(e, t) {
                        var n = De(e, t);
                        switch (ke([Pe(n, Ie.down), Pe(n, Ie.left), Pe(n, Ie.downLeft)])) {
                            case 0:
                                e.y--;
                                break;
                            case 1:
                                e.x--;
                                break;
                            case 2:
                                e.y--, e.x--
                        }
                    }

                    function De(e, t) {
                        var n = y.cornerstoneMath.point.distance(e, t);
                        return {
                            x: (t.x - e.x) / n,
                            y: (t.y - e.y) / n
                        }
                    }

                    function Pe(e, t) {
                        return e.x * t.x + e.y * t.y
                    }

                    function ke(e) {
                        var t = e[0] > e[1] ? 0 : 1;
                        return e[2] > e[t] && (t = 2), t
                    }

                    function _e(e, t) {
                        var n = wt("segmentation").getters;
                        t = void 0 === t ? n.activeLabelmapIndex(e) : t, y.cornerstone.triggerEvent(e, x.LABELMAP_MODIFIED, {
                            labelmapIndex: t
                        })
                    }

                    function Le(e, t) {
                        for (var n = [], o = 0; o < e.length; o++) e[o] !== t[o] && n.push([o, e[o], t[o]]);
                        return n
                    }
                    var Oe = E.UINT_16_ARRAY,
                        Re = E.FLOAT_32_ARRAY;

                    function Ne(e, t, n) {
                        var o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : [],
                            r = arguments.length > 4 ? arguments[4] : void 0,
                            a = arguments.length > 5 ? arguments[5] : void 0,
                            i = arguments.length > 6 && void 0 !== arguments[6] ? arguments[6] : 0,
                            s = wt("segmentation").configuration,
                            l = H.series[e];
                        l || (H.series[e] = {
                            activeLabelmapIndex: n,
                            labelmaps3D: []
                        }, l = H.series[e]), l.labelmaps3D[n] = {
                            buffer: t,
                            labelmaps2D: [],
                            metadata: o,
                            activeSegmentIndex: 1,
                            colorLUTIndex: i,
                            segmentsHidden: [],
                            undo: [],
                            redo: []
                        };
                        for (var c = l.labelmaps3D[n].labelmaps2D, u = t.byteLength / r, d = 0; d < r; d++) {
                            var h = void 0;
                            switch (s.arrayType) {
                                case Oe:
                                    h = new Uint16Array(t, u * d, u / 2);
                                    break;
                                case Re:
                                    h = new Float32Array(t, u * d, u / 4);
                                    break;
                                default:
                                    throw new Error("Unsupported Array Type ".concat(s.arrayType))
                            }
                            var f = a ? a[d] : $(h);
                            f && f.some((function(e) {
                                return e
                            })) && (c[d] = {
                                pixelData: h,
                                segmentsOnLabelmap: f
                            })
                        }
                    }
                    var Ue = B("store:modules:segmentationModule:getLabelmapStats");

                    function Be(e, t, n) {
                        var o = e.length,
                            r = t[n].imagePositionPatient;
                        if (0 === n) return Ve(r, t[n + 1].imagePositionPatient);
                        if (n === o - 1) return Ve(r, t[n - 1].imagePositionPatient);
                        var a = t[n - 1].imagePositionPatient,
                            i = t[n + 1].imagePositionPatient;
                        return (Ve(r, a) + Ve(r, i)) / 2
                    }

                    function Ve(e, t) {
                        return Math.sqrt(Math.pow(e[0] - t[0], 2) + Math.pow(e[1] - t[1], 2) + Math.pow(e[2] - t[2], 2))
                    }
                    var Fe = E.UINT_16_ARRAY,
                        He = E.FLOAT_32_ARRAY;

                    function qe(e, t, n, o, r) {
                        var a, i = wt("segmentation").configuration,
                            s = o * r,
                            l = s * n;
                        switch (i.arrayType) {
                            case Fe:
                                a = new Uint16Array(e.labelmaps3D[t].buffer, 2 * l, s);
                                break;
                            case He:
                                a = new Float32Array(e.labelmaps3D[t].buffer, 4 * l, s);
                                break;
                            default:
                                throw new Error("Unsupported Array Type ".concat(i.arrayType))
                        }
                        e.labelmaps3D[t].labelmaps2D[n] = {
                            pixelData: a,
                            segmentsOnLabelmap: []
                        }
                    }
                    var je = E.UINT_16_ARRAY,
                        ze = E.FLOAT_32_ARRAY,
                        We = B("store:modules:segmentationModule:getLabelmap2D");

                    function Ge(e, t, n) {
                        var o = e.x,
                            r = e.y;
                        return o < n && o >= 0 && r < t && r >= 0
                    }
                    var Ye = B("store:modules:segmentationModule:getSegmentOfActiveLabelmapAtEvent"),
                        Ze = B("store:modules:segmentationModule:setColorLUT");

                    function Ke(e) {
                        var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : [],
                            n = wt("segmentation").configuration.segmentsPerLabelmap;
                        t ? (Je(t, n), t.length < n && (t = [].concat(Q()(t), Q()(Qe(n - t.length))))) : t = t || Qe(n), t.unshift([0, 0, 0, 0]), H.colorLutTables[e] = t
                    }

                    function Xe(e) {
                        return "number" == typeof e ? H.colorLutTables[e] : H.colorLutTables[e.colorLUTIndex]
                    }

                    function Je(e, t) {
                        e.length < t ? Ze.warn("The provided colorLUT only provides ".concat(e.length, " labels, whereas segmentsPerLabelmap is set to ").concat(t, ". Autogenerating the rest.")) : e.length > t && Ze.warn("segmentsPerLabelmap is set to ".concat(t, ", and the provided colorLUT provides ").concat(e.length, ". Using the first ").concat(t, " colors from the LUT."))
                    }

                    function Qe() {
                        for (var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 255, t = [], n = 0; n < e; n++) t.push(ot(et(), nt()));
                        return t
                    }
                    var $e = 222.5;

                    function et() {
                        return ($e += 137.5) >= 360 && ($e -= 360), $e
                    }
                    var tt = .6;

                    function nt() {
                        return (tt += .07) > .82 && (tt = tt - .82 + .3), tt
                    }

                    function ot(e) {
                        var t, n, o, r = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1,
                            a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : .6,
                            i = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 255,
                            s = (1 - Math.abs(2 * a - 1)) * r,
                            l = s * (1 - Math.abs(e / 60 % 2 - 1)),
                            c = a - s / 2;
                        return e < 60 ? (t = s, n = l, o = 0) : e < 120 ? (t = l, n = s, o = 0) : e < 180 ? (t = 0, n = s, o = l) : e < 240 ? (t = 0, n = l, o = s) : e < 300 ? (t = l, n = 0, o = s) : e < 360 && (t = s, n = 0, o = l), [255 * (t + c), 255 * (n + c), 255 * (o + c), i]
                    }
                    var rt = B("store:modules:segmentationModule:getBrushColor"),
                        at = {
                            renderOutline: !0,
                            renderFill: !0,
                            shouldRenderInactiveLabelmaps: !0,
                            radius: 10,
                            minRadius: 1,
                            maxRadius: 50,
                            fillAlpha: .2,
                            fillAlphaInactive: .1,
                            outlineAlpha: .7,
                            outlineAlphaInactive: .35,
                            outlineWidth: 3,
                            storeHistory: !0,
                            segmentsPerLabelmap: 65535,
                            arrayType: E.UINT_16_ARRAY
                        },
                        it = B("util:segmentation:labelmap3DHistory");

                    function st(e, t, n) {
                        var o = e.labelmaps2D;
                        t.forEach((function(e) {
                            for (var t = e.imageIdIndex, r = e.diff, a = o[t].pixelData, i = 0; i < r.length; i++) {
                                var s = r[i];
                                a[s[0]] = s[n]
                            }
                        }))
                    }
                    var lt = {
                            state: H,
                            configuration: at,
                            onRegisterCallback: function() {
                                Ke(0)
                            },
                            getters: {
                                metadata: function(e, t, n) {
                                    var o = I(e);
                                    if (o) {
                                        var r = _(o, "stack").data[0].imageIds[0],
                                            a = H.series[r];
                                        if (a) {
                                            if (t = void 0 === t ? a.activeLabelmapIndex : t, a.labelmaps3D[t]) {
                                                var i = a.labelmaps3D[t];
                                                return void 0 === n ? i.metadata : i.metadata[n]
                                            }
                                            q.warn("No labelmap3D of labelmap index ".concat(t, " on stack."))
                                        } else q.warn("brushStackState is undefined")
                                    }
                                },
                                labelmap3D: Y,
                                labelmaps3D: G,
                                activeLabelmapIndex: function(e) {
                                    var t = I(e);
                                    if (t) {
                                        var n = _(t, "stack").data[0].imageIds[0],
                                            o = H.series[n];
                                        if (o) return o.activeLabelmapIndex
                                    }
                                },
                                activeSegmentIndex: function(e, t) {
                                    var n = I(e);
                                    if (n) {
                                        var o = _(n, "stack").data[0].imageIds[0],
                                            r = H.series[o];
                                        if (r) {
                                            t = void 0 === t ? r.activeLabelmapIndex : t;
                                            var a = r.labelmaps3D[t];
                                            if (a) return a.activeSegmentIndex
                                        }
                                        return 1
                                    }
                                },
                                isSegmentVisible: function(e, t, n) {
                                    if (t) {
                                        var o = I(e);
                                        if (o) {
                                            var r = _(o, "stack").data[0].imageIds[0],
                                                a = H.series[r];
                                            if (a) {
                                                if (n = void 0 === n ? a.activeLabelmapIndex : n, a.labelmaps3D[n]) return !a.labelmaps3D[n].segmentsHidden[t];
                                                z.warn("No labelmap3D of labelmap index ".concat(n, " on stack."))
                                            } else z.warn("brushStackState is undefined")
                                        }
                                    }
                                },
                                labelmap2D: function(e) {
                                    var t = I(e);
                                    if (t) {
                                        var n = y.cornerstone,
                                            o = _(t, "stack");
                                        if (o) {
                                            var r, a = o.data[0],
                                                i = n.getEnabledElement(t),
                                                s = a.currentImageIdIndex,
                                                l = i.image,
                                                c = l.rows,
                                                u = l.columns,
                                                d = a.imageIds.length,
                                                h = a.imageIds[0],
                                                f = H.series[h];
                                            f ? (r = f.activeLabelmapIndex, f.labelmaps3D[r] || C(f, r, c * u * d), f.labelmaps3D[r].labelmaps2D[s] || qe(f, r, s, c, u)) : (r = 0, H.series[h] = {
                                                activeLabelmapIndex: r,
                                                labelmaps3D: []
                                            }, C(f = H.series[h], r, c * u * d), qe(f, r, s, c, u));
                                            var m = f.labelmaps3D[r];
                                            return {
                                                labelmap2D: m.labelmaps2D[s],
                                                labelmap3D: m,
                                                currentImageIdIndex: s,
                                                activeLabelmapIndex: r
                                            }
                                        }
                                        We.error("Consumers must define stacks in their application if using segmentations in cornerstoneTools.")
                                    }
                                },
                                labelmap2DByImageIdIndex: function(e, t, n, o) {
                                    if (!e.labelmaps2D[t]) {
                                        var r, a = wt("segmentation").configuration,
                                            i = n * o,
                                            s = i * t;
                                        switch (a.arrayType) {
                                            case je:
                                                r = new Uint16Array(e.buffer, 2 * s, i);
                                                break;
                                            case ze:
                                                r = new Float32Array(e.buffer, 4 * s, i);
                                                break;
                                            default:
                                                throw new Error("Unsupported Array Type ".concat(a.arrayType))
                                        }
                                        e.labelmaps2D[t] = {
                                            pixelData: r,
                                            segmentsOnLabelmap: $(r)
                                        }
                                    }
                                    return e.labelmaps2D[t]
                                },
                                labelmapStats: function(e, t, n) {
                                    var o = y.cornerstone,
                                        r = I(e);
                                    if (!r) return null;
                                    var a = _(r, "stack").data[0].imageIds,
                                        i = a[0];
                                    return new Promise((function(e) {
                                        var r = H.series[i];
                                        r || e(null);
                                        var s = function(e) {
                                                for (var t = [], n = y.cornerstone.metaData, o = !0, r = 0; r < e.length; r++) {
                                                    var a = n.get("imagePlaneModule", e[r]);
                                                    if (!a) {
                                                        o = !1;
                                                        break
                                                    }
                                                    t.push(a)
                                                }
                                                return {
                                                    sufficientMetadata: o,
                                                    imagePlanes: t
                                                }
                                            }(a),
                                            l = s.sufficientMetadata,
                                            c = s.imagePlanes;
                                        l || (Ue.warn("Insufficient imagePlaneModule information to calculate volume statistics."), e(null)), n = void 0 === n ? r.activeLabelmapIndex : n;
                                        for (var u = r.labelmaps3D[n], d = [], h = 0; h < a.length; h++) d.push(o.loadAndCacheImage(a[h]));
                                        Promise.all(d).then((function(n) {
                                            var o = function(e, t, n, o) {
                                                for (var r = function(e, t, n, o) {
                                                        for (var r = t[0], a = r.rowPixelSpacing, i = r.columnPixelSpacing, s = e.labelmaps2D, l = [], c = 0; c < s.length; c++) {
                                                            var u = s[c];
                                                            if (u && u.segmentsOnLabelmap.includes(o)) {
                                                                for (var d = Be(t, n, c) * a * i, h = u.pixelData, f = t[c].getPixelData(), m = [], g = 0; g < h.length; g++) h[g] === o && m.push(f[g]);
                                                                l.push({
                                                                    voxelInMM3: d,
                                                                    values: m
                                                                })
                                                            }
                                                        }
                                                        return l
                                                    }(e, t, n, o), a = 0, i = r[0].values[0], s = i, l = 0, c = 0; c < r.length; c++) {
                                                    var u = r[c],
                                                        d = u.values,
                                                        h = u.voxelInMM3;
                                                    l += h * d.length;
                                                    var f = 0;
                                                    d.forEach((function(e) {
                                                        e > i ? i = e : e < s && (s = e), f += e
                                                    })), a += f * h
                                                }
                                                a /= l;
                                                for (var m = 0, g = 0; g < r.length; g++) {
                                                    var p = r[g],
                                                        v = (d = p.values, h = p.voxelInMM3, 0);
                                                    d.forEach((function(e) {
                                                        v += Math.pow(e - a, 2)
                                                    })), m += v * h
                                                }
                                                return m /= l, m = Math.sqrt(m), {
                                                    volume: l,
                                                    mean: a,
                                                    stdDev: m,
                                                    max: i,
                                                    min: s
                                                }
                                            }(u, n, c, t);
                                            e(o)
                                        }))
                                    }))
                                },
                                segmentOfActiveLabelmapAtEvent: function(e) {
                                    var t = e.detail,
                                        n = t.element,
                                        o = t.image,
                                        r = t.currentPoints;
                                    if (r) {
                                        var a = o.width,
                                            i = o.height;
                                        if (n) {
                                            var s = _(n, "stack").data[0],
                                                l = s.currentImageIdIndex,
                                                c = s.imageIds[0],
                                                u = H.series[c],
                                                d = u.activeLabelmapIndex,
                                                h = u.labelmaps3D[d];
                                            if (h) {
                                                var f = h.labelmaps2D[l];
                                                if (f) {
                                                    var m = f.pixelData,
                                                        g = r.image,
                                                        p = g.x,
                                                        v = g.y;
                                                    if (Ge({
                                                            x: p = Math.floor(p),
                                                            y: v = Math.floor(v)
                                                        }, i, a)) {
                                                        var y = m[v * a + p];
                                                        if (0 === y) return;
                                                        return {
                                                            segmentIndex: y,
                                                            metadata: h.metadata[y]
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    } else Ye.warn("Not a cornerstone input event.")
                                },
                                brushColor: function(e) {
                                    var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1],
                                        n = I(e);
                                    if (n) {
                                        var o = _(n, "stack");
                                        if (o) {
                                            var r, a = o.data[0].imageIds[0],
                                                i = H.series[a];
                                            if (i) {
                                                var s = i.activeLabelmapIndex,
                                                    l = i.labelmaps3D[s],
                                                    c = l.activeSegmentIndex;
                                                r = H.colorLutTables[l.colorLUTIndex][c]
                                            } else r = H.colorLutTables[0][1];
                                            return t ? "rgba(".concat(r[0], ", ").concat(r[1], ", ").concat(r[2], ", 1.0 )") : "rgba(".concat(r[0], ", ").concat(r[1], ", ").concat(r[2], ", 0.8 )")
                                        }
                                        rt.error("Consumers must define stacks in their application if using segmentations in cornerstoneTools.")
                                    }
                                },
                                labelmapBuffers: X,
                                activeLabelmapBuffer: function(e) {
                                    var t = I(e);
                                    if (t) {
                                        var n = _(t, "stack").data[0].imageIds[0],
                                            o = H.series[n];
                                        if (o) return X(t, o.activeLabelmapIndex)
                                    }
                                },
                                colorLUT: Xe,
                                colorForSegmentIndexColorLUT: function(e, t) {
                                    return Xe(e)[t]
                                }
                            },
                            setters: {
                                metadata: function(e) {
                                    var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0,
                                        n = arguments.length > 2 ? arguments[2] : void 0,
                                        o = arguments.length > 3 ? arguments[3] : void 0,
                                        r = I(e);
                                    if (r) {
                                        var a = y.cornerstone,
                                            i = _(r, "stack").data[0],
                                            s = i.imageIds[0],
                                            l = H.series[s];
                                        if (l || (H.series[s] = {
                                                labelmapIndex: t,
                                                labelmaps3D: []
                                            }, l = H.series[s]), !l.labelmaps3D[t]) {
                                            var c = a.getEnabledElement(r).image;
                                            C(l, t, c.rows * c.columns * i.imageIds.length)
                                        }
                                        l.labelmaps3D[t].metadata[n] = o
                                    }
                                },
                                labelmap3DForElement: function(e, t, n) {
                                    var o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : [],
                                        r = arguments.length > 4 ? arguments[4] : void 0,
                                        a = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : 0,
                                        i = I(e);
                                    if (i) {
                                        var s = _(i, "stack"),
                                            l = s.data[0].imageIds.length;
                                        Ne(s.data[0].imageIds[0], t, n, o, l, r, a), _e(i, n)
                                    }
                                },
                                labelmap3DByFirstImageId: Ne,
                                incrementActiveSegmentIndex: function(e) {
                                    var t = I(e);
                                    t && j(t, "increase")
                                },
                                decrementActiveSegmentIndex: function(e) {
                                    var t = I(e);
                                    t && j(t, "decrease")
                                },
                                activeSegmentIndex: function(e, t) {
                                    var n = I(e);
                                    if (n) {
                                        var o = _(n, "stack").data[0].imageIds[0],
                                            r = H.series[o];
                                        if (r) {
                                            var a = r.activeLabelmapIndex,
                                                i = r.labelmaps3D[a],
                                                s = wt("segmentation").configuration;
                                            t <= 0 ? t = 1 : t > s.segmentsPerLabelmap && (t = s.segmentsPerLabelmap), i.activeSegmentIndex = t
                                        }
                                    }
                                },
                                toggleSegmentVisibility: function(e, t, n) {
                                    if (t) {
                                        var o = I(e);
                                        if (o) {
                                            var r = _(o, "stack").data[0].imageIds[0],
                                                a = H.series[r];
                                            if (a) {
                                                if (n = void 0 === n ? a.activeLabelmapIndex : n, a.labelmaps3D[n]) {
                                                    var i = a.labelmaps3D[n].segmentsHidden;
                                                    return i[t] = !i[t], !i[t]
                                                }
                                                z.warn("No labelmap3D of labelmap index ".concat(n, " on stack."))
                                            } else z.warn("brushStackState is undefined")
                                        }
                                    }
                                },
                                updateSegmentsOnLabelmap2D: function(e) {
                                    e.segmentsOnLabelmap = $(e.pixelData)
                                },
                                deleteSegment: function(e, t, n) {
                                    if (t) {
                                        var o = I(e);
                                        if (o) {
                                            var r = _(o, "stack").data[0].imageIds[0],
                                                a = H.series[r];
                                            if (a) {
                                                n = void 0 === n ? a.activeLabelmapIndex : n;
                                                var i = a.labelmaps3D[n];
                                                if (i) {
                                                    delete i.metadata[t];
                                                    for (var s = i.labelmaps2D, l = 0; l < s.length; l++) {
                                                        var c = s[l];
                                                        if (c && c.segmentsOnLabelmap.includes(t)) {
                                                            var u = c.pixelData,
                                                                d = c.segmentsOnLabelmap.indexOf(t);
                                                            c.segmentsOnLabelmap.splice(d, 1);
                                                            for (var h = 0; h < u.length; h++) u[h] === t && (u[h] = 0)
                                                        }
                                                    }
                                                    y.cornerstone.updateImage(o)
                                                }
                                            }
                                        }
                                    }
                                },
                                colorLUT: Ke,
                                colorLUTIndexForLabelmap3D: function(e, t) {
                                    e.colorLUTIndex = t
                                },
                                colorForSegmentIndexOfColorLUT: function(e, t, n) {
                                    Xe(e)[t] = n
                                },
                                activeLabelmapIndex: function(e) {
                                    var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0,
                                        n = I(e);
                                    if (n) {
                                        var o = y.cornerstone,
                                            r = _(n, "stack").data[0],
                                            a = o.getEnabledElement(n).image,
                                            i = a.rows * a.columns * r.imageIds.length,
                                            s = r.imageIds[0],
                                            l = H.series[s];
                                        l ? (l.activeLabelmapIndex = t, l.labelmaps3D[t] || C(l, t, i)) : (H.series[s] = {
                                            activeLabelmapIndex: t,
                                            labelmaps3D: []
                                        }, C(l = H.series[s], t, i)), o.updateImage(n)
                                    }
                                },
                                radius: function(e) {
                                    var t = wt("segmentation").configuration;
                                    t.radius = Math.min(Math.max(e, t.minRadius), t.maxRadius)
                                },
                                pushState: function(e, t, n) {
                                    var o = Y(e, n);
                                    o.undo.push(t), o.redo = []
                                },
                                undo: function(e, t) {
                                    var n = Y(e, t),
                                        o = n.undo,
                                        r = n.redo;
                                    if (o.length) {
                                        var a = o.pop();
                                        st(n, a, 1), r.push(a), y.cornerstone.updateImage(e)
                                    } else it.warn("No undos left.")
                                },
                                redo: function(e, t) {
                                    var n = Y(e, t),
                                        o = n.undo,
                                        r = n.redo;
                                    if (r.length) {
                                        var a = r.pop();
                                        st(n, a, 2), o.push(a), y.cornerstone.updateImage(e)
                                    } else it.warn("No redos left.")
                                }
                            }
                        },
                        ct = {
                            activeManipulators: {}
                        };

                    function ut(e) {
                        var t = y.cornerstone.getEnabledElement(e).uuid;
                        delete ct.activeManipulators[t]
                    }

                    function dt(e) {
                        var t = ct.activeManipulators,
                            n = t[e];
                        "function" == typeof n && n(), delete t[e]
                    }

                    function ht(e) {
                        ut(e.detail.element)
                    }
                    var ft = {
                            setters: {
                                addActiveManipulatorForElement: function(e, t) {
                                    var n = y.cornerstone.getEnabledElement(e).uuid;
                                    ct.activeManipulators[n] = t
                                },
                                removeActiveManipulatorForElement: ut,
                                cancelActiveManipulatorsForElement: function(e) {
                                    dt(y.cornerstone.getEnabledElement(e).uuid)
                                },
                                cancelActiveManipulators: function() {
                                    var e = ct.activeManipulators;
                                    Object.keys(e).forEach((function(e) {
                                        return dt(e)
                                    }))
                                }
                            },
                            state: ct,
                            enabledElementCallback: function(e) {
                                var t = y.cornerstone.EVENTS.NEW_IMAGE;
                                e.removeEventListener(t, ht), e.addEventListener(t, ht)
                            },
                            removeEnabledElementCallback: function(e) {
                                var t = y.cornerstone.EVENTS.NEW_IMAGE;
                                e.removeEventListener(t, ht), ut(e)
                            }
                        },
                        mt = {
                            iconSize: 16,
                            viewBox: {
                                x: 16,
                                y: 16
                            },
                            mousePoint: {
                                x: 8,
                                y: 8
                            },
                            mousePointerGroupString: '\n    <path stroke="ACTIVE_COLOR" d="M8 16L8 0"></path>\n    <path stroke="ACTIVE_COLOR" d="M16 8L0 8"></path>\n  '
                        },
                        gt = {
                            configuration: mt,
                            getters: {
                                defaultOptions: function() {
                                    return mt
                                }
                            },
                            setters: {
                                defaultOptions: function(e) {
                                    Object.assign(mt, e)
                                }
                            }
                        },
                        pt = {
                            configuration: {
                                mouseEnabled: !0,
                                touchEnabled: !0,
                                globalToolSyncEnabled: !1,
                                showSVGCursors: !1,
                                autoResizeViewports: !0,
                                lineDash: [4, 4]
                            }
                        },
                        vt = (B("store:modules:storeLogger"), {
                            globalTools: {},
                            globalToolChangeHistory: [],
                            enabledElements: [],
                            tools: [],
                            isToolLocked: !1,
                            activeMultiPartTool: null,
                            mousePositionImage: {},
                            clickProximity: 6,
                            touchProximity: 10,
                            handleRadius: 6,
                            deleteIfHandleOutsideImage: !0,
                            preventHandleOutsideImage: !1,
                            preventTextBoxOutsideDisplayedArea: !1,
                            handleTouchOffset: {
                                x: 0,
                                y: -57
                            },
                            svgCursorUrl: null
                        }),
                        yt = {
                            mouseTools: function() {
                                return vt.tools.filter((function(e) {
                                    return e.supportedInteractionTypes.includes("Mouse")
                                }))
                            },
                            touchTools: function() {
                                return vt.tools.filter((function(e) {
                                    return e.supportedInteractionTypes.includes("Touch")
                                }))
                            },
                            enabledElementByUID: function(e) {
                                return vt.enabledElements.find((function(t) {
                                    return y.cornerstone.getEnabledElement(t).uuid === e
                                }))
                            }
                        },
                        bt = {
                            segmentation: lt,
                            cursor: gt,
                            globalConfiguration: pt,
                            manipulatorState: ft
                        };

                    function wt(e) {
                        return bt[e]
                    }
                    var xt = {
                            modules: bt,
                            state: vt,
                            getters: yt
                        },
                        Tt = function(e, t) {
                            return vt.tools.find((function(n) {
                                return n.element === e && n.name === t
                            }))
                        },
                        It = bt.globalConfiguration;

                    function Et(e, t) {
                        if (It.configuration.showSVGCursors) {
                            var n = t.getIconWithPointerSVG(),
                                o = t.mousePoint,
                                r = window.URL.createObjectURL(n);
                            e.style.cursor = "url('".concat(r, "') ").concat(o, ", auto"), vt.svgCursorUrl = r
                        }
                    }

                    function St(e) {
                        It.configuration.showSVGCursors && At(e, "none")
                    }

                    function At(e, t) {
                        vt.svgCursorUrl && window.URL.revokeObjectURL(vt.svgCursorUrl), vt.svgCursorUrl = null, e.style.cursor = t
                    }
                    var Ct = wt("globalConfiguration"),
                        Mt = B("store:setToolMode"),
                        Dt = function(e, t, n, o) {
                            void 0 === o && Array.isArray(n) && (o = n, n = null);
                            var r = Tt(e, t);
                            r && (function(e, t, n, o) {
                                t.supportedInteractionTypes.forEach((function(r) {
                                    if (void 0 === o || o.includes(r)) {
                                        var a = Ht[r];
                                        a ? a(t, e, n) : Mt.warn("Unable to resolve input conflicts for type %s", r)
                                    }
                                })), xt.state.tools.filter((function(t) {
                                    return t.element === e && "active" === t.mode && t.supportedInteractionTypes.length > 0
                                })).forEach((function(t) {
                                    var n = !1;
                                    t.supportedInteractionTypes.forEach((function(e) {
                                        t.options["is".concat(e, "Active")] && (n = !0)
                                    })), n || (Mt.log("Setting tool %s's to PASSIVE", t.name), Rt(e, t.name))
                                }))
                            }(e, r, n, o), r.supportedInteractionTypes.forEach((function(e) {
                                void 0 === o || o.includes(e) ? n["is".concat(e, "Active")] = !0 : n["is".concat(e, "Active")] = !1
                            })), Ct.configuration.showSVGCursors && r.supportedInteractionTypes.includes("Mouse") && function(e, t, n) {
                                ("number" == typeof t ? [t] : t.mouseButtonMask).includes(1) && (n.svgCursor ? Et(n.element, n.svgCursor) : n.hideDefaultCursor ? St(e) : function(e) {
                                    At(e, "initial")
                                }(e))
                            }(e, n, r)), Ut("active", null, e, t, n)
                        },
                        Pt = function(e, t, n) {
                            Ft("active", e, t, n), xt.state.enabledElements.forEach((function(o) {
                                Dt(o, e, t, n)
                            }))
                        },
                        kt = Ut.bind(null, "disabled", null),
                        _t = Bt.bind(null, "disabled", null),
                        Lt = Ut.bind(null, "enabled", null),
                        Ot = Bt.bind(null, "enabled", null),
                        Rt = Ut.bind(null, "passive", x.TOOL_DEACTIVATED),
                        Nt = Bt.bind(null, "passive", x.TOOL_DEACTIVATED);

                    function Ut(e, t, n, o, r) {
                        var a, i, s = Tt(n, o);
                        s ? (r = qt(r), Array.isArray(r.mouseButtonMask) && 0 !== r.mouseButtonMask.length && Array.isArray(s.options.mouseButtonMask) && (r.mouseButtonMask = (a = r.mouseButtonMask, i = s.options.mouseButtonMask, a.concat(i).reduce((function(e, t) {
                            return -1 === e.indexOf(t) && e.push(t), e
                        }), []))), s.mode = e, s.mergeOptions(r), s["".concat(e, "Callback")] && s["".concat(e, "Callback")](n, r), t && T(n, t, {
                            options: r,
                            toolName: o,
                            toolType: o,
                            type: t
                        })) : Mt.warn('Unable to find tool "%s" for enabledElement', o)
                    }

                    function Bt(e, t, n, o) {
                        Ft(e, n, o), xt.state.enabledElements.forEach((function(r) {
                            Ut(e, t, r, n, o)
                        }))
                    }

                    function Vt(e, t, n) {
                        var o = "is".concat(e, "Active"),
                            r = xt.state.tools.find((function(e) {
                                return e.element === n && "active" === e.mode && !0 === e.options[o]
                            }));
                        r && (Mt.log("Setting tool %s's %s to false", r.name, o), r.options[o] = !1)
                    }

                    function Ft(e, t, n, o) {
                        if (Ct.configuration.globalToolSyncEnabled) {
                            var r = {
                                mode: e,
                                args: [t, n]
                            };
                            o && r.push(o), xt.state.globalToolChangeHistory.push(r), xt.state.globalToolChangeHistory.length > 50 && xt.state.globalToolChangeHistory.shift();
                            var a = xt.state.globalTools[t];
                            if (a)
                                if ("active" === e) {
                                    var i = function(e, t, n) {
                                        void 0 === n && Array.isArray(t) && (n = t, t = null);
                                        var o = [],
                                            r = xt.state.globalTools[e];
                                        if (r) {
                                            var a = new r.tool(r.props);
                                            a.supportedInteractionTypes.forEach((function(e) {
                                                if (void 0 === n || n.includes(e))
                                                    if ("Mouse" === e) {
                                                        var r = qt(t).mouseButtonMask;
                                                        Array.isArray(r) && r.length > 0 ? r.forEach((function(t) {
                                                            return o.push("".concat(e, "-").concat(t))
                                                        })) : Array.isArray(r) && 0 === r.length && o.push("".concat(e, "-DELETE"))
                                                    } else "MultiTouch" === e ? o.push("".concat(e, "-").concat(a.configuration.touchPointers)) : o.push(e)
                                            }))
                                        }
                                        return o
                                    }(t, n, o);
                                    Object.keys(xt.state.globalTools).forEach((function(e) {
                                        var t = xt.state.globalTools[e];
                                        t.activeBindings = t.activeBindings.filter((function(e) {
                                            return !i.includes(e)
                                        }))
                                    })), i.some((function(e) {
                                        return e.includes("Mouse-DELETE")
                                    })) && (a.activeBindings = a.activeBindings.filter((function(e) {
                                        return !e.includes("Mouse")
                                    })), i = i.filter((function(e) {
                                        return !e.includes("Mouse")
                                    }))), a.activeBindings = a.activeBindings.concat(i)
                                } else a.activeBindings = [];
                            else Mt.warn("setToolMode call for tool not available globally: ".concat(t))
                        }
                    }
                    var Ht = {
                        Mouse: function(e, t, n) {
                            var o = qt(n).mouseButtonMask;
                            if (Array.isArray(o) && o.length > 0) {
                                var r = xt.state.tools.find((function(e) {
                                    return e.element === t && "active" === e.mode && !0 === e.options.isMouseActive && Array.isArray(e.options.mouseButtonMask) && e.options.mouseButtonMask.some((function(e) {
                                        return o.includes(e)
                                    }))
                                }));
                                r && (r.options.mouseButtonMask = r.options.mouseButtonMask.filter((function(e) {
                                    return !o.includes(e)
                                })), 0 === r.options.mouseButtonMask.length && (r.options.isMouseActive = !1))
                            }
                        },
                        MouseWheel: Vt.bind(void 0, "MouseWheel"),
                        Touch: function(e, t) {
                            var n = xt.state.tools.find((function(e) {
                                    return e.element === t && "active" === e.mode && !0 === e.options.isTouchActive
                                })),
                                o = xt.state.tools.find((function(e) {
                                    return e.element === t && "active" === e.mode && !0 === e.options.isMultiTouchActive && 1 === e.configuration.touchPointers
                                }));
                            n && (Mt.log("Setting tool %s's isTouchActive to false", n.name), n.options.isTouchActive = !1), o && (Mt.log("Setting tool %s's isTouchActive to false", o.name), o.options.isMultiTouchActive = !1)
                        },
                        TouchPinch: Vt.bind(void 0, "TouchPinch"),
                        TouchRotate: Vt.bind(void 0, "TouchRotate"),
                        DoubleTap: Vt.bind(void 0, "DoubleTap"),
                        MultiTouch: function(e, t) {
                            var n, o = xt.state.tools.find((function(n) {
                                return n.element === t && "active" === n.mode && !0 === n.options.isMultiTouchActive && n.configuration.touchPointers === e.configuration.touchPointers
                            }));
                            1 === e.configuration.touchPointers && (n = xt.state.tools.find((function(e) {
                                return e.element === t && "active" === e.mode && !0 === e.options.isTouchActive
                            }))), o && (Mt.log("Setting tool %s's isMultiTouchActive to false", o.name), o.options.isMultiTouchActive = !1), n && (Mt.log("Setting tool %s's isTouchActive to false", n.name), n.options.isTouchActive = !1)
                        }
                    };

                    function qt(e) {
                        return Array.isArray(e) ? e = {
                            mouseButtonMask: e
                        } : e !== Object(e) && (e = {
                            mouseButtonMask: [e]
                        }), e.hasOwnProperty("mouseButtonMask") || (e.mouseButtonMask = []), Array.isArray(e.mouseButtonMask) || (e.mouseButtonMask = [e.mouseButtonMask]), e.mouseButtonMask = e.mouseButtonMask.filter((function(e) {
                            return "number" == typeof e && 0 !== e
                        })), e
                    }
                    var jt = {
                            passiveCallback: function(e) {
                                kt(e, this.name)
                            },
                            enabledCallback: function(e) {
                                Dt(e, this.name)
                            }
                        },
                        zt = {
                            passiveCallback: function(e) {
                                kt(e, this.name)
                            },
                            activeCallback: function(e) {
                                Lt(e, this.name)
                            }
                        },
                        Wt = function(e, t) {
                            e.save(), t(e), e.restore()
                        },
                        Gt = 1,
                        Yt = 2,
                        Zt = {
                            setToolWidth: function(e) {
                                Gt = e
                            },
                            getToolWidth: function() {
                                return Gt
                            },
                            setActiveWidth: function(e) {
                                Yt = e
                            },
                            getActiveWidth: function() {
                                return Yt
                            }
                        },
                        Kt = function(e) {
                            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
                                n = arguments.length > 2 ? arguments[2] : void 0,
                                o = t.color,
                                r = t.lineWidth,
                                a = t.fillStyle,
                                i = t.lineDash,
                                s = t.shouldDrawLines,
                                l = void 0 === s || s;
                            e.beginPath(), e.strokeStyle = o || e.strokeStyle, e.lineWidth = r || void 0 === r && Zt.getToolWidth() || e.lineWidth, i && e.setLineDash(i), n(e), a && (e.fillStyle = a, e.fill()), l && e.stroke(), i && e.setLineDash([])
                        };

                    function Xt(e, t, n, o, r) {
                        var a = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : "pixel";
                        Kt(e, r, (function(e) {
                            "pixel" === a && (n = y.cornerstone.pixelToCanvas(t, n), o = y.cornerstone.pixelToCanvas(t, o)), e.moveTo(n.x, n.y), e.lineTo(o.x, o.y)
                        }))
                    }
                    var Jt = function(e, t, n, o, r) {
                            var a = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : "pixel";
                            Kt(e, r, (function(e) {
                                "pixel" === a && (n = y.cornerstone.pixelToCanvas(t, n), o = o.map((function(e) {
                                    return y.cornerstone.pixelToCanvas(t, e)
                                }))), e.moveTo(n.x, n.y), o.forEach((function(t) {
                                    var n = t.x,
                                        o = t.y;
                                    e.lineTo(n, o)
                                }))
                            }))
                        },
                        Qt = function(e, t, n, o, r, a) {
                            var i = Math.atan2(n.y - t.y, n.x - t.x),
                                s = {
                                    color: o,
                                    lineWidth: r
                                };
                            a && (s.lineDash = a), Xt(e, void 0, t, n, s, "canvas"), s = {
                                color: o,
                                lineWidth: r,
                                fillStyle: o
                            };
                            var l = [{
                                x: n.x - 10 * Math.cos(i - Math.PI / 7),
                                y: n.y - 10 * Math.sin(i - Math.PI / 7)
                            }, {
                                x: n.x - 10 * Math.cos(i + Math.PI / 7),
                                y: n.y - 10 * Math.sin(i + Math.PI / 7)
                            }, n];
                            Jt(e, void 0, n, l, s, "canvas")
                        },
                        $t = function(e, t, n, o, r) {
                            "pixel" === (arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : "pixel") && (n = y.cornerstone.pixelToCanvas(t, n)), Kt(e, r, (function(e) {
                                e.arc(n.x, n.y, o, 0, 2 * Math.PI)
                            }))
                        };

                    function en(e) {
                        var t = y.cornerstoneMath;
                        if (e instanceof t.Vector3) return e;
                        var n = Object.keys(e);
                        return n.includes("x") && n.includes("y") && n.includes("z") ? new t.Vector3(e.x, e.y, e.z) : new t.Vector3(e[0], e[1], e[2])
                    }

                    function tn(e, t) {
                        var n = en(t.rowCosines),
                            o = en(t.columnCosines),
                            r = en(t.imagePositionPatient),
                            a = e.clone().sub(r);
                        return {
                            x: n.dot(a) / t.columnPixelSpacing,
                            y: o.dot(a) / t.rowPixelSpacing
                        }
                    }

                    function nn(e, t) {
                        var n = en(t.rowCosines),
                            o = en(t.columnCosines),
                            r = en(t.imagePositionPatient),
                            a = n.clone().multiplyScalar(e.x);
                        a.multiplyScalar(t.columnPixelSpacing);
                        var i = o.clone().multiplyScalar(e.y);
                        i.multiplyScalar(t.rowPixelSpacing);
                        var s = a.add(i);
                        return s.add(r), s
                    }

                    function on(e, t) {
                        var n = en(e.rowCosines),
                            o = en(e.columnCosines),
                            r = en(e.imagePositionPatient),
                            a = en(t.rowCosines),
                            i = en(t.columnCosines),
                            s = en(t.imagePositionPatient),
                            l = n.clone().cross(o),
                            c = new y.cornerstoneMath.Plane;
                        c.setFromNormalAndCoplanarPoint(l, r);
                        var u = a.clone().cross(i),
                            d = new y.cornerstoneMath.Plane;
                        d.setFromNormalAndCoplanarPoint(u, s);
                        var h = d.clone().intersectPlane(c),
                            f = h.origin,
                            m = h.direction,
                            g = nn({
                                x: t.columns,
                                y: t.rows
                            }, t),
                            p = s.distanceTo(g),
                            v = new y.cornerstoneMath.Line3;
                        v.start = f, v.end = f.clone().add(m.multiplyScalar(p));
                        var b = function(e, t) {
                            var n = [];
                            return Object.keys(t).forEach((function(o) {
                                var r = t[o],
                                    a = e.intersectLine(r);
                                a && n.push(a)
                            })), n
                        }(v, function(e) {
                            var t = nn({
                                    x: 0,
                                    y: 0
                                }, e),
                                n = nn({
                                    x: e.columns,
                                    y: 0
                                }, e),
                                o = nn({
                                    x: 0,
                                    y: e.rows
                                }, e),
                                r = nn({
                                    x: e.columns,
                                    y: e.rows
                                }, e);
                            return {
                                top: new y.cornerstoneMath.Line3(t, n),
                                left: new y.cornerstoneMath.Line3(t, o),
                                right: new y.cornerstoneMath.Line3(n, r),
                                bottom: new y.cornerstoneMath.Line3(o, r)
                            }
                        }(t));
                        if (2 === b.length) return {
                            start: b[0],
                            end: b[1]
                        }
                    }

                    function rn(e, t, n) {
                        var o = n * (Math.PI / 180);
                        return {
                            x: Math.cos(o) * (e.x - t.x) - Math.sin(o) * (e.y - t.y) + t.x,
                            y: Math.sin(o) * (e.x - t.x) + Math.cos(o) * (e.y - t.y) + t.y
                        }
                    }
                    var an = function(e, t, n, o, r) {
                            var a = arguments.length > 6 && void 0 !== arguments[6] ? arguments[6] : 0;
                            "pixel" === (arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : "pixel") && (n = y.cornerstone.pixelToCanvas(t, n), o = y.cornerstone.pixelToCanvas(t, o));
                            var i = y.cornerstone.getViewport(t),
                                s = t.clientWidth,
                                l = t.clientHeight,
                                c = i.scale,
                                u = i.translation,
                                d = i.rotation - a,
                                h = {
                                    x: s / 2 + u.x * c,
                                    y: l / 2 + u.y * c
                                };
                            Math.abs(d) > .05 && (n = rn(n, h, -d), o = rn(o, h, -d));
                            var f = Math.abs(n.x - o.x),
                                m = Math.abs(n.y - o.y),
                                g = Math.min(n.x, o.x),
                                p = Math.min(n.y, o.y),
                                v = {
                                    x: g + f / 2,
                                    y: p + m / 2
                                };
                            Math.abs(d) > .05 && (v = rn(v, h, d));
                            var b = d * Math.PI / 180;
                            Kt(e, r, (function(e) {
                                e.ellipse(v.x, v.y, f / 2, m / 2, b, 0, 2 * Math.PI), e.closePath()
                            }))
                        },
                        sn = "white",
                        ln = "greenyellow",
                        cn = "transparent",
                        un = {
                            setFillColor: function(e) {
                                cn = e
                            },
                            getFillColor: function() {
                                return cn
                            },
                            setToolColor: function(e) {
                                sn = e
                            },
                            getToolColor: function() {
                                return sn
                            },
                            setActiveColor: function(e) {
                                ln = e
                            },
                            getActiveColor: function() {
                                return ln
                            },
                            getColorIfActive: function(e) {
                                return e.color ? e.color : e.active ? ln : sn
                            }
                        },
                        dn = function(e, t, n) {
                            var o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : {},
                                r = t.element,
                                a = un.getToolColor();
                            e.strokeStyle = o.color || a;
                            for (var i = Object.keys(n), s = function(t) {
                                    var a = i[t],
                                        s = n[a];
                                    if (!0 === s.drawnIndependently) return "continue";
                                    if (!0 === o.drawHandlesIfActive && !s.active) return "continue";
                                    if (o.hideHandlesIfMoving && s.moving) return "continue";
                                    var l = {
                                        lineWidth: s.active ? Zt.getActiveWidth() : Zt.getToolWidth(),
                                        fillStyle: o.fill
                                    };
                                    o.lineDash && (l.lineDash = o.lineDash), Kt(e, l, (function(e) {
                                        var t = y.cornerstone.pixelToCanvas(r, s),
                                            n = s.radius || o.handleRadius || vt.handleRadius;
                                        e.arc(t.x, t.y, n, 0, 2 * Math.PI)
                                    }))
                                }, l = 0; l < i.length; l++) s(l)
                        },
                        hn = function(e, t, n, o) {
                            var r = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : "pixel";
                            Kt(e, o, (function(e) {
                                n.forEach((function(n) {
                                    var o = n.start,
                                        a = n.end;
                                    if ("pixel" === r) {
                                        var i = y.cornerstone;
                                        o = i.pixelToCanvas(t, o), a = i.pixelToCanvas(t, a)
                                    }
                                    e.moveTo(o.x, o.y), e.lineTo(a.x, a.y)
                                }))
                            }))
                        },
                        fn = function(e, t, n, o, r, a) {
                            var i = e.length > 0 ? y.cornerstoneMath.point.findClosestPoint(e, t) : t,
                                s = [{
                                    x: n.left + n.width / 2,
                                    y: n.top
                                }, {
                                    x: n.left,
                                    y: n.top + n.height / 2
                                }, {
                                    x: n.left + n.width / 2,
                                    y: n.top + n.height
                                }, {
                                    x: n.left + n.width,
                                    y: n.top + n.height / 2
                                }];
                            Xt(o, void 0, i, y.cornerstoneMath.point.findClosestPoint(s, i), {
                                color: r,
                                lineWidth: a,
                                lineDash: [2, 3]
                            }, "canvas")
                        },
                        mn = {
                            fontSize: 15,
                            fontFamily: "Arial",
                            backgroundColor: "transparent"
                        };

                    function gn(e) {
                        if ("string" != typeof e) throw new Error("Font family must be a valid string");
                        mn.fontFamily = e
                    }

                    function pn(e) {
                        if ("number" != typeof e || isNaN(e) || !isFinite(e)) throw new Error("Font size must be a valid number");
                        mn.fontSize = parseFloat(e)
                    }
                    var vn = {
                            setFont: function(e) {
                                var t = e.split("px ");
                                2 === t.length && (pn(parseFloat(t[0])), gn(t[1]))
                            },
                            getFont: function() {
                                return "".concat(mn.fontSize, "px ").concat(mn.fontFamily)
                            },
                            setFontSize: pn,
                            getFontSize: function() {
                                return mn.fontSize
                            },
                            setFontFamily: gn,
                            getFontFamily: function() {
                                return mn.fontFamily
                            },
                            setBackgroundColor: function(e) {
                                mn.backgroundColor = e
                            },
                            getBackgroundColor: function() {
                                return mn.backgroundColor
                            }
                        },
                        yn = function(e, t, n, o, r) {
                            var a = vn.getFontSize();
                            e.font = vn.getFont(), e.textBaseline = "top", e.fillStyle = o, n.forEach((function(n, o) {
                                e.fillText(n, t.left + r, t.top + r + o * (a + r))
                            }))
                        },
                        bn = function(e, t, n) {
                            e.fillStyle = n, e.fillRect(t.left, t.top, t.width, t.height)
                        };

                    function wn(e, t, n) {
                        var o = vn.getFont(),
                            r = e.font;
                        o && o !== r && (e.font = o);
                        var a = e.measureText(t).width;
                        return o && o !== r && (e.font = r), a + 2 * n
                    }
                    var xn = function(e, t, n, o, r) {
                        var a = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : {};
                        "[object Array]" !== Object.prototype.toString.call(t) && (t = [t]);
                        var i = 5,
                            s = vn.getFontSize(),
                            l = vn.getBackgroundColor(),
                            c = 0;
                        t.forEach((function(t) {
                            var n = wn(e, t, i);
                            c = Math.max(c, n)
                        }));
                        var u = {
                            width: c,
                            height: i + t.length * (s + i)
                        };
                        return Wt(e, (function(e) {
                            e.strokeStyle = r, a.centering && (!0 === a.centering.x && (n -= u.width / 2), !0 === a.centering.y && (o -= u.height / 2)), u.left = n, u.top = o, "function" == typeof a.displacer && a.displacer(u), bn(e, u, l), yn(e, u, t, r, i)
                        })), u
                    };

                    function Tn(e, t, n) {
                        return Math.min(Math.max(t, e), n)
                    }

                    function In(e, t) {
                        var n = t.left || 0,
                            o = t.top || 0;
                        e.x = Tn(e.x, n, n + t.width), e.y = Tn(e.y, o, o + t.height)
                    }
                    var En = function(e, t, n, o, r, a) {
                        a - r < o - n ? (e[t] += r - n, e[t] += (a - r) / 2, e[t] -= (o - n) / 2) : n < r ? e[t] += r - n : o > a && (e[t] -= o - a)
                    };

                    function Sn(e, t) {
                        var n = y.cornerstone,
                            o = n.pixelToCanvas,
                            r = n.canvasToPixel,
                            a = n.getViewport,
                            i = n.getEnabledElement,
                            s = n.getDisplayedArea,
                            l = r(e, {
                                x: t.left,
                                y: t.top
                            }),
                            c = function(e, t) {
                                var n = function(t) {
                                        return y.cornerstone.canvasToPixel(e, t)
                                    },
                                    o = t.top,
                                    r = t.left,
                                    a = t.width,
                                    i = t.height,
                                    s = [n({
                                        x: r,
                                        y: o
                                    }), n({
                                        x: r + a,
                                        y: o
                                    }), n({
                                        x: r,
                                        y: o + i
                                    }), n({
                                        x: r + a,
                                        y: o + i
                                    })],
                                    l = s.map((function(e) {
                                        return e.x
                                    })),
                                    c = s.map((function(e) {
                                        return e.y
                                    }));
                                return {
                                    minX: Math.min.apply(Math, Q()(l)),
                                    minY: Math.min.apply(Math, Q()(c)),
                                    maxX: Math.max.apply(Math, Q()(l)),
                                    maxY: Math.max.apply(Math, Q()(c))
                                }
                            }(e, t),
                            u = c.minX,
                            d = c.minY,
                            h = c.maxX,
                            f = c.maxY,
                            m = a(e),
                            g = s(i(e).image, m),
                            p = m.displayedArea ? m.displayedArea : g,
                            v = p.tlhc,
                            b = p.brhc,
                            w = v.y - 1,
                            x = v.x - 1,
                            T = b.y,
                            I = b.x;
                        En(l, "y", d, f, w, T), En(l, "x", u, h, x, I);
                        var E = o(e, l);
                        t.top = E.y, t.left = E.x
                    }
                    var An = Tn,
                        Cn = function(e, t, n, o, r, a, i, s, l, c) {
                            var u = y.cornerstone.pixelToCanvas,
                                d = u(t, n);
                            l && (d.x += l);
                            var h = {
                                centering: {
                                    x: !1,
                                    y: c
                                }
                            };
                            if (vt.preventTextBoxOutsideDisplayedArea && (h.displacer = function(e) {
                                    return Sn(t, e)
                                }), n.boundingBox = xn(e, o, d.x, d.y, i, h), n.hasMoved) {
                                var f = a(r).map((function(e) {
                                    return u(t, e)
                                }));
                                fn(f, d, n.boundingBox, e, i, s)
                            }
                        },
                        Mn = function(e, t, n, o, r) {
                            var a = arguments.length > 6 && void 0 !== arguments[6] ? arguments[6] : 0;
                            if ("pixel" === (arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : "pixel")) {
                                var i = y.cornerstone;
                                n = i.pixelToCanvas(t, n), o = i.pixelToCanvas(t, o)
                            }
                            var s = y.cornerstone.getViewport(t),
                                l = t.clientWidth,
                                c = t.clientHeight,
                                u = s.scale,
                                d = s.translation,
                                h = s.rotation - a,
                                f = {
                                    x: l / 2 + d.x * u,
                                    y: c / 2 + d.y * u
                                };
                            Math.abs(h) > .05 && (n = rn(n, f, -h), o = rn(o, f, -h));
                            var m = Math.abs(n.x - o.x),
                                g = Math.abs(n.y - o.y);
                            n = {
                                x: Math.min(n.x, o.x),
                                y: Math.min(n.y, o.y)
                            }, o = {
                                x: n.x + m,
                                y: n.y + g
                            };
                            var p = {
                                    x: n.x + m,
                                    y: n.y
                                },
                                v = {
                                    x: n.x,
                                    y: n.y + g
                                };
                            Math.abs(h) > .05 && (n = rn(n, f, h), o = rn(o, f, h), p = rn(p, f, h), v = rn(v, f, h)), Kt(e, r, (function(e) {
                                e.moveTo(n.x, n.y), e.lineTo(p.x, p.y), e.lineTo(o.x, o.y), e.lineTo(v.x, v.y), e.lineTo(n.x, n.y)
                            }))
                        },
                        Dn = function(e) {
                            var t = e.getContext("2d");
                            return t.setTransform(1, 0, 0, 1, 0, 0), t
                        },
                        Pn = function(e, t) {
                            return void 0 === e ? t : e
                        },
                        kn = function(e) {
                            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};
                            t.shadow && (e.shadowColor = Pn(t.shadowColor, "#000000"), e.shadowBlur = Pn(t.shadowBlur, 0), e.shadowOffsetX = Pn(t.shadowOffsetX, 1), e.shadowOffsetY = Pn(t.shadowOffsetY, 1))
                        },
                        _n = function(e) {
                            return 0 === Object.keys(e).length && e.constructor === Object
                        },
                        Ln = wt("segmentation"),
                        On = Ln.getters,
                        Rn = Ln.setters;

                    function Nn() {
                        this.handles = {
                            start: {},
                            end: {}
                        }
                    }

                    function Un(e) {
                        var t = e.detail.element,
                            n = e.detail.currentPoints.image;
                        return _n(this.handles.start) ? this.handles.start = n : (this.handles.end = n, this._applyStrategy(e)), y.cornerstone.updateImage(t), !0
                    }

                    function Bn(e) {
                        var t = e.detail,
                            n = t.element,
                            o = t.currentPoints.image;
                        this.handles.end = o, y.cornerstone.updateImage(n)
                    }

                    function Vn(e) {
                        e.detail.handles = this.handles;
                        var t = e.detail.element,
                            n = On.labelmap2D(t),
                            o = n.labelmap2D,
                            r = n.labelmap3D,
                            a = n.currentImageIdIndex,
                            i = o.pixelData,
                            s = i.slice(),
                            l = {
                                points: {
                                    start: {
                                        x: this.handles.start.x,
                                        y: this.handles.start.y
                                    },
                                    end: {
                                        x: this.handles.end.x,
                                        y: this.handles.end.y
                                    }
                                },
                                pixelData: i,
                                segmentIndex: r.activeSegmentIndex,
                                segmentationMixinType: "circleSegmentationMixin"
                            };
                        this.applyActiveStrategy(e, l);
                        var c = {
                            imageIdIndex: a,
                            diff: Le(s, i)
                        };
                        Rn.pushState(this.element, [c]), Rn.updateSegmentsOnLabelmap2D(o), y.cornerstone.updateImage(t), this._resetHandles()
                    }
                    var Fn = {
                            postTouchStartCallback: Un,
                            postMouseDownCallback: Un,
                            mouseClickCallback: Un,
                            touchDragCallback: Bn,
                            mouseDragCallback: Bn,
                            mouseMoveCallback: Bn,
                            touchEndCallback: Vn,
                            mouseUpCallback: Vn,
                            initializeMixin: Nn,
                            renderToolData: function(e) {
                                var t = this,
                                    n = e.detail,
                                    o = n.element,
                                    r = On.brushColor(o, !0),
                                    a = Dn(n.canvasContext.canvas),
                                    i = y.cornerstoneMath.point.distance;
                                Wt(a, (function(e) {
                                    if (!t.handles) return null;
                                    var n = y.cornerstone.pixelToCanvas(o, t.handles.start),
                                        a = y.cornerstone.pixelToCanvas(o, t.handles.end),
                                        s = i(n, a);
                                    $t(e, o, t.handles.start, s, {
                                        color: r
                                    })
                                }))
                            },
                            _resetHandles: Nn,
                            _applyStrategy: Vn
                        },
                        Hn = B("tools:ScissorsTool"),
                        qn = wt("segmentation"),
                        jn = qn.getters,
                        zn = qn.setters;

                    function Wn(e) {
                        var t = e.detail.element,
                            n = e.detail.currentPoints.image,
                            o = this.handles.points;
                        if (!o.length) return Hn.warn("Something went wrong, empty handles detected."), null;
                        o.push({
                            x: n.x,
                            y: n.y,
                            lines: []
                        }), this.currentHandle += 1, y.cornerstone.updateImage(t)
                    }

                    function Gn(e) {
                        var t = e.detail,
                            n = e.detail.element;
                        this._addPoint(t), y.cornerstone.updateImage(n)
                    }

                    function Yn(e) {
                        var t = this.handles.points,
                            n = e.detail.element,
                            o = jn.labelmap2D(n),
                            r = o.labelmap2D,
                            a = o.labelmap3D,
                            i = o.currentImageIdIndex,
                            s = r.pixelData,
                            l = s.slice(),
                            c = {
                                points: t,
                                pixelData: s,
                                segmentIndex: a.activeSegmentIndex,
                                segmentationMixinType: "freehandSegmentationMixin"
                            };
                        this.applyActiveStrategy(e, c);
                        var u = {
                            imageIdIndex: i,
                            diff: Le(l, s)
                        };
                        zn.pushState(this.element, [u]), zn.updateSegmentsOnLabelmap2D(r), y.cornerstone.updateImage(n), this._resetHandles()
                    }

                    function Zn() {
                        this.handles = {
                            points: []
                        }, this.currentHandle = 0
                    }
                    var Kn = {
                            postTouchStartCallback: Wn,
                            postMouseDownCallback: Wn,
                            mouseClickCallback: Wn,
                            touchDragCallback: Gn,
                            mouseDragCallback: Gn,
                            mouseMoveCallback: Gn,
                            touchEndCallback: Yn,
                            mouseUpCallback: Yn,
                            initializeMixin: Zn,
                            renderToolData: function(e) {
                                var t = e.detail,
                                    n = t.element,
                                    o = jn.brushColor(n, !0),
                                    r = Dn(t.canvasContext.canvas),
                                    a = this.handles.points;
                                a.length < 2 || Wt(r, (function(e) {
                                    for (var t = 0; t < a.length; t++) {
                                        var r = Q()(a[t].lines);
                                        t === a.length - 1 && r.push(a[0]), Jt(e, n, a[t], r, {
                                            color: o
                                        })
                                    }
                                }))
                            },
                            _resetHandles: Zn,
                            _addPoint: function(e) {
                                var t = this.handles.points;
                                t.length && t[this.currentHandle - 1].lines.push({
                                    x: e.currentPoints.image.x,
                                    y: e.currentPoints.image.y,
                                    lines: []
                                }), t.push({
                                    x: e.currentPoints.image.x,
                                    y: e.currentPoints.image.y,
                                    lines: []
                                }), this.currentHandle += 1, y.cornerstone.updateImage(e.element)
                            },
                            _applyStrategy: Yn
                        },
                        Xn = wt("segmentation").getters,
                        Jn = Object.assign({}, Kn, {
                            renderToolData: function(e) {
                                var t = this,
                                    n = e.detail,
                                    o = n.element,
                                    r = Xn.brushColor(o, !0),
                                    a = Dn(n.canvasContext.canvas),
                                    i = this.handles;
                                Wt(a, (function(e) {
                                    if (i.points.length > 1)
                                        for (var n = 0; n < i.points.length; n++) {
                                            var a = Q()(i.points[n].lines);
                                            Jt(e, o, t.handles.points[n], a, {
                                                color: r
                                            })
                                        }
                                }))
                            }
                        }),
                        Qn = wt("segmentation"),
                        $n = Qn.getters,
                        eo = Qn.setters;

                    function to(e) {
                        var t = e.detail.element,
                            n = e.detail.currentPoints.image;
                        return _n(this.handles.start) ? this.handles.start = n : (this.handles.end = n, this._applyStrategy(e)), y.cornerstone.updateImage(t), !0
                    }

                    function no(e) {
                        var t = e.detail,
                            n = t.element,
                            o = t.currentPoints.image;
                        this.handles.end = o, y.cornerstone.updateImage(n)
                    }

                    function oo(e) {
                        e.detail.handles = this.handles;
                        var t = e.detail.element,
                            n = $n.labelmap2D(t),
                            o = n.labelmap2D,
                            r = n.labelmap3D,
                            a = n.currentImageIdIndex,
                            i = o.pixelData,
                            s = i.slice(),
                            l = {
                                points: [{
                                    x: this.handles.start.x,
                                    y: this.handles.start.y
                                }, {
                                    x: this.handles.end.x,
                                    y: this.handles.end.y
                                }],
                                pixelData: i,
                                segmentIndex: r.activeSegmentIndex,
                                segmentationMixinType: "rectangleSegmentationMixin"
                            };
                        this.applyActiveStrategy(e, l);
                        var c = {
                            imageIdIndex: a,
                            diff: Le(s, i)
                        };
                        eo.pushState(this.element, [c]), eo.updateSegmentsOnLabelmap2D(o), y.cornerstone.updateImage(t), this._resetHandles()
                    }

                    function ro() {
                        this.handles = {
                            start: {},
                            end: {}
                        }
                    }
                    var ao = {
                            activeOrDisabledBinaryTool: jt,
                            enabledOrDisabledBinaryTool: zt,
                            circleSegmentationMixin: Fn,
                            polylineSegmentationMixin: Jn,
                            freehandSegmentationMixin: Kn,
                            rectangleSegmentationMixin: {
                                postTouchStartCallback: to,
                                postMouseDownCallback: to,
                                mouseClickCallback: to,
                                touchDragCallback: no,
                                mouseDragCallback: no,
                                mouseMoveCallback: no,
                                touchEndCallback: oo,
                                mouseUpCallback: oo,
                                initializeMixin: ro,
                                renderToolData: function(e) {
                                    var t = this,
                                        n = e.detail,
                                        o = n.element,
                                        r = $n.brushColor(o, !0),
                                        a = Dn(n.canvasContext.canvas);
                                    Wt(a, (function(e) {
                                        Mn(e, o, t.handles.start, t.handles.end, {
                                            color: r
                                        })
                                    }))
                                },
                                _resetHandles: ro,
                                _applyStrategy: oo
                            },
                            renderBrushMixin: {
                                renderBrush: function(e) {
                                    var t, n = y.cornerstone,
                                        o = wt("segmentation"),
                                        r = o.getters,
                                        a = o.configuration,
                                        i = e.detail,
                                        s = i.viewport;
                                    if (this._drawing ? t = this._lastImageCoords : this._mouseUpRender ? (t = this._lastImageCoords, this._mouseUpRender = !1) : t = xt.state.mousePositionImage, t) {
                                        var l = i.image,
                                            c = l.rows,
                                            u = l.columns,
                                            d = t,
                                            h = d.x,
                                            f = d.y;
                                        if (!(h < 0 || h > u || f < 0 || f > c)) {
                                            var m = a.radius,
                                                g = i.canvasContext,
                                                p = i.element,
                                                v = r.brushColor(p, this._drawing);
                                            g.setTransform(1, 0, 0, 1, 0, 0);
                                            var b = m * s.scale,
                                                w = n.pixelToCanvas(p, t);
                                            g.beginPath(), g.strokeStyle = v, g.ellipse(w.x, w.y, b, b, 0, 0, 2 * Math.PI), g.stroke()
                                        }
                                    }
                                }
                            }
                        },
                        io = function(e) {
                            return e && "object" === w()(e) && "[object RegExp]" !== Object.prototype.toString.call(e) && "[object Date]" !== Object.prototype.toString.call(e)
                        },
                        so = function(e, t) {
                            var n;
                            return t && !0 === t.clone && io(e) ? uo((n = e, Array.isArray(n) ? [] : {}), e, t) : e
                        },
                        lo = function(e, t, n) {
                            var o = e.slice();
                            return t.forEach((function(t, r) {
                                void 0 === o[r] ? o[r] = so(t, n) : io(t) ? o[r] = uo(e[r], t, n) : -1 === e.indexOf(t) && o.push(so(t, n))
                            })), o
                        },
                        co = function(e, t, n) {
                            var o = {};
                            return io(e) && Object.keys(e).forEach((function(t) {
                                o[t] = so(e[t], n)
                            })), Object.keys(t).forEach((function(r) {
                                io(t[r]) && e[r] ? o[r] = uo(e[r], t[r], n) : o[r] = so(t[r], n)
                            })), o
                        },
                        uo = function() {
                            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},
                                t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
                                n = arguments.length > 2 ? arguments[2] : void 0,
                                o = Array.isArray(t),
                                r = (n || {
                                    arrayMerge: lo
                                }).arrayMerge || lo;
                            if (o) return Array.isArray(e) ? r(e, t, n) : so(t, n);
                            var a = co(e, t, n);
                            return Object.getPrototypeOf(e) !== Object.prototype && Object.setPrototypeOf(a, Object.getPrototypeOf(e)), a
                        },
                        ho = uo,
                        fo = B("tools:base:BaseTool"),
                        mo = wt("globalConfiguration"),
                        go = function() {
                            function e(t, n) {
                                i()(this, e), this.initialConfiguration = ho(n, t);
                                var o = this.initialConfiguration,
                                    r = o.name,
                                    a = o.strategies,
                                    s = o.defaultStrategy,
                                    l = o.configuration,
                                    c = o.supportedInteractionTypes,
                                    u = o.mixins,
                                    d = o.svgCursor;
                                this.name = r, this.mode = "disabled", this.element = void 0, this.supportedInteractionTypes = c || [], this.strategies = a || {}, this.defaultStrategy = s || Object.keys(this.strategies)[0] || void 0, this.activeStrategy = this.defaultStrategy, d && (this.svgCursor = d), this._options = {}, this._configuration = Object.assign({}, l), this.updateOnMouseMove = !1, this.hideDefaultCursor = !1, u && u.length && this._applyMixins(u), this._cursors = Object.assign({}, this.initialConfiguration.cursors);
                                var h = this.defaultStrategy && this._cursors[this.activeStrategy];
                                h && (this.svgCursor = h)
                            }
                            return l()(e, [{
                                key: "mergeOptions",
                                value: function(e) {
                                    this._options = Object.assign({}, this._options, e)
                                }
                            }, {
                                key: "clearOptions",
                                value: function() {
                                    this._options = {}
                                }
                            }, {
                                key: "applyActiveStrategy",
                                value: function(e, t) {
                                    return this.strategies[this.activeStrategy].call(this, e, t)
                                }
                            }, {
                                key: "_applyMixins",
                                value: function(e) {
                                    for (var t = 0; t < e.length; t++) {
                                        var n = ao["".concat(e[t])];
                                        "object" === w()(n) ? (Object.assign(this, n), "function" == typeof this.initializeMixin && this.initializeMixin()) : fo.warn("".concat(this.name, ": mixin ").concat(ao[t], " does not exist."))
                                    }
                                    "function" === this.initializeMixin && delete this.initializeMixin
                                }
                            }, {
                                key: "setActiveStrategy",
                                value: function(e) {
                                    this.activeStrategy = e, mo.configuration.showSVGCursors && this.changeCursor(this.element, e)
                                }
                            }, {
                                key: "changeCursor",
                                value: function(e, t) {
                                    if (e) {
                                        var n = this._cursors[t];
                                        n && (this.svgCursor = n, "active" === this.mode && Et(e, n))
                                    }
                                }
                            }, {
                                key: "configuration",
                                get: function() {
                                    return this._configuration
                                },
                                set: function(e) {
                                    this._configuration = e
                                }
                            }, {
                                key: "options",
                                get: function() {
                                    return this._options
                                }
                            }], [{
                                key: "configuration",
                                get: function() {}
                            }]), e
                        }(),
                        po = function(e, t) {
                            if (e.boundingBox) return y.cornerstoneMath.point.insideRect(t, e.boundingBox)
                        },
                        vo = function(e, t, n, o) {
                            if (e.hasOwnProperty("pointNearHandle")) {
                                if (e.pointNearHandle(t, e, n)) return !0
                            } else if (!0 === e.hasBoundingBox) {
                                if (po(e, n)) return !0
                            } else {
                                var r = y.cornerstone.pixelToCanvas(t, e);
                                if (y.cornerstoneMath.point.distance(r, n) <= o) return !0
                            }
                            return !1
                        },
                        yo = function e(t, n, o, r) {
                            var a;
                            if (n) {
                                if (Array.isArray(n))
                                    for (var i = Object.keys(n), s = 0; s < i.length; s++) {
                                        var l = n[i[s]];
                                        if (l.hasOwnProperty("x") && l.hasOwnProperty("y") && vo(l, t, o, r)) {
                                            a = l;
                                            break
                                        }
                                    } else if ("object" === w()(n))
                                        for (var c = Object.keys(n), u = 0; u < c.length; u++) {
                                            var d = c[u];
                                            if (Array.isArray(n[d])) {
                                                if (a = e(t, n[d], o, r)) break
                                            } else {
                                                var h = n[d];
                                                if (vo(h, t, o, r)) {
                                                    a = h;
                                                    break
                                                }
                                            }
                                        }
                                return a
                            }
                        },
                        bo = function(e, t, n, o) {
                            o || (o = 6);
                            var r = function(e) {
                                    var t;
                                    return Object.keys(e).forEach((function(n) {
                                        var o = e[n];
                                        !0 !== o.active || (t = o)
                                    })), t
                                }(t),
                                a = yo(e, t, n, o);
                            return r !== a && (void 0 !== a && (a.active = !0), void 0 !== r && (r.active = !1), !0)
                        },
                        wo = n(9),
                        xo = n.n(wo),
                        To = function(e, t) {
                            var n = e.image,
                                o = {
                                    left: 0,
                                    top: 0,
                                    width: n.width,
                                    height: n.height
                                },
                                r = !1;
                            return Object.keys(t).forEach((function(e) {
                                var n = t[e];
                                !0 !== n.allowedOutsideImage && !1 === y.cornerstoneMath.point.insideRect(n, o) && (r = !0)
                            })), r
                        },
                        Io = function(e, t) {
                            var n = e.currentPoints,
                                o = e.element,
                                r = n.page,
                                a = vt.handleTouchOffset,
                                i = 0,
                                s = 0;
                            return "touch" === t && (i = a.x, s = a.y), y.cornerstone.pageToPixel(o, r.x + i, r.y + s)
                        },
                        Eo = function(e, t, n) {
                            return t.filter((function(t) {
                                return t.element === e && "active" === t.mode && (void 0 === n || t.options["is".concat(n, "Active")])
                            }))
                        },
                        So = n(5),
                        Ao = n.n(So),
                        Co = function(e, t) {
                            return "active" === Tt(e, t).mode
                        },
                        Mo = wt("segmentation"),
                        Do = function(e) {
                            function t(e) {
                                var n, o = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};
                                return i()(this, t), o.configuration || (o.configuration = {
                                    alwaysEraseOnClick: !1
                                }), (n = u()(this, h()(t).call(this, e, o))).updateOnMouseMove = !0, n.hideDefaultCursor = !0, n._drawing = !1, n._drawingMouseUpCallback = n._drawingMouseUpCallback.bind(Ao()(n)), n
                            }
                            return m()(t, e), l()(t, [{
                                key: "renderBrush",
                                value: function(e) {
                                    throw new Error("Method renderBrush not implemented for ".concat(this.name, "."))
                                }
                            }, {
                                key: "_paint",
                                value: function(e) {
                                    throw new Error("Method _paint not implemented for ".concat(this.name, "."))
                                }
                            }, {
                                key: "mouseDragCallback",
                                value: function(e) {
                                    var t = e.detail.currentPoints;
                                    this._lastImageCoords = t.image, this._drawing && this._paint(e)
                                }
                            }, {
                                key: "preMouseDownCallback",
                                value: function(e) {
                                    var t = e.detail,
                                        n = t.element,
                                        o = t.currentPoints;
                                    return this._startPainting(e), this._lastImageCoords = o.image, this._drawing = !0, this._startListeningForMouseUp(n), this._paint(e), !0
                                }
                            }, {
                                key: "_startPainting",
                                value: function(e) {
                                    var t = e.detail,
                                        n = t.element,
                                        o = Mo.configuration,
                                        r = Mo.getters.labelmap2D(n),
                                        a = r.labelmap2D,
                                        i = r.labelmap3D,
                                        s = r.currentImageIdIndex,
                                        l = r.activeLabelmapIndex,
                                        c = this._isCtrlDown(t) || this.configuration.alwaysEraseOnClick;
                                    if (this.paintEventData = {
                                            labelmap2D: a,
                                            labelmap3D: i,
                                            currentImageIdIndex: s,
                                            activeLabelmapIndex: l,
                                            shouldErase: c
                                        }, o.storeHistory) {
                                        var u = a.pixelData.slice();
                                        this.paintEventData.previousPixelData = u
                                    }
                                }
                            }, {
                                key: "_endPainting",
                                value: function(e) {
                                    for (var t = Mo.configuration, n = Mo.setters, o = this.paintEventData, r = o.labelmap2D, a = o.currentImageIdIndex, i = new Set(r.pixelData).values(), s = [], l = !1; !l;) {
                                        var c = i.next();
                                        (l = c.done) || s.push(c.value)
                                    }
                                    if (r.segmentsOnLabelmap = s, t.storeHistory) {
                                        var u = {
                                            imageIdIndex: a,
                                            diff: Le(this.paintEventData.previousPixelData, r.pixelData)
                                        };
                                        n.pushState(this.element, [u])
                                    }
                                    _e(this.element)
                                }
                            }, {
                                key: "mouseMoveCallback",
                                value: function(e) {
                                    var t = e.detail.currentPoints;
                                    this._lastImageCoords = t.image
                                }
                            }, {
                                key: "renderToolData",
                                value: function(e) {
                                    var t = e.detail.element;
                                    Co(t, this.name) && this.renderBrush(e)
                                }
                            }, {
                                key: "passiveCallback",
                                value: function(e) {
                                    try {
                                        y.cornerstone.updateImage(this.element)
                                    } catch (e) {
                                        return
                                    }
                                }
                            }, {
                                key: "_drawingMouseUpCallback",
                                value: function(e) {
                                    var t = e.detail.element;
                                    this._endPainting(e), this._drawing = !1, this._mouseUpRender = !0, this._stopListeningForMouseUp(t)
                                }
                            }, {
                                key: "newImageCallback",
                                value: function(e) {
                                    this._drawing && (this._endPainting(e), this._startPainting(e))
                                }
                            }, {
                                key: "_startListeningForMouseUp",
                                value: function(e) {
                                    e.removeEventListener(x.MOUSE_UP, this._drawingMouseUpCallback), e.removeEventListener(x.MOUSE_CLICK, this._drawingMouseUpCallback), e.addEventListener(x.MOUSE_UP, this._drawingMouseUpCallback), e.addEventListener(x.MOUSE_CLICK, this._drawingMouseUpCallback), y.cornerstone.updateImage(e)
                                }
                            }, {
                                key: "_stopListeningForMouseUp",
                                value: function(e) {
                                    e.removeEventListener(x.MOUSE_UP, this._drawingMouseUpCallback), e.removeEventListener(x.MOUSE_CLICK, this._drawingMouseUpCallback), y.cornerstone.updateImage(e)
                                }
                            }, {
                                key: "increaseBrushSize",
                                value: function() {
                                    var e = Mo.configuration,
                                        t = Mo.setters,
                                        n = e.radius,
                                        o = Math.floor(1.2 * n);
                                    o === n && (o += 1), t.radius(o)
                                }
                            }, {
                                key: "decreaseBrushSize",
                                value: function() {
                                    var e = Mo.configuration,
                                        t = Mo.setters,
                                        n = e.radius,
                                        o = Math.floor(.8 * n);
                                    t.radius(o)
                                }
                            }, {
                                key: "_isCtrlDown",
                                value: function(e) {
                                    return e.event && e.event.ctrlKey || e.ctrlKey
                                }
                            }]), t
                        }(go),
                        Po = function(e) {
                            return e.filter((function(e) {
                                return !(e.isMultiPartTool || e instanceof gr || e instanceof Do)
                            }))
                        };

                    function ko(e, t) {
                        var n;
                        if ("touch" === (arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : "mouse") ? n = (n = Eo(e, yt.touchTools())).filter((function(e) {
                                return e.options.isTouchActive
                            })) : (n = (n = Eo(e, yt.mouseTools())).filter((function(e) {
                                return Array.isArray(e.options.mouseButtonMask) && t && e.options.mouseButtonMask.includes(t) && e.options.isMouseActive
                            })), vt.isMultiPartToolActive && (n = Po(n))), 0 !== n.length) return n[0]
                    }
                    var _o = B("manipulators:moveAllHandles"),
                        Lo = wt("manipulatorState"),
                        Oo = {
                            mouse: [x.MOUSE_DRAG],
                            touch: [x.TOUCH_DRAG]
                        },
                        Ro = {
                            mouse: [x.MOUSE_UP, x.MOUSE_CLICK],
                            touch: [x.TOUCH_END, x.TOUCH_DRAG_END, x.TOUCH_PINCH, x.TOUCH_PRESS, x.TAP]
                        },
                        No = function(e, t, n, o) {
                            var r = e.element,
                                a = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : {},
                                i = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : "mouse",
                                s = arguments.length > 6 ? arguments[6] : void 0;
                            a = Object.assign({
                                deleteIfHandleOutsideImage: vt.deleteIfHandleOutsideImage,
                                preventHandleOutsideImage: vt.preventHandleOutsideImage
                            }, a);
                            var l = Uo.bind(this, t, n, a, i),
                                c = function e(o) {
                                    Vo(t, n, a, i, {
                                        dragHandler: l,
                                        upOrEndHandler: e
                                    }, o, s)
                                };
                            Lo.setters.addActiveManipulatorForElement(r, Bo.bind(null, n, a, i, {
                                dragHandler: l,
                                upOrEndHandler: c
                            }, r, s)), n.active = !0, vt.isToolLocked = !0, Oo[i].forEach((function(e) {
                                r.addEventListener(e, l)
                            })), Ro[i].forEach((function(e) {
                                r.addEventListener(e, c)
                            }))
                        };

                    function Uo(e, t) {
                        var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                            o = arguments.length > 3 ? arguments[3] : void 0,
                            r = arguments.length > 4 ? arguments[4] : void 0,
                            a = r.detail,
                            i = a.element,
                            s = a.image,
                            l = a.buttons,
                            c = r.detail.deltaPoints.image,
                            u = c.x,
                            d = c.y;
                        t.active = !0, t.invalidated = !0;
                        for (var h = Object.keys(t.handles), f = 0; f < h.length; f++) {
                            var m = h[f],
                                g = t.handles[m];
                            !0 !== g.movesIndependently && g.hasOwnProperty("x") && g.hasOwnProperty("y") && (g.x += u, g.y += d, n.preventHandleOutsideImage && In(g, s))
                        }
                        y.cornerstone.updateImage(i);
                        var p = ko(i, l, o);
                        p instanceof gr && p.updateCachedStats(s, i, t), T(i, x.MEASUREMENT_MODIFIED, {
                            toolName: e,
                            toolType: e,
                            element: i,
                            measurementData: t
                        }), r.preventDefault(), r.stopPropagation()
                    }

                    function Bo(e) {
                        var t = arguments.length > 3 ? arguments[3] : void 0;
                        Fo(e, arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, arguments.length > 2 ? arguments[2] : void 0, {
                            dragHandler: t.dragHandler,
                            upOrEndHandler: t.upOrEndHandler
                        }, arguments.length > 4 ? arguments[4] : void 0, arguments.length > 5 ? arguments[5] : void 0, !1)
                    }

                    function Vo(e, t) {
                        var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                            o = arguments.length > 3 ? arguments[3] : void 0,
                            r = arguments.length > 4 ? arguments[4] : void 0,
                            a = r.dragHandler,
                            i = r.upOrEndHandler,
                            s = arguments.length > 6 ? arguments[6] : void 0,
                            l = (arguments.length > 5 ? arguments[5] : void 0).detail,
                            c = l.element;
                        Lo.setters.removeActiveManipulatorForElement(c), n.deleteIfHandleOutsideImage && To(l, t.handles) && L(c, e, t), Fo(t, n, o, {
                            dragHandler: a,
                            upOrEndHandler: i
                        }, c, s, !0)
                    }

                    function Fo(e) {
                        var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
                            n = arguments.length > 2 ? arguments[2] : void 0,
                            o = arguments.length > 3 ? arguments[3] : void 0,
                            r = o.dragHandler,
                            a = o.upOrEndHandler,
                            i = arguments.length > 4 ? arguments[4] : void 0,
                            s = arguments.length > 5 ? arguments[5] : void 0,
                            l = !(arguments.length > 6 && void 0 !== arguments[6]) || arguments[6];
                        e.active = !1, e.invalidated = !0, vt.isToolLocked = !1, Oo[n].forEach((function(e) {
                            i.removeEventListener(e, r)
                        })), Ro[n].forEach((function(e) {
                            i.removeEventListener(e, a)
                        })), "function" == typeof t.doneMovingCallback && (_o.warn("`options.doneMovingCallback` has been depricated. See https://github.com/cornerstonejs/cornerstoneTools/pull/915 for details."), t.doneMovingCallback(l)), "function" == typeof s && s(l), y.cornerstone.updateImage(i)
                    }
                    var Ho = B("manipulators:moveHandle"),
                        qo = wt("manipulatorState"),
                        jo = {
                            value: !1
                        },
                        zo = {
                            mouse: [x.MOUSE_DRAG],
                            touch: [x.TOUCH_DRAG]
                        },
                        Wo = {
                            mouse: [x.MOUSE_UP, x.MOUSE_CLICK],
                            touch: [x.TOUCH_END, x.TOUCH_DRAG_END, x.TOUCH_PINCH, x.TOUCH_PRESS, x.TAP]
                        },
                        Go = function(e, t, n, o) {
                            var r = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : {},
                                a = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : "mouse",
                                i = arguments.length > 6 ? arguments[6] : void 0;
                            r = Object.assign({
                                deleteIfHandleOutsideImage: vt.deleteIfHandleOutsideImage,
                                preventHandleOutsideImage: vt.preventHandleOutsideImage
                            }, r);
                            var s = e.element,
                                l = Yo.bind(this, t, n, o, r, a),
                                c = function s() {
                                    Ko(t, e, n, o, r, a, {
                                        dragHandler: l,
                                        upOrEndHandler: s
                                    }, i)
                                };
                            if (qo.setters.addActiveManipulatorForElement(s, Zo.bind(null, t, e, n, o, r, a, {
                                    dragHandler: l,
                                    upOrEndHandler: c
                                }, i)), o.active = !0, o.moving = !0, n.active = !0, vt.isToolLocked = !0, zo[a].forEach((function(e) {
                                    s.addEventListener(e, l)
                                })), Wo[a].forEach((function(e) {
                                    s.addEventListener(e, c)
                                })), "touch" === a) {
                                jo.value = !0;
                                var u = y.cornerstone.getEnabledElement(s),
                                    d = Io(e, a);
                                Jo(o, jo, u, d)
                            }
                        };

                    function Yo(e, t, n, o, r, a) {
                        var i = a.detail,
                            s = i.image,
                            l = i.element,
                            c = i.buttons,
                            u = Io(a.detail, r);
                        jo.value = !1, n.active = !0, n.hasMoved = !0, n.x = u.x, n.y = u.y, t.invalidated = !0, o.preventHandleOutsideImage && In(n, s), y.cornerstone.updateImage(l);
                        var d = ko(l, c, r);
                        d instanceof gr && d.updateCachedStats(s, l, t), T(l, x.MEASUREMENT_MODIFIED, {
                            toolName: e,
                            toolType: e,
                            element: l,
                            measurementData: t
                        })
                    }

                    function Zo(e, t, n, o) {
                        var r = arguments.length > 6 ? arguments[6] : void 0;
                        Xo(e, t, n, o, arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : {}, arguments.length > 5 ? arguments[5] : void 0, {
                            dragHandler: r.dragHandler,
                            upOrEndHandler: r.upOrEndHandler
                        }, arguments.length > 7 ? arguments[7] : void 0, !1)
                    }

                    function Ko(e, t, n, o) {
                        var r = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : {},
                            a = arguments.length > 5 ? arguments[5] : void 0,
                            i = arguments.length > 6 ? arguments[6] : void 0,
                            s = i.dragHandler,
                            l = i.upOrEndHandler,
                            c = arguments.length > 7 ? arguments[7] : void 0,
                            u = t.element;
                        qo.setters.removeActiveManipulatorForElement(u), Xo(e, t, n, o, r, a, {
                            dragHandler: s,
                            upOrEndHandler: l
                        }, c, !0)
                    }

                    function Xo(e, t, n, o) {
                        var r = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : {},
                            a = arguments.length > 5 ? arguments[5] : void 0,
                            i = arguments.length > 6 ? arguments[6] : void 0,
                            s = i.dragHandler,
                            l = i.upOrEndHandler,
                            c = arguments.length > 7 ? arguments[7] : void 0,
                            u = !(arguments.length > 8 && void 0 !== arguments[8]) || arguments[8],
                            d = t.element;
                        o.active = !1, o.moving = !1, n.active = !1, n.invalidated = !0, jo.value = !1, vt.isToolLocked = !1, zo[a].forEach((function(e) {
                            d.removeEventListener(e, s)
                        })), Wo[a].forEach((function(e) {
                            d.removeEventListener(e, l)
                        })), r.deleteIfHandleOutsideImage && To(t, n.handles) && L(d, e, n), "function" == typeof r.doneMovingCallback && (Ho.warn("`options.doneMovingCallback` has been depricated. See https://github.com/cornerstonejs/cornerstoneTools/pull/915 for details."), r.doneMovingCallback(u)), "function" == typeof c && c(u), y.cornerstone.updateImage(d)
                    }

                    function Jo(e, t, n, o) {
                        if (t.value) {
                            var r = Math.abs(e.y - o.y),
                                a = r / 10;
                            if (r < 1) return e.y = o.y, void(t.value = !1);
                            e.y > o.y ? e.y -= a : e.y < o.y && (e.y += a), y.cornerstone.updateImage(n.element), y.cornerstone.requestAnimationFrame((function() {
                                Jo(e, t, n, o)
                            }))
                        }
                    }
                    var Qo = B("manipulators:moveNewHandle"),
                        $o = wt("manipulatorState"),
                        er = {
                            mouse: [x.MOUSE_MOVE, x.MOUSE_DRAG],
                            touch: [x.TOUCH_DRAG]
                        },
                        tr = {
                            mouse: [x.MOUSE_UP, x.MOUSE_CLICK],
                            touch: [x.TOUCH_END, x.TOUCH_PINCH, x.TAP]
                        },
                        nr = function(e, t, n, o, r) {
                            var a = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : "mouse",
                                i = arguments.length > 6 ? arguments[6] : void 0;
                            (r = Object.assign({
                                deleteIfHandleOutsideImage: vt.deleteIfHandleOutsideImage,
                                preventHandleOutsideImage: vt.preventHandleOutsideImage
                            }, r)).hasMoved = !1;
                            var s = e.element;

                            function l(e) {
                                or(t, n, o, r, a, e)
                            }

                            function c(e) {
                                ar(t, n, o, r, a, {
                                    moveHandler: l,
                                    moveEndHandler: c
                                }, e, i)
                            }
                            n.active = !0, o.moving = !0, o.active = !0, vt.isToolLocked = !0, er[a].forEach((function(e) {
                                s.addEventListener(e, l)
                            })), s.addEventListener(x.TOUCH_START, sr), tr[a].forEach((function(e) {
                                s.addEventListener(e, c)
                            })), $o.setters.addActiveManipulatorForElement(s, ir.bind(null, n, o, r, a, {
                                moveHandler: l,
                                moveEndHandler: c
                            }, s, i))
                        };

                    function or(e, t, n, o, r, a) {
                        var i = a.detail,
                            s = i.image,
                            l = i.element,
                            c = i.buttons,
                            u = Io(a.detail, r);
                        o.hasMoved = !0, t.invalidated = !0, n.active = !0, n.x = u.x, n.y = u.y, o && o.preventHandleOutsideImage && In(n, s), y.cornerstone.updateImage(l);
                        var d = ko(l, c, r);
                        d instanceof gr && d.updateCachedStats(s, l, t), T(l, x.MEASUREMENT_MODIFIED, {
                            toolName: e,
                            toolType: e,
                            element: l,
                            measurementData: t
                        })
                    }

                    function rr(e, t, n, o, r) {
                        var a = o.moveHandler,
                            i = o.moveEndHandler,
                            s = !(arguments.length > 5 && void 0 !== arguments[5]) || arguments[5];
                        er[e].forEach((function(e) {
                            n.removeEventListener(e, a)
                        })), tr[e].forEach((function(e) {
                            n.removeEventListener(e, i)
                        })), n.removeEventListener(x.TOUCH_START, sr), vt.isToolLocked = !1, "function" == typeof r && r(s), "function" == typeof t.doneMovingCallback && (Qo.warn("`options.doneMovingCallback` has been depricated. See https://github.com/cornerstonejs/cornerstoneTools/pull/915 for details."), t.doneMovingCallback(s)), y.cornerstone.updateImage(n)
                    }

                    function ar(e, t, n, o, r, a, i, s) {
                        var l = a.moveHandler,
                            c = a.moveEndHandler,
                            u = i.detail,
                            d = u.element,
                            h = !0;
                        if (!1 !== o.hasMoved) {
                            var f = Io(u, r);
                            t.active = !1, t.invalidated = !0, n.active = !1, n.moving = !1, n.x = f.x, n.y = f.y, $o.setters.removeActiveManipulatorForElement(d), o.preventHandleOutsideImage && In(n, i.detail.image), o.deleteIfHandleOutsideImage && To(i.detail, t.handles) && (t.cancelled = !0, h = !1, L(d, e, t)), rr(r, o, d, {
                                moveHandler: l,
                                moveEndHandler: c
                            }, s, h)
                        }
                    }

                    function ir(e, t, n, o, r, a, i) {
                        var s = r.moveHandler,
                            l = r.moveEndHandler;
                        e.active = !1, e.invalidated = !0, t.active = !1, rr(o, n, a, {
                            moveHandler: s,
                            moveEndHandler: l
                        }, i, !1)
                    }

                    function sr(e) {
                        return e.stopImmediatePropagation(), !1
                    }

                    function lr(e, t) {
                        var n = vt.clickProximity,
                            o = vt.touchProximity,
                            r = vt.tools.find((function(e) {
                                return e.name === t
                            }));
                        return r && r.configuration && (n = r.configuration.clickProximity || n, o = r.configuration.touchProximity || o), "mouse" === e ? n : o
                    }

                    function cr(e, t) {
                        var n = Object.keys(e);
                        if (Object.getOwnPropertySymbols) {
                            var o = Object.getOwnPropertySymbols(e);
                            t && (o = o.filter((function(t) {
                                return Object.getOwnPropertyDescriptor(e, t).enumerable
                            }))), n.push.apply(n, o)
                        }
                        return n
                    }

                    function ur(e) {
                        for (var t = 1; t < arguments.length; t++) {
                            var n = null != arguments[t] ? arguments[t] : {};
                            t % 2 ? cr(n, !0).forEach((function(t) {
                                xo()(e, t, n[t])
                            })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : cr(n).forEach((function(t) {
                                Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                            }))
                        }
                        return e
                    }
                    var dr = function(e, t, n, o, r) {
                            n.active = !0, vt.isToolLocked = !0, Go(e.detail, t.name, n, o, t.options, r, (function(t) {
                                var o = e.detail.element,
                                    r = n.toolType || n.toolName,
                                    a = {
                                        toolName: r,
                                        toolType: r,
                                        element: o,
                                        measurementData: ur({}, n, {
                                            active: !1
                                        })
                                    };
                                T(o, x.MEASUREMENT_COMPLETED, a)
                            })), e.stopImmediatePropagation(), e.stopPropagation(), e.preventDefault()
                        },
                        hr = function(e, t, n, o) {
                            for (var r = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : "mouse", a = 0; a < t.data.length; a++) {
                                var i = t.data[a],
                                    s = yo(e, i.handles, o, lr(r, n));
                                if (s) return {
                                    handle: s,
                                    data: i
                                }
                            }
                        },
                        fr = function(e, t, n) {
                            var o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : "mouse";
                            n.active = !0, vt.isToolLocked = !0, No(e.detail, t.name, n, null, t.options, o, (function() {
                                n.active = !1, vt.isToolLocked = !1
                            })), e.stopImmediatePropagation(), e.stopPropagation(), e.preventDefault()
                        },
                        mr = B("baseAnnotationTool"),
                        gr = function(e) {
                            function t() {
                                return i()(this, t), u()(this, h()(t).apply(this, arguments))
                            }
                            return m()(t, e), l()(t, [{
                                key: "createNewMeasurement",
                                value: function(e) {
                                    throw new Error("Method createNewMeasurement not implemented for ".concat(this.name, "."))
                                }
                            }, {
                                key: "pointNearTool",
                                value: function(e, t, n) {
                                    throw new Error("Method pointNearTool not implemented for ".concat(this.name, "."))
                                }
                            }, {
                                key: "distanceFromPoint",
                                value: function(e, t, n) {
                                    throw new Error("Method distanceFromPoint not implemented for ".concat(this.name, "."))
                                }
                            }, {
                                key: "renderToolData",
                                value: function(e) {
                                    throw new Error("renderToolData not implemented for ".concat(this.name, "."))
                                }
                            }, {
                                key: "mouseMoveCallback",
                                value: function(e) {
                                    for (var t = e.detail, n = t.element, o = t.currentPoints.canvas, r = _(n, this.name), a = !1, i = 0; i < r.data.length; i++) {
                                        var s = r.data[i];
                                        !0 === bo(n, s.handles, o) && (a = !0);
                                        var l = this.pointNearTool(n, s, o, "mouse") && !s.active,
                                            c = !this.pointNearTool(n, s, o, "mouse") && s.active;
                                        (l || c) && (s.active = !s.active, a = !0)
                                    }
                                    return a
                                }
                            }, {
                                key: "handleSelectedCallback",
                                value: function(e, t, n) {
                                    dr(e, this, t, n, arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : "mouse")
                                }
                            }, {
                                key: "toolSelectedCallback",
                                value: function(e, t) {
                                    fr(e, this, t, arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : "mouse")
                                }
                            }, {
                                key: "updateCachedStats",
                                value: function(e, t, n) {
                                    mr.warn("updateCachedStats not implemented for ".concat(this.name, "."))
                                }
                            }]), t
                        }(go),
                        pr = function(e, t, n, o) {
                            var r = y.cornerstone,
                                a = {
                                    start: r.pixelToCanvas(e, t),
                                    end: r.pixelToCanvas(e, n)
                                };
                            return y.cornerstoneMath.lineSegment.distanceToPoint(a, o)
                        },
                        vr = function(e, t) {
                            var n = Math.pow(10, t);
                            return Math.round(e * n) / n
                        },
                        yr = bt.cursor,
                        br = function() {
                            function e(t, n) {
                                i()(this, e), this.iconGroupString = t, this.options = Object.assign({}, yr.getters.defaultOptions(), n)
                            }
                            return l()(e, [{
                                key: "getIconSVG",
                                value: function() {
                                    var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},
                                        t = this._generateIconSVGString(e);
                                    return new Blob([t], {
                                        type: "image/svg+xml"
                                    })
                                }
                            }, {
                                key: "getIconSVGString",
                                value: function() {
                                    var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                    return this._generateIconSVGString(e)
                                }
                            }, {
                                key: "getIconWithPointerSVG",
                                value: function() {
                                    var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},
                                        t = this._generateIconWithPointerSVGString(e);
                                    return new Blob([t], {
                                        type: "image/svg+xml"
                                    })
                                }
                            }, {
                                key: "getIconWithPointerString",
                                value: function() {
                                    var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                    return this._generateIconWithPointerSVGString(e)
                                }
                            }, {
                                key: "_generateIconWithPointerSVGString",
                                value: function() {
                                    var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},
                                        t = Object.assign({}, this.options, e),
                                        n = t.mousePointerGroupString,
                                        o = t.iconSize,
                                        r = t.viewBox,
                                        a = o / Math.max(r.x, r.y),
                                        i = 16 + o,
                                        s = '\n        <svg\n        data-icon="cursor" role="img" xmlns="http://www.w3.org/2000/svg"\n        width="'.concat(i, '" height="').concat(i, '" viewBox="0 0 ').concat(i, " ").concat(i, '"\n      >\n        <g>\n          ').concat(n, '\n        </g>\n        <g transform="translate(16, 16) scale(').concat(a, ')">\n          ').concat(this.iconGroupString, "\n        </g>\n      </svg>");
                                    return this._injectColors(s, t)
                                }
                            }, {
                                key: "_generateIconSVGString",
                                value: function() {
                                    var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},
                                        t = Object.assign({}, this.options, e),
                                        n = t.iconSize,
                                        o = t.viewBox,
                                        r = '\n      <svg\n        data-icon="cursor" role="img" xmlns="http://www.w3.org/2000/svg"\n        width="'.concat(n, '" height="').concat(n, '" viewBox="0 0\n        ').concat(o.x, " ").concat(o.y, '"\n      >\n        ').concat(this.iconGroupString, "\n      </svg>");
                                    return this._injectColors(r, t)
                                }
                            }, {
                                key: "_injectColors",
                                value: function(e) {
                                    var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
                                        n = t.activeColor || un.getActiveColor(),
                                        o = t.toolColor || un.getToolColor(),
                                        r = t.fillColor || un.getFillColor();
                                    return e.replace(/ACTIVE_COLOR/g, "".concat(n)).replace(/TOOL_COLOR/g, "".concat(o)).replace(/FILL_COLOR/g, "".concat(r))
                                }
                            }, {
                                key: "mousePoint",
                                get: function() {
                                    var e = this.options.mousePoint;
                                    return "".concat(e.x, " ").concat(e.y)
                                }
                            }]), e
                        }(),
                        wr = new br('<path fill="ACTIVE_COLOR" d="M1203 544q0 13-10 23l-393 393 393 393q10 10 10 23t-10 23l-50\n        50q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l466-466q10-10 23-10t23\n        10l50 50q10 10 10 23z"\n      />', {
                            viewBox: {
                                x: 1792,
                                y: 1792
                            }
                        }),
                        xr = new br('<g id="arrowAnnotate-group" fill="none" stroke-width="1" stroke="ACTIVE_COLOR" stroke-linecap="round" stroke-linejoin="round">\n    <path id="arrowAnnotate-arrow" d="M23,7 l-15,15 M7,17 l0,6 6,0" stroke-width="2" />\n  </g>', {
                            viewBox: {
                                x: 24,
                                y: 24
                            }
                        }),
                        Tr = new br('<g fill="ACTIVE_COLOR" stroke-width="3" stroke="ACTIVE_COLOR">\n    <path d="M27.63 3.21L3.12 28.81"></path>\n    <path d="M27.63 15.75L15.27 4.43"></path>\n    <path d="M16.5 4.28C16.5 4.96 15.95 5.51 15.27 5.51C14.59 5.51 14.03 4.96 14.03 4.28C14.03 3.59 14.59 3.04 15.27 3.04C15.95 3.04 16.5 3.59 16.5 4.28Z" ></path>\n    <path d="M28.87 3.19C28.87 3.87 28.31 4.43 27.63 4.43C26.95 4.43 26.4 3.87 26.4 3.19C26.4 2.51 26.95 1.95 27.63 1.95C28.31 1.95 28.87 2.51 28.87 3.19Z"></path>\n    <path d="M28.87 15.75C28.87 16.43 28.31 16.99 27.63 16.99C26.95 16.99 26.4 16.43 26.4 15.75C26.4 15.07 26.95 14.51 27.63 14.51C28.31 14.51 28.87 15.07 28.87 15.75Z"></path>\n    <path d="M4.73 28.44C4.73 29.12 4.17 29.68 3.49 29.68C2.81 29.68 2.25 29.12 2.25 28.44C2.25 27.76 2.81 27.2 3.49 27.2C4.17 27.2 4.73 27.76 4.73 28.44Z"></path>\n  </g>', {
                            viewBox: {
                                x: 48,
                                y: 48
                            }
                        }),
                        Ir = new br('<g stroke="ACTIVE_COLOR" stroke-width="3">\n    <path d="M28.59 2.34L3.82 12.32"></path>\n    <path d="M28.59 29.66L3.82 19.68"></path>\n    <path stroke-dasharray="2" fill-opacity="0" d="M12.37\n      23.06C12.67 22.36 12.85 21.93 12.92 21.76C14.6 17.8 14.68 13.35 13.15\n      9.33C13.11 9.24 13.02 9 12.88 8.63">\n    </path>\n  </g>', {
                            viewBox: {
                                x: 32,
                                y: 32
                            }
                        }),
                        Er = new br('<circle stroke="ACTIVE_COLOR" fill="none" stroke-width="3" cx="16" cy="16" r="14" />', {
                            viewBox: {
                                x: 32,
                                y: 32
                            }
                        }),
                        Sr = new br('<path stroke="ACTIVE_COLOR" fill="none" stroke-width="3" d="M30.74 15.76C30.74 20.99 24.14 25.23 16\n    25.23C7.86 25.23 1.26 20.99 1.26 15.76C1.26 10.54 7.86 6.3 16 6.3C24.14\n    6.3 30.74 10.54 30.74 15.76Z"\n    />', {
                            viewBox: {
                                x: 32,
                                y: 32
                            }
                        }),
                        Ar = new br('\n  <g fill="ACTIVE_COLOR" stroke="ACTIVE_COLOR" stroke-width="2">\n    <ellipse ry="1" rx="1" id="svg_3" cy="4.240343" cx="14.306499"/>\n    <line id="svg_4" y2="3.58462" x2="12.242186" y1="3.997482" x1="13.432202"/>\n    <line id="svg_5" y2="3.268901" x2="10.857882" y1="3.608906" x1="12.387902"/>\n    <line id="svg_6" y2="3.147471" x2="9.740724" y1="3.293187" x1="10.955026"/>\n    <line id="svg_7" y2="3.147471" x2="8.089274" y1="3.196043" x1="9.983585"/>\n    <line id="svg_8" y2="3.268901" x2="6.874972" y1="3.123185" x1="8.307848"/>\n    <line id="svg_9" y2="3.657478" x2="5.587812" y1="3.220329" x1="7.020688"/>\n    <line id="svg_10" y2="4.046054" x2="4.737801" y1="3.560334" x1="5.854959"/>\n    <line id="svg_11" y2="4.337487" x2="4.300652" y1="3.997482" x1="4.834945"/>\n    <line id="svg_12" y2="4.726063" x2="3.88779" y1="4.191771" x1="4.470655"/>\n    <line id="svg_15" y2="5.3575" x2="3.377783" y1="4.604633" x1="3.960648"/>\n    <line id="svg_16" y2="6.183226" x2="2.916348" y1="5.138926" x1="3.547785"/>\n    <line id="svg_17" y2="6.960379" x2="2.770632" y1="5.867507" x1="3.037779"/>\n    <line id="svg_18" y2="7.713246" x2="2.673488" y1="6.741804" x1="2.819204"/>\n    <line id="svg_19" y2="8.684687" x2="2.697774" y1="7.616102" x1="2.673488"/>\n    <line id="svg_20" y2="9.753273" x2="2.892062" y1="8.611829" x1="2.697774"/>\n    <line id="svg_21" y2="10.724714" x2="3.134923" y1="9.534698" x1="2.84349"/>\n    <line id="svg_23" y2="11.647583" x2="3.596357" y1="10.578998" x1="3.086351"/>\n    <line id="svg_25" y2="12.521881" x2="4.276366" y1="11.501867" x1="3.499213"/>\n    <line id="svg_26" y2="13.930471" x2="5.830673" y1="12.376165" x1="4.13065"/>\n    <line id="svg_28" y2="14.707624" x2="7.263549" y1="13.881899" x1="5.733528"/>\n    <line id="svg_29" y2="15.339061" x2="8.963571" y1="14.61048" x1="7.06926"/>\n    <line id="svg_30" y2="15.581921" x2="10.882168" y1="15.314775" x1="8.817855"/>\n    <line id="svg_31" y2="15.460491" x2="12.023612" y1="15.581921" x1="10.785024"/>\n    <line id="svg_33" y2="15.120487" x2="13.092197" y1="15.484777" x1="11.877895"/>\n    <line id="svg_34" y2="14.586194" x2="13.86935" y1="15.217631" x1="12.897909"/>\n    <line id="svg_35" y2="13.833327" x2="14.597931" y1="14.756196" x1="13.699348"/>\n    <line id="svg_37" y2="12.716169" x2="15.180796" y1="13.881899" x1="14.549359"/>\n    <line id="svg_39" y2="11.429009" x2="15.520801" y1="12.813313" x1="15.15651"/>\n    <ellipse ry="1" rx="1" id="svg_40" cy="10.967574" cx="15.520801"/>\n  </g>', {
                            viewBox: {
                                x: 18,
                                y: 18
                            }
                        }),
                        Cr = new br('<g id="icon-freehand-sculpt" fill="none" stroke-width="1.5" stroke="ACTIVE_COLOR" stroke-linecap="round" stroke-linejoin="round">\n      <line id="svg_1" y2="2.559367" x2="10.184807" y1="4.467781" x1="8.81711"/>\n      <line id="svg_4" y2="1.493836" x2="11.727442" y1="2.766112" x1="10.089386"/>\n      <line id="svg_7" y2="1.080346" x2="13.047428" y1="1.748291" x1="11.345759"/>\n      <line id="svg_8" y2="1.000829" x2="14.351511" y1="1.112153" x1="12.77707"/>\n      <line id="svg_9" y2="1.350705" x2="15.242104" y1="0.905408" x1="13.969828"/>\n      <line id="svg_10" y2="2.098167" x2="15.862339" y1="1.14396" x1="14.955842"/>\n      <line id="svg_11" y2="3.195505" x2="16.41896" y1="1.939133" x1="15.766918"/>\n      <line id="svg_12" y2="4.292843" x2="16.530284" y1="2.925147" x1="16.387153"/>\n      <line id="svg_16" y2="5.644637" x2="16.196311" y1="3.831643" x1="16.593898"/>\n      <line id="svg_18" y2="7.266789" x2="15.623787" y1="5.19934" x1="16.275829"/>\n      <line id="svg_19" y2="10.813258" x2="14.526449" y1="6.726071" x1="15.766918"/>\n      <line id="svg_20" y2="5.056209" x2="8.085552" y1="4.181519" x1="8.976145"/>\n      <line id="svg_23" y2="5.326568" x2="7.481221" y1="4.78585" x1="8.403621"/>\n      <line id="svg_24" y2="5.565119" x2="6.749662" y1="5.294761" x1="7.624352"/>\n      <line id="svg_25" y2="5.994512" x2="5.429675" y1="5.533312" x1="6.956407"/>\n      <line id="svg_27" y2="6.551133" x2="4.284627" y1="5.962706" x1="5.572807"/>\n      <line id="svg_28" y2="7.584858" x2="3.044158" y1="6.392099" x1="4.427758"/>\n      <line id="svg_29" y2="8.84123" x2="2.185372" y1="7.489437" x1="3.219096"/>\n      <line id="svg_31" y2="10.606513" x2="1.644654" y1="8.602678" x1="2.280792"/>\n      <line id="svg_32" y2="13.214679" x2="1.48562" y1="10.352058" x1="1.724171"/>\n      <line id="svg_33" y2="14.375631" x2="1.676461" y1="12.992031" x1="1.453813"/>\n      <line id="svg_34" y2="15.298031" x2="2.264889" y1="14.152983" x1="1.517427"/>\n      <line id="svg_35" y2="16.172721" x2="3.521261" y1="14.948155" x1="1.915013"/>\n      <line id="svg_36" y2="16.824762" x2="5.207027" y1="15.997783" x1="3.28271"/>\n      <line id="svg_38" y2="17.063314" x2="7.035924" y1="16.745245" x1="4.968475"/>\n      <line id="svg_39" y2="16.888376" x2="9.278311" y1="17.047411" x1="6.733758"/>\n      <line id="svg_40" y2="16.284045" x2="10.661911" y1="16.983797" x1="8.992048"/>\n      <line id="svg_41" y2="15.313934" x2="11.647925" y1="16.395369" x1="10.455166"/>\n      <line id="svg_44" y2="13.898527" x2="12.82478" y1="15.425259" x1="11.504794"/>\n      <line id="svg_45" y2="12.037824" x2="14.144766" y1="14.312017" x1="12.522614"/>\n      <line id="svg_47" y2="10.59061" x2="14.605966" y1="12.228665" x1="13.953925"/>\n      <ellipse ry="1" rx="1" id="svg_48" cy="3.982726" cx="13.460918"/>\n    </g>', {
                            viewBox: {
                                x: 18,
                                y: 18
                            }
                        }),
                        Mr = new br('<g id="length-group" fill="none" stroke-width="1" stroke="ACTIVE_COLOR" stroke-linecap="round" stroke-linejoin="round">\n    <path id="length-dashes" d="m22.5,6 -16.5,16.5" stroke-width="3" stroke-dasharray="0.6666,5" />\n  </g>', {
                            viewBox: {
                                x: 24,
                                y: 24
                            }
                        }),
                        Dr = new br('<path fill="ACTIVE_COLOR" d="M1152 896q0 106-75 181t-181 75-181-75-75-181 75-181 181-75 181 75\n    75 181zm-256-544q-148 0-273 73t-198 198-73 273 73 273 198 198 273 73 273-73\n    198-198 73-273-73-273-198-198-273-73zm768 544q0 209-103 385.5t-279.5\n    279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5\n    385.5-103 385.5 103 279.5 279.5 103 385.5z"\n  />', {
                            viewBox: {
                                x: 1792,
                                y: 1792
                            }
                        }),
                        Pr = new br('<path fill="ACTIVE_COLOR" d="M1312 256h-832q-66 0-113 47t-47 113v832q0 66 47\n    113t113 47h832q66 0 113-47t47-113v-832q0-66-47-113t-113-47zm288 160v832q0\n    119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119\n    84.5-203.5t203.5-84.5h832q119 0 203.5 84.5t84.5 203.5z"\n  />', {
                            viewBox: {
                                x: 1792,
                                y: 1792
                            }
                        }),
                        kr = new br('<path fill="ACTIVE_COLOR" d="M789 559l-170 450q33 0 136.5 2t160.5 2q19 0\n    57-2-87-253-184-452zm-725 1105l2-79q23-7 56-12.5t57-10.5 49.5-14.5 44.5-29\n    31-50.5l237-616 280-724h128q8 14 11 21l205 480q33 78 106 257.5t114 274.5q15\n    34 58 144.5t72 168.5q20 45 35 57 19 15 88 29.5t84 20.5q6 38 6 57 0 5-.5\n    13.5t-.5 12.5q-63 0-190-8t-191-8q-76 0-215 7t-178 8q0-43 4-78l131-28q1 0\n    12.5-2.5t15.5-3.5 14.5-4.5 15-6.5 11-8 9-11\n    2.5-14q0-16-31-96.5t-72-177.5-42-100l-450-2q-26 58-76.5 195.5t-50.5 162.5q0\n    22 14 37.5t43.5 24.5 48.5 13.5 57 8.5 41 4q1 19 1 58 0 9-2 27-58\n    0-174.5-10t-174.5-10q-8 0-26.5 4t-21.5 4q-80 14-188 14z"\n  />', {
                            viewBox: {
                                x: 1792,
                                y: 1792
                            }
                        }),
                        _r = new br('<path fill="ACTIVE_COLOR" d="M1325 1024h-109q-26 0-45-19t-19-45v-128q0-26\n    19-45t45-19h109q-32-108-112.5-188.5t-188.5-112.5v109q0 26-19 45t-45\n    19h-128q-26 0-45-19t-19-45v-109q-108 32-188.5 112.5t-112.5 188.5h109q26\n    0 45 19t19 45v128q0 26-19 45t-45 19h-109q32 108 112.5 188.5t188.5\n    112.5v-109q0-26 19-45t45-19h128q26 0 45 19t19 45v109q108-32\n    188.5-112.5t112.5-188.5zm339-192v128q0 26-19 45t-45 19h-143q-37 161-154.5\n    278.5t-278.5 154.5v143q0 26-19 45t-45 19h-128q-26\n    0-45-19t-19-45v-143q-161-37-278.5-154.5t-154.5-278.5h-143q-26\n    0-45-19t-19-45v-128q0-26 19-45t45-19h143q37-161\n    154.5-278.5t278.5-154.5v-143q0-26 19-45t45-19h128q26 0 45 19t19 45v143q161\n    37 278.5 154.5t154.5 278.5h143q26 0 45 19t19 45z"\n  />', {
                            viewBox: {
                                x: 1792,
                                y: 1792
                            }
                        }),
                        Lr = new br('<path transform="translate(0,1792) scale(1,-1)" fill="ACTIVE_COLOR" d="M960 1408l336-384h-768l-336 384h768zm1013-1077q15\n      34 9.5 71.5t-30.5 65.5l-896 1024q-38 44-96 44h-768q-38\n      0-69.5-20.5t-47.5-54.5q-15-34-9.5-71.5t30.5-65.5l896-1024q38-44 96-44h768q38\n      0 69.5 20.5t47.5 54.5z"\n    />', {
                            viewBox: {
                                x: 2048,
                                y: 1792
                            }
                        }),
                        Or = new br('<path fill="ACTIVE_COLOR" d="M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395\n      312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5\n      0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17\n      0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208\n      32s176 78.7 176 176-78.7 176-176 176z"\n    />', {
                            viewBox: {
                                x: 512,
                                y: 512
                            }
                        }),
                        Rr = new br('<path fill="ACTIVE_COLOR" d="M1411 541l-355 355 355 355 144-144q29-31 70-14 39 17\n      39 59v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l144-144-355-355-355\n      355 144 144q31 30 14 69-17 40-59 40h-448q-26 0-45-19t-19-45v-448q0-42 40-59\n      39-17 69 14l144 144 355-355-355-355-144 144q-19 19-45 19-12\n      0-24-5-40-17-40-59v-448q0-26 19-45t45-19h448q42 0 59 40 17 39-14 69l-144\n      144 355 355 355-355-144-144q-31-30-14-69 17-40 59-40h448q26 0 45 19t19\n      45v448q0 42-39 59-13 5-25 5-26 0-45-19z"\n    />', {
                            viewBox: {
                                x: 1792,
                                y: 1792
                            }
                        }),
                        Nr = new br('<path fill="ACTIVE_COLOR" d="M1664 256v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39\n      14-69l138-138q-148-137-349-137-104 0-198.5 40.5t-163.5 109.5-109.5\n      163.5-40.5 198.5 40.5 198.5 109.5 163.5 163.5 109.5 198.5 40.5q119 0\n      225-52t179-147q7-10 23-12 15 0 25 9l137 138q9 8 9.5 20.5t-7.5 22.5q-109\n      132-264 204.5t-327 72.5q-156 0-298-61t-245-164-164-245-61-298 61-298\n      164-245 245-164 298-61q147 0 284.5 55.5t244.5 156.5l130-129q29-31 70-14\n      39 17 39 59z"\n    />', {
                            viewBox: {
                                x: 1792,
                                y: 1792
                            }
                        }),
                        Ur = new br('<path fill="ACTIVE_COLOR" d="M24 21v2c0 0.547-0.453 1-1 1h-22c-0.547\n      0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1zM24 13v2c0\n      0.547-0.453 1-1 1h-22c-0.547 0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547\n      0 1 0.453 1 1zM24 5v2c0 0.547-0.453 1-1 1h-22c-0.547\n      0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1z"\n      />', {
                            viewBox: {
                                x: 24,
                                y: 28
                            }
                        }),
                        Br = new br('<path fill="ACTIVE_COLOR" d="M1664 416v960q0 119-84.5 203.5t-203.5 84.5h-960q-119\n    0-203.5-84.5t-84.5-203.5v-960q0-119 84.5-203.5t203.5-84.5h960q119 0 203.5\n    84.5t84.5 203.5z"\n  />', {
                            viewBox: {
                                x: 1792,
                                y: 1792
                            }
                        }),
                        Vr = new br('<path fill="ACTIVE_COLOR" d="M14.5,3.5 a1 1 0 0 1 -11,11 Z" stroke="none" opacity="0.8" />\n    <circle cx="9" cy="9" r="8" fill="none" stroke-width="2" stroke="ACTIVE_COLOR" />', {
                            viewBox: {
                                x: 18,
                                y: 18
                            }
                        }),
                        Fr = new br('<path fill="ACTIVE_COLOR" d="M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395\n      312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5\n      0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17\n      0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208\n      32s176 78.7 176 176-78.7 176-176 176z"\n    />\n    <path fill="ACTIVE_COLOR" transform="scale(0.22,0.22) translate(1400,0)" d="M1216\n      320q0 26-19 45t-45 19h-128v1024h128q26 0 45 19t19 45-19 45l-256 256q-19\n      19-45 19t-45-19l-256-256q-19-19-19-45t19-45 45-19h128v-1024h-128q-26\n      0-45-19t-19-45 19-45l256-256q19-19 45-19t45 19l256 256q19 19 19 45z"\n    />', {
                            viewBox: {
                                x: 640,
                                y: 512
                            }
                        }),
                        Hr = {
                            x: 127,
                            y: 60
                        },
                        qr = function() {
                            return '<rect fill="'.concat(arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "ACTIVE_COLOR", '" x="80.19" y="25.03" width="47.14" height="15.85"/>')
                        },
                        jr = function() {
                            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "ACTIVE_COLOR";
                            return '<rect fill="'.concat(e, '" x="80.19" y="25.03" width="47.14" height="15.85"/>\n      <rect fill="').concat(e, '" x="95.84" y="9.38" width="15.85" height="47.14"/>')
                        },
                        zr = '<path fill="ACTIVE_COLOR" d="M82.89,10a12.09,12.09,0,0,0-16.8-2.5l-27.5,20.4-8.5-6.3a2.93,2.93,0,0,1-1.1-3,14.66,14.66,0,0,0,.1-6.6,14.08,14.08,0,1,0-6.5,15.2,2.87,2.87,0,0,1,3.2.2l8.2,6.1-8.2,6.1a2.87,2.87,0,0,1-3.2.2,14.16,14.16,0,1,0,6.7,14.4,14,14,0,0,0-.3-5.8,2.93,2.93,0,0,1,1.1-3l8.5-6.3,27.5,20.4A11.91,11.91,0,0,0,82.89,57l-31.7-23.5ZM15.29,21a5.9,5.9,0,1,1,5.9-5.9A5.91,5.91,0,0,1,15.29,21Zm0,36.8a5.9,5.9,0,1,1,5.9-5.9A5.91,5.91,0,0,1,15.29,57.77Zm28.3-21.5a2.8,2.8,0,1,1,2.8-2.8A2.8,2.8,0,0,1,43.59,36.27Z" transform="translate(-1.17 -0.96)"/>',
                        Wr = '<path fill="ACTIVE_COLOR" d="M8.86,2.25V66.08H72.69V2.25H8.86ZM65.28,58.67h-49v-49h49v49Z" transform="translate(-8.86 -2.25)"/>',
                        Gr = '<path fill="ACTIVE_COLOR" d="M40.77,2.25A31.92,31.92,0,1,0,72.69,34.16,31.92,31.92,0,0,0,40.77,2.25Zm0,57.63A25.71,25.71,0,1,1,66.48,34.16,25.71,25.71,0,0,1,40.77,59.87Z" transform="translate(-8.86 -2.25)"/>',
                        Yr = new br("".concat(zr, " ").concat(qr()), {
                            viewBox: Hr
                        }),
                        Zr = new br("".concat(zr, " ").concat(jr()), {
                            viewBox: Hr
                        }),
                        Kr = new br("".concat(zr, " ").concat(qr()), {
                            viewBox: Hr
                        }),
                        Xr = new br("".concat(zr, " ").concat(jr()), {
                            viewBox: Hr
                        }),
                        Jr = new br("".concat(Wr, " ").concat(qr()), {
                            viewBox: Hr
                        }),
                        Qr = new br("".concat(Wr, " ").concat(jr()), {
                            viewBox: Hr
                        }),
                        $r = new br("".concat(Wr, " ").concat(qr()), {
                            viewBox: Hr
                        }),
                        ea = new br("".concat(Wr, " ").concat(jr()), {
                            viewBox: Hr
                        }),
                        ta = new br("".concat(Gr, " ").concat(qr()), {
                            viewBox: Hr
                        }),
                        na = new br("".concat(Gr, " ").concat(jr()), {
                            viewBox: Hr
                        }),
                        oa = new br("".concat(Gr, " ").concat(qr()), {
                            viewBox: Hr
                        }),
                        ra = new br("".concat(Gr, " ").concat(jr()), {
                            viewBox: Hr
                        });

                    function aa(e) {
                        var t = y.cornerstone.metaData.get("imagePlaneModule", e.imageId);
                        return t ? {
                            rowPixelSpacing: t.rowPixelSpacing || t.rowImagePixelSpacing,
                            colPixelSpacing: t.columnPixelSpacing || t.colImagePixelSpacing
                        } : {
                            rowPixelSpacing: e.rowPixelSpacing,
                            colPixelSpacing: e.columnPixelSpacing
                        }
                    }
                    var ia = function(e) {
                            var t = w()(e);
                            return null !== e && ("object" === t || "function" === t)
                        },
                        sa = function(e, t, n) {
                            var o, r, a, i, s, l, c = 0,
                                u = !1,
                                d = !1,
                                h = !0,
                                f = !t && 0 !== t && "function" == typeof window.requestAnimationFrame;
                            if ("function" != typeof e) throw new TypeError("Expected a function");

                            function m(t) {
                                var n = o,
                                    a = r;
                                return o = r = void 0, c = t, i = e.apply(a, n)
                            }

                            function g(e, t) {
                                return f ? window.requestAnimationFrame(e) : setTimeout(e, t)
                            }

                            function p(e) {
                                return c = e, s = g(y, t), u ? m(e) : i
                            }

                            function v(e) {
                                var n = e - l;
                                return void 0 === l || n >= t || n < 0 || d && e - c >= a
                            }

                            function y() {
                                var e = Date.now();
                                if (v(e)) return b(e);
                                s = g(y, function(e) {
                                    var n = e - c,
                                        o = t - (e - l);
                                    return d ? Math.min(o, a - n) : o
                                }(e))
                            }

                            function b(e) {
                                return s = void 0, h && o ? m(e) : (o = r = void 0, i)
                            }

                            function w() {
                                for (var e = Date.now(), n = v(e), a = arguments.length, c = new Array(a), u = 0; u < a; u++) c[u] = arguments[u];
                                if (o = c, r = this, l = e, n) {
                                    if (void 0 === s) return p(l);
                                    if (d) return s = g(y, t), m(l)
                                }
                                return void 0 === s && (s = g(y, t)), i
                            }
                            return t = Number(t) || 0, ia(n) && (u = Boolean(n.leading), a = (d = "maxWait" in n) ? Math.max(Number(n.maxWait) || 0, t) : a, h = "trailing" in n ? Boolean(n.trailing) : h), w.cancel = function() {
                                void 0 !== s && function(e) {
                                    if (f) return window.cancelAnimationFrame(e);
                                    clearTimeout(e)
                                }(s), c = 0, o = l = r = s = void 0
                            }, w.flush = function() {
                                return void 0 === s ? i : b(Date.now())
                            }, w.pending = function() {
                                return void 0 !== s
                            }, w
                        },
                        la = function(e, t, n) {
                            var o = !0,
                                r = !0;
                            if ("function" != typeof e) throw new TypeError("Expected a function");
                            return ia(n) && (o = "leading" in n ? Boolean(n.leading) : o, r = "trailing" in n ? Boolean(n.trailing) : r), sa(e, t, {
                                leading: o,
                                trailing: r,
                                maxWait: t
                            })
                        },
                        ca = function(e) {
                            function t() {
                                var e, n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var o = {
                                    name: "Angle",
                                    supportedInteractionTypes: ["Mouse", "Touch"],
                                    svgCursor: wr,
                                    configuration: {
                                        drawHandles: !0,
                                        drawHandlesOnHover: !1,
                                        hideHandlesIfMoving: !1,
                                        renderDashed: !1
                                    }
                                };
                                return (e = u()(this, h()(t).call(this, n, o))).preventNewMeasurement = !1, e.throttledUpdateCachedStats = la(e.updateCachedStats, 110), e
                            }
                            return m()(t, e), l()(t, [{
                                key: "createNewMeasurement",
                                value: function(e) {
                                    return {
                                        visible: !0,
                                        active: !0,
                                        color: void 0,
                                        invalidated: !0,
                                        handles: {
                                            start: {
                                                x: e.currentPoints.image.x,
                                                y: e.currentPoints.image.y,
                                                highlight: !0,
                                                active: !1
                                            },
                                            middle: {
                                                x: e.currentPoints.image.x,
                                                y: e.currentPoints.image.y,
                                                highlight: !0,
                                                active: !0
                                            },
                                            end: {
                                                x: e.currentPoints.image.x,
                                                y: e.currentPoints.image.y,
                                                highlight: !0,
                                                active: !1
                                            },
                                            textBox: {
                                                active: !1,
                                                hasMoved: !1,
                                                movesIndependently: !1,
                                                drawnIndependently: !0,
                                                allowedOutsideImage: !0,
                                                hasBoundingBox: !0
                                            }
                                        }
                                    }
                                }
                            }, {
                                key: "pointNearTool",
                                value: function(e, t, n) {
                                    return !1 !== t.visible && (pr(e, t.handles.start, t.handles.middle, n) < 25 || pr(e, t.handles.middle, t.handles.end, n) < 25)
                                }
                            }, {
                                key: "updateCachedStats",
                                value: function(e, t, n) {
                                    var o = da(e, n.handles.middle, n.handles.start),
                                        r = da(e, n.handles.end, n.handles.middle),
                                        a = da(e, n.handles.end, n.handles.start),
                                        i = ua(o),
                                        s = ua(r),
                                        l = ua(a),
                                        c = Math.acos((Math.pow(i, 2) + Math.pow(s, 2) - Math.pow(l, 2)) / (2 * i * s));
                                    c *= 180 / Math.PI, n.rAngle = vr(c, 2), n.invalidated = !1
                                }
                            }, {
                                key: "renderToolData",
                                value: function(e) {
                                    var t = this,
                                        n = e.detail,
                                        o = n.enabledElement,
                                        r = this.configuration,
                                        a = r.handleRadius,
                                        i = r.drawHandlesOnHover,
                                        s = r.hideHandlesIfMoving,
                                        l = r.renderDashed,
                                        c = _(e.currentTarget, this.name),
                                        u = wt("globalConfiguration").configuration.lineDash;
                                    if (c)
                                        for (var d = Dn(n.canvasContext.canvas), h = n.image, f = n.element, m = aa(h), g = m.rowPixelSpacing, p = m.colPixelSpacing, v = Zt.getToolWidth(), b = function(e) {
                                                var r = c.data[e];
                                                if (!1 === r.visible) return "continue";
                                                Wt(d, (function(e) {
                                                    kn(e, t.configuration);
                                                    var c = un.getColorIfActive(r),
                                                        d = y.cornerstone.pixelToCanvas(n.element, r.handles.start),
                                                        m = y.cornerstone.pixelToCanvas(n.element, r.handles.middle),
                                                        b = {
                                                            color: c
                                                        };
                                                    l && (b.lineDash = u), Jt(e, n.element, r.handles.start, [r.handles.middle, r.handles.end], b);
                                                    var w = {
                                                        color: c,
                                                        handleRadius: a,
                                                        drawHandlesIfActive: i,
                                                        hideHandlesIfMoving: s
                                                    };
                                                    if (t.configuration.drawHandles && dn(e, n, r.handles, w), !0 === r.invalidated && (r.rAngle ? t.throttledUpdateCachedStats(h, f, r) : t.updateCachedStats(h, f, r)), r.rAngle) {
                                                        var T, I = function(e, t, n) {
                                                            var o = t && n ? "" : " (isotropic)";
                                                            return e.rAngle.toString() + String.fromCharCode(parseInt("00B0", 16)) + o
                                                        }(r, g, p);
                                                        if (!r.handles.textBox.hasMoved) {
                                                            T = {
                                                                x: m.x,
                                                                y: m.y
                                                            };
                                                            var E = wn(e, I, 5);
                                                            m.x < d.x ? T.x -= 15 + E + 10 : T.x += 15;
                                                            var S = y.cornerstone.internal.getTransform(o);
                                                            S.invert();
                                                            var A = S.transformPoint(T.x, T.y);
                                                            r.handles.textBox.x = A.x, r.handles.textBox.y = A.y
                                                        }
                                                        Cn(e, n.element, r.handles.textBox, I, r.handles, x, c, v, 0, !0)
                                                    }
                                                }))
                                            }, w = 0; w < c.data.length; w++) b(w);

                                    function x(e) {
                                        return [e.start, e.middle, e.end]
                                    }
                                }
                            }, {
                                key: "addNewMeasurement",
                                value: function(e, t) {
                                    var n = this;
                                    if (!this.preventNewMeasurement) {
                                        this.preventNewMeasurement = !0, e.preventDefault(), e.stopPropagation();
                                        var o = e.detail,
                                            r = this.createNewMeasurement(o),
                                            a = e.detail.element;
                                        k(a, this.name, r), y.cornerstone.updateImage(a), nr(o, this.name, r, r.handles.middle, this.options, t, (function(e) {
                                            if (r.active = !1, !e) return L(a, n.name, r), void(n.preventNewMeasurement = !1);
                                            r.handles.end.active = !0, y.cornerstone.updateImage(a), nr(o, n.name, r, r.handles.end, n.options, t, (function(e) {
                                                e ? (r.active = !1, y.cornerstone.updateImage(a)) : L(a, n.name, r), n.preventNewMeasurement = !1, y.cornerstone.updateImage(a);
                                                var t = {
                                                    toolName: n.name,
                                                    toolType: n.name,
                                                    element: a,
                                                    measurementData: r
                                                };
                                                T(a, x.MEASUREMENT_COMPLETED, t)
                                            }))
                                        }))
                                    }
                                }
                            }]), t
                        }(gr);

                    function ua(e) {
                        return Math.sqrt(Math.pow(e.x, 2) + Math.pow(e.y, 2))
                    }

                    function da(e, t, n) {
                        var o = aa(e),
                            r = o.rowPixelSpacing,
                            a = o.colPixelSpacing;
                        return {
                            x: (t.x - n.x) * (a || 1),
                            y: (t.y - n.y) * (r || 1)
                        }
                    }
                    var ha = function(e) {
                        function t() {
                            var e, n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                            i()(this, t);
                            var o = {
                                name: "ArrowAnnotate",
                                supportedInteractionTypes: ["Mouse", "Touch"],
                                configuration: {
                                    getTextCallback: fa,
                                    changeTextCallback: ma,
                                    drawHandles: !0,
                                    drawHandlesOnHover: !1,
                                    hideHandlesIfMoving: !1,
                                    arrowFirst: !0,
                                    renderDashed: !1,
                                    allowEmptyLabel: !1
                                },
                                svgCursor: xr
                            };
                            return (e = u()(this, h()(t).call(this, n, o))).preventNewMeasurement = !1, e
                        }
                        return m()(t, e), l()(t, [{
                            key: "createNewMeasurement",
                            value: function(e) {
                                return {
                                    visible: !0,
                                    active: !0,
                                    color: void 0,
                                    handles: {
                                        start: {
                                            x: e.detail.currentPoints.image.x,
                                            y: e.detail.currentPoints.image.y,
                                            highlight: !0,
                                            active: !1
                                        },
                                        end: {
                                            x: e.detail.currentPoints.image.x,
                                            y: e.detail.currentPoints.image.y,
                                            highlight: !0,
                                            active: !1
                                        },
                                        textBox: {
                                            active: !1,
                                            hasMoved: !1,
                                            movesIndependently: !1,
                                            drawnIndependently: !0,
                                            allowedOutsideImage: !0,
                                            hasBoundingBox: !0
                                        }
                                    }
                                }
                            }
                        }, {
                            key: "pointNearTool",
                            value: function(e, t, n) {
                                return !1 !== t.visible && pr(e, t.handles.start, t.handles.end, n) < 25
                            }
                        }, {
                            key: "updateCachedStats",
                            value: function() {}
                        }, {
                            key: "renderToolData",
                            value: function(e) {
                                var t = this,
                                    n = e.detail,
                                    o = n.element,
                                    r = n.enabledElement,
                                    a = this.configuration,
                                    i = a.handleRadius,
                                    s = a.drawHandlesOnHover,
                                    l = a.hideHandlesIfMoving,
                                    c = a.renderDashed,
                                    u = _(o, this.name);
                                if (u) {
                                    var d, h = e.detail.canvasContext.canvas,
                                        f = Dn(h),
                                        m = Zt.getToolWidth();
                                    c && (d = wt("globalConfiguration").configuration.lineDash);
                                    for (var g = function(n) {
                                            var a = u.data[n];
                                            if (!1 === a.visible) return "continue";
                                            Wt(f, (function(n) {
                                                kn(n, t.configuration);
                                                var c = un.getColorIfActive(a),
                                                    u = y.cornerstone.pixelToCanvas(o, a.handles.start),
                                                    h = y.cornerstone.pixelToCanvas(o, a.handles.end);
                                                t.configuration.arrowFirst ? Qt(n, h, u, c, m, d) : Qt(n, u, h, c, m, d);
                                                var f = {
                                                    color: c,
                                                    handleRadius: i,
                                                    drawHandlesIfActive: s,
                                                    hideHandlesIfMoving: l
                                                };
                                                t.configuration.drawHandles && dn(n, e.detail, a.handles, f);
                                                var g = function(e) {
                                                    return e.text
                                                }(a);
                                                if (g && "" !== g) {
                                                    var p = wn(n, g, 5),
                                                        b = vn.getFontSize() + 10,
                                                        w = Math.max(p, b) / 2 + 5;
                                                    if (h.x < u.x && (w = -w), !a.handles.textBox.hasMoved) {
                                                        var x;
                                                        x = t.configuration.arrowFirst ? {
                                                            x: h.x - p / 2 + w,
                                                            y: h.y - b / 2
                                                        } : {
                                                            x: u.x - p / 2 - w,
                                                            y: u.y - b / 2
                                                        };
                                                        var T = y.cornerstone.internal.getTransform(r);
                                                        T.invert();
                                                        var I = T.transformPoint(x.x, x.y);
                                                        a.handles.textBox.x = I.x, a.handles.textBox.y = I.y
                                                    }
                                                    Cn(n, o, a.handles.textBox, g, a.handles, v, c, m, 0, !1)
                                                }
                                            }))
                                        }, p = 0; p < u.data.length; p++) g(p)
                                }

                                function v(e) {
                                    var t = {
                                        x: (e.start.x + e.end.x) / 2,
                                        y: (e.start.y + e.end.y) / 2
                                    };
                                    return [e.start, t, e.end]
                                }
                            }
                        }, {
                            key: "addNewMeasurement",
                            value: function(e, t) {
                                var n = this,
                                    o = e.detail.element,
                                    r = this.createNewMeasurement(e),
                                    a = this.configuration.allowEmptyLabel;
                                k(o, this.name, r), y.cornerstone.updateImage(o), nr(e.detail, this.name, r, r.handles.end, this.options, t, (function(t) {
                                    t ? void 0 === r.text && n.configuration.getTextCallback((function(e) {
                                        if (e || a) {
                                            r.text = e, r.active = !1;
                                            var t = {
                                                toolName: n.name,
                                                toolType: n.name,
                                                element: o,
                                                measurementData: r
                                            };
                                            y.cornerstone.updateImage(o), T(o, x.MEASUREMENT_COMPLETED, t)
                                        } else L(o, n.name, r)
                                    }), e.detail) : L(o, n.name, r), y.cornerstone.updateImage(o)
                                }))
                            }
                        }, {
                            key: "doubleClickCallback",
                            value: function(e) {
                                return this._updateTextForNearbyAnnotation(e)
                            }
                        }, {
                            key: "touchPressCallback",
                            value: function(e) {
                                return this._updateTextForNearbyAnnotation(e)
                            }
                        }, {
                            key: "_updateTextForNearbyAnnotation",
                            value: function(e) {
                                var t = e.detail.element,
                                    n = e.detail.currentPoints.canvas,
                                    o = _(t, this.name);
                                if (!o) return !1;
                                for (var r = 0; r < o.data.length; r++) {
                                    var a = o.data[r];
                                    if (this.pointNearTool(t, a, n) || po(a.handles.textBox, n)) return a.active = !0, y.cornerstone.updateImage(t), this.configuration.changeTextCallback(a, e.detail, this._doneChangingTextCallback.bind(this, t, a)), e.stopImmediatePropagation(), e.preventDefault(), e.stopPropagation(), !0
                                }
                            }
                        }, {
                            key: "_doneChangingTextCallback",
                            value: function(e, t, n, o) {
                                !0 === o ? L(e, this.name, t) : t.text = n, t.active = !1, y.cornerstone.updateImage(e), T(e, x.MEASUREMENT_MODIFIED, {
                                    toolName: this.name,
                                    toolType: this.name,
                                    element: e,
                                    measurementData: t
                                })
                            }
                        }]), t
                    }(gr);

                    function fa(e) {
                        e(prompt("Enter your annotation:"))
                    }

                    function ma(e, t, n) {
                        n(prompt("Change your annotation:"))
                    }
                    var ga = function(e, t, n) {
                            var o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : {};
                            return Object.assign({
                                x: e,
                                y: t,
                                index: n,
                                drawnIndependently: !1,
                                allowedOutsideImage: !1,
                                highlight: !0,
                                active: !1
                            }, o)
                        },
                        pa = function(e) {
                            var t = e.currentPoints.image,
                                n = t.x,
                                o = t.y;
                            return {
                                toolName: this.name,
                                toolType: this.name,
                                isCreating: !0,
                                visible: !0,
                                active: !0,
                                invalidated: !0,
                                handles: {
                                    start: ga(n, o, 0),
                                    end: ga(n, o, 1, {
                                        active: !0
                                    }),
                                    perpendicularStart: ga(n, o, 2, {
                                        locked: !0
                                    }),
                                    perpendicularEnd: ga(n, o, 3),
                                    textBox: ga(n - 50, o - 70, null, {
                                        highlight: !1,
                                        hasMoved: !0,
                                        active: !1,
                                        movesIndependently: !1,
                                        drawnIndependently: !0,
                                        allowedOutsideImage: !0,
                                        hasBoundingBox: !0
                                    })
                                },
                                longestDiameter: 0,
                                shortestDiameter: 0
                            }
                        },
                        va = function(e, t, n, o) {
                            var r = y.cornerstone,
                                a = y.cornerstoneMath,
                                i = {
                                    start: r.pixelToCanvas(e, t.perpendicularStart),
                                    end: r.pixelToCanvas(e, t.perpendicularEnd)
                                };
                            return a.lineSegment.distanceToPoint(i, n) < o
                        },
                        ya = function(e, t, n) {
                            var o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : "mouse",
                                r = y.cornerstone,
                                a = y.cornerstoneMath,
                                i = t.handles,
                                s = {
                                    start: r.pixelToCanvas(e, i.start),
                                    end: r.pixelToCanvas(e, i.end)
                                },
                                l = a.lineSegment.distanceToPoint(s, n);
                            if (po(i.textBox, n)) return !0;
                            var c = lr(o, "Bidirectional");
                            return !!va(e, i, n, c) || l < c
                        };

                    function ba(e, t, n, o) {
                        var r = (n.x - o.x) * e,
                            a = (n.y - o.y) * t,
                            i = Math.sqrt(r * r + a * a);
                        return {
                            x: r / i,
                            y: a / i,
                            length: i
                        }
                    }

                    function wa(e, t) {
                        if (!t.handles.perpendicularStart.locked) return !1;
                        var n, o, r, a, i = t.handles,
                            s = i.start,
                            l = i.end,
                            c = e.image,
                            u = c.columnPixelSpacing,
                            d = void 0 === u ? 1 : u,
                            h = c.rowPixelSpacing,
                            f = void 0 === h ? 1 : h;
                        if (s.x === l.x && s.y === l.y) n = s.x, o = s.y, r = l.x, a = l.y;
                        else {
                            var m = {
                                    x: (s.x + l.x) / 2,
                                    y: (s.y + l.y) / 2
                                },
                                g = ba(d, f, s, l),
                                p = g.length / 2,
                                v = p / (2 * f),
                                y = p / (2 * d);
                            n = m.x + y * g.y, o = m.y - v * g.x, r = m.x - y * g.y, a = m.y + v * g.x
                        }
                        return t.handles.perpendicularStart.x = n, t.handles.perpendicularStart.y = o, t.handles.perpendicularEnd.x = r, t.handles.perpendicularEnd.y = a, !0
                    }
                    var xa, Ta = function(e) {
                            var t = this,
                                n = e.detail,
                                o = n.element,
                                r = n.canvasContext,
                                a = n.image,
                                i = this.configuration,
                                s = i.handleRadius,
                                l = i.drawHandlesOnHover,
                                c = i.hideHandlesIfMoving,
                                u = i.renderDashed,
                                d = wt("globalConfiguration").configuration.lineDash,
                                h = _(o, this.name);
                            if (h) {
                                var f = aa(a),
                                    m = f.rowPixelSpacing,
                                    g = f.colPixelSpacing;
                                if (m && g)
                                    for (var p, v = Dn(r.canvas), y = Zt.getToolWidth(), b = function(e) {
                                            var r = h.data[e];
                                            if (!1 === r.visible) return "continue";
                                            p = un.getColorIfActive(r), !0 === r.invalidated && (r.longestDiameter && r.shortestDiameter ? t.throttledUpdateCachedStats(a, o, r) : t.updateCachedStats(a, o, r)), Wt(v, (function(e) {
                                                kn(e, t.configuration);
                                                var a = r.handles,
                                                    i = a.start,
                                                    h = a.end,
                                                    f = a.perpendicularStart,
                                                    v = a.perpendicularEnd,
                                                    b = a.textBox,
                                                    w = {
                                                        color: p
                                                    },
                                                    x = {
                                                        color: p,
                                                        strokeWidth: T
                                                    };
                                                u && (w.lineDash = d, x.lineDash = d), Xt(e, o, i, h, w);
                                                var T = y;
                                                wa(n, r), Xt(e, o, f, v, x);
                                                var I = {
                                                    color: p,
                                                    handleRadius: s,
                                                    drawHandlesIfActive: l,
                                                    hideHandlesIfMoving: c
                                                };
                                                t.configuration.drawHandles && dn(e, n, r.handles, I);
                                                var E = Ia(r, m, g);
                                                Cn(e, o, b, E, r.handles, (function(e) {
                                                    return [e.start, e.end, e.perpendicularStart, e.perpendicularEnd]
                                                }), p, y, 10, !0)
                                            }))
                                        }, w = 0; w < h.data.length; w++) b(w)
                            }
                        },
                        Ia = function(e, t, n) {
                            var o = " mm";
                            t && n || (o = " pixels");
                            var r = " L ".concat(e.longestDiameter).concat(o),
                                a = " W ".concat(e.shortestDiameter).concat(o),
                                i = e.labels;
                            return i && Array.isArray(i) ? [].concat(Q()(i), [r, a]) : [r, a]
                        },
                        Ea = function(e, t) {
                            var n = this,
                                o = e.detail,
                                r = o.element,
                                a = o.image,
                                i = o.buttons,
                                s = this.configuration;
                            if (!Sa(a)) {
                                var l = this.createNewMeasurement(o),
                                    c = function() {
                                        l.active = !1, y.cornerstone.updateImage(r)
                                    };
                                k(r, this.name, l), y.cornerstone.updateImage(r);
                                var u = (new Date).getTime(),
                                    d = l.handles,
                                    h = d.end,
                                    f = d.perpendicularStart;
                                nr(o, this.name, l, h, {}, t, (function(e) {
                                    if (e) {
                                        var d = l.handles,
                                            h = l.longestDiameter,
                                            m = l.shortestDiameter,
                                            g = To(o, d),
                                            p = parseFloat(h) || 0,
                                            v = parseFloat(m) || 0,
                                            b = p < 1 || v < 1,
                                            w = (new Date).getTime() - u < 150;
                                        g || b || w ? (l.cancelled = !0, L(r, n.name, l)) : s.getMeasurementLocationCallback(l, o, c), wa(o, l), f.locked = !1, l.invalidated = !0, y.cornerstone.updateImage(r);
                                        var I = ko(r, i, t);
                                        I instanceof Xa && I.updateCachedStats(a, r, l);
                                        var E = {
                                            toolName: n.name,
                                            toolType: n.name,
                                            element: r,
                                            measurementData: l
                                        };
                                        T(r, x.MEASUREMENT_MODIFIED, E), T(r, x.MEASUREMENT_COMPLETED, E)
                                    } else L(r, n.name, l)
                                }))
                            }
                        },
                        Sa = function(e) {
                            var t = y.cornerstone.metaData.get("imagePlaneModule", e.imageId),
                                n = e.rowPixelSpacing,
                                o = e.columnPixelSpacing;
                            return t && (n = t.rowPixelSpacing || t.rowImagePixelSpacing, o = t.columnPixelSpacing || t.colImagePixelSpacing), !n || !o
                        },
                        Aa = {
                            setCoords: function(e) {
                                xa = e.currentPoints.canvas
                            },
                            getCoords: function() {
                                return xa
                            }
                        },
                        Ca = function(e) {
                            var t = this,
                                n = e.detail,
                                o = n.element;
                            Aa.setCoords(n);
                            var r = _(o, this.name);
                            if (r) {
                                for (var a = !1, i = function(e) {
                                        var i = n.currentPoints.canvas,
                                            s = r.data[e],
                                            l = function(e, t, n) {
                                                var o = yo(e, t, n, arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 6),
                                                    r = !1;
                                                return Object.keys(t).forEach((function(e) {
                                                    if ("textBox" !== e) {
                                                        var n = t[e],
                                                            a = n === o;
                                                        n.active !== a && (r = !0), n.active = a
                                                    }
                                                })), r
                                            }(o, s.handles, i);
                                        Object.keys(s.handles).forEach((function(e) {
                                            if ("textBox" !== e) {
                                                var t = s.handles[e];
                                                t.hover = t.active
                                            }
                                        })), l && (a = !0);
                                        var c = t.pointNearTool(o, s, i, "mouse"),
                                            u = c && !s.active,
                                            d = !c && s.active;
                                        (u || d) && (s.active = !s.active, a = !0)
                                    }, s = 0; s < r.data.length; s++) i(s);
                                !0 === a && y.cornerstone.updateImage(o)
                            }
                        },
                        Ma = function(e, t, n) {
                            "touch" === (arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : "mouse") ? this.handleSelectedTouchCallback(e): this.handleSelectedMouseCallback(e)
                        };

                    function Da(e, t, n, o) {
                        var r = (n.x - o.x) / t,
                            a = (n.y - o.y) / e;
                        return Math.sqrt(r * r + a * a)
                    }

                    function Pa(e, t) {
                        return {
                            start: e,
                            end: t
                        }
                    }

                    function ka(e, t, n) {
                        var o = y.cornerstoneMath.lineSegment,
                            r = e.handles,
                            a = r.start,
                            i = r.end,
                            s = r.perpendicularStart,
                            l = r.perpendicularEnd,
                            c = t.image,
                            u = c.columnPixelSpacing,
                            d = void 0 === u ? 1 : u,
                            h = c.rowPixelSpacing,
                            f = void 0 === h ? 1 : h,
                            m = Pa(a, i),
                            g = Pa(s, l),
                            p = o.intersectLine(m, g);
                        return {
                            columnPixelSpacing: d,
                            rowPixelSpacing: f,
                            start: a,
                            end: i,
                            perpendicularStart: s,
                            perpendicularEnd: l,
                            longLine: m,
                            intersection: p,
                            distanceToFixed: Da(d, f, n, p),
                            fixedPoint: n
                        }
                    }

                    function _a(e, t, n, o) {
                        var r = ka(t, n, o),
                            a = r.columnPixelSpacing,
                            i = r.rowPixelSpacing,
                            s = r.distanceToFixed,
                            l = Da(a, i, o, e);
                        if (l <= s) return !1;
                        var c = s / l,
                            u = function(e, t) {
                                var n = e.columnPixelSpacing,
                                    o = e.rowPixelSpacing,
                                    r = e.start,
                                    a = e.perpendicularStart,
                                    i = e.perpendicularEnd,
                                    s = e.intersection,
                                    l = e.fixedPoint,
                                    c = Da(n, o, a, s),
                                    u = Da(n, o, i, s),
                                    d = ba(n, o, l, t),
                                    h = l === r ? 1 : -1,
                                    f = h * o,
                                    m = h * n;
                                return {
                                    start: {
                                        x: t.x + d.y * c * f,
                                        y: t.y + d.x * c * m * -1
                                    },
                                    end: {
                                        x: t.x + d.y * u * f * -1,
                                        y: t.y + d.x * u * m
                                    }
                                }
                            }(r, {
                                x: o.x + (e.x - o.x) * c,
                                y: o.y + (e.y - o.y) * c
                            });
                        return t.handles.perpendicularStart.x = u.start.x, t.handles.perpendicularStart.y = u.start.y, t.handles.perpendicularEnd.x = u.end.x, t.handles.perpendicularEnd.y = u.end.y, !0
                    }

                    function La(e, t) {
                        return e === t
                    }

                    function Oa(e, t) {
                        return La(e, t) ? -1 : 1
                    }

                    function Ra(e, t, n, o) {
                        var r, a = e.columnPixelSpacing,
                            i = e.rowPixelSpacing,
                            s = e.fixedPoint,
                            l = e.perpendicularStart,
                            c = e.perpendicularEnd,
                            u = e.distanceToFixed,
                            d = Oa(s, c) * u,
                            h = function(e, t, n) {
                                return La(e, n) ? t : n
                            }(s, l, c) === l,
                            f = h ? "start" : "end",
                            m = h ? "end" : "start";
                        return r = {}, xo()(r, f, {
                            x: n.start.x,
                            y: n.start.y
                        }), xo()(r, m, {
                            x: t.x + o.y * i * d,
                            y: t.y + o.x * a * d * -1
                        }), r
                    }

                    function Na(e, t, n, o) {
                        var r = y.cornerstoneMath.lineSegment,
                            a = ka(t, n, o),
                            i = a.columnPixelSpacing,
                            s = a.rowPixelSpacing,
                            l = a.start,
                            c = a.longLine,
                            u = a.intersection;
                        if (! function(e, t, n) {
                                return 0 !== Da(e, t, n.start, n.end)
                            }(i, s, c)) return !1;
                        var d = ba(i, s, l, u),
                            h = function(e, t, n) {
                                var o = e.columnPixelSpacing,
                                    r = e.rowPixelSpacing,
                                    a = e.perpendicularEnd,
                                    i = e.fixedPoint,
                                    s = Number.MAX_SAFE_INTEGER,
                                    l = Oa(i, a) * s;
                                return {
                                    start: t,
                                    end: {
                                        x: t.x + n.y * r * l,
                                        y: t.y + n.x * o * l * -1
                                    }
                                }
                            }(a, e, d),
                            f = r.intersectLine(c, h);
                        if (!f) return !1;
                        var m = Ra(a, f, h, d);
                        return t.handles.perpendicularStart.x = m.start.x, t.handles.perpendicularStart.y = m.start.y, t.handles.perpendicularEnd.x = m.end.x, t.handles.perpendicularEnd.y = m.end.y, !0
                    }
                    var Ua = function(e, t, n, o) {
                            var r, a, i, s, l = {},
                                c = {},
                                u = {
                                    x: t.currentPoints.image.x + o.x,
                                    y: t.currentPoints.image.y + o.y
                                };
                            0 === e.index ? _a(u, n, t, n.handles.end) ? (e.x = u.x, e.y = u.y) : (t.currentPoints.image.x = e.x, t.currentPoints.image.y = e.y) : 1 === e.index ? _a(u, n, t, n.handles.start) ? (e.x = u.x, e.y = u.y) : (t.currentPoints.image.x = e.x, t.currentPoints.image.y = e.y) : 2 === e.index ? (r = !1, l.start = {
                                x: n.handles.start.x,
                                y: n.handles.start.y
                            }, l.end = {
                                x: n.handles.end.x,
                                y: n.handles.end.y
                            }, c.start = {
                                x: n.handles.perpendicularEnd.x,
                                y: n.handles.perpendicularEnd.y
                            }, c.end = {
                                x: u.x,
                                y: u.y
                            }, (a = y.cornerstoneMath.lineSegment.intersectLine(l, c)) || (c.end = {
                                x: n.handles.perpendicularStart.x,
                                y: n.handles.perpendicularStart.y
                            }, a = y.cornerstoneMath.lineSegment.intersectLine(l, c), i = y.cornerstoneMath.point.distance(a, n.handles.start), s = y.cornerstoneMath.point.distance(a, n.handles.end), (!a || i < 3 || s < 3) && (r = !0)), r || Na(u, n, t, n.handles.perpendicularEnd) || (t.currentPoints.image.x = n.handles.perpendicularStart.x, t.currentPoints.image.y = n.handles.perpendicularStart.y)) : 3 === e.index && (r = !1, l.start = {
                                x: n.handles.start.x,
                                y: n.handles.start.y
                            }, l.end = {
                                x: n.handles.end.x,
                                y: n.handles.end.y
                            }, c.start = {
                                x: n.handles.perpendicularStart.x,
                                y: n.handles.perpendicularStart.y
                            }, c.end = {
                                x: u.x,
                                y: u.y
                            }, (a = y.cornerstoneMath.lineSegment.intersectLine(l, c)) || (c.end = {
                                x: n.handles.perpendicularEnd.x,
                                y: n.handles.perpendicularEnd.y
                            }, a = y.cornerstoneMath.lineSegment.intersectLine(l, c), i = y.cornerstoneMath.point.distance(a, n.handles.start), s = y.cornerstoneMath.point.distance(a, n.handles.end), (!a || i < 3 || s < 3) && (r = !0)), r || Na(u, n, t, n.handles.perpendicularStart) || (t.currentPoints.image.x = n.handles.perpendicularEnd.x, t.currentPoints.image.y = n.handles.perpendicularEnd.y))
                        },
                        Ba = function(e, t, n) {
                            var o = e[n],
                                r = t[n];
                            e[n] = r, t[n] = o
                        },
                        Va = function(e, t) {
                            Ba(e, t, "x"), Ba(e, t, "y"), Ba(e, t, "moving"), Ba(e, t, "hover"), Ba(e, t, "active"), Ba(e, t, "selected")
                        },
                        Fa = function(e) {
                            var t, n = this,
                                o = e.detail,
                                r = o.element,
                                a = lr("mouse", this.name),
                                i = function(e) {
                                    t.invalidated = !0, To(o, t.handles) && L(r, n.name, t), e && (e.moving = !1, e.selected = !0), Et(n.element, n.svgCursor), y.cornerstone.updateImage(r), r.addEventListener(x.MOUSE_MOVE, n._moveCallback), r.addEventListener(x.TOUCH_START, n._moveCallback)
                                },
                                s = o.startPoints.canvas,
                                l = _(e.currentTarget, this.name);
                            if (l) {
                                for (var c = function(c) {
                                        t = l.data[c];
                                        var u = [r, t.handles, s, a],
                                            d = yo.apply(void 0, u);
                                        if (d) return r.removeEventListener(x.MOUSE_MOVE, n._moveCallback), r.removeEventListener(x.TOUCH_START, n._moveCallback), t.active = !0, Ha(t.handles), d.moving = !0, (d = function(e, t, n) {
                                                var o = e.image,
                                                    r = o.rowPixelSpacing,
                                                    a = o.columnPixelSpacing,
                                                    i = t.handles,
                                                    s = i.start,
                                                    l = i.end,
                                                    c = i.perpendicularStart,
                                                    u = i.perpendicularEnd,
                                                    d = (s.x - l.x) * (a || 1),
                                                    h = (s.y - l.y) * (r || 1),
                                                    f = Math.sqrt(d * d + h * h),
                                                    m = (c.x - u.x) * (a || 1),
                                                    g = (c.y - u.y) * (r || 1);
                                                return (Math.sqrt(m * m + g * g) || 0) > f ? (Va(s, l), Va(s, c), Va(l, u), Object.values(i).find((function(e) {
                                                    return !0 === e.moving
                                                }))) : n
                                            }(o, t, d)).hasBoundingBox || St(n.element),
                                            function(e, t, n, o, r, a) {
                                                var i = e.element,
                                                    s = e.image,
                                                    l = e.buttons,
                                                    c = {
                                                        x: o.x - e.currentPoints.image.x,
                                                        y: o.y - e.currentPoints.image.y
                                                    },
                                                    u = function(e) {
                                                        var r = e.detail;
                                                        o.hasMoved = !0, void 0 === o.index || null === o.index ? (o.x = r.currentPoints.image.x + c.x, o.y = r.currentPoints.image.y + c.y) : Ua(o, r, n, c), a && (o.x = Math.max(o.x, 0), o.x = Math.min(o.x, r.image.width), o.y = Math.max(o.y, 0), o.y = Math.min(o.y, r.image.height)), n.invalidated = !0, y.cornerstone.updateImage(i);
                                                        var u = ko(i, l, "mouse");
                                                        u instanceof gr && u.updateCachedStats(s, i, n);
                                                        var d = {
                                                            toolName: t,
                                                            toolType: t,
                                                            element: i,
                                                            measurementData: n
                                                        };
                                                        y.cornerstone.triggerEvent(i, x.MEASUREMENT_MODIFIED, d)
                                                    };
                                                o.active = !0, o.moving = !0, vt.isToolLocked = !0, i.addEventListener(x.MOUSE_DRAG, u), i.addEventListener(x.TOUCH_DRAG, u);
                                                var d = y.cornerstone.getImage(i),
                                                    h = function() {
                                                        y.cornerstone.getImage(i).imageId !== d.imageId && f()
                                                    };
                                                i.addEventListener(y.cornerstone.EVENTS.IMAGE_RENDERED, h);
                                                var f = function e() {
                                                    o.active = !1, vt.isToolLocked = !1, i.removeEventListener(y.cornerstone.EVENTS.IMAGE_RENDERED, h), i.removeEventListener(x.MOUSE_DRAG, u), i.removeEventListener(x.MOUSE_UP, e), i.removeEventListener(x.MOUSE_CLICK, e), i.removeEventListener(x.TOUCH_DRAG, u), i.removeEventListener(x.TOUCH_DRAG_END, e), i.removeEventListener(x.TAP, e), y.cornerstone.updateImage(i), "function" == typeof r && r()
                                                };
                                                i.addEventListener(x.MOUSE_UP, f), i.addEventListener(x.MOUSE_CLICK, f), i.addEventListener(x.TOUCH_DRAG_END, f), i.addEventListener(x.TAP, f)
                                            }(o, n.name, t, d, (function() {
                                                return i(d)
                                            })), ja(e), {
                                                v: !0
                                            }
                                    }, u = 0; u < l.data.length; u++) {
                                    var d = c(u);
                                    if ("object" === w()(d)) return d.v
                                }
                                var h = function(e) {
                                    return function() {
                                        qa(e, !1), i()
                                    }
                                };
                                for (u = 0; u < l.data.length; u++)
                                    if (t = l.data[u], this.pointNearTool(r, t, s, "mouse")) {
                                        r.removeEventListener(x.MOUSE_MOVE, this._moveCallback), r.removeEventListener(x.TOUCH_START, this._moveCallback), t.active = !0, Ha(t.handles), qa(t.handles, !0);
                                        var f = h(t.handles);
                                        return No(o, this.name, t, null, {
                                            deleteIfHandleOutsideImage: !0,
                                            preventHandleOutsideImage: !1
                                        }, "mouse", f), ja(e), !0
                                    }
                            }
                        },
                        Ha = function(e) {
                            var t = !1;
                            return Object.keys(e).forEach((function(n) {
                                "textBox" !== n && (e[n].selected = !1, t = e[n].active || t, e[n].active = !1)
                            })), t
                        },
                        qa = function(e, t) {
                            Object.keys(e).forEach((function(n) {
                                "textBox" !== n && (e[n].moving = t)
                            }))
                        },
                        ja = function(e) {
                            e.stopImmediatePropagation(), e.stopPropagation(), e.preventDefault()
                        },
                        za = [x.TOUCH_END, x.TOUCH_DRAG_END, x.TOUCH_PINCH, x.TOUCH_PRESS, x.TAP],
                        Wa = function(e) {
                            var t, n = this,
                                o = e.detail,
                                r = o.element,
                                a = vt.touchProximity,
                                i = function(e) {
                                    t.invalidated = !0, To(o, t.handles) && L(r, n.name, t), e && (e.moving = !1, e.selected = !0), y.cornerstone.updateImage(r), r.addEventListener(x.TOUCH_DRAG, n._moveCallback)
                                },
                                s = o.startPoints.canvas,
                                l = _(e.currentTarget, this.name);
                            if (l) {
                                for (var c = function(c) {
                                        t = l.data[c];
                                        var u = [r, t.handles, s, a],
                                            d = yo.apply(void 0, u);
                                        if (d) return r.removeEventListener(x.TOUCH_DRAG, n._moveCallback), t.active = !0, Ga(t.handles), d.moving = !0,
                                            function(e, t, n, o, r, a) {
                                                var i = e.element,
                                                    s = e.image,
                                                    l = e.buttons,
                                                    c = {
                                                        x: o.x - e.currentPoints.image.x,
                                                        y: o.y - e.currentPoints.image.y
                                                    },
                                                    u = function(e) {
                                                        var r = e.detail;
                                                        o.hasMoved = !0, void 0 === o.index || null === o.index ? (o.x = r.currentPoints.image.x + c.x, o.y = r.currentPoints.image.y + c.y) : Ua(o, r, n, c), a && (o.x = Math.max(o.x, 0), o.x = Math.min(o.x, r.image.width), o.y = Math.max(o.y, 0), o.y = Math.min(o.y, r.image.height)), n.invalidated = !0, y.cornerstone.updateImage(i);
                                                        var u = ko(i, l, "touch");
                                                        u instanceof gr && u.updateCachedStats(s, i, n);
                                                        var d = {
                                                            toolName: t,
                                                            toolType: t,
                                                            element: i,
                                                            measurementData: n
                                                        };
                                                        y.cornerstone.triggerEvent(i, x.MEASUREMENT_MODIFIED, d)
                                                    };
                                                o.active = !0, vt.isToolLocked = !0, i.addEventListener(x.TOUCH_DRAG, u);
                                                var d = function e() {
                                                    o.active = !1, vt.isToolLocked = !1, i.removeEventListener(x.TOUCH_DRAG, u), za.forEach((function(t) {
                                                        i.removeEventListener(t, e)
                                                    })), y.cornerstone.updateImage(i), "function" == typeof r && r()
                                                };
                                                za.forEach((function(e) {
                                                    i.addEventListener(e, d)
                                                }))
                                            }(o, n.name, t, d, (function() {
                                                return i(d)
                                            })), Za(e), {
                                                v: !0
                                            }
                                    }, u = 0; u < l.data.length; u++) {
                                    var d = c(u);
                                    if ("object" === w()(d)) return d.v
                                }
                                var h = function(e) {
                                    return function() {
                                        Ya(e, !1), i()
                                    }
                                };
                                for (u = 0; u < l.data.length; u++)
                                    if (t = l.data[u], this.pointNearTool(r, t, s, "touch")) {
                                        r.removeEventListener(x.TOUCH_DRAG, this._moveCallback), t.active = !0, Ga(t.handles), Ya(t.handles, !0);
                                        var f = h(t.handles);
                                        return No(o, this.name, t, null, {
                                            deleteIfHandleOutsideImage: !0,
                                            preventHandleOutsideImage: !1
                                        }, "touch", f), Za(e), !0
                                    }
                            }
                        },
                        Ga = function(e) {
                            var t = !1;
                            return Object.keys(e).forEach((function(n) {
                                "textBox" !== n && (e[n].selected = !1, t = e[n].active || t, e[n].active = !1)
                            })), t
                        },
                        Ya = function(e, t) {
                            Object.keys(e).forEach((function(n) {
                                "textBox" !== n && (e[n].moving = t)
                            }))
                        },
                        Za = function(e) {
                            e.stopImmediatePropagation(), e.stopPropagation(), e.preventDefault()
                        },
                        Ka = function(e, t, n) {
                            return n()
                        },
                        Xa = function(e) {
                            function t(e) {
                                var n;
                                i()(this, t);
                                var o = {
                                    name: "Bidirectional",
                                    supportedInteractionTypes: ["Mouse", "Touch"],
                                    configuration: {
                                        changeMeasurementLocationCallback: Ka,
                                        getMeasurementLocationCallback: Ka,
                                        textBox: "",
                                        shadow: "",
                                        drawHandles: !0,
                                        drawHandlesOnHover: !0,
                                        hideHandlesIfMoving: !1,
                                        renderDashed: !1,
                                        additionalData: []
                                    },
                                    svgCursor: Tr
                                };
                                return (n = u()(this, h()(t).call(this, e, o))).throttledUpdateCachedStats = la(n.updateCachedStats, 110), n.createNewMeasurement = pa.bind(Ao()(n)), n.pointNearTool = ya.bind(Ao()(n)), n.renderToolData = Ta.bind(Ao()(n)), n.addNewMeasurement = Ea.bind(Ao()(n)), n._moveCallback = Ca.bind(Ao()(n)), n.handleSelectedCallback = Ma.bind(Ao()(n)), n.handleSelectedMouseCallback = Fa.bind(Ao()(n)), n.handleSelectedTouchCallback = Wa.bind(Ao()(n)), n
                            }
                            return m()(t, e), l()(t, [{
                                key: "updateCachedStats",
                                value: function(e, t, n) {
                                    if (n.toolName === this.name) {
                                        var o = function(e, t) {
                                                var n = t.rowPixelSpacing,
                                                    o = t.colPixelSpacing,
                                                    r = e.handles,
                                                    a = r.start,
                                                    i = r.end,
                                                    s = r.perpendicularStart,
                                                    l = r.perpendicularEnd,
                                                    c = (a.x - i.x) * (o || 1),
                                                    u = (a.y - i.y) * (n || 1),
                                                    d = Math.sqrt(c * c + u * u),
                                                    h = (s.x - l.x) * (o || 1),
                                                    f = (s.y - l.y) * (n || 1),
                                                    m = Math.sqrt(h * h + f * f);
                                                if (m || (m = 0), m > d) {
                                                    var g = d;
                                                    d = m, m = g
                                                }
                                                return {
                                                    longestDiameter: d.toFixed(1),
                                                    shortestDiameter: m.toFixed(1)
                                                }
                                            }(n, aa(e)),
                                            r = o.longestDiameter,
                                            a = o.shortestDiameter;
                                        n.longestDiameter = r, n.shortestDiameter = a, n.invalidated = !1
                                    }
                                }
                            }]), t
                        }(gr),
                        Ja = function(e, t) {
                            var n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2],
                                o = y.cornerstone,
                                r = o.metaData.get("patientStudyModule", e.imageId),
                                a = o.metaData.get("generalSeriesModule", e.imageId);
                            if (r && a && "PT" === a.modality) {
                                var i = n ? t : t * e.slope + e.intercept,
                                    s = r.patientWeight;
                                if (s) {
                                    var l = o.metaData.get("petIsotopeModule", e.imageId);
                                    if (l) {
                                        var c = l.radiopharmaceuticalInfo,
                                            u = c.radiopharmaceuticalStartTime,
                                            d = c.radionuclideTotalDose,
                                            h = c.radionuclideHalfLife,
                                            f = a.seriesTime;
                                        if (u && d && h && f) {
                                            var m = Qa(f.fractionalSeconds || 0) + f.seconds + 60 * f.minutes + 60 * f.hours * 60 - (Qa(u.fractionalSeconds || 0) + u.seconds + 60 * u.minutes + 60 * u.hours * 60);
                                            return i * s / (d * Math.exp(-m * Math.log(2) / h)) * 1e3
                                        }
                                    }
                                }
                            }
                        };

                    function Qa(e) {
                        return parseFloat(".".concat(e))
                    }
                    var $a = function(e, t) {
                            var n = e.width / 2,
                                o = e.height / 2;
                            if (n <= 0 || o <= 0) return !1;
                            var r = e.left + n,
                                a = e.top + o,
                                i = t.x - r,
                                s = t.y - a;
                            return i * i / (n * n) + s * s / (o * o) <= 1
                        },
                        ei = function(e, t) {
                            for (var n = 0, o = 0, r = 0, a = 0, i = null, s = null, l = t.top; l < t.top + t.height; l++)
                                for (var c = t.left; c < t.left + t.width; c++) $a(t, {
                                    x: c,
                                    y: l
                                }) && (null === i && (i = e[a], s = e[a]), n += e[a], o += e[a] * e[a], i = Math.min(i, e[a]), s = Math.max(s, e[a]), r++), a++;
                            if (0 === r) return {
                                count: r,
                                mean: 0,
                                variance: 0,
                                stdDev: 0,
                                min: 0,
                                max: 0
                            };
                            var u = n / r,
                                d = o / r - u * u;
                            return {
                                count: r,
                                mean: u,
                                variance: d,
                                stdDev: Math.sqrt(d),
                                min: i,
                                max: s
                            }
                        },
                        ti = {
                            calculateEllipseStatistics: ei,
                            pointInEllipse: $a
                        };

                    function ni(e, t) {
                        var n = function(e) {
                                var t = [e.start, e.end].sort((function(e, t) {
                                        return e.x < t.x ? -1 : 1
                                    })),
                                    n = [e.start, e.end].sort((function(e, t) {
                                        return e.y < t.y ? -1 : 1
                                    })),
                                    o = t[0],
                                    r = t[t.length - 1];
                                return {
                                    top: n[0],
                                    left: o,
                                    bottom: n[n.length - 1],
                                    right: r
                                }
                            }(t),
                            o = (n.left.x + n.right.x) / 2,
                            r = (n.top.y + n.bottom.y) / 2,
                            a = {};
                        return e.rotation >= 0 && e.rotation < 90 && (a.x = e.hflip ? n.left.x : n.right.x, a.y = r), e.rotation >= 90 && e.rotation < 180 && (a.x = o, a.y = e.vflip ? n.bottom.y : n.top.y), e.rotation >= 180 && e.rotation < 270 && (a.x = e.hflip ? n.right.x : n.left.x, a.y = r), e.rotation >= 270 && e.rotation < 360 && (a.x = o, a.y = e.vflip ? n.top.y : n.bottom.y), a
                    }
                    var oi = function(e) {
                            var t = e.toString().split(".");
                            return t[0] = t[0].replace(/\B(?=(\d{3})+(?!\d))/g, ","), t.join(".")
                        },
                        ri = B("tools:annotation:CircleRoiTool"),
                        ai = function(e) {
                            function t() {
                                var e, n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var o = {
                                    name: "CircleRoi",
                                    supportedInteractionTypes: ["Mouse", "Touch"],
                                    svgCursor: Er,
                                    configuration: {
                                        centerPointRadius: 0,
                                        renderDashed: !1,
                                        hideHandlesIfMoving: !1
                                    }
                                };
                                return (e = u()(this, h()(t).call(this, n, o))).throttledUpdateCachedStats = la(e.updateCachedStats, 110), e
                            }
                            return m()(t, e), l()(t, [{
                                key: "createNewMeasurement",
                                value: function(e) {
                                    if (e && e.currentPoints && e.currentPoints.image) return {
                                        visible: !0,
                                        active: !0,
                                        color: void 0,
                                        invalidated: !0,
                                        handles: {
                                            start: {
                                                x: e.currentPoints.image.x,
                                                y: e.currentPoints.image.y,
                                                highlight: !0,
                                                active: !1
                                            },
                                            end: {
                                                x: e.currentPoints.image.x,
                                                y: e.currentPoints.image.y,
                                                highlight: !0,
                                                active: !0
                                            },
                                            initialRotation: e.viewport.rotation,
                                            textBox: {
                                                active: !1,
                                                hasMoved: !1,
                                                movesIndependently: !1,
                                                drawnIndependently: !0,
                                                allowedOutsideImage: !0,
                                                hasBoundingBox: !0
                                            }
                                        }
                                    };
                                    ri.error("required eventData not supplied to tool ".concat(this.name, "'s createNewMeasurement"))
                                }
                            }, {
                                key: "pointNearTool",
                                value: function(e, t, n, o) {
                                    var r = t && t.handles && t.handles.start && t.handles.end,
                                        a = y.cornerstoneMath.point.distance;
                                    if (r || ri.warn("invalid parameters supplied to tool ".concat(this.name, "'s pointNearTool")), !r || !1 === t.visible) return !1;
                                    var i = "mouse" === o ? 15 : 25,
                                        s = y.cornerstone.pixelToCanvas(e, t.handles.start),
                                        l = y.cornerstone.pixelToCanvas(e, t.handles.end),
                                        c = a(s, n),
                                        u = a(s, l);
                                    return c > u - i / 2 && c < u + i / 2
                                }
                            }, {
                                key: "updateCachedStats",
                                value: function(e, t, n) {
                                    var o = (y.cornerstone.metaData.get("generalSeriesModule", e.imageId) || {}).modality,
                                        r = aa(e),
                                        a = function(e, t, n, o, r) {
                                            var a, i = ye(n.start, n.end),
                                                s = y.cornerstone.getPixels(t, i.left, i.top, i.width, i.height),
                                                l = ei(s, i);
                                            "PT" === o && (a = {
                                                mean: Ja(e, l.mean, !0) || 0,
                                                stdDev: Ja(e, l.stdDev, !0) || 0
                                            });
                                            var c = i.width * (r && r.colPixelSpacing || 1) / 2,
                                                u = 2 * Math.PI * c;
                                            return {
                                                area: Math.PI * (i.width * (r && r.colPixelSpacing || 1) / 2) * (i.height * (r && r.rowPixelSpacing || 1) / 2) || 0,
                                                radius: c || 0,
                                                perimeter: u || 0,
                                                count: l.count || 0,
                                                mean: l.mean || 0,
                                                variance: l.variance || 0,
                                                stdDev: l.stdDev || 0,
                                                min: l.min || 0,
                                                max: l.max || 0,
                                                meanStdDevSUV: a
                                            }
                                        }(e, t, n.handles, o, r);
                                    n.cachedStats = a, n.invalidated = !1
                                }
                            }, {
                                key: "renderToolData",
                                value: function(e) {
                                    var t = this,
                                        n = _(e.currentTarget, this.name);
                                    if (n) {
                                        var o = y.cornerstoneMath.point.distance,
                                            r = e.detail,
                                            a = r.image,
                                            i = r.element,
                                            s = r.canvasContext,
                                            l = Zt.getToolWidth(),
                                            c = this.configuration,
                                            u = c.handleRadius,
                                            d = c.drawHandlesOnHover,
                                            h = c.hideHandlesIfMoving,
                                            f = c.renderDashed,
                                            m = c.centerPointRadius,
                                            g = Dn(s.canvas),
                                            p = aa(a),
                                            v = p.rowPixelSpacing,
                                            b = p.colPixelSpacing,
                                            w = wt("globalConfiguration").configuration.lineDash,
                                            x = (y.cornerstone.metaData.get("generalSeriesModule", a.imageId) || {}).modality,
                                            T = v && b;
                                        Wt(g, (function(e) {
                                            for (var s = 0; s < n.data.length; s++) {
                                                var c = n.data[s];
                                                if (!1 !== c.visible) {
                                                    var g = un.getColorIfActive(c),
                                                        p = {
                                                            color: g,
                                                            handleRadius: u,
                                                            drawHandlesIfActive: d,
                                                            hideHandlesIfMoving: h
                                                        };
                                                    kn(e, t.configuration);
                                                    var v = y.cornerstone.pixelToCanvas(i, c.handles.start),
                                                        b = y.cornerstone.pixelToCanvas(i, c.handles.end),
                                                        I = o(v, b),
                                                        E = {
                                                            color: g
                                                        };
                                                    if (f && (E.lineDash = w), $t(e, i, c.handles.start, I, E, "pixel"), m && I > 3 * m && $t(e, i, c.handles.start, m, E, "pixel"), c.handles && (c.handles.start.drawnIndependently = !0, c.handles.end.drawnIndependently = !0), dn(e, r, c.handles, p), !0 === c.invalidated && (c.cachedStats ? t.throttledUpdateCachedStats(a, i, c) : t.updateCachedStats(a, i, c)), !c.handles.textBox.hasMoved) {
                                                        var S = ni(r.viewport, c.handles);
                                                        Object.assign(c.handles.textBox, S)
                                                    }
                                                    var A = si(e, a.color, c.cachedStats, x, T, t.configuration);
                                                    c.unit = ii(x, t.configuration.showHounsfieldUnits), Cn(e, i, c.handles.textBox, A, c.handles, (function(e) {
                                                        return n = (t = ye(e.start, e.end)).left, o = t.top, [{
                                                            x: n + (r = t.width) / 2,
                                                            y: o
                                                        }, {
                                                            x: n,
                                                            y: o + (a = t.height) / 2
                                                        }, {
                                                            x: n + r / 2,
                                                            y: o + a
                                                        }, {
                                                            x: n + r,
                                                            y: o + a / 2
                                                        }];
                                                        var t, n, o, r, a
                                                    }), g, l, 10, !0)
                                                }
                                            }
                                        }))
                                    }
                                }
                            }]), t
                        }(gr);

                    function ii(e, t) {
                        return "CT" === e && !1 !== t ? "HU" : ""
                    }

                    function si(e, t) {
                        var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                            o = n.area,
                            r = void 0 === o ? 0 : o,
                            a = n.radius,
                            i = void 0 === a ? 0 : a,
                            s = n.perimeter,
                            l = void 0 === s ? 0 : s,
                            c = n.mean,
                            u = void 0 === c ? 0 : c,
                            d = n.stdDev,
                            h = void 0 === d ? 0 : d,
                            f = n.min,
                            m = void 0 === f ? 0 : f,
                            g = n.max,
                            p = void 0 === g ? 0 : g,
                            v = n.meanStdDevSUV,
                            y = void 0 === v ? 0 : v,
                            b = arguments.length > 3 ? arguments[3] : void 0,
                            w = arguments.length > 4 ? arguments[4] : void 0,
                            x = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : {},
                            T = x.showMinMax || !1,
                            I = [],
                            E = [];
                        if (!t) {
                            var S = y && 0 !== y.mean,
                                A = ii(b, x.showHounsfieldUnits),
                                C = "Mean: ".concat(oi(u.toFixed(2)), " ").concat(A),
                                M = "Std Dev: ".concat(oi(h.toFixed(2)), " ").concat(A);
                            if (S) {
                                for (var D = " SUV: ", P = "".concat(D).concat(oi(y.mean.toFixed(2))), k = "".concat(D).concat(oi(y.stdDev.toFixed(2))), _ = Math.floor(e.measureText("".concat(M, "     ")).width); e.measureText(C).width < _;) C += " ";
                                E.push("".concat(C).concat(P)), E.push("".concat(M, "     ").concat(k))
                            } else E.push("".concat(C, "     ").concat(M));
                            if (T) {
                                for (var L = "Min: ".concat(m, " ").concat(A), O = "Max: ".concat(p, " ").concat(A), R = S ? Math.floor(e.measureText("".concat(M, "     ")).width) : Math.floor(e.measureText("".concat(C, "     ")).width); e.measureText(L).width < R;) L += " ";
                                E.push("".concat(L).concat(O))
                            }
                        }
                        return I.push(li(r, w)), i && I.push(ci(i, "Radius", w)), l && I.push(ci(l, "Perimeter", w)), E.forEach((function(e) {
                            return I.push(e)
                        })), I
                    }

                    function li(e, t) {
                        var n = t ? " mm".concat(String.fromCharCode(178)) : " px".concat(String.fromCharCode(178));
                        return "Area: ".concat(oi(e.toFixed(2))).concat(n)
                    }

                    function ci(e, t, n) {
                        if (!e) return "";
                        var o = n ? " mm" : " px";
                        return "".concat(t, ": ").concat(oi(e.toFixed(1))).concat(o)
                    }
                    var ui = function(e) {
                            function t() {
                                var e, n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var o = {
                                    name: "CobbAngle",
                                    supportedInteractionTypes: ["Mouse", "Touch"],
                                    svgCursor: Ir,
                                    configuration: {
                                        drawHandles: !0,
                                        drawHandlesOnHover: !1,
                                        hideHandlesIfMoving: !1,
                                        renderDashed: !1
                                    }
                                };
                                return (e = u()(this, h()(t).call(this, n, o))).hasIncomplete = !1, e.throttledUpdateCachedStats = la(e.updateCachedStats, 110), e
                            }
                            return m()(t, e), l()(t, [{
                                key: "createNewMeasurement",
                                value: function(e) {
                                    return this.hasIncomplete = !0, {
                                        visible: !0,
                                        active: !0,
                                        color: void 0,
                                        invalidated: !0,
                                        complete: !1,
                                        value: "",
                                        handles: {
                                            start: {
                                                x: e.currentPoints.image.x,
                                                y: e.currentPoints.image.y,
                                                highlight: !0,
                                                active: !1
                                            },
                                            end: {
                                                x: e.currentPoints.image.x,
                                                y: e.currentPoints.image.y,
                                                highlight: !0,
                                                active: !0
                                            },
                                            start2: {
                                                x: e.currentPoints.image.x,
                                                y: e.currentPoints.image.y,
                                                highlight: !0,
                                                active: !1,
                                                drawnIndependently: !0
                                            },
                                            end2: {
                                                x: e.currentPoints.image.x + 1,
                                                y: e.currentPoints.image.y,
                                                highlight: !0,
                                                active: !1,
                                                drawnIndependently: !0
                                            },
                                            textBox: {
                                                active: !1,
                                                hasMoved: !1,
                                                movesIndependently: !1,
                                                drawnIndependently: !0,
                                                allowedOutsideImage: !0,
                                                hasBoundingBox: !0
                                            }
                                        }
                                    }
                                }
                            }, {
                                key: "pointNearTool",
                                value: function(e, t, n) {
                                    if (!1 === t.visible) return !1;
                                    if (this.hasIncomplete) return !1;
                                    var o = pr(e, t.handles.start, t.handles.end, n) < 25,
                                        r = pr(e, t.handles.start2, t.handles.end2, n) < 25;
                                    return o || r
                                }
                            }, {
                                key: "updateCachedStats",
                                value: function(e, t, n) {
                                    var o = aa(e),
                                        r = o.rowPixelSpacing,
                                        a = o.colPixelSpacing,
                                        i = (Math.ceil(n.handles.start.x) - Math.ceil(n.handles.end.x)) * (a || 1),
                                        s = (Math.ceil(n.handles.start.y) - Math.ceil(n.handles.end.y)) * (r || 1),
                                        l = (Math.ceil(n.handles.start2.x) - Math.ceil(n.handles.end2.x)) * (a || 1),
                                        c = (Math.ceil(n.handles.start2.y) - Math.ceil(n.handles.end2.y)) * (r || 1),
                                        u = Math.acos(Math.abs((i * l + s * c) / (Math.sqrt(i * i + s * s) * Math.sqrt(l * l + c * c))));
                                    u *= 180 / Math.PI, n.rAngle = vr(u, 2), n.invalidated = !1
                                }
                            }, {
                                key: "renderToolData",
                                value: function(e) {
                                    var t = this,
                                        n = e.detail,
                                        o = this.configuration,
                                        r = o.handleRadius,
                                        a = o.drawHandlesOnHover,
                                        i = o.hideHandlesIfMoving,
                                        s = o.renderDashed,
                                        l = _(e.currentTarget, this.name);
                                    if (l)
                                        for (var c = Dn(n.canvasContext.canvas), u = Zt.getToolWidth(), d = wt("globalConfiguration").configuration.lineDash, h = vn.getFont(), f = e.detail.element, m = aa(y.cornerstone.getEnabledElement(f).image), g = m.rowPixelSpacing, p = m.colPixelSpacing, v = function(e) {
                                                var o = l.data[e];
                                                if (!1 === o.visible) return "continue";
                                                o.value || (o.value = t.textBoxText(o, g, p)), Wt(c, (function(e) {
                                                    kn(e, t.configuration);
                                                    var l = un.getColorIfActive(o),
                                                        c = {
                                                            color: l
                                                        };
                                                    s && (c.lineDash = d), Xt(e, n.element, o.handles.start, o.handles.end, c), o.complete && Xt(e, n.element, o.handles.start2, o.handles.end2, c);
                                                    var f = {
                                                        color: l,
                                                        handleRadius: r,
                                                        drawHandlesIfActive: a,
                                                        hideHandlesIfMoving: i
                                                    };
                                                    t.configuration.drawHandles && dn(e, n, o.handles, f), e.fillStyle = l;
                                                    var m = o.value;
                                                    if (!o.handles.textBox.hasMoved) {
                                                        var g = {
                                                            x: (o.handles.start.x + o.handles.end.x) / 2,
                                                            y: (o.handles.start.y + o.handles.end.y) / 2 - 10
                                                        };
                                                        e.font = h, o.handles.textBox.x = g.x, o.handles.textBox.y = g.y
                                                    }
                                                    Cn(e, n.element, o.handles.textBox, m, o.handles, w, l, u, 0, !0)
                                                }))
                                            }, b = 0; b < l.data.length; b++) v(b);

                                    function w(e) {
                                        return [e.start, e.start2, e.end, e.end2]
                                    }
                                }
                            }, {
                                key: "getIncomplete",
                                value: function(e) {
                                    var t = _(e, this.name);
                                    if (t && Array.isArray(t.data)) return t.data.find((function(e) {
                                        return !1 === e.complete
                                    }))
                                }
                            }, {
                                key: "addNewMeasurement",
                                value: function(e, t) {
                                    var n = this;
                                    e.preventDefault(), e.stopPropagation();
                                    var o, r, a = e.detail,
                                        i = function(e) {
                                            if (e) {
                                                var t = x.MEASUREMENT_COMPLETED,
                                                    r = {
                                                        toolName: n.name,
                                                        toolType: n.name,
                                                        element: s,
                                                        measurementData: o
                                                    };
                                                T(s, t, r)
                                            } else L(s, n.name, o)
                                        },
                                        s = e.detail.element,
                                        l = this.getIncomplete(s);
                                    l ? ((o = l).complete = !0, o.handles.start2 = {
                                        x: a.currentPoints.image.x,
                                        y: a.currentPoints.image.y,
                                        drawnIndependently: !1,
                                        highlight: !0,
                                        active: !1
                                    }, o.handles.end2 = {
                                        x: a.currentPoints.image.x,
                                        y: a.currentPoints.image.y,
                                        drawnIndependently: !1,
                                        highlight: !0,
                                        active: !0
                                    }, r = o.handles.end2, this.hasIncomplete = !1, i = function(e) {
                                        if (e) {
                                            var t = x.MEASUREMENT_COMPLETED,
                                                r = {
                                                    toolName: n.name,
                                                    toolType: n.name,
                                                    element: s,
                                                    measurementData: o
                                                };
                                            T(s, t, r)
                                        } else L(s, n.name, o)
                                    }) : (o = this.createNewMeasurement(a), k(s, this.name, o), r = o.handles.end), y.cornerstone.updateImage(s), nr(a, this.name, o, r, this.options, t, i)
                                }
                            }, {
                                key: "onMeasureModified",
                                value: function(e) {
                                    var t = e.detail.element,
                                        n = y.cornerstone.getEnabledElement(t).image,
                                        o = aa(n),
                                        r = o.rowPixelSpacing,
                                        a = o.colPixelSpacing;
                                    if (e.detail.toolName === this.name) {
                                        var i = e.detail.measurementData;
                                        !0 === i.invalidated && (i.rAngle ? this.throttledUpdateCachedStats(n, t, i) : this.updateCachedStats(n, t, i)), i.value = this.textBoxText(i, r, a)
                                    }
                                }
                            }, {
                                key: "textBoxText",
                                value: function(e, t, n) {
                                    var o = e.rAngle;
                                    if (void 0 === o) return "";
                                    if (Number.isNaN(o)) return "";
                                    var r = t && n ? "" : " (isotropic)";
                                    return "".concat(o, "").concat(r)
                                }
                            }, {
                                key: "activeCallback",
                                value: function(e) {
                                    this.onMeasureModified = this.onMeasureModified.bind(this), e.addEventListener(x.MEASUREMENT_MODIFIED, this.onMeasureModified)
                                }
                            }, {
                                key: "passiveCallback",
                                value: function(e) {
                                    this.onMeasureModified = this.onMeasureModified.bind(this), e.addEventListener(x.MEASUREMENT_MODIFIED, this.onMeasureModified)
                                }
                            }, {
                                key: "enabledCallback",
                                value: function(e) {
                                    e.removeEventListener(x.MEASUREMENT_MODIFIED, this.onMeasureModified)
                                }
                            }, {
                                key: "disabledCallback",
                                value: function(e) {
                                    e.removeEventListener(x.MEASUREMENT_MODIFIED, this.onMeasureModified)
                                }
                            }]), t
                        }(gr),
                        di = B("tools:annotation:EllipticalRoiTool"),
                        hi = function(e) {
                            function t() {
                                var e, n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var o = {
                                    name: "EllipticalRoi",
                                    supportedInteractionTypes: ["Mouse", "Touch"],
                                    configuration: {
                                        drawHandlesOnHover: !1,
                                        hideHandlesIfMoving: !1,
                                        renderDashed: !1
                                    },
                                    svgCursor: Sr
                                };
                                return (e = u()(this, h()(t).call(this, n, o))).throttledUpdateCachedStats = la(e.updateCachedStats, 110), e
                            }
                            return m()(t, e), l()(t, [{
                                key: "createNewMeasurement",
                                value: function(e) {
                                    if (e && e.currentPoints && e.currentPoints.image) return {
                                        visible: !0,
                                        active: !0,
                                        color: void 0,
                                        invalidated: !0,
                                        handles: {
                                            start: {
                                                x: e.currentPoints.image.x,
                                                y: e.currentPoints.image.y,
                                                highlight: !0,
                                                active: !1
                                            },
                                            end: {
                                                x: e.currentPoints.image.x,
                                                y: e.currentPoints.image.y,
                                                highlight: !0,
                                                active: !0
                                            },
                                            initialRotation: e.viewport.rotation,
                                            textBox: {
                                                active: !1,
                                                hasMoved: !1,
                                                movesIndependently: !1,
                                                drawnIndependently: !0,
                                                allowedOutsideImage: !0,
                                                hasBoundingBox: !0
                                            }
                                        }
                                    };
                                    di.error("required eventData not supplied to tool ".concat(this.name, "'s createNewMeasurement"))
                                }
                            }, {
                                key: "pointNearTool",
                                value: function(e, t, n, o) {
                                    var r = t && t.handles && t.handles.start && t.handles.end;
                                    if (r || di.warn("invalid parameters supplied to tool ".concat(this.name, "'s pointNearTool")), !r || !1 === t.visible) return !1;
                                    if (yo(e, t.handles, n, 6)) return !0;
                                    var a = "mouse" === o ? 15 : 25,
                                        i = y.cornerstone.pixelToCanvas(e, t.handles.start),
                                        s = y.cornerstone.pixelToCanvas(e, t.handles.end),
                                        l = {
                                            left: Math.min(i.x, s.x) + a / 2,
                                            top: Math.min(i.y, s.y) + a / 2,
                                            width: Math.abs(i.x - s.x) - a,
                                            height: Math.abs(i.y - s.y) - a
                                        },
                                        c = {
                                            left: Math.min(i.x, s.x) - a / 2,
                                            top: Math.min(i.y, s.y) - a / 2,
                                            width: Math.abs(i.x - s.x) + a,
                                            height: Math.abs(i.y - s.y) + a
                                        },
                                        u = $a(l, n);
                                    return !(!$a(c, n) || u)
                                }
                            }, {
                                key: "updateCachedStats",
                                value: function(e, t, n) {
                                    var o = (y.cornerstone.metaData.get("generalSeriesModule", e.imageId) || {}).modality,
                                        r = aa(e),
                                        a = function(e, t, n, o, r) {
                                            var a, i = pi(n.start, n.end),
                                                s = y.cornerstone.getPixels(t, i.left, i.top, i.width, i.height),
                                                l = ei(s, i);
                                            return "PT" === o && (a = {
                                                mean: Ja(e, l.mean, !0) || 0,
                                                stdDev: Ja(e, l.stdDev, !0) || 0
                                            }), {
                                                area: Math.PI * (i.width * (r.colPixelSpacing || 1) / 2) * (i.height * (r.rowPixelSpacing || 1) / 2) || 0,
                                                count: l.count || 0,
                                                mean: l.mean || 0,
                                                variance: l.variance || 0,
                                                stdDev: l.stdDev || 0,
                                                min: l.min || 0,
                                                max: l.max || 0,
                                                meanStdDevSUV: a
                                            }
                                        }(e, t, n.handles, o, r);
                                    n.cachedStats = a, n.invalidated = !1
                                }
                            }, {
                                key: "renderToolData",
                                value: function(e) {
                                    var t = this,
                                        n = _(e.currentTarget, this.name);
                                    if (n) {
                                        var o = e.detail,
                                            r = o.image,
                                            a = o.element,
                                            i = Zt.getToolWidth(),
                                            s = wt("globalConfiguration").configuration.lineDash,
                                            l = this.configuration,
                                            c = l.handleRadius,
                                            u = l.drawHandlesOnHover,
                                            d = l.hideHandlesIfMoving,
                                            h = l.renderDashed,
                                            f = Dn(o.canvasContext.canvas),
                                            m = aa(r),
                                            g = m.rowPixelSpacing,
                                            p = m.colPixelSpacing,
                                            v = (y.cornerstone.metaData.get("generalSeriesModule", r.imageId) || {}).modality,
                                            b = g && p;
                                        Wt(f, (function(e) {
                                            for (var l = 0; l < n.data.length; l++) {
                                                var f = n.data[l];
                                                if (!1 !== f.visible) {
                                                    var m = un.getColorIfActive(f),
                                                        g = {
                                                            color: m,
                                                            handleRadius: c,
                                                            drawHandlesIfActive: u,
                                                            hideHandlesIfMoving: d
                                                        };
                                                    kn(e, t.configuration);
                                                    var p = {
                                                        color: m
                                                    };
                                                    if (h && (p.lineDash = s), an(e, a, f.handles.start, f.handles.end, p, "pixel", f.handles.initialRotation), dn(e, o, f.handles, g), !0 === f.invalidated && (f.cachedStats ? t.throttledUpdateCachedStats(r, a, f) : t.updateCachedStats(r, a, f)), !f.handles.textBox.hasMoved) {
                                                        var y = ni(o.viewport, f.handles);
                                                        Object.assign(f.handles.textBox, y)
                                                    }
                                                    var w = mi(e, r.color, f.cachedStats, v, b, t.configuration);
                                                    f.unit = fi(v, t.configuration.showHounsfieldUnits), Cn(e, a, f.handles.textBox, w, f.handles, (function(e) {
                                                        return n = (t = pi(e.start, e.end)).left, o = t.top, [{
                                                            x: n + (r = t.width) / 2,
                                                            y: o
                                                        }, {
                                                            x: n,
                                                            y: o + (a = t.height) / 2
                                                        }, {
                                                            x: n + r / 2,
                                                            y: o + a
                                                        }, {
                                                            x: n + r,
                                                            y: o + a / 2
                                                        }];
                                                        var t, n, o, r, a
                                                    }), m, i, 10, !0)
                                                }
                                            }
                                        }))
                                    }
                                }
                            }]), t
                        }(gr);

                    function fi(e, t) {
                        return "CT" === e && !1 !== t ? "HU" : ""
                    }

                    function mi(e, t) {
                        var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                            o = n.area,
                            r = void 0 === o ? 0 : o,
                            a = n.mean,
                            i = void 0 === a ? 0 : a,
                            s = n.stdDev,
                            l = void 0 === s ? 0 : s,
                            c = n.min,
                            u = void 0 === c ? 0 : c,
                            d = n.max,
                            h = void 0 === d ? 0 : d,
                            f = n.meanStdDevSUV,
                            m = void 0 === f ? 0 : f,
                            g = arguments.length > 3 ? arguments[3] : void 0,
                            p = arguments.length > 4 ? arguments[4] : void 0,
                            v = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : {},
                            y = v.showMinMax || !1,
                            b = [],
                            w = [];
                        if (!t) {
                            var x = m && 0 !== m.mean,
                                T = fi(g, v.showHounsfieldUnits),
                                I = "Mean: ".concat(oi(i.toFixed(2)), " ").concat(T),
                                E = "Std Dev: ".concat(oi(l.toFixed(2)), " ").concat(T);
                            if (x) {
                                for (var S = " SUV: ", A = "".concat(S).concat(oi(m.mean.toFixed(2))), C = "".concat(S).concat(oi(m.stdDev.toFixed(2))), M = Math.floor(e.measureText("".concat(E, "     ")).width); e.measureText(I).width < M;) I += " ";
                                w.push("".concat(I).concat(A)), w.push("".concat(E, "     ").concat(C))
                            } else w.push("".concat(I)), w.push("".concat(E));
                            if (y) {
                                for (var D = "Min: ".concat(u, " ").concat(T), P = "Max: ".concat(h, " ").concat(T), k = x ? Math.floor(e.measureText("".concat(E, "     ")).width) : Math.floor(e.measureText("".concat(I, "     ")).width); e.measureText(D).width < k;) D += " ";
                                w.push("".concat(D).concat(P))
                            }
                        }
                        return b.push(gi(r, p)), w.forEach((function(e) {
                            return b.push(e)
                        })), b
                    }

                    function gi(e, t) {
                        var n = t ? " mm".concat(String.fromCharCode(178)) : " px".concat(String.fromCharCode(178));
                        return "Area: ".concat(oi(e.toFixed(2))).concat(n)
                    }

                    function pi(e, t) {
                        return {
                            left: Math.round(Math.min(e.x, t.x)),
                            top: Math.round(Math.min(e.y, t.y)),
                            width: Math.round(Math.abs(e.x - t.x)),
                            height: Math.round(Math.abs(e.y - t.y))
                        }
                    }
                    var vi = function(e, t) {
                        for (var n = !1, o = e.length - 1, r = 0; r < e.length; r++) yi(t, e[r], e[o]) && (n = !n), o = r;
                        return n
                    };

                    function yi(e, t, n) {
                        return o = e.y, r = t.y, a = n.y, !(!(r < o && o < a || a < o && o < r) || ! function(e, t, n) {
                            if (t.x > e.x && n.x > e.x) return !0;
                            if (t.x === n.x) return e.x < t.x;
                            if (t.x > n.x) {
                                var o = t;
                                t = n, n = o
                            }
                            var r = function(e, t, n) {
                                var o = (n.y - t.y) / (n.x - t.x);
                                return {
                                    value: t.y + o * (e.x - t.x),
                                    gradient: o
                                }
                            }(e, t, n);
                            return Math.sign(r.gradient) * e.y > Math.sign(r.gradient) * r.value
                        }(e, t, n));
                        var o, r, a
                    }

                    function bi(e, t, n, o) {
                        vi(e, t) && (n.value += o, n.squared += o * o, n.count++)
                    }
                    var wi = function e(t, n) {
                            i()(this, e), this.toolIndex = t, this.handleIndexArray = n
                        },
                        xi = function e(t) {
                            var n = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1],
                                o = !(arguments.length > 2 && void 0 !== arguments[2]) || arguments[2];
                            i()(this, e), this.x = t.x, this.y = t.y, this.highlight = n, this.active = o, this.lines = []
                        };

                    function Ti(e, t, n, o) {
                        for (var r = e.length - 1, a = 0; a < e.length; a++)
                            if (-1 === o.indexOf(a) && -1 === o.indexOf(r)) {
                                if (Ii(t, n, Ei(e[r]), Ei(e[a]))) return !0;
                                r = a
                            } else r = a;
                        return !1
                    }

                    function Ii(e, t, n, o) {
                        var r = !1,
                            a = [Si(e, t, n), Si(e, t, o), Si(n, o, e), Si(n, o, t)];
                        return a[0] !== a[1] && a[2] !== a[3] || ((0 === a[0] && Ai(e, n, t) || 0 === a[1] && Ai(e, o, t) || 0 === a[2] && Ai(n, e, o) || 0 === a[3] && Ai(n, t, o)) && (r = !0), r)
                    }

                    function Ei(e) {
                        return {
                            x: e.x,
                            y: e.y
                        }
                    }

                    function Si(e, t, n) {
                        var o = (t.y - e.y) * (n.x - t.x) - (t.x - e.x) * (n.y - t.y);
                        return 0 === o ? 0 : o > 0 ? 1 : 2
                    }

                    function Ai(e, t, n) {
                        return t.x <= Math.max(e.x, n.x) && t.x >= Math.min(e.x, n.x) && t.y <= Math.max(e.y, n.y) && t.y >= Math.min(e.y, n.y)
                    }
                    var Ci = {
                            newHandle: function(e, t) {
                                var n = t.length - 1;
                                return Ti(t, Ei(t[n]), Ei(e), [n])
                            },
                            end: function(e) {
                                var t = e.length - 1;
                                return Ti(e, Ei(e[t]), Ei(e[0]), [t, 0])
                            },
                            modify: function(e, t) {
                                var n = Ei(e[t]),
                                    o = t - 1;
                                0 === t && (o = e.length - 1);
                                var r = Ei(e[o]);
                                return !!Ti(e, n, r, [t, o]) || Ti(e, n, r = Ei(e[o = t === e.length - 1 ? 0 : t + 1]), [t, o])
                            }
                        },
                        Mi = function() {
                            function e(t, n) {
                                i()(this, e), this._eventData = t, this._toolName = n
                            }
                            return l()(e, [{
                                key: "findLine",
                                value: function() {
                                    var e = this.findTool();
                                    if (null === e) return null;
                                    var t = this._getCloseLinesInTool(e);
                                    return t ? this._findCorrectLine(e, t) : null
                                }
                            }, {
                                key: "findTool",
                                value: function() {
                                    return this._toolData = _(this._eventData.element, this._toolName), this._mousePoint = this._eventData.currentPoints.canvas, this._toolData ? this._nearestHandleToPointAllTools().toolIndex : null
                                }
                            }, {
                                key: "_nearestHandleToPointAllTools",
                                value: function() {
                                    for (var e = this._toolData, t = {
                                            toolIndex: null,
                                            handleIndex: null,
                                            distance: 1 / 0
                                        }, n = 0; n < e.data.length; n++) {
                                        var o = this._nearestHandleToPoint(n);
                                        null !== o && o.distance < t.distance && (t = o)
                                    }
                                    return t
                                }
                            }, {
                                key: "_nearestHandleToPoint",
                                value: function(e) {
                                    var t = this._eventData,
                                        n = this._toolData.data[e],
                                        o = n.handles.points;
                                    if (void 0 === o) return null;
                                    if (!1 === n.visible) return null;
                                    for (var r = {
                                            toolIndex: e,
                                            handleIndex: null,
                                            distance: 1 / 0
                                        }, a = 0; a < o.length; a++) {
                                        var i = y.cornerstone.pixelToCanvas(t.element, o[a]),
                                            s = y.cornerstoneMath.point.distance(i, this._mousePoint);
                                        s < r.distance && (r.handleIndex = a, r.distance = s)
                                    }
                                    return r
                                }
                            }, {
                                key: "_getCloseLinesInTool",
                                value: function(t) {
                                    for (var n = this._toolData.data[t].handles.points, o = [], r = 0; r < n.length; r++) {
                                        var a = e.getNextHandleIndex(r, n.length);
                                        this._distanceOfPointfromLine(n[r], n[a]) < 10 && o.push([r, a])
                                    }
                                    return o
                                }
                            }, {
                                key: "_findCorrectLine",
                                value: function(e, t) {
                                    for (var n = 0; n < t.length; n++)
                                        if (this._pointProjectsToLineSegment(e, t[n])) return new wi(e, t[n]);
                                    return null
                                }
                            }, {
                                key: "_pointProjectsToLineSegment",
                                value: function(t, n) {
                                    var o = this._eventData,
                                        r = this._toolData.data[t],
                                        a = r.handles.points;
                                    if (void 0 !== r.handles.points) {
                                        if (!1 === r.visible) return !1;
                                        var i = a[n[0]],
                                            s = a[n[1]],
                                            l = e.getCanvasPointsFromHandles(i, s, o.element),
                                            c = e.getLineAsVector(l),
                                            u = this._getLineOriginToMouseAsVector(l),
                                            d = (u[0] * c[0] + u[1] * c[1]) / c.magnitude;
                                        return d > 0 && d < c.magnitude
                                    }
                                }
                            }, {
                                key: "_getLineOriginToMouseAsVector",
                                value: function(e) {
                                    return [this._mousePoint.x - e[0].x, this._mousePoint.y - e[0].y]
                                }
                            }, {
                                key: "_distanceOfPointfromLine",
                                value: function(e, t) {
                                    var n = this._eventData,
                                        o = y.cornerstone.pixelToCanvas(n.element, e),
                                        r = y.cornerstone.pixelToCanvas(n.element, t),
                                        a = this._mousePoint;
                                    return Math.abs((r.y - o.y) * a.x - (r.x - o.x) * a.y + r.x * o.y - r.y * o.x) / y.cornerstoneMath.point.distance(o, r)
                                }
                            }], [{
                                key: "getCanvasPointsFromHandles",
                                value: function(e, t, n) {
                                    var o = [];
                                    return e.x < t.x ? (o.push(y.cornerstone.pixelToCanvas(n, e)), o.push(y.cornerstone.pixelToCanvas(n, t))) : (o.push(y.cornerstone.pixelToCanvas(n, t)), o.push(y.cornerstone.pixelToCanvas(n, e))), o
                                }
                            }, {
                                key: "getLineAsVector",
                                value: function(e) {
                                    var t = [e[1].x - e[0].x, e[1].y - e[0].y];
                                    return t.magnitude = y.cornerstoneMath.point.distance(e[0], e[1]), t
                                }
                            }, {
                                key: "getNextHandleIndex",
                                value: function(e, t) {
                                    return e < t - 1 ? e + 1 : 0
                                }
                            }]), e
                        }(),
                        Di = function(e, t) {
                            t === e.length - 1 ? e[t].lines.push(e[0]) : e[t].lines.push(e[t + 1])
                        };

                    function Pi(e, t) {
                        var n = _(e.element, this.name);
                        if (void 0 !== n) {
                            var o = t.handleIndex,
                                r = t.toolIndex,
                                a = n.data[r],
                                i = a.handles.points;
                            i.length <= 3 || (o === i.length - 1 ? (i[o - 1].lines.pop(), i[o - 1].lines.push(i[0])) : 0 === o ? (i[i.length - 1].lines.pop(), i[i.length - 1].lines.push(i[o + 1])) : (i[o - 1].lines.pop(), i[o - 1].lines.push(i[o + 1])), i.splice(o, 1), a.invalidated = !0, a.active = !0, a.highlight = !0, y.cornerstone.updateImage(e.element))
                        }
                    }

                    function ki(e, t) {
                        var n = _(e.element, this.name);
                        if (void 0 !== n) {
                            var o = n.data[t.toolIndex],
                                r = function(e) {
                                    for (var t = e.handleIndexArray, n = 1 / 0, o = t.includes(0), r = 0; r < t.length; r++) {
                                        var a = t[r];
                                        0 !== a && a < n && (n = a)
                                    }
                                    return o && 1 === n && (n = 0), ++n
                                }(t);
                            if (r !== 1 / 0) {
                                var a = new xi(e.currentPoints.image),
                                    i = o.handles.points;
                                i.splice(r, 0, a), i[r - 1].lines.pop(), i[r - 1].lines.push(e.currentPoints.image), Di(i, r), o.active = !0, o.highlight = !0, o.invalidated = !0, y.cornerstone.updateImage(e.element)
                            }
                        }
                    }
                    var _i = {
                            calculateFreehandStatistics: function(e, t, n) {
                                var o = {
                                        count: 0,
                                        mean: 0,
                                        variance: 0,
                                        stdDev: 0
                                    },
                                    r = function(e, t, n) {
                                        for (var o = {
                                                value: 0,
                                                squared: 0,
                                                count: 0
                                            }, r = 0, a = t.top; a < t.top + t.height; a++)
                                            for (var i = t.left; i < t.left + t.width; i++) bi(n, {
                                                x: i,
                                                y: a
                                            }, o, e[r]), r++;
                                        return o
                                    }(e, t, n);
                                return 0 === r.count || (o.count = r.count, o.mean = r.value / r.count, o.variance = r.squared / r.count - o.mean * o.mean, o.stdDev = Math.sqrt(o.variance)), o
                            },
                            ClickedLineData: wi,
                            freehandArea: function(e, t) {
                                var n = 0,
                                    o = e.length - 1;
                                t = t || 1;
                                for (var r = 0; r < e.length; r++) n += (e[o].x + e[r].x) * (e[o].y - e[r].y), o = r;
                                return Math.abs(n * t / 2)
                            },
                            FreehandHandleData: xi,
                            freehandIntersect: Ci,
                            FreehandLineFinder: Mi,
                            insertOrDelete: function(e, t) {
                                var n = e.detail;
                                if (t && null !== t.handleNearby) {
                                    var o = {
                                        toolIndex: t.toolIndex,
                                        handleIndex: t.handleNearby
                                    };
                                    Pi.call(this, n, o)
                                } else {
                                    var r = new Mi(n, this.name).findLine();
                                    r && ki.call(this, n, r)
                                }
                            },
                            pointInFreehand: vi,
                            addLine: Di
                        },
                        Li = B("tools:annotation:FreehandRoiTool"),
                        Oi = _i.insertOrDelete,
                        Ri = _i.freehandArea,
                        Ni = _i.calculateFreehandStatistics,
                        Ui = _i.freehandIntersect,
                        Bi = _i.FreehandHandleData,
                        Vi = function(e) {
                            function t() {
                                var e, n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var o = {
                                    name: "FreehandRoi",
                                    supportedInteractionTypes: ["Mouse", "Touch"],
                                    configuration: {
                                        mouseLocation: {
                                            handles: {
                                                start: {
                                                    highlight: !0,
                                                    active: !0
                                                }
                                            }
                                        },
                                        spacing: 1,
                                        activeHandleRadius: 3,
                                        completeHandleRadius: 6,
                                        completeHandleRadiusTouch: 28,
                                        alwaysShowHandles: !1,
                                        invalidColor: "crimson",
                                        currentHandle: 0,
                                        currentTool: -1,
                                        drawHandles: !0,
                                        renderDashed: !1
                                    },
                                    svgCursor: Ar
                                };
                                return (e = u()(this, h()(t).call(this, n, o))).isMultiPartTool = !0, e._drawing = !1, e._dragging = !1, e._modifying = !1, e._drawingMouseDownCallback = e._drawingMouseDownCallback.bind(Ao()(e)), e._drawingMouseMoveCallback = e._drawingMouseMoveCallback.bind(Ao()(e)), e._drawingMouseDragCallback = e._drawingMouseDragCallback.bind(Ao()(e)), e._drawingMouseUpCallback = e._drawingMouseUpCallback.bind(Ao()(e)), e._drawingMouseDoubleClickCallback = e._drawingMouseDoubleClickCallback.bind(Ao()(e)), e._editMouseUpCallback = e._editMouseUpCallback.bind(Ao()(e)), e._editMouseDragCallback = e._editMouseDragCallback.bind(Ao()(e)), e._drawingTouchStartCallback = e._drawingTouchStartCallback.bind(Ao()(e)), e._drawingTouchDragCallback = e._drawingTouchDragCallback.bind(Ao()(e)), e._drawingDoubleTapClickCallback = e._drawingDoubleTapClickCallback.bind(Ao()(e)), e._editTouchDragCallback = e._editTouchDragCallback.bind(Ao()(e)), e.throttledUpdateCachedStats = la(e.updateCachedStats, 110), e
                            }
                            return m()(t, e), l()(t, [{
                                key: "createNewMeasurement",
                                value: function(e) {
                                    if (e && e.currentPoints && e.currentPoints.image) {
                                        var t = {
                                            visible: !0,
                                            active: !0,
                                            invalidated: !0,
                                            color: void 0,
                                            handles: {
                                                points: []
                                            }
                                        };
                                        return t.handles.textBox = {
                                            active: !1,
                                            hasMoved: !1,
                                            movesIndependently: !1,
                                            drawnIndependently: !0,
                                            allowedOutsideImage: !0,
                                            hasBoundingBox: !0
                                        }, t
                                    }
                                    Li.error("required eventData not supplied to tool ".concat(this.name, "'s createNewMeasurement"))
                                }
                            }, {
                                key: "pointNearTool",
                                value: function(e, t, n) {
                                    var o = t && t.handles && t.handles.points;
                                    if (!o) throw new Error("invalid parameters supplied to tool ".concat(this.name, "'s pointNearTool"));
                                    return !(!o || !1 === t.visible) && void 0 !== this._pointNearHandle(e, t, n)
                                }
                            }, {
                                key: "distanceFromPoint",
                                value: function(e, t, n) {
                                    for (var o = 1 / 0, r = 0; r < t.handles.points.length; r++) {
                                        var a = y.cornerstoneMath.point.distance(t.handles.points[r], n);
                                        o = Math.min(o, a)
                                    }
                                    return o === 1 / 0 ? -1 : o
                                }
                            }, {
                                key: "distanceFromPointCanvas",
                                value: function(e, t, n) {
                                    var o = 1 / 0;
                                    if (!t) return -1;
                                    for (var r = y.cornerstone.pixelToCanvas(e, n), a = t.handles.points, i = 0; i < a.length; i++) {
                                        var s = y.cornerstone.pixelToCanvas(e, a[i]),
                                            l = y.cornerstoneMath.point.distance(s, r);
                                        o = Math.min(o, l)
                                    }
                                    return o === 1 / 0 ? -1 : o
                                }
                            }, {
                                key: "updateCachedStats",
                                value: function(e, t, n) {
                                    for (var o, r, a = y.cornerstone.metaData.get("generalSeriesModule", e.imageId), i = a ? a.modality : null, s = n.handles.points, l = {
                                            left: s[0].x,
                                            right: s[0].x,
                                            bottom: s[0].y,
                                            top: s[0].x
                                        }, c = 0; c < s.length; c++) l.left = Math.min(l.left, s[c].x), l.right = Math.max(l.right, s[c].x), l.bottom = Math.min(l.bottom, s[c].y), l.top = Math.max(l.top, s[c].y);
                                    var u = {
                                        left: l.left,
                                        top: l.bottom,
                                        width: Math.abs(l.right - l.left),
                                        height: Math.abs(l.top - l.bottom)
                                    };
                                    if (n.polyBoundingBox = u, !e.color) {
                                        var d = y.cornerstone.getPixels(t, u.left, u.top, u.width, u.height);
                                        o = Ni.call(this, d, u, n.handles.points), "PT" === i && (r = {
                                            mean: Ja(e, (o.mean - e.intercept) / e.slope),
                                            stdDev: Ja(e, (o.stdDev - e.intercept) / e.slope)
                                        }), o && !isNaN(o.mean) && (n.meanStdDev = o, n.meanStdDevSUV = r)
                                    }
                                    var h = aa(e),
                                        f = (h.colPixelSpacing || 1) * (h.rowPixelSpacing || 1),
                                        m = Ri(n.handles.points, f);
                                    isNaN(m) || (n.area = m), n.invalidated = !1
                                }
                            }, {
                                key: "renderToolData",
                                value: function(e) {
                                    var t = this,
                                        n = e.detail,
                                        o = _(e.currentTarget, this.name);
                                    if (o)
                                        for (var r = n.image, a = n.element, i = this.configuration, s = y.cornerstone.metaData.get("generalSeriesModule", r.imageId), l = s ? s.modality : null, c = Dn(n.canvasContext.canvas), u = Zt.getToolWidth(), d = i.renderDashed, h = wt("globalConfiguration").configuration.lineDash, f = function(e) {
                                                var s = o.data[e];
                                                if (!1 === s.visible) return "continue";
                                                Wt(c, (function(e) {
                                                    var o, l = un.getColorIfActive(s);
                                                    s.active ? s.handles.invalidHandlePlacement ? (l = i.invalidColor, o = i.invalidColor) : (l = un.getColorIfActive(s), o = un.getFillColor()) : o = un.getToolColor();
                                                    var c = {
                                                        color: l
                                                    };
                                                    if (d && (c.lineDash = h), s.handles.points.length) {
                                                        var f = s.handles.points;
                                                        Jt(e, a, f[0], f, c), s.polyBoundingBox ? Jt(e, a, f[f.length - 1], [f[0]], c) : Jt(e, a, f[f.length - 1], [i.mouseLocation.handles.start], c)
                                                    }
                                                    if (c = {
                                                            color: l,
                                                            fill: o
                                                        }, (i.alwaysShowHandles || s.active && s.polyBoundingBox) && (c.handleRadius = i.activeHandleRadius, t.configuration.drawHandles && dn(e, n, s.handles.points, c)), s.canComplete) {
                                                        c.handleRadius = i.completeHandleRadius;
                                                        var m = s.handles.points[0];
                                                        t.configuration.drawHandles && dn(e, n, [m], c)
                                                    }
                                                    if (s.active && !s.polyBoundingBox) {
                                                        c.handleRadius = i.activeHandleRadius, t.configuration.drawHandles && dn(e, n, i.mouseLocation.handles, c);
                                                        var v = s.handles.points[0];
                                                        t.configuration.drawHandles && dn(e, n, [v], c)
                                                    }
                                                    if (!0 !== s.invalidated || s.active || (s.meanStdDev && s.meanStdDevSUV && s.area ? t.throttledUpdateCachedStats(r, a, s) : t.updateCachedStats(r, a, s)), s.polyBoundingBox && !s.handles.textBox.freehand) {
                                                        s.handles.textBox.hasMoved || (s.handles.textBox.x = s.polyBoundingBox.left + s.polyBoundingBox.width, s.handles.textBox.y = s.polyBoundingBox.top + s.polyBoundingBox.height / 2);
                                                        var y = g.call(t, s);
                                                        Cn(e, a, s.handles.textBox, y, s.handles.points, p, l, u, 0, !0)
                                                    }
                                                }))
                                            }, m = 0; m < o.data.length; m++) f(m);

                                    function g(e) {
                                        var t = e.meanStdDev,
                                            n = e.meanStdDevSUV,
                                            o = e.area,
                                            a = [];
                                        if (t && void 0 !== t.mean) {
                                            var i = "";
                                            "CT" === l && (i = "HU"), e.unit = i;
                                            var s = "Mean: ".concat(oi(t.mean.toFixed(2)), " ").concat(i),
                                                c = "StdDev: ".concat(oi(t.stdDev.toFixed(2)), " ").concat(i);
                                            n && void 0 !== n.mean && (s += " SUV: " + oi(n.mean.toFixed(2)), c += " SUV: " + oi(n.stdDev.toFixed(2))), a.push(s), a.push(c)
                                        }
                                        if (o) {
                                            var u = " mm".concat(String.fromCharCode(178)),
                                                d = aa(r),
                                                h = d.rowPixelSpacing,
                                                f = d.colPixelSpacing;
                                            h && f || (u = " pixels".concat(String.fromCharCode(178)));
                                            var m = "Area: ".concat(oi(o.toFixed(2))).concat(u);
                                            a.push(m)
                                        }
                                        return a
                                    }

                                    function p(e) {
                                        return e
                                    }
                                }
                            }, {
                                key: "addNewMeasurement",
                                value: function(e) {
                                    var t = e.detail;
                                    this._startDrawing(e), this._addPoint(t), Fi(e)
                                }
                            }, {
                                key: "preMouseDownCallback",
                                value: function(e) {
                                    var t = e.detail,
                                        n = this._pointNearHandleAllTools(t);
                                    return !!t.event.ctrlKey && (void 0 !== n && n.handleNearby.hasBoundingBox || Oi.call(this, e, n), Fi(e), !0)
                                }
                            }, {
                                key: "handleSelectedCallback",
                                value: function(e, t, n) {
                                    var o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : "mouse",
                                        r = e.detail.element,
                                        a = _(r, this.name);
                                    if (n.hasBoundingBox) dr(e, this, t, n, o);
                                    else {
                                        var i = this.configuration;
                                        i.dragOrigin = {
                                            x: n.x,
                                            y: n.y
                                        };
                                        for (var s = 0; s < a.data.length; s++)
                                            for (var l = a.data[s].handles.points, c = 0; c < l.length; c++) l[c] === n && (i.currentHandle = c, i.currentTool = s);
                                        this._modifying = !0, this._activateModify(r), Fi(e)
                                    }
                                }
                            }, {
                                key: "_drawingMouseMoveCallback",
                                value: function(e) {
                                    var t = e.detail,
                                        n = t.currentPoints,
                                        o = t.element,
                                        r = _(o, this.name),
                                        a = this.configuration,
                                        i = a.currentTool,
                                        s = r.data[i],
                                        l = n.canvas;
                                    this._getMouseLocation(t), this._checkInvalidHandleLocation(s, t);
                                    var c = this._pointNearHandle(o, s, l),
                                        u = s.handles.points;
                                    void 0 !== c && !c.hasBoundingBox && c < u.length - 1 && (a.mouseLocation.handles.start.x = u[c].x, a.mouseLocation.handles.start.y = u[c].y), y.cornerstone.updateImage(o)
                                }
                            }, {
                                key: "_drawingMouseDragCallback",
                                value: function(e) {
                                    this.options.mouseButtonMask.includes(e.detail.buttons) && this._drawingDrag(e)
                                }
                            }, {
                                key: "_drawingTouchDragCallback",
                                value: function(e) {
                                    this._drawingDrag(e)
                                }
                            }, {
                                key: "_drawingDrag",
                                value: function(e) {
                                    var t = e.detail,
                                        n = t.element,
                                        o = _(n, this.name),
                                        r = this.configuration.currentTool,
                                        a = o.data[r];
                                    this._getMouseLocation(t), this._checkInvalidHandleLocation(a, t), this._addPointPencilMode(t, a.handles.points), this._dragging = !0, y.cornerstone.updateImage(n)
                                }
                            }, {
                                key: "_drawingMouseUpCallback",
                                value: function(e) {
                                    var t = e.detail.element;
                                    if (this._dragging) {
                                        this._dragging = !1;
                                        var n = this.configuration,
                                            o = n.currentTool,
                                            r = _(t, this.name).data[o];
                                        if (!Ui.end(r.handles.points) && r.canComplete) {
                                            var a = n.currentHandle;
                                            this._endDrawing(t, a)
                                        }
                                        Fi(e)
                                    }
                                }
                            }, {
                                key: "_drawingMouseDownCallback",
                                value: function(e) {
                                    var t = e.detail,
                                        n = t.buttons,
                                        o = t.currentPoints,
                                        r = t.element;
                                    if (this.options.mouseButtonMask.includes(n)) {
                                        var a = o.canvas,
                                            i = this.configuration,
                                            s = i.currentTool,
                                            l = _(r, this.name).data[s],
                                            c = this._pointNearHandle(r, l, a);
                                        if (!Ui.end(l.handles.points) && l.canComplete) {
                                            var u = i.currentHandle;
                                            this._endDrawing(r, u)
                                        } else void 0 === c && this._addPoint(t);
                                        Fi(e)
                                    }
                                }
                            }, {
                                key: "_drawingTouchStartCallback",
                                value: function(e) {
                                    var t = e.detail,
                                        n = t.currentPoints,
                                        o = t.element,
                                        r = n.canvas,
                                        a = this.configuration,
                                        i = a.currentTool,
                                        s = _(o, this.name).data[i],
                                        l = this._pointNearHandle(o, s, r);
                                    if (!Ui.end(s.handles.points) && s.canComplete) {
                                        var c = a.currentHandle;
                                        this._endDrawing(o, c)
                                    } else void 0 === l && this._addPoint(t);
                                    Fi(e)
                                }
                            }, {
                                key: "completeDrawing",
                                value: function(e) {
                                    if (this._drawing) {
                                        var t = _(e, this.name),
                                            n = this.configuration,
                                            o = t.data[n.currentTool];
                                        if (!Ui.end(o.handles.points) && o.handles.points.length >= 2) {
                                            var r = n.currentHandle;
                                            o.polyBoundingBox = {}, this._endDrawing(e, r)
                                        }
                                    }
                                }
                            }, {
                                key: "_drawingMouseDoubleClickCallback",
                                value: function(e) {
                                    var t = e.detail.element;
                                    this.completeDrawing(t), Fi(e)
                                }
                            }, {
                                key: "_drawingDoubleTapClickCallback",
                                value: function(e) {
                                    var t = e.detail.element;
                                    this.completeDrawing(t), Fi(e)
                                }
                            }, {
                                key: "_editMouseDragCallback",
                                value: function(e) {
                                    var t = e.detail,
                                        n = t.element,
                                        o = t.buttons;
                                    if (this.options.mouseButtonMask.includes(o)) {
                                        var r, a = _(n, this.name),
                                            i = this.configuration,
                                            s = a.data[i.currentTool],
                                            l = i.currentHandle,
                                            c = s.handles.points;
                                        if (this._getMouseLocation(t), s.handles.invalidHandlePlacement = Ui.modify(c, l), s.active = !0, s.highlight = !0, c[l].x = i.mouseLocation.handles.start.x, c[l].y = i.mouseLocation.handles.start.y, r = this._getPrevHandleIndex(l, c), l >= 0) {
                                            var u = c[r].lines.length - 1,
                                                d = c[r].lines[u];
                                            d.x = i.mouseLocation.handles.start.x, d.y = i.mouseLocation.handles.start.y
                                        }
                                        y.cornerstone.updateImage(n)
                                    }
                                }
                            }, {
                                key: "_editTouchDragCallback",
                                value: function(e) {
                                    var t, n = e.detail,
                                        o = n.element,
                                        r = _(o, this.name),
                                        a = this.configuration,
                                        i = r.data[a.currentTool],
                                        s = a.currentHandle,
                                        l = i.handles.points;
                                    if (this._getMouseLocation(n), i.handles.invalidHandlePlacement = Ui.modify(l, s), i.active = !0, i.highlight = !0, l[s].x = a.mouseLocation.handles.start.x, l[s].y = a.mouseLocation.handles.start.y, t = this._getPrevHandleIndex(s, l), s >= 0) {
                                        var c = l[t].lines.length - 1,
                                            u = l[t].lines[c];
                                        u.x = a.mouseLocation.handles.start.x, u.y = a.mouseLocation.handles.start.y
                                    }
                                    y.cornerstone.updateImage(o)
                                }
                            }, {
                                key: "_getPrevHandleIndex",
                                value: function(e, t) {
                                    return 0 === e ? t.length - 1 : e - 1
                                }
                            }, {
                                key: "_editMouseUpCallback",
                                value: function(e) {
                                    var t = e.detail,
                                        n = t.element,
                                        o = _(n, this.name);
                                    this._deactivateModify(n), this._dropHandle(t, o), this._endDrawing(n), y.cornerstone.updateImage(n)
                                }
                            }, {
                                key: "_dropHandle",
                                value: function(e, t) {
                                    var n = this.configuration,
                                        o = n.currentTool,
                                        r = t.data[o].handles,
                                        a = r.points;
                                    if (r.invalidHandlePlacement) {
                                        var i, s = n.currentHandle,
                                            l = a[s];
                                        i = 0 === s ? a[a.length - 1] : a[s - 1], l.x = n.dragOrigin.x, l.y = n.dragOrigin.y, i.lines[0] = l, r.invalidHandlePlacement = !1
                                    }
                                }
                            }, {
                                key: "_startDrawing",
                                value: function(e) {
                                    var t, n = e.detail,
                                        o = this.createNewMeasurement(n),
                                        r = n.element,
                                        a = this.configuration;
                                    e.type === x.MOUSE_DOWN_ACTIVATE ? t = "Mouse" : e.type === x.TOUCH_START_ACTIVE && (t = "Touch"), this._activateDraw(r, t), this._getMouseLocation(n), k(r, this.name, o);
                                    var i = _(r, this.name);
                                    a.currentTool = i.data.length - 1, this._activeDrawingToolReference = i.data[a.currentTool]
                                }
                            }, {
                                key: "_addPoint",
                                value: function(e) {
                                    var t = e.currentPoints,
                                        n = e.element,
                                        o = _(n, this.name),
                                        r = this.configuration,
                                        a = o.data[r.currentTool];
                                    if (!a.handles.invalidHandlePlacement) {
                                        var i = new Bi(t.image);
                                        a.handles.points.length && a.handles.points[r.currentHandle - 1].lines.push(t.image), a.handles.points.push(i), r.currentHandle += 1, y.cornerstone.updateImage(n), this.fireModifiedEvent(n, a)
                                    }
                                }
                            }, {
                                key: "_addPointPencilMode",
                                value: function(e, t) {
                                    var n = this,
                                        o = this.configuration,
                                        r = e.element,
                                        a = o.mouseLocation.handles.start;
                                    t.every((function(e) {
                                        return n._isDistanceLargerThanSpacing(r, e, a)
                                    })) && this._addPoint(e)
                                }
                            }, {
                                key: "_endDrawing",
                                value: function(e, t) {
                                    var n = _(e, this.name),
                                        o = this.configuration,
                                        r = n.data[o.currentTool];
                                    if (r.active = !1, r.highlight = !1, r.handles.invalidHandlePlacement = !1, void 0 !== t) {
                                        var a = r.handles.points;
                                        a[o.currentHandle - 1].lines.push(a[0])
                                    }
                                    this._modifying && (this._modifying = !1, r.invalidated = !0), o.currentHandle = 0, o.currentTool = -1, r.canComplete = !1, this._drawing && this._deactivateDraw(e), y.cornerstone.updateImage(e), this.fireModifiedEvent(e, r), this.fireCompletedEvent(e, r)
                                }
                            }, {
                                key: "_pointNearHandle",
                                value: function(e, t, n) {
                                    if (void 0 !== t.handles && void 0 !== t.handles.points && !1 !== t.visible) {
                                        for (var o = 0; o < t.handles.points.length; o++) {
                                            var r = y.cornerstone.pixelToCanvas(e, t.handles.points[o]);
                                            if (y.cornerstoneMath.point.distance(r, n) < 6) return o
                                        }
                                        return t.handles.textBox && po(t.handles.textBox, n) ? t.handles.textBox : void 0
                                    }
                                }
                            }, {
                                key: "_pointNearHandleAllTools",
                                value: function(e) {
                                    var t = e.currentPoints,
                                        n = e.element,
                                        o = t.canvas,
                                        r = _(n, this.name);
                                    if (r)
                                        for (var a, i = 0; i < r.data.length; i++)
                                            if (void 0 !== (a = this._pointNearHandle(n, r.data[i], o))) return {
                                                handleNearby: a,
                                                toolIndex: i
                                            }
                                }
                            }, {
                                key: "_getMouseLocation",
                                value: function(e) {
                                    var t = e.currentPoints,
                                        n = e.image,
                                        o = this.configuration;
                                    o.mouseLocation.handles.start.x = t.image.x, o.mouseLocation.handles.start.y = t.image.y, In(o.mouseLocation.handles.start, n)
                                }
                            }, {
                                key: "_checkInvalidHandleLocation",
                                value: function(e, t) {
                                    if (e.handles.points.length < 2) return !0;
                                    var n;
                                    n = this._dragging ? this._checkHandlesPencilMode(e, t) : this._checkHandlesPolygonMode(e, t), e.handles.invalidHandlePlacement = n
                                }
                            }, {
                                key: "_checkHandlesPolygonMode",
                                value: function(e, t) {
                                    var n = this.configuration,
                                        o = t.element,
                                        r = n.mouseLocation.handles.start,
                                        a = e.handles.points,
                                        i = !1;
                                    return e.canComplete = !1, this._isDistanceSmallerThanCompleteSpacingCanvas(o, a[0], r) && !Ui.end(a) && a.length > 2 ? (e.canComplete = !0, i = !1) : i = Ui.newHandle(r, a), i
                                }
                            }, {
                                key: "_checkHandlesPencilMode",
                                value: function(e, t) {
                                    var n = this.configuration.mouseLocation.handles.start,
                                        o = e.handles.points,
                                        r = Ui.newHandle(n, o);
                                    return !1 === r && (r = this._invalidHandlePencilMode(e, t)), r
                                }
                            }, {
                                key: "_invalidHandlePencilMode",
                                value: function(e, t) {
                                    var n = this.configuration,
                                        o = t.element,
                                        r = n.mouseLocation.handles.start,
                                        a = e.handles.points;
                                    if (this._isDistanceSmallerThanCompleteSpacingCanvas(o, a[0], r)) return e.canComplete = !0, !1;
                                    e.canComplete = !1;
                                    for (var i = 1; i < a.length - 1; i++)
                                        if (this._isDistanceSmallerThanSpacing(o, a[i], r)) return !0;
                                    return !1
                                }
                            }, {
                                key: "_isDistanceSmallerThanCompleteSpacingCanvas",
                                value: function(e, t, n) {
                                    var o, r = y.cornerstone.pixelToCanvas(e, t),
                                        a = y.cornerstone.pixelToCanvas(e, n);
                                    return "Mouse" === this._drawingInteractionType ? o = this.configuration.completeHandleRadius : "Touch" === this._drawingInteractionType && (o = this.configuration.completeHandleRadiusTouch), this._compareDistanceToSpacing(e, r, a, "<", o)
                                }
                            }, {
                                key: "_isDistanceSmallerThanSpacing",
                                value: function(e, t, n) {
                                    return this._compareDistanceToSpacing(e, t, n, "<")
                                }
                            }, {
                                key: "_isDistanceLargerThanSpacing",
                                value: function(e, t, n) {
                                    return this._compareDistanceToSpacing(e, t, n, ">")
                                }
                            }, {
                                key: "_compareDistanceToSpacing",
                                value: function(e, t, n) {
                                    var o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : ">",
                                        r = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : this.configuration.spacing;
                                    return ">" === o ? y.cornerstoneMath.point.distance(t, n) > r : y.cornerstoneMath.point.distance(t, n) < r
                                }
                            }, {
                                key: "_activateDraw",
                                value: function(e) {
                                    var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : "Mouse";
                                    this._drawing = !0, this._drawingInteractionType = t, vt.isMultiPartToolActive = !0, St(this.element), e.addEventListener(x.MOUSE_DOWN, this._drawingMouseDownCallback), e.addEventListener(x.MOUSE_MOVE, this._drawingMouseMoveCallback), e.addEventListener(x.MOUSE_DOUBLE_CLICK, this._drawingMouseDoubleClickCallback), e.addEventListener(x.MOUSE_DRAG, this._drawingMouseDragCallback), e.addEventListener(x.MOUSE_UP, this._drawingMouseUpCallback), e.addEventListener(x.TOUCH_START, this._drawingMouseMoveCallback), e.addEventListener(x.TOUCH_START, this._drawingTouchStartCallback), e.addEventListener(x.TOUCH_DRAG, this._drawingTouchDragCallback), e.addEventListener(x.TOUCH_END, this._drawingMouseUpCallback), e.addEventListener(x.DOUBLE_TAP, this._drawingDoubleTapClickCallback), y.cornerstone.updateImage(e)
                                }
                            }, {
                                key: "_deactivateDraw",
                                value: function(e) {
                                    this._drawing = !1, vt.isMultiPartToolActive = !1, this._activeDrawingToolReference = null, this._drawingInteractionType = null, Et(this.element, this.svgCursor), e.removeEventListener(x.MOUSE_DOWN, this._drawingMouseDownCallback), e.removeEventListener(x.MOUSE_MOVE, this._drawingMouseMoveCallback), e.removeEventListener(x.MOUSE_DOUBLE_CLICK, this._drawingMouseDoubleClickCallback), e.removeEventListener(x.MOUSE_DRAG, this._drawingMouseDragCallback), e.removeEventListener(x.MOUSE_UP, this._drawingMouseUpCallback), e.removeEventListener(x.TOUCH_START, this._drawingTouchStartCallback), e.removeEventListener(x.TOUCH_DRAG, this._drawingTouchDragCallback), e.removeEventListener(x.TOUCH_START, this._drawingMouseMoveCallback), e.removeEventListener(x.TOUCH_END, this._drawingMouseUpCallback), y.cornerstone.updateImage(e)
                                }
                            }, {
                                key: "_activateModify",
                                value: function(e) {
                                    vt.isToolLocked = !0, e.addEventListener(x.MOUSE_UP, this._editMouseUpCallback), e.addEventListener(x.MOUSE_DRAG, this._editMouseDragCallback), e.addEventListener(x.MOUSE_CLICK, this._editMouseUpCallback), e.addEventListener(x.TOUCH_END, this._editMouseUpCallback), e.addEventListener(x.TOUCH_DRAG, this._editTouchDragCallback), y.cornerstone.updateImage(e)
                                }
                            }, {
                                key: "_deactivateModify",
                                value: function(e) {
                                    vt.isToolLocked = !1, e.removeEventListener(x.MOUSE_UP, this._editMouseUpCallback), e.removeEventListener(x.MOUSE_DRAG, this._editMouseDragCallback), e.removeEventListener(x.MOUSE_CLICK, this._editMouseUpCallback), e.removeEventListener(x.TOUCH_END, this._editMouseUpCallback), e.removeEventListener(x.TOUCH_DRAG, this._editTouchDragCallback), y.cornerstone.updateImage(e)
                                }
                            }, {
                                key: "passiveCallback",
                                value: function(e) {
                                    this._closeToolIfDrawing(e)
                                }
                            }, {
                                key: "enabledCallback",
                                value: function(e) {
                                    this._closeToolIfDrawing(e)
                                }
                            }, {
                                key: "disabledCallback",
                                value: function(e) {
                                    this._closeToolIfDrawing(e)
                                }
                            }, {
                                key: "_closeToolIfDrawing",
                                value: function(e) {
                                    if (this._drawing) {
                                        var t = this.configuration.currentHandle;
                                        this._endDrawing(e, t), y.cornerstone.updateImage(e)
                                    }
                                }
                            }, {
                                key: "fireModifiedEvent",
                                value: function(e, t) {
                                    T(e, x.MEASUREMENT_MODIFIED, {
                                        toolName: this.name,
                                        toolType: this.name,
                                        element: e,
                                        measurementData: t
                                    })
                                }
                            }, {
                                key: "fireCompletedEvent",
                                value: function(e, t) {
                                    T(e, x.MEASUREMENT_COMPLETED, {
                                        toolName: this.name,
                                        toolType: this.name,
                                        element: e,
                                        measurementData: t
                                    })
                                }
                            }, {
                                key: "cancelDrawing",
                                value: function(e) {
                                    if (this._drawing) {
                                        var t = _(e, this.name),
                                            n = this.configuration,
                                            o = t.data[n.currentTool];
                                        o.active = !1, o.highlight = !1, o.handles.invalidHandlePlacement = !1, n.currentHandle = 0, n.currentTool = -1, o.canComplete = !1, L(e, this.name, o), this._deactivateDraw(e), y.cornerstone.updateImage(e)
                                    }
                                }
                            }, {
                                key: "newImageCallback",
                                value: function(e) {
                                    var t = this.configuration;
                                    if (this._drawing && this._activeDrawingToolReference) {
                                        var n = e.detail.element,
                                            o = this._activeDrawingToolReference;
                                        o.active = !1, o.highlight = !1, o.handles.invalidHandlePlacement = !1;
                                        var r = o.handles.points;
                                        r[t.currentHandle - 1].lines.push(r[0]), t.currentHandle = 0, t.currentTool = -1, o.canComplete = !1, this._deactivateDraw(n), y.cornerstone.updateImage(n)
                                    }
                                }
                            }, {
                                key: "spacing",
                                get: function() {
                                    return this.configuration.spacing
                                },
                                set: function(e) {
                                    if ("number" != typeof e) throw new Error("Attempting to set freehand spacing to a value other than a number.");
                                    this.configuration.spacing = e, y.cornerstone.updateImage(this.element)
                                }
                            }, {
                                key: "activeHandleRadius",
                                get: function() {
                                    return this.configuration.activeHandleRadius
                                },
                                set: function(e) {
                                    if ("number" != typeof e) throw new Error("Attempting to set freehand activeHandleRadius to a value other than a number.");
                                    this.configuration.activeHandleRadius = e, y.cornerstone.updateImage(this.element)
                                }
                            }, {
                                key: "completeHandleRadius",
                                get: function() {
                                    return this.configuration.completeHandleRadius
                                },
                                set: function(e) {
                                    if ("number" != typeof e) throw new Error("Attempting to set freehand completeHandleRadius to a value other than a number.");
                                    this.configuration.completeHandleRadius = e, y.cornerstone.updateImage(this.element)
                                }
                            }, {
                                key: "alwaysShowHandles",
                                get: function() {
                                    return this.configuration.alwaysShowHandles
                                },
                                set: function(e) {
                                    if ("boolean" != typeof e) throw new Error("Attempting to set freehand alwaysShowHandles to a value other than a boolean.");
                                    this.configuration.alwaysShowHandles = e, y.cornerstone.updateImage(this.element)
                                }
                            }, {
                                key: "invalidColor",
                                get: function() {
                                    return this.configuration.invalidColor
                                },
                                set: function(e) {
                                    this.configuration.invalidColor = e, y.cornerstone.updateImage(this.element)
                                }
                            }]), t
                        }(gr);

                    function Fi(e) {
                        e.stopImmediatePropagation(), e.stopPropagation(), e.preventDefault()
                    }
                    var Hi = B("tools:annotation:LengthTool"),
                        qi = function(e) {
                            function t() {
                                var e, n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var o = {
                                    name: "Length",
                                    supportedInteractionTypes: ["Mouse", "Touch"],
                                    svgCursor: Mr,
                                    configuration: {
                                        drawHandles: !0,
                                        drawHandlesOnHover: !1,
                                        hideHandlesIfMoving: !1,
                                        renderDashed: !1,
                                        digits: 2
                                    }
                                };
                                return (e = u()(this, h()(t).call(this, n, o))).throttledUpdateCachedStats = la(e.updateCachedStats, 110), e
                            }
                            return m()(t, e), l()(t, [{
                                key: "createNewMeasurement",
                                value: function(e) {
                                    if (e && e.currentPoints && e.currentPoints.image) {
                                        var t = e.currentPoints.image,
                                            n = t.x,
                                            o = t.y;
                                        return {
                                            visible: !0,
                                            active: !0,
                                            color: void 0,
                                            invalidated: !0,
                                            handles: {
                                                start: {
                                                    x: n,
                                                    y: o,
                                                    highlight: !0,
                                                    active: !1
                                                },
                                                end: {
                                                    x: n,
                                                    y: o,
                                                    highlight: !0,
                                                    active: !0
                                                },
                                                textBox: {
                                                    active: !1,
                                                    hasMoved: !1,
                                                    movesIndependently: !1,
                                                    drawnIndependently: !0,
                                                    allowedOutsideImage: !0,
                                                    hasBoundingBox: !0
                                                }
                                            }
                                        }
                                    }
                                    Hi.error("required eventData not supplied to tool ".concat(this.name, "'s createNewMeasurement"))
                                }
                            }, {
                                key: "pointNearTool",
                                value: function(e, t, n) {
                                    return t && t.handles && t.handles.start && t.handles.end ? !1 !== t.visible && pr(e, t.handles.start, t.handles.end, n) < 25 : (Hi.warn("invalid parameters supplied to tool ".concat(this.name, "'s pointNearTool")), !1)
                                }
                            }, {
                                key: "updateCachedStats",
                                value: function(e, t, n) {
                                    var o = aa(e),
                                        r = o.rowPixelSpacing,
                                        a = o.colPixelSpacing,
                                        i = (n.handles.end.x - n.handles.start.x) * (a || 1),
                                        s = (n.handles.end.y - n.handles.start.y) * (r || 1),
                                        l = Math.sqrt(i * i + s * s);
                                    n.length = l, n.invalidated = !1
                                }
                            }, {
                                key: "renderToolData",
                                value: function(e) {
                                    var t = this,
                                        n = e.detail,
                                        o = this.configuration,
                                        r = o.handleRadius,
                                        a = o.drawHandlesOnHover,
                                        i = o.hideHandlesIfMoving,
                                        s = o.renderDashed,
                                        l = o.digits,
                                        c = _(e.currentTarget, this.name);
                                    if (c)
                                        for (var u = Dn(n.canvasContext.canvas), d = n.image, h = n.element, f = aa(d), m = f.rowPixelSpacing, g = f.colPixelSpacing, p = Zt.getToolWidth(), v = wt("globalConfiguration").configuration.lineDash, y = function(e) {
                                                var o = c.data[e];
                                                if (!1 === o.visible) return "continue";
                                                Wt(u, (function(e) {
                                                    kn(e, t.configuration);
                                                    var c = un.getColorIfActive(o),
                                                        u = {
                                                            color: c
                                                        };
                                                    s && (u.lineDash = v), Xt(e, h, o.handles.start, o.handles.end, u);
                                                    var f = {
                                                        color: c,
                                                        handleRadius: r,
                                                        drawHandlesIfActive: a,
                                                        hideHandlesIfMoving: i
                                                    };
                                                    if (t.configuration.drawHandles && dn(e, n, o.handles, f), !o.handles.textBox.hasMoved) {
                                                        var y = {
                                                            x: Math.max(o.handles.start.x, o.handles.end.x)
                                                        };
                                                        y.x === o.handles.start.x ? y.y = o.handles.start.y : y.y = o.handles.end.y, o.handles.textBox.x = y.x, o.handles.textBox.y = y.y
                                                    }!0 === o.invalidated && (o.length ? t.throttledUpdateCachedStats(d, h, o) : t.updateCachedStats(d, h, o));
                                                    var b = function(e, t, n) {
                                                        var o, r, a = (o = e.length, r = Number(o), isNaN(r) ? void 0 : r);
                                                        if (!a) return "";
                                                        var i = "mm";
                                                        return t && n || (i = "pixels"), e.unit = i, "".concat(a.toFixed(l), " ").concat(i)
                                                    }(o, m, g);
                                                    Cn(e, h, o.handles.textBox, b, o.handles, w, c, p, 10, !0)
                                                }))
                                            }, b = 0; b < c.data.length; b++) y(b);

                                    function w(e) {
                                        var t = {
                                            x: (e.start.x + e.end.x) / 2,
                                            y: (e.start.y + e.end.y) / 2
                                        };
                                        return [e.start, t, e.end]
                                    }
                                }
                            }]), t
                        }(gr),
                        ji = function(e, t, n, o, r) {
                            if (!e) throw new Error("getRGBPixels: parameter element must not be undefined");
                            t = Math.round(t), n = Math.round(n);
                            var a, i, s, l = y.cornerstone.getEnabledElement(e),
                                c = [],
                                u = 0,
                                d = l.image.getPixelData();
                            if (l.image.color)
                                for (i = 0; i < r; i++)
                                    for (s = 0; s < o; s++) {
                                        var h = d[a = 4 * ((i + n) * l.image.columns + (s + t))],
                                            f = d[a + 1],
                                            m = d[a + 2],
                                            g = d[a + 3];
                                        c[u++] = h, c[u++] = f, c[u++] = m, c[u++] = g
                                    }
                            return c
                        },
                        zi = B("tools:annotation:ProbeTool"),
                        Wi = function(e) {
                            function t() {
                                var e, n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var o = {
                                    name: "Probe",
                                    supportedInteractionTypes: ["Mouse", "Touch"],
                                    svgCursor: Dr,
                                    configuration: {
                                        drawHandles: !0,
                                        renderDashed: !1
                                    }
                                };
                                return (e = u()(this, h()(t).call(this, n, o))).throttledUpdateCachedStats = la(e.updateCachedStats, 110), e
                            }
                            return m()(t, e), l()(t, [{
                                key: "createNewMeasurement",
                                value: function(e) {
                                    if (e && e.currentPoints && e.currentPoints.image) return {
                                        visible: !0,
                                        active: !0,
                                        color: void 0,
                                        invalidated: !0,
                                        handles: {
                                            end: {
                                                x: e.currentPoints.image.x,
                                                y: e.currentPoints.image.y,
                                                highlight: !0,
                                                active: !0
                                            }
                                        }
                                    };
                                    zi.error("required eventData not supplied to tool ".concat(this.name, "'s createNewMeasurement"))
                                }
                            }, {
                                key: "pointNearTool",
                                value: function(e, t, n) {
                                    var o = t && t.handles && t.handles.end;
                                    if (o || zi.warn("invalid parameters supplied to tool ".concat(this.name, "'s pointNearTool")), !o || !1 === t.visible) return !1;
                                    var r = y.cornerstone.pixelToCanvas(e, t.handles.end);
                                    return y.cornerstoneMath.point.distance(r, n) < 5
                                }
                            }, {
                                key: "updateCachedStats",
                                value: function(e, t, n) {
                                    var o = Math.round(n.handles.end.x),
                                        r = Math.round(n.handles.end.y),
                                        a = {};
                                    o >= 0 && r >= 0 && o < e.columns && r < e.rows && (a.x = o, a.y = r, e.color ? a.storedPixels = ji(t, o, r, 1, 1) : (a.storedPixels = y.cornerstone.getStoredPixels(t, o, r, 1, 1), a.sp = a.storedPixels[0], a.mo = a.sp * e.slope + e.intercept, a.suv = Ja(e, a.sp))), n.cachedStats = a, n.invalidated = !1
                                }
                            }, {
                                key: "renderToolData",
                                value: function(e) {
                                    var t = this,
                                        n = e.detail,
                                        o = this.configuration,
                                        r = o.handleRadius,
                                        a = o.renderDashed,
                                        i = _(e.currentTarget, this.name);
                                    if (i)
                                        for (var s = Dn(n.canvasContext.canvas), l = n.image, c = n.element, u = vn.getFontSize(), d = wt("globalConfiguration").configuration.lineDash, h = function(e) {
                                                var o = i.data[e];
                                                if (!1 === o.visible) return "continue";
                                                Wt(s, (function(e) {
                                                    var i, s, h = un.getColorIfActive(o);
                                                    if (t.configuration.drawHandles) {
                                                        var f = {
                                                            handleRadius: r,
                                                            color: h
                                                        };
                                                        a && (f.lineDash = d), dn(e, n, o.handles, f)
                                                    }!0 === o.invalidated && (o.cachedStats ? t.throttledUpdateCachedStats(l, c, o) : t.updateCachedStats(l, c, o));
                                                    var m = o.cachedStats,
                                                        g = m.x,
                                                        p = m.y,
                                                        v = m.storedPixels,
                                                        b = m.sp,
                                                        w = m.mo,
                                                        x = m.suv;
                                                    if (g >= 0 && p >= 0 && g < l.columns && p < l.rows) {
                                                        i = "".concat(g, ", ").concat(p), l.color ? s = "R: ".concat(v[0], " G: ").concat(v[1], " B: ").concat(v[2]) : (s = "SP: ".concat(b, " MO: ").concat(parseFloat(w.toFixed(3))), x && (s += " SUV: ".concat(parseFloat(x.toFixed(3)))));
                                                        var T = {
                                                                x: o.handles.end.x + 3,
                                                                y: o.handles.end.y - 3
                                                            },
                                                            I = y.cornerstone.pixelToCanvas(n.element, T);
                                                        xn(e, s, I.x, I.y + u + 5, h), xn(e, i, I.x, I.y, h)
                                                    }
                                                }))
                                            }, f = 0; f < i.data.length; f++) h(f)
                                }
                            }]), t
                        }(gr),
                        Gi = B("tools:annotation:RectangleRoiTool"),
                        Yi = function(e) {
                            function t() {
                                var e, n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var o = {
                                    name: "RectangleRoi",
                                    supportedInteractionTypes: ["Mouse", "Touch"],
                                    configuration: {
                                        drawHandles: !0,
                                        drawHandlesOnHover: !1,
                                        hideHandlesIfMoving: !1,
                                        renderDashed: !1
                                    },
                                    svgCursor: Pr
                                };
                                return (e = u()(this, h()(t).call(this, n, o))).throttledUpdateCachedStats = la(e.updateCachedStats, 110), e
                            }
                            return m()(t, e), l()(t, [{
                                key: "createNewMeasurement",
                                value: function(e) {
                                    if (e && e.currentPoints && e.currentPoints.image) return {
                                        visible: !0,
                                        active: !0,
                                        color: void 0,
                                        invalidated: !0,
                                        handles: {
                                            start: {
                                                x: e.currentPoints.image.x,
                                                y: e.currentPoints.image.y,
                                                highlight: !0,
                                                active: !1
                                            },
                                            end: {
                                                x: e.currentPoints.image.x,
                                                y: e.currentPoints.image.y,
                                                highlight: !0,
                                                active: !0
                                            },
                                            initialRotation: e.viewport.rotation,
                                            textBox: {
                                                active: !1,
                                                hasMoved: !1,
                                                movesIndependently: !1,
                                                drawnIndependently: !0,
                                                allowedOutsideImage: !0,
                                                hasBoundingBox: !0
                                            }
                                        }
                                    };
                                    Gi.error("required eventData not supplied to tool ".concat(this.name, "'s createNewMeasurement"))
                                }
                            }, {
                                key: "pointNearTool",
                                value: function(e, t, n, o) {
                                    var r = t && t.handles && t.handles.start && t.handles.end;
                                    if (r || Gi.warn("invalid parameters supplied to tool ".concat(this.name, "'s pointNearTool")), !r || !1 === t.visible) return !1;
                                    var a = "mouse" === o ? 15 : 25,
                                        i = y.cornerstone.pixelToCanvas(e, t.handles.start),
                                        s = y.cornerstone.pixelToCanvas(e, t.handles.end),
                                        l = {
                                            left: Math.min(i.x, s.x),
                                            top: Math.min(i.y, s.y),
                                            width: Math.abs(i.x - s.x),
                                            height: Math.abs(i.y - s.y)
                                        };
                                    return y.cornerstoneMath.rect.distanceToPoint(l, n) < a
                                }
                            }, {
                                key: "updateCachedStats",
                                value: function(e, t, n) {
                                    var o = (y.cornerstone.metaData.get("generalSeriesModule", e.imageId) || {}).modality,
                                        r = aa(e),
                                        a = function(e, t, n, o, r) {
                                            var a, i = Zi(n.start, n.end),
                                                s = function(e, t) {
                                                    for (var n = 0, o = 0, r = 0, a = 0, i = e ? e[0] : null, s = e ? e[0] : null, l = t.top; l < t.top + t.height; l++)
                                                        for (var c = t.left; c < t.left + t.width; c++) n += e[a], o += e[a] * e[a], i = Math.min(i, e[a]), s = Math.max(s, e[a]), r++, a++;
                                                    if (0 === r) return {
                                                        count: r,
                                                        mean: 0,
                                                        variance: 0,
                                                        stdDev: 0,
                                                        min: 0,
                                                        max: 0
                                                    };
                                                    var u = n / r,
                                                        d = o / r - u * u;
                                                    return {
                                                        count: r,
                                                        mean: u,
                                                        variance: d,
                                                        stdDev: Math.sqrt(d),
                                                        min: i,
                                                        max: s
                                                    }
                                                }(y.cornerstone.getPixels(t, i.left, i.top, i.width, i.height), i);
                                            return "PT" === o && (a = {
                                                mean: Ja(e, s.mean, !0) || 0,
                                                stdDev: Ja(e, s.stdDev, !0) || 0
                                            }), {
                                                area: i.width * (r.colPixelSpacing || 1) * (i.height * (r.rowPixelSpacing || 1)) || 0,
                                                perimeter: 2 * i.width * (r.colPixelSpacing || 1) + 2 * i.height * (r.rowPixelSpacing || 1),
                                                count: s.count || 0,
                                                mean: s.mean || 0,
                                                variance: s.variance || 0,
                                                stdDev: s.stdDev || 0,
                                                min: s.min || 0,
                                                max: s.max || 0,
                                                meanStdDevSUV: a
                                            }
                                        }(e, t, n.handles, o, r);
                                    n.cachedStats = a, n.invalidated = !1
                                }
                            }, {
                                key: "renderToolData",
                                value: function(e) {
                                    var t = this,
                                        n = _(e.currentTarget, this.name);
                                    if (n) {
                                        var o = e.detail,
                                            r = o.image,
                                            a = o.element,
                                            i = Zt.getToolWidth(),
                                            s = wt("globalConfiguration").configuration.lineDash,
                                            l = this.configuration,
                                            c = l.handleRadius,
                                            u = l.drawHandlesOnHover,
                                            d = l.hideHandlesIfMoving,
                                            h = l.renderDashed,
                                            f = Dn(o.canvasContext.canvas),
                                            m = aa(r),
                                            g = m.rowPixelSpacing,
                                            p = m.colPixelSpacing,
                                            v = (y.cornerstone.metaData.get("generalSeriesModule", r.imageId) || {}).modality,
                                            b = g && p;
                                        Wt(f, (function(e) {
                                            for (var l = 0; l < n.data.length; l++) {
                                                var f = n.data[l];
                                                if (!1 !== f.visible) {
                                                    var m = un.getColorIfActive(f),
                                                        g = {
                                                            color: m,
                                                            handleRadius: c,
                                                            drawHandlesIfActive: u,
                                                            hideHandlesIfMoving: d
                                                        };
                                                    kn(e, t.configuration);
                                                    var p = {
                                                        color: m
                                                    };
                                                    if (h && (p.lineDash = s), Mn(e, a, f.handles.start, f.handles.end, p, "pixel", f.handles.initialRotation), t.configuration.drawHandles && dn(e, o, f.handles, g), !0 === f.invalidated && (f.cachedStats ? t.throttledUpdateCachedStats(r, a, f) : t.updateCachedStats(r, a, f)), !f.handles.textBox.hasMoved) {
                                                        var y = ni(o.viewport, f.handles);
                                                        Object.assign(f.handles.textBox, y)
                                                    }
                                                    var w = Ji(e, r.color, f.cachedStats, v, b, t.configuration);
                                                    f.unit = Xi(v, t.configuration.showHounsfieldUnits), Cn(e, a, f.handles.textBox, w, f.handles, (function(e) {
                                                        return n = (t = Zi(e.start, e.end)).left, o = t.top, [{
                                                            x: n + (r = t.width) / 2,
                                                            y: o
                                                        }, {
                                                            x: n,
                                                            y: o + (a = t.height) / 2
                                                        }, {
                                                            x: n + r / 2,
                                                            y: o + a
                                                        }, {
                                                            x: n + r,
                                                            y: o + a / 2
                                                        }];
                                                        var t, n, o, r, a
                                                    }), m, i, 10, !0)
                                                }
                                            }
                                        }))
                                    }
                                }
                            }]), t
                        }(gr);

                    function Zi(e, t) {
                        return {
                            left: Math.min(e.x, t.x),
                            top: Math.min(e.y, t.y),
                            width: Math.abs(e.x - t.x),
                            height: Math.abs(e.y - t.y)
                        }
                    }

                    function Ki(e, t) {
                        var n = t ? " mm".concat(String.fromCharCode(178)) : " px".concat(String.fromCharCode(178));
                        return "Area: ".concat(oi(e.toFixed(2))).concat(n)
                    }

                    function Xi(e, t) {
                        return "CT" === e && !1 !== t ? "HU" : ""
                    }

                    function Ji(e, t) {
                        var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                            o = n.area,
                            r = void 0 === o ? 0 : o,
                            a = n.mean,
                            i = void 0 === a ? 0 : a,
                            s = n.stdDev,
                            l = void 0 === s ? 0 : s,
                            c = n.min,
                            u = void 0 === c ? 0 : c,
                            d = n.max,
                            h = void 0 === d ? 0 : d,
                            f = n.meanStdDevSUV,
                            m = void 0 === f ? 0 : f,
                            g = arguments.length > 3 ? arguments[3] : void 0,
                            p = arguments.length > 4 ? arguments[4] : void 0,
                            v = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : {},
                            y = v.showMinMax || !1,
                            b = [],
                            w = [];
                        if (!t) {
                            var x = m && 0 !== m.mean,
                                T = Xi(g, v.showHounsfieldUnits),
                                I = "Mean: ".concat(oi(i.toFixed(2)), " ").concat(T),
                                E = "Std Dev: ".concat(oi(l.toFixed(2)), " ").concat(T);
                            if (x) {
                                for (var S = " SUV: ", A = "".concat(S).concat(oi(m.mean.toFixed(2))), C = "".concat(S).concat(oi(m.stdDev.toFixed(2))), M = Math.floor(e.measureText("".concat(E, "     ")).width); e.measureText(I).width < M;) I += " ";
                                w.push("".concat(I).concat(A)), w.push("".concat(E, "     ").concat(C))
                            } else w.push("".concat(I)), w.push("".concat(E));
                            if (y) {
                                for (var D = "Min: ".concat(u, " ").concat(T), P = "Max: ".concat(h, " ").concat(T), k = x ? Math.floor(e.measureText("".concat(E, "     ")).width) : Math.floor(e.measureText("".concat(I, "     ")).width); e.measureText(D).width < k;) D += " ";
                                w.push("".concat(D).concat(P))
                            }
                        }
                        return b.push(Ki(r, p)), w.forEach((function(e) {
                            return b.push(e)
                        })), b
                    }
                    var Qi = function(e) {
                            function t() {
                                var e, n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var o = {
                                    name: "TextMarker",
                                    supportedInteractionTypes: ["Mouse", "Touch"],
                                    configuration: {
                                        markers: [],
                                        current: "",
                                        ascending: !0,
                                        loop: !1,
                                        changeTextCallback: $i
                                    },
                                    svgCursor: kr
                                };
                                return (e = u()(this, h()(t).call(this, n, o))).touchPressCallback = e._changeText.bind(Ao()(e)), e.doubleClickCallback = e._changeText.bind(Ao()(e)), e
                            }
                            return m()(t, e), l()(t, [{
                                key: "createNewMeasurement",
                                value: function(e) {
                                    var t = this.configuration;
                                    if (t.current) {
                                        var n = {
                                                visible: !0,
                                                active: !0,
                                                text: t.current,
                                                color: void 0,
                                                handles: {
                                                    end: {
                                                        x: e.currentPoints.image.x,
                                                        y: e.currentPoints.image.y,
                                                        highlight: !0,
                                                        active: !0,
                                                        hasBoundingBox: !0
                                                    }
                                                }
                                            },
                                            o = {
                                                left: 0,
                                                top: 0,
                                                width: e.image.width,
                                                height: e.image.height
                                            };
                                        if (y.cornerstoneMath.point.insideRect(n.handles.end, o)) {
                                            var r = t.markers.indexOf(t.current);
                                            return (r += t.ascending ? 1 : -1) >= t.markers.length ? r = t.loop ? 0 : -1 : r < 0 && (r = t.loop ? t.markers.length : -1), t.current = t.markers[r], n
                                        }
                                    }
                                }
                            }, {
                                key: "pointNearTool",
                                value: function(e, t, n) {
                                    if (!1 === t.visible) return !1;
                                    if (t.handles.end.boundingBox) {
                                        var o = y.cornerstoneMath.rect.distanceToPoint(t.handles.end.boundingBox, n),
                                            r = po(t.handles.end, n);
                                        return o < 10 || r
                                    }
                                }
                            }, {
                                key: "updateCachedStats",
                                value: function() {}
                            }, {
                                key: "renderToolData",
                                value: function(e) {
                                    var t = e.detail,
                                        n = this.configuration,
                                        o = _(t.element, this.name);
                                    if (o)
                                        for (var r = Dn(t.canvasContext.canvas), a = function(e) {
                                                var a = o.data[e];
                                                if (!1 === a.visible) return "continue";
                                                var i = un.getColorIfActive(a);
                                                Wt(r, (function(e) {
                                                    kn(e, n);
                                                    var o = y.cornerstone.pixelToCanvas(t.element, a.handles.end);
                                                    a.handles.end.boundingBox = xn(e, a.text, o.x, o.y - 10, i, {
                                                        centering: {
                                                            x: !0,
                                                            y: !0
                                                        }
                                                    })
                                                }))
                                            }, i = 0; i < o.data.length; i++) a(i)
                                }
                            }, {
                                key: "_changeText",
                                value: function(e) {
                                    var t, n = e.detail,
                                        o = n.element,
                                        r = n.currentPoints;

                                    function a(e, t, n) {
                                        !0 === n ? L(o, this.name, e) : e.text = t, e.active = !1, y.cornerstone.updateImage(o)
                                    }
                                    var i = this.configuration,
                                        s = r.canvas,
                                        l = _(o, this.name);
                                    if (l)
                                        for (var c = 0; c < l.data.length; c++)
                                            if (t = l.data[c], this.pointNearTool(o, t, s)) return t.active = !0, y.cornerstone.updateImage(o), i.changeTextCallback(t, n, a), e.stopImmediatePropagation(), e.preventDefault(), void e.stopPropagation()
                                }
                            }]), t
                        }(gr),
                        $i = function(e, t, n) {
                            n(e, prompt("Change your annotation:"))
                        },
                        es = (B("tools:BrushTool"), wt("segmentation")),
                        ts = function(e) {
                            function t() {
                                var e, n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var o = {
                                    name: "Brush",
                                    supportedInteractionTypes: ["Mouse", "Touch"],
                                    configuration: {},
                                    mixins: ["renderBrushMixin"]
                                };
                                return (e = u()(this, h()(t).call(this, n, o))).touchDragCallback = e._paint.bind(Ao()(e)), e
                            }
                            return m()(t, e), l()(t, [{
                                key: "_paint",
                                value: function(e) {
                                    var t = es.configuration,
                                        n = e.detail,
                                        o = (n.element, n.image),
                                        r = o.rows,
                                        a = o.columns,
                                        i = n.currentPoints.image,
                                        s = i.x,
                                        l = i.y;
                                    if (!(s < 0 || s > a || l < 0 || l > r)) {
                                        var c = xe(t.radius, r, a, s, l),
                                            u = this.paintEventData,
                                            d = u.labelmap2D,
                                            h = u.labelmap3D,
                                            f = u.shouldErase;
                                        te(c, d.pixelData, h.activeSegmentIndex, a, f), y.cornerstone.updateImage(e.detail.element)
                                    }
                                }
                            }]), t
                        }(Do),
                        ns = B("tools:SphericalBrushTool"),
                        os = wt("segmentation"),
                        rs = function(e) {
                            function t() {
                                var e, n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var o = {
                                    name: "SphericalBrush",
                                    supportedInteractionTypes: ["Mouse", "Touch"],
                                    configuration: {
                                        alwaysEraseOnClick: !1
                                    },
                                    mixins: ["renderBrushMixin"]
                                };
                                return (e = u()(this, h()(t).call(this, n, o))).touchDragCallback = e._paint.bind(Ao()(e)), e
                            }
                            return m()(t, e), l()(t, [{
                                key: "_startPainting",
                                value: function(e) {
                                    var t, n = os.configuration,
                                        o = os.getters,
                                        r = e.detail,
                                        a = r.element,
                                        i = r.image,
                                        s = y.cornerstone,
                                        l = n.radius,
                                        c = i.rows,
                                        u = i.columns,
                                        d = Math.max(i.rowPixelSpacing, i.columnPixelSpacing),
                                        h = _(a, "stack").data[0].imageIds,
                                        f = o.labelmap2D(a),
                                        m = f.labelmap2D,
                                        g = f.labelmap3D,
                                        p = f.currentImageIdIndex,
                                        v = f.activeLabelmapIndex,
                                        b = this._isCtrlDown(r) || this.configuration.alwaysEraseOnClick,
                                        w = s.metaData.get("imagePlaneModule", i.imageId);
                                    if (w) {
                                        var x = w.imagePositionPatient;
                                        t = this._getImagesInRange(p, x, h, l, d)
                                    } else ns.warn("No imagePlane metadata found for image, defaulting to circle brush application."), t = [{
                                        imageIdIndex: p,
                                        radiusOnImage: l
                                    }];
                                    if (this.paintEventData = {
                                            labelmap2D: m,
                                            labelmap3D: g,
                                            currentImageIdIndex: p,
                                            activeLabelmapIndex: v,
                                            shouldErase: b,
                                            imagesInRange: t
                                        }, n.storeHistory) {
                                        for (var T = [], I = 0; I < t.length; I++) {
                                            var E = t[I].imageIdIndex,
                                                S = o.labelmap2DByImageIdIndex(g, E, c, u).pixelData.slice();
                                            T.push(S)
                                        }
                                        this.paintEventData.previousPixeldataForImagesInRange = T
                                    }
                                }
                            }, {
                                key: "_paint",
                                value: function(e) {
                                    var t = os.getters,
                                        n = e.detail,
                                        o = (n.element, n.image),
                                        r = o.rows,
                                        a = o.columns,
                                        i = n.currentPoints.image,
                                        s = i.x,
                                        l = i.y;
                                    if (!(s < 0 || s > a || l < 0 || l > r)) {
                                        for (var c = this.paintEventData, u = c.labelmap3D, d = c.imagesInRange, h = c.shouldErase, f = 0; f < d.length; f++) {
                                            var m = d[f],
                                                g = m.imageIdIndex;
                                            te(xe(m.radiusOnImage, r, a, s, l), t.labelmap2DByImageIdIndex(u, g, r, a).pixelData, u.activeSegmentIndex, a, h)
                                        }
                                        y.cornerstone.updateImage(e.detail.element)
                                    }
                                }
                            }, {
                                key: "_getImagesInRange",
                                value: function(e, t, n, o, r) {
                                    for (var a = o * r, i = [{
                                            imageIdIndex: e,
                                            radiusOnImage: o
                                        }], s = e + 1; s < n.length; s++) {
                                        var l = this._getRadiusOnImage(n[s], t, a, r);
                                        if (!l) break;
                                        i.push({
                                            imageIdIndex: s,
                                            radiusOnImage: l
                                        })
                                    }
                                    for (var c = e - 1; c >= 0; c--) {
                                        var u = this._getRadiusOnImage(n[c], t, a, r);
                                        if (!u) break;
                                        i.push({
                                            imageIdIndex: c,
                                            radiusOnImage: u
                                        })
                                    }
                                    return i
                                }
                            }, {
                                key: "_getRadiusOnImage",
                                value: function(e, t, n, o) {
                                    var r = y.cornerstone.metaData.get("imagePlaneModule", e);
                                    if (r) {
                                        var a = r.imagePositionPatient,
                                            i = Math.sqrt(Math.pow(a[0] - t[0], 2) + Math.pow(a[1] - t[1], 2) + Math.pow(a[2] - t[2], 2));
                                        if (!(i > n)) return Math.floor(Math.sqrt(Math.pow(n, 2) - Math.pow(i, 2)) / o)
                                    } else ns.warn("Can't find imagePlane metadata for image, cancelling spherical brushing on: ".concat(e, ","))
                                }
                            }, {
                                key: "_endPainting",
                                value: function(e) {
                                    for (var t = this.paintEventData, n = t.labelmap3D, o = t.imagesInRange, r = [], a = os.configuration, i = os.setters, s = 0; s < o.length; s++) {
                                        for (var l = o[s].imageIdIndex, c = n.labelmaps2D[l], u = new Set(c.pixelData).values(), d = [], h = !1; !h;) {
                                            var f = u.next();
                                            (h = f.done) || d.push(f.value)
                                        }
                                        if (c.segmentsOnLabelmap = d, a.storeHistory) {
                                            var m = this.paintEventData.previousPixeldataForImagesInRange[s],
                                                g = n.labelmaps2D[l].pixelData;
                                            r.push({
                                                imageIdIndex: l,
                                                diff: Le(m, g)
                                            })
                                        }
                                    }
                                    a.storeHistory && i.pushState(this.element, r), _e(this.element)
                                }
                            }]), t
                        }(Do),
                        as = B("util:segmentation:operations:correction");

                    function is(e, t) {
                        var n = t.pixelData,
                            o = t.segmentIndex,
                            r = t.segmentationMixinType;
                        if ("freehandSegmentationMixin" === r) {
                            var a = function(e, t) {
                                    for (var n = t.pixelData, o = t.points, r = e.detail.image, a = r.width, i = r.height, s = [], l = 0; l < o.length; l++) {
                                        var c = o[l],
                                            u = Math.floor(c.x),
                                            d = Math.floor(c.y);
                                        u = An(u, 0, a - 1), d = An(d, 0, i - 1);
                                        var h = s[s.length - 1];
                                        h && u === h.x && d === h.y || s.push({
                                            x: u,
                                            y: d,
                                            segment: n[d * a + u]
                                        })
                                    }
                                    return s
                                }(e, t),
                                i = function(e, t) {
                                    for (var n = !0, o = !0, r = 0; r < e.length && (e[r].segment === t ? o = !1 : n = !1, n || o); r++);
                                    return o ? {
                                        isScissorOperation: !0,
                                        operation: "fillInsideFreehand"
                                    } : n ? {
                                        isScissorOperation: !0,
                                        operation: "eraseInsideFreehand"
                                    } : {
                                        isScissorOperation: !1
                                    }
                                }(a, o);
                            if (i.isScissorOperation) "fillInsideFreehand" === i.operation ? (as.warn("The line never intersects a segment."), xs(e, t)) : "eraseInsideFreehand" === i.operation && (as.warn("The line is only ever inside the segment."), fs(e, t));
                            else {
                                var s = new Uint8Array(n.length);
                                (function(e, t) {
                                    var n = e[0].segment === t,
                                        o = [];
                                    o.push({
                                        additive: !n,
                                        nodes: []
                                    });
                                    for (var r = 0, a = 0; a < e.length; a++) {
                                        var i = e[a];
                                        n ? (o[r].nodes.push(i), i.segment !== t && (r++, n = !n, o.push({
                                            additive: !0,
                                            nodes: []
                                        }), o[r].nodes.push(e[a - 1]), o[r].nodes.push(i))) : (o[r].nodes.push(i), i.segment === t && (r++, n = !n, o.push({
                                            additive: !1,
                                            nodes: []
                                        }), o[r].nodes.push(e[a - 1]), o[r].nodes.push(i)))
                                    }
                                    return o.pop(), o.shift(), o
                                })(a, o).forEach((function(t) {
                                    ! function(e, t, n, o, r) {
                                        var a = r.detail.image,
                                            i = a.width,
                                            s = a.height,
                                            l = e.nodes,
                                            c = e.additive,
                                            u = c ? 0 : 1,
                                            d = function(e) {
                                                return e.y * i + e.x
                                            },
                                            h = function(e) {
                                                return {
                                                    x: e % i,
                                                    y: Math.floor(e / i)
                                                }
                                            };
                                        c ? as.warn("additive operation...") : as.warn("subtractive operation...");
                                        for (var f = function(e) {
                                                for (var t = [], n = 0; n < e.length - 1; n++) t.push(e[n]), t.push.apply(t, Q()(Ee(e[n], e[n + 1])));
                                                t.push[e[e.length - 1]];
                                                for (var o = [], r = [], a = 0; a < t.length - 1; a++) {
                                                    var i = cs(t[a], t[a + 1]),
                                                        s = i.left,
                                                        l = i.right;
                                                    o.push(s), r.push(l)
                                                }
                                                return {
                                                    pixelPath: t,
                                                    leftPath: o,
                                                    rightPath: r
                                                }
                                            }(l), m = f.pixelPath, g = f.leftPath, p = f.rightPath, v = m[0], y = {
                                                xMin: v.x,
                                                xMax: v.x,
                                                yMin: v.y,
                                                yMax: v.y
                                            }, b = 0; b < n.length; b++) t[b] === o ? (ss(y, h(b)), n[b] = 1) : n[b] = 0;
                                        for (var w = 0; w < m.length; w++) {
                                            var x = m[w];
                                            n[d(x)] = 2, ss(y, x)
                                        }! function(e, t, n) {
                                            e.xMax = Math.min(e.xMax + 2, n), e.xMin = Math.max(e.xMin - 2, 0), e.yMax = Math.min(e.yMax + 2, t), e.yMin = Math.max(e.yMin - 2, 0)
                                        }(y, s, i);
                                        var T = y.xMin,
                                            I = y.xMax,
                                            E = y.yMin,
                                            S = y.yMax;

                                        function A(e, t) {
                                            if (!(e >= I || e < T || t >= S || t < E)) return n[t * i + e]
                                        }
                                        for (var C = 0, M = 0, D = 0; D < g.length; D++) {
                                            var P = g[D];
                                            n[d(P)] === u && Ge(P, s, i) && (C += ls(P, 3, n, A, i));
                                            var k = p[D];
                                            n[d(k)] === u && Ge(k, s, i) && (M += ls(k, 4, n, A, i))
                                        }
                                        if (0 !== C && 0 !== M) {
                                            for (var _ = c ? o : 0, L = C < M ? 3 : 4, O = 0; O < n.length; O++) n[O] === L && (t[O] = _);
                                            if (_ === o)
                                                for (var R = 0; R < m.length; R++) t[d(m[R])] = o;
                                            else
                                                for (var N = 0; N < m.length; N++) {
                                                    var U = d(m[N]);
                                                    t[U] === o && (t[U] = 0)
                                                }
                                        }
                                    }(t, n, s, o, e)
                                }))
                            }
                        } else as.error("correction operation requires freehandSegmentationMixin operationData, recieved ".concat(r))
                    }

                    function ss(e, t) {
                        var n = t.x,
                            o = t.y;
                        n < e.xMin && (e.xMin = n), n > e.xMax && (e.xMax = n), o < e.yMin && (e.yMin = o), o > e.yMax && (e.yMax = o)
                    }

                    function ls(e, t, n, o, r) {
                        for (var a = me(o, [e.x, e.y]).flooded, i = 0; i < a.length; i++) {
                            var s = a[i];
                            n[s[1] * r + s[0]] = t
                        }
                        return a.length
                    }

                    function cs(e, t) {
                        var n = {
                            x: t.x - e.x,
                            y: t.y - e.y
                        };
                        return -1 === n.x && 1 === n.y ? {
                            left: {
                                x: e.x - 1,
                                y: e.y - 1
                            },
                            right: {
                                x: e.x + 1,
                                y: e.y + 1
                            }
                        } : 0 === n.x && 1 === n.y ? {
                            left: {
                                x: e.x - 1,
                                y: e.y
                            },
                            right: {
                                x: e.x + 1,
                                y: e.y
                            }
                        } : 1 === n.x && 1 === n.y ? {
                            left: {
                                x: e.x - 1,
                                y: e.y + 1
                            },
                            right: {
                                x: e.x + 1,
                                y: e.y - 1
                            }
                        } : 1 === n.x && 0 === n.y ? {
                            left: {
                                x: e.x,
                                y: e.y + 1
                            },
                            right: {
                                x: e.x,
                                y: e.y - 1
                            }
                        } : 1 === n.x && -1 === n.y ? {
                            left: {
                                x: e.x + 1,
                                y: e.y + 1
                            },
                            right: {
                                x: e.x - 1,
                                y: e.y - 1
                            }
                        } : 0 === n.x && -1 === n.y ? {
                            left: {
                                x: e.x + 1,
                                y: e.y
                            },
                            right: {
                                x: e.x - 1,
                                y: e.y
                            }
                        } : -1 === n.x && -1 === n.y ? {
                            left: {
                                x: e.x + 1,
                                y: e.y - 1
                            },
                            right: {
                                x: e.x - 1,
                                y: e.y + 1
                            }
                        } : -1 === n.x && 0 === n.y ? {
                            left: {
                                x: e.x,
                                y: e.y - 1
                            },
                            right: {
                                x: e.x,
                                y: e.y + 1
                            }
                        } : void as.error("Unable to find left and right paths for flood fill ", e, t, n)
                    }

                    function us(e, t) {
                        for (var n = e[0], o = e[1], r = !1, a = 0, i = t.length - 1; a < t.length; i = a++) {
                            var s = t[a][0],
                                l = t[a][1],
                                c = t[i][0],
                                u = t[i][1];
                            l > o != u > o && n < (c - s) * (o - l) / (u - l) + s && (r = !r)
                        }
                        return r
                    }
                    var ds = B("util:segmentation:operations:eraseInsideFreehand");

                    function hs(e, t) {
                        var n = !(arguments.length > 2 && void 0 !== arguments[2]) || arguments[2],
                            o = t.points,
                            r = t.segmentationMixinType;
                        if ("freehandSegmentationMixin" === r) {
                            var a = e.detail.image,
                                i = o.map((function(e) {
                                    return [e.x, e.y]
                                })),
                                s = we(i, a),
                                l = re()(s, 2),
                                c = l[0],
                                u = l[1];
                            n ? se(e, t, (function(e) {
                                return us([e.x, e.y], i)
                            }), c, u) : le(e, t, (function(e) {
                                return us([e.x, e.y], i)
                            }), c, u)
                        } else ds.error("eraseInsideFreehand operation requires freehandSegmentationMixin operationData, recieved ".concat(r))
                    }

                    function fs(e, t) {
                        hs(e, t, !0)
                    }

                    function ms(e, t) {
                        hs(e, t, !1)
                    }
                    var gs = B("util:segmentation:operations:eraseInsideRectangle");

                    function ps(e, t) {
                        var n = !(arguments.length > 2 && void 0 !== arguments[2]) || arguments[2],
                            o = t.points,
                            r = t.segmentationMixinType;
                        if ("rectangleSegmentationMixin" === r) {
                            var a = e.detail.image,
                                i = o.map((function(e) {
                                    return [e.x, e.y]
                                })),
                                s = we(i, a),
                                l = re()(s, 2),
                                c = l[0],
                                u = l[1];
                            n ? se(e, t, (function() {
                                return !0
                            }), c, u) : ne(e, t, c, u)
                        } else gs.error("eraseInsideRectangle operation requires rectangleSegmentationMixin operationData, recieved ".concat(r))
                    }

                    function vs(e, t) {
                        ps(e, t, !0)
                    }

                    function ys(e, t) {
                        ps(e, t, !1)
                    }
                    var bs = B("util:segmentation:operations:fillInsideFreehand");

                    function ws(e, t) {
                        var n = !(arguments.length > 2 && void 0 !== arguments[2]) || arguments[2],
                            o = t.points,
                            r = t.segmentationMixinType;
                        if ("freehandSegmentationMixin" === r) {
                            var a = e.detail.image,
                                i = o.map((function(e) {
                                    return [e.x, e.y]
                                })),
                                s = we(i, a),
                                l = re()(s, 2),
                                c = l[0],
                                u = l[1];
                            n ? he(e, t, (function(e) {
                                return us([e.x, e.y], i)
                            }), c, u) : fe(e, t, (function(e) {
                                return us([e.x, e.y], i)
                            }), c, u)
                        } else bs.error("eraseInsideFreehand operation requires freehandSegmentationMixin operationData, recieved ".concat(r))
                    }

                    function xs(e, t) {
                        ws(e, t, !0)
                    }

                    function Ts(e, t) {
                        ws(e, t, !1)
                    }
                    var Is = B("util:segmentation:operations:fillInsideRectangle");

                    function Es(e, t) {
                        var n = !(arguments.length > 2 && void 0 !== arguments[2]) || arguments[2],
                            o = t.points,
                            r = t.segmentationMixinType;
                        if ("rectangleSegmentationMixin" === r) {
                            var a = e.detail.image,
                                i = o.map((function(e) {
                                    return [e.x, e.y]
                                })),
                                s = we(i, a),
                                l = re()(s, 2),
                                c = l[0],
                                u = l[1];
                            n ? he(e, t, (function() {
                                return !0
                            }), c, u) : ce(e, t, c, u)
                        } else Is.error("eraseInsideRectangle operation requires rectangleSegmentationMixin operationData, recieved ".concat(r))
                    }

                    function Ss(e, t) {
                        Es(e, t, !0)
                    }

                    function As(e, t) {
                        Es(e, t, !1)
                    }
                    var Cs = B("util:segmentation:operations:fillCircle");

                    function Ms(e, t) {
                        var n = !(arguments.length > 2 && void 0 !== arguments[2]) || arguments[2],
                            o = t.segmentationMixinType;
                        if ("circleSegmentationMixin" === o) {
                            var r = e.detail,
                                a = be(e),
                                i = re()(a, 2),
                                s = i[0],
                                l = i[1],
                                c = ye(r.handles.start, r.handles.end);
                            n ? he(e, t, (function(e) {
                                return $a(c, e)
                            }), s, l) : fe(e, t, (function(e) {
                                return $a(c, e)
                            }), s, l)
                        } else Cs.error("fillInsideCircle operation requires circleSegmentationMixin operationData, recieved ".concat(o))
                    }

                    function Ds(e, t) {
                        Ms(e, t, !0)
                    }

                    function Ps(e, t) {
                        Ms(e, t, !1)
                    }
                    var ks = B("util:segmentation:operations:eraseInsideCircle");

                    function _s(e, t) {
                        var n = !(arguments.length > 2 && void 0 !== arguments[2]) || arguments[2],
                            o = t.segmentationMixinType;
                        if ("circleSegmentationMixin" === o) {
                            var r = e.detail,
                                a = be(e),
                                i = re()(a, 2),
                                s = i[0],
                                l = i[1],
                                c = ye(r.handles.start, r.handles.end);
                            n ? se(e, t, (function(e) {
                                return $a(c, e)
                            }), s, l) : le(e, t, (function(e) {
                                return $a(c, e)
                            }), s, l)
                        } else ks.error("eraseInsideCircle operation requires circleSegmentationMixin operationData, recieved ".concat(o))
                    }

                    function Ls(e, t) {
                        _s(e, t, !0)
                    }

                    function Os(e, t) {
                        _s(e, t, !1)
                    }
                    var Rs = function(e) {
                            function t() {
                                var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var n = {
                                    name: "FreehandScissors",
                                    strategies: {
                                        FILL_INSIDE: xs,
                                        FILL_OUTSIDE: Ts,
                                        ERASE_OUTSIDE: ms,
                                        ERASE_INSIDE: fs
                                    },
                                    cursors: {
                                        FILL_INSIDE: Zr,
                                        FILL_OUTSIDE: Xr,
                                        ERASE_OUTSIDE: Kr,
                                        ERASE_INSIDE: Yr
                                    },
                                    defaultStrategy: "FILL_INSIDE",
                                    supportedInteractionTypes: ["Mouse", "Touch"],
                                    svgCursor: Zr,
                                    mixins: ["freehandSegmentationMixin"]
                                };
                                return u()(this, h()(t).call(this, e, n))
                            }
                            return m()(t, e), t
                        }(go),
                        Ns = function(e) {
                            function t() {
                                var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var n = {
                                    name: "RectangleScissors",
                                    strategies: {
                                        FILL_INSIDE: Ss,
                                        FILL_OUTSIDE: As,
                                        ERASE_OUTSIDE: ys,
                                        ERASE_INSIDE: vs
                                    },
                                    cursors: {
                                        FILL_INSIDE: Qr,
                                        FILL_OUTSIDE: ea,
                                        ERASE_OUTSIDE: $r,
                                        ERASE_INSIDE: Jr
                                    },
                                    defaultStrategy: "FILL_INSIDE",
                                    supportedInteractionTypes: ["Mouse", "Touch"],
                                    mixins: ["rectangleSegmentationMixin"]
                                };
                                return u()(this, h()(t).call(this, e, n))
                            }
                            return m()(t, e), t
                        }(go),
                        Us = function(e) {
                            function t() {
                                var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var n = {
                                    name: "CircleScissors",
                                    strategies: {
                                        FILL_INSIDE: Ds,
                                        FILL_OUTSIDE: Ps,
                                        ERASE_OUTSIDE: Os,
                                        ERASE_INSIDE: Ls
                                    },
                                    cursors: {
                                        FILL_INSIDE: na,
                                        FILL_OUTSIDE: ra,
                                        ERASE_OUTSIDE: oa,
                                        ERASE_INSIDE: ta
                                    },
                                    defaultStrategy: "FILL_INSIDE",
                                    supportedInteractionTypes: ["Mouse", "Touch"],
                                    svgCursor: na,
                                    mixins: ["circleSegmentationMixin"]
                                };
                                return u()(this, h()(t).call(this, e, n))
                            }
                            return m()(t, e), t
                        }(go),
                        Bs = function(e) {
                            function t() {
                                var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var n = {
                                    name: "CorrectionScissors",
                                    strategies: {
                                        CORRECTION: is
                                    },
                                    cursors: {
                                        CORRECTION: Zr
                                    },
                                    defaultStrategy: "CORRECTION",
                                    supportedInteractionTypes: ["Mouse", "Touch"],
                                    svgCursor: Zr,
                                    mixins: ["polylineSegmentationMixin"]
                                };
                                return u()(this, h()(t).call(this, e, n))
                            }
                            return m()(t, e), t
                        }(go),
                        Vs = {},
                        Fs = {},
                        Hs = {};

                    function qs(e) {
                        if (!e) return "DEFAULT";
                        var t = y.cornerstone.getEnabledElement(e).uuid;
                        if (!t) throw new Error("Something went wrong when getting uuid from element");
                        return t
                    }
                    var js = {
                            setStartLoadHandler: function(e) {
                                var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : void 0;
                                if (!e) throw new Error("The Handler function must be defined");
                                var n = qs(t);
                                Vs[n] = e
                            },
                            getStartLoadHandler: function(e) {
                                var t = qs(e);
                                return Vs[t] || Vs.DEFAULT
                            },
                            setEndLoadHandler: function(e) {
                                var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : void 0;
                                if (!e) throw new Error("The Handler function must be defined");
                                var n = qs(t);
                                Fs[n] = e
                            },
                            getEndLoadHandler: function(e) {
                                var t = qs(e);
                                return Fs[t] || Fs.DEFAULT
                            },
                            setErrorLoadingHandler: function(e) {
                                var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : void 0;
                                if (!e) throw new Error("The Handler function must be defined");
                                var n = qs(t);
                                Hs[n] = e
                            },
                            getErrorLoadingHandler: function(e) {
                                var t = qs(e);
                                return Hs[t] || Hs.DEFAULT
                            },
                            removeHandlers: function(e) {
                                var t = qs(e);
                                delete Vs[t], delete Fs[t], delete Hs[t]
                            }
                        },
                        zs = {};

                    function Ws(e, t) {
                        if (!zs[e]) return {};
                        var n = zs[e].find((function(e) {
                            return e.element === t
                        }));
                        return n ? n.options : {}
                    }

                    function Gs(e, t, n) {
                        if (zs[e]) {
                            var o = zs[e].findIndex((function(e) {
                                return e.element === t
                            }));
                            if (-1 === o) zs[e].push({
                                element: t,
                                options: n
                            });
                            else {
                                var r = zs[e][o].options || {};
                                zs[e][o].options = Object.assign(r, n)
                            }
                        } else zs[e] = [{
                            element: t,
                            options: n
                        }]
                    }
                    var Ys = function(e) {
                            function t() {
                                var e, n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var o = {
                                    name: "Crosshairs",
                                    supportedInteractionTypes: ["Mouse", "Touch"],
                                    svgCursor: _r
                                };
                                return (e = u()(this, h()(t).call(this, n, o))).preMouseDownCallback = e._chooseLocation.bind(Ao()(e)), e.mouseDragCallback = e._chooseLocation.bind(Ao()(e)), e.touchDragCallback = e._chooseLocation.bind(Ao()(e)), e
                            }
                            return m()(t, e), l()(t, [{
                                key: "_chooseLocation",
                                value: function(e) {
                                    var t = e.detail,
                                        n = t.element;
                                    e.stopImmediatePropagation();
                                    var o = _(n, this.name);
                                    if (o) {
                                        var r = n,
                                            a = y.cornerstone.getEnabledElement(r).image.imageId,
                                            i = y.cornerstone.metaData.get("imagePlaneModule", a);
                                        if (i) {
                                            var s = nn(t.currentPoints.image, i);
                                            o.data[0].synchronizationContext.getSourceElements().forEach((function(e) {
                                                if (e !== r) {
                                                    var t = Number.MAX_VALUE,
                                                        n = -1,
                                                        o = _(e, "stack");
                                                    if (void 0 !== o) {
                                                        var a = o.data[0];
                                                        if (a.imageIds.forEach((function(e, o) {
                                                                var r = y.cornerstone.metaData.get("imagePlaneModule", e);
                                                                if (r && r.imagePositionPatient && r.rowCosines && r.columnCosines) {
                                                                    var a = en(r.imagePositionPatient),
                                                                        i = en(r.rowCosines),
                                                                        l = en(r.columnCosines).clone().cross(i.clone()),
                                                                        c = Math.abs(l.clone().dot(a) - l.clone().dot(s));
                                                                    c < t && (t = c, n = o)
                                                                }
                                                            })), n !== a.currentImageIdIndex && -1 !== n && void 0 !== a.imageIds[n]) {
                                                            var i = js.getStartLoadHandler(e),
                                                                l = js.getEndLoadHandler(e),
                                                                c = js.getErrorLoadingHandler(e);
                                                            i && i(e), (!0 === a.preventCache ? y.cornerstone.loadImage(a.imageIds[n]) : y.cornerstone.loadAndCacheImage(a.imageIds[n])).then((function(t) {
                                                                var o = y.cornerstone.getViewport(e);
                                                                a.currentImageIdIndex = n, y.cornerstone.displayImage(e, t, o), l && l(e, t)
                                                            }), (function(t) {
                                                                var o = a.imageIds[n];
                                                                c && c(e, o, t)
                                                            }))
                                                        }
                                                    }
                                                }
                                            }))
                                        }
                                    }
                                }
                            }, {
                                key: "activeCallback",
                                value: function(e, t) {
                                    var n = t.mouseButtonMask,
                                        o = t.synchronizationContext;
                                    Gs(this.name, e, {
                                        mouseButtonMask: n
                                    }), O(e, this.name), k(e, this.name, {
                                        synchronizationContext: o
                                    })
                                }
                            }]), t
                        }(go),
                        Zs = function(e) {
                            function t() {
                                var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var n = {
                                    name: "DoubleTapFitToWindow",
                                    supportedInteractionTypes: ["DoubleTap"]
                                };
                                return u()(this, h()(t).call(this, e, n))
                            }
                            return m()(t, e), l()(t, [{
                                key: "doubleTapCallback",
                                value: function(e) {
                                    var t = e.detail;
                                    y.cornerstone.fitToWindow(t.element)
                                }
                            }]), t
                        }(go),
                        Ks = function(e) {
                            function t() {
                                var e, n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var o = {
                                    name: "DragProbe",
                                    strategies: {
                                        default: Xs,
                                        minimal: Js
                                    },
                                    defaultStrategy: "default",
                                    supportedInteractionTypes: ["Mouse", "Touch"],
                                    svgCursor: Dr
                                };
                                return (e = u()(this, h()(t).call(this, n, o))).touchDragCallback = e._movingEventCallback.bind(Ao()(e)), e.touchEndCallback = e._endMovingEventCallback.bind(Ao()(e)), e.mouseDragCallback = e._movingEventCallback.bind(Ao()(e)), e.mouseUpCallback = e._endMovingEventCallback.bind(Ao()(e)), e.dragEventData = {}, e
                            }
                            return m()(t, e), l()(t, [{
                                key: "_movingEventCallback",
                                value: function(e) {
                                    var t = e.detail,
                                        n = t.element;
                                    this.dragEventData = t, y.cornerstone.updateImage(n)
                                }
                            }, {
                                key: "_endMovingEventCallback",
                                value: function(e) {
                                    var t = e.detail.element;
                                    this.dragEventData = {}, y.cornerstone.updateImage(t)
                                }
                            }, {
                                key: "renderToolData",
                                value: function(e) {
                                    this.dragEventData.currentPoints && e && e.detail && Boolean(Object.keys(this.dragEventData.currentPoints).length) && (e.detail.currentPoints = this.dragEventData.currentPoints, this.applyActiveStrategy(e))
                                }
                            }]), t
                        }(go);

                    function Xs(e) {
                        var t = this.configuration,
                            n = y.cornerstone,
                            o = e.detail,
                            r = o.element,
                            a = o.image,
                            i = o.currentPoints,
                            s = o.canvasContext,
                            l = Dn(s.canvas),
                            c = un.getActiveColor(),
                            u = vn.getFontSize(),
                            d = Math.round(i.image.x),
                            h = Math.round(i.image.y);
                        d < 0 || h < 0 || d >= a.columns || h >= a.rows || Wt(l, (function(e) {
                            kn(e, t);
                            var o, s, l = "".concat(d, ", ").concat(h);
                            if (a.color) o = ji(r, d, h, 1, 1), s = "R: ".concat(o[0], " G: ").concat(o[1], " B: ").concat(o[2], " A: ").concat(o[3]);
                            else {
                                var f = (o = n.getStoredPixels(r, d, h, 1, 1))[0],
                                    m = f * a.slope + a.intercept,
                                    g = Ja(a, f);
                                s = "SP: ".concat(f, " MO: ").concat(parseFloat(m.toFixed(3))), g && (s += " SUV: ".concat(parseFloat(g.toFixed(3))))
                            }
                            var p = {
                                x: i.canvas.x + 5,
                                y: i.canvas.y - 5
                            };
                            xn(e, s, p.x, p.y + u + 5, c), xn(e, l, p.x, p.y, c)
                        }))
                    }

                    function Js(e) {
                        var t = this.configuration,
                            n = y.cornerstone,
                            o = e.detail,
                            r = o.element,
                            a = o.image,
                            i = o.currentPoints,
                            s = o.canvasContext,
                            l = o.isTouchEvent,
                            c = Dn(s.canvas),
                            u = un.getActiveColor(),
                            d = i.page.y - vn.getFontSize() / 2;
                        l && (d = i.page.y - 4 * vn.getFontSize());
                        var h = n.pageToPixel(r, i.page.x, d);
                        h.x < 0 || h.y < 0 || h.x >= a.columns || h.y >= a.rows || Wt(c, (function(e) {
                            kn(e, t);
                            var o, i = n.metaData.get("generalSeriesModule", a.imageId),
                                s = i && i.modality,
                                c = "";
                            if (a.color) o = ji(r, h.x, h.y, 1, 1), c = "R: ".concat(o[0], " G: ").concat(o[1], " B: ").concat(o[2]);
                            else {
                                var d = (o = n.getStoredPixels(r, h.x, h.y, 1, 1))[0],
                                    f = d * a.slope + a.intercept,
                                    m = parseFloat(f.toFixed(2));
                                if ("CT" === s) c += "HU: ".concat(m);
                                else if ("PT" === s) {
                                    c += m;
                                    var g = Ja(a, d);
                                    g && (c += " SUV: ".concat(parseFloat(g.toFixed(2))))
                                } else c += m
                            }
                            var p = n.pixelToCanvas(r, h),
                                v = {
                                    x: 12,
                                    y: -(vn.getFontSize() + 10) / 2
                                },
                                y = wn(e, c, 5);
                            l && (v = {
                                x: -y / 2,
                                y: -vn.getFontSize() - 10 - 12
                            }), $t(e, r, p, 6, {
                                color: u
                            }, "canvas"), xn(e, c, p.x + v.x, p.y + v.y, u)
                        }))
                    }
                    var Qs = function(e) {
                            function t() {
                                var e, n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var o = {
                                    name: "Eraser",
                                    supportedInteractionTypes: ["Mouse", "Touch"],
                                    svgCursor: Lr
                                };
                                return (e = u()(this, h()(t).call(this, n, o))).preMouseDownCallback = e._deleteAllNearbyTools.bind(Ao()(e)), e.preTouchStartCallback = e._deleteAllNearbyTools.bind(Ao()(e)), e
                            }
                            return m()(t, e), l()(t, [{
                                key: "_deleteAllNearbyTools",
                                value: function(e) {
                                    var t = e.detail.currentPoints.canvas,
                                        n = e.detail.element;
                                    return vt.tools.forEach((function(e) {
                                        var o = _(n, e.name);
                                        o && o.data.forEach((function(o) {
                                            "function" == typeof e.pointNearTool && e.pointNearTool(n, o, t) && (L(n, e.name, o), y.cornerstone.updateImage(n))
                                        }))
                                    })), !0
                                }
                            }]), t
                        }(go),
                        $s = _i.FreehandHandleData,
                        el = function(e) {
                            function t() {
                                var e, n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var o = {
                                    name: "FreehandRoiSculptor",
                                    referencedToolName: "FreehandRoi",
                                    supportedInteractionTypes: ["Mouse", "Touch", "DoubleTap"],
                                    mixins: ["activeOrDisabledBinaryTool"],
                                    configuration: tl(),
                                    svgCursor: Cr
                                };
                                return (e = u()(this, h()(t).call(this, n, o))).updateOnMouseMove = !0, e.isMultiPartTool = !0, e.referencedToolName = e.initialConfiguration.referencedToolName, e._active = !1, e.activeMouseUpCallback = e.activeMouseUpCallback.bind(Ao()(e)), e.activeTouchEndCallback = e.activeTouchEndCallback.bind(Ao()(e)), e.activeMouseDragCallback = e.activeMouseDragCallback.bind(Ao()(e)), e
                            }
                            return m()(t, e), l()(t, [{
                                key: "renderToolData",
                                value: function(e) {
                                    var t = e.detail;
                                    if (null === this.configuration.currentTool) return !1;
                                    var n = t.element,
                                        o = this.configuration;
                                    if (!_(n, this.referencedToolName).data[o.currentTool]) return !1;
                                    if (this._active) {
                                        var r = t.canvasContext.canvas.getContext("2d"),
                                            a = {
                                                color: this.configuration.dragColor,
                                                fill: null,
                                                handleRadius: this._toolSizeCanvas
                                            };
                                        dn(r, t, this.configuration.mouseLocation.handles, a)
                                    } else this.configuration.showCursorOnHover && !this._recentTouchEnd && this._renderHoverCursor(e)
                                }
                            }, {
                                key: "doubleClickCallback",
                                value: function(e) {
                                    var t = e.detail;
                                    this._selectFreehandTool(t), y.cornerstone.updateImage(t.element)
                                }
                            }, {
                                key: "doubleTapCallback",
                                value: function(e) {
                                    var t = e.detail;
                                    this._selectFreehandTool(t), y.cornerstone.updateImage(t.element)
                                }
                            }, {
                                key: "preTouchStartCallback",
                                value: function(e) {
                                    return this._initialiseSculpting(e), !0
                                }
                            }, {
                                key: "preMouseDownCallback",
                                value: function(e) {
                                    if (this.options.mouseButtonMask.includes(e.detail.buttons)) return this._initialiseSculpting(e), !0
                                }
                            }, {
                                key: "activeMouseDragCallback",
                                value: function(e) {
                                    var t = this.configuration;
                                    if (this._active) {
                                        var n = e.detail,
                                            o = _(n.element, this.referencedToolName);
                                        if (o) {
                                            var r = o.data[t.currentTool].handles.points;
                                            this._getMouseLocation(n), this._sculpt(n, r), y.cornerstone.updateImage(n.element)
                                        }
                                    }
                                }
                            }, {
                                key: "activeMouseUpCallback",
                                value: function(e) {
                                    this._activeEnd(e)
                                }
                            }, {
                                key: "activeTouchEndCallback",
                                value: function(e) {
                                    this._activeEnd(e), this._deselectAllTools(e), this._recentTouchEnd = !0
                                }
                            }, {
                                key: "_activeEnd",
                                value: function(e) {
                                    var t = e.detail,
                                        n = t.element,
                                        o = this.configuration;
                                    this._active = !1, vt.isMultiPartToolActive = !1, this._getMouseLocation(t), this._invalidateToolData(t), o.mouseUpRender = !0, this._deactivateSculpt(n), y.cornerstone.updateImage(t.element),
                                        function(e) {
                                            e.stopImmediatePropagation(), e.stopPropagation(), e.preventDefault()
                                        }(e)
                                }
                            }, {
                                key: "_renderHoverCursor",
                                value: function(e) {
                                    var t, n = e.detail,
                                        o = n.element,
                                        r = n.canvasContext.canvas.getContext("2d"),
                                        a = _(o, this.referencedToolName).data[this.configuration.currentTool];
                                    this._recentTouchEnd = !1, this.configuration.mouseUpRender ? (t = this.configuration.mouseLocation.handles.start, this.configuration.mouseUpRender = !1) : t = vt.mousePositionImage;
                                    var i = Tt(o, this.referencedToolName).distanceFromPointCanvas(o, a, t);
                                    if (this.configuration.mouseLocation.handles.start.x = t.x, this.configuration.mouseLocation.handles.start.y = t.y, this.configuration.limitRadiusOutsideRegion) {
                                        var s = i;
                                        i = this._limitCursorRadiusCanvas(n, i), s > this.configuration.hoverCursorFadeDistance * i && (r.globalAlpha = this.configuration.hoverCursorFadeAlpha)
                                    }
                                    var l = {
                                        fill: null,
                                        color: this.configuration.hoverColor,
                                        handleRadius: i
                                    };
                                    dn(r, n, this.configuration.mouseLocation.handles, l), this.configuration.limitRadiusOutsideRegion && (r.globalAlpha = 1)
                                }
                            }, {
                                key: "newImageCallback",
                                value: function(e) {
                                    this._deselectAllTools(e)
                                }
                            }, {
                                key: "enabledCallback",
                                value: function(e) {
                                    this._deselectAllTools(e)
                                }
                            }, {
                                key: "passiveCallback",
                                value: function(e) {
                                    this._deselectAllTools(e)
                                }
                            }, {
                                key: "disabledCallback",
                                value: function(e) {
                                    this._deselectAllTools(e)
                                }
                            }, {
                                key: "_selectFreehandTool",
                                value: function(e) {
                                    var t = this.configuration,
                                        n = e.element,
                                        o = this._getClosestFreehandToolOnElement(n, e);
                                    void 0 !== o && (t.currentTool = o, St(n))
                                }
                            }, {
                                key: "_activateFreehandTool",
                                value: function(e, t) {
                                    var n = _(e, this.referencedToolName).data;
                                    this.configuration.currentTool = t;
                                    for (var o = 0; o < n.length; o++) n[o].active = o === t
                                }
                            }, {
                                key: "_initialiseSculpting",
                                value: function(e) {
                                    var t = e.detail,
                                        n = this.configuration,
                                        o = t.element;
                                    null === n.currentTool && (this._selectFreehandTool(t), null === n.currentTool) || (this._active = !0, vt.isMultiPartToolActive = !0, this._configureToolSize(t), this._getMouseLocation(t), this._activateFreehandTool(o, n.currentTool), this._activateSculpt(o), y.cornerstone.updateImage(t.element))
                                }
                            }, {
                                key: "_sculpt",
                                value: function(e, t) {
                                    var n = this.configuration;
                                    this._sculptData = {
                                        element: e.element,
                                        image: e.image,
                                        mousePoint: e.currentPoints.image,
                                        points: t,
                                        toolSize: this._toolSizeImage,
                                        minSpacing: n.minSpacing,
                                        maxSpacing: Math.max(this._toolSizeImage, 2 * n.minSpacing)
                                    };
                                    var o = this._pushHandles();
                                    void 0 !== o.first && (this._insertNewHandles(o), this._consolidateHandles())
                                }
                            }, {
                                key: "_pushHandles",
                                value: function() {
                                    for (var e = this._sculptData, t = e.points, n = e.mousePoint, o = e.toolSize, r = {}, a = 0; a < t.length; a++) {
                                        var i = y.cornerstoneMath.point.distance(t[a], n);
                                        i > o || (this._pushOneHandle(a, i), void 0 === r.first ? (r.first = a, r.last = a) : r.last = a)
                                    }
                                    return r
                                }
                            }, {
                                key: "_pushOneHandle",
                                value: function(e, t) {
                                    var n = this._sculptData,
                                        o = n.points,
                                        r = n.mousePoint,
                                        a = n.toolSize,
                                        i = n.image,
                                        s = o[e],
                                        l = (s.x - r.x) / t,
                                        c = (s.y - r.y) / t,
                                        u = {
                                            x: r.x + a * l,
                                            y: r.y + a * c
                                        };
                                    In(u, i), s.x = u.x, s.y = u.y;
                                    var d = this.constructor._getPreviousHandleIndex(e, o.length);
                                    o[d].lines.pop(), o[d].lines.push(s)
                                }
                            }, {
                                key: "_insertNewHandles",
                                value: function(e) {
                                    for (var t = this._findNewHandleIndicies(e), n = 0, o = 0; o < t.length; o++) {
                                        var r = t[o] + 1 + n;
                                        this._insertHandleRadially(r), n++
                                    }
                                }
                            }, {
                                key: "_findNewHandleIndicies",
                                value: function(e) {
                                    for (var t = this._sculptData, n = t.points, o = t.maxSpacing, r = [], a = e.first; a <= e.last; a++) this._checkSpacing(a, n, r, o);
                                    var i = this.constructor._getNextHandleIndex(e.last, n.length);
                                    if (i !== e.first) {
                                        this._checkSpacing(i, n, r, o);
                                        var s = this.constructor._getPreviousHandleIndex(e.first, n.length);
                                        s !== i && this._checkSpacing(s, n, r, o)
                                    }
                                    return r
                                }
                            }, {
                                key: "_checkSpacing",
                                value: function(e, t, n, o) {
                                    var r = this.constructor._getNextHandleIndex(e, t.length);
                                    y.cornerstoneMath.point.distance(t[e], t[r]) > o && n.push(e)
                                }
                            }, {
                                key: "_insertHandleRadially",
                                value: function(e) {
                                    var t = this._sculptData.points,
                                        n = e - 1,
                                        o = this.constructor._getNextHandleIndexBeforeInsert(e, t.length),
                                        r = this._getInsertPosition(e, n, o),
                                        a = new $s(r);
                                    t.splice(e, 0, a), t[n].lines.pop(), t[n].lines.push(t[e]), _i.addLine(t, e)
                                }
                            }, {
                                key: "_consolidateHandles",
                                value: function() {
                                    if (!(this._sculptData.points.length <= 3)) {
                                        var e = this._findCloseHandlePairs();
                                        this._mergeCloseHandles(e)
                                    }
                                }
                            }, {
                                key: "_findCloseHandlePairs",
                                value: function() {
                                    for (var e = this._sculptData, t = e.points, n = e.minSpacing, o = [], r = t.length, a = 0; a < r; a++) {
                                        var i = this.constructor._getNextHandleIndex(a, t.length);
                                        if (y.cornerstoneMath.point.distance(t[a], t[i]) < n) {
                                            var s = [a, i];
                                            o.push(s), 0 === a && (r -= 1), a++
                                        }
                                    }
                                    return o
                                }
                            }, {
                                key: "_mergeCloseHandles",
                                value: function(e) {
                                    for (var t = 0, n = 0; n < e.length; n++) {
                                        var o = this.constructor._getCorrectedPair(e[n], t);
                                        this._combineHandles(o), t++
                                    }
                                    var r = this._findCloseHandlePairs();
                                    r.length && this._mergeCloseHandles(r)
                                }
                            }, {
                                key: "_combineHandles",
                                value: function(e) {
                                    var t = this._sculptData,
                                        n = t.points,
                                        o = t.image,
                                        r = {
                                            x: (n[e[0]].x + n[e[1]].x) / 2,
                                            y: (n[e[0]].y + n[e[1]].y) / 2
                                        };
                                    In(r, o), n[e[0]].x = r.x, n[e[0]].y = r.y;
                                    var a = this.constructor._getNextHandleIndex(e[1], n.length);
                                    n[e[0]].lines.pop(), n[e[0]].lines.push(n[a]), n.splice(e[1], 1)
                                }
                            }, {
                                key: "_configureToolSize",
                                value: function(e) {
                                    var t = e.element,
                                        n = this.configuration,
                                        o = n.currentTool,
                                        r = e.currentPoints.image,
                                        a = _(t, this.referencedToolName).data[o],
                                        i = Tt(t, this.referencedToolName),
                                        s = i.distanceFromPoint(t, a, r),
                                        l = i.distanceFromPointCanvas(t, a, r);
                                    n.limitRadiusOutsideRegion && (s = this._limitCursorRadiusImage(e, s), l = this._limitCursorRadiusCanvas(e, l)), this._toolSizeImage = s, this._toolSizeCanvas = l
                                }
                            }, {
                                key: "_getMouseLocation",
                                value: function(e) {
                                    var t = this.configuration;
                                    t.mouseLocation.handles.start.x = e.currentPoints.image.x, t.mouseLocation.handles.start.y = e.currentPoints.image.y, In(t.mouseLocation.handles.start, e.image)
                                }
                            }, {
                                key: "_activateSculpt",
                                value: function(e) {
                                    this._deactivateSculpt(e), e.addEventListener(x.MOUSE_UP, this.activeMouseUpCallback), e.addEventListener(x.MOUSE_CLICK, this.activeMouseUpCallback), e.addEventListener(x.MOUSE_DRAG, this.activeMouseDragCallback), e.addEventListener(x.TOUCH_END, this.activeTouchEndCallback), e.addEventListener(x.TOUCH_TAP, this.activeTouchEndCallback), e.addEventListener(x.TOUCH_DRAG, this.activeMouseDragCallback), y.cornerstone.updateImage(e)
                                }
                            }, {
                                key: "_deactivateSculpt",
                                value: function(e) {
                                    e.removeEventListener(x.MOUSE_UP, this.activeMouseUpCallback), e.removeEventListener(x.MOUSE_CLICK, this.activeMouseUpCallback), e.removeEventListener(x.MOUSE_DRAG, this.activeMouseDragCallback), e.removeEventListener(x.TOUCH_END, this.activeTouchEndCallback), e.removeEventListener(x.TOUCH_TAP, this.activeTouchEndCallback), e.removeEventListener(x.TOUCH_DRAG, this.activeMouseDragCallback), y.cornerstone.updateImage(e)
                                }
                            }, {
                                key: "_invalidateToolData",
                                value: function(e) {
                                    var t = this.configuration;
                                    _(e.element, this.referencedToolName).data[t.currentTool].invalidated = !0
                                }
                            }, {
                                key: "_deselectAllTools",
                                value: function(e) {
                                    var t = this.configuration,
                                        n = _(this.element, this.referencedToolName);
                                    if (t.currentTool = null, n)
                                        for (var o = 0; o < n.data.length; o++) n.data[o].active = !1;
                                    Et(this.element, this.svgCursor), y.cornerstone.updateImage(this.element)
                                }
                            }, {
                                key: "_limitCursorRadiusCanvas",
                                value: function(e, t) {
                                    return this._limitCursorRadius(e, t, !0)
                                }
                            }, {
                                key: "_limitCursorRadiusImage",
                                value: function(e, t) {
                                    return this._limitCursorRadius(e, t, !1)
                                }
                            }, {
                                key: "_limitCursorRadius",
                                value: function(e, t) {
                                    var n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2],
                                        o = e.element,
                                        r = e.image,
                                        a = this.configuration,
                                        i = _(o, this.referencedToolName).data[a.currentTool],
                                        s = 1;
                                    if (n) {
                                        var l = y.cornerstone.pixelToCanvas(o, {
                                                x: 0,
                                                y: 0
                                            }),
                                            c = y.cornerstone.pixelToCanvas(o, {
                                                x: r.width,
                                                y: r.height
                                            });
                                        s = (c.x - l.x) * (c.y - l.y) / (r.width * r.height)
                                    }
                                    var u = i.area * s,
                                        d = Math.pow(u / Math.PI, .5);
                                    return Math.min(t, d)
                                }
                            }, {
                                key: "_getClosestFreehandToolOnElement",
                                value: function(e, t) {
                                    var n = Tt(e, this.referencedToolName),
                                        o = _(e, this.referencedToolName);
                                    if (o) {
                                        for (var r = o.data, a = t.currentPoints.image, i = {
                                                distance: 1 / 0,
                                                toolIndex: null
                                            }, s = 0; s < r.length; s++) {
                                            var l = n.distanceFromPoint(e, r[s], a); - 1 !== l && l < i.distance && (i.distance = l, i.toolIndex = s)
                                        }
                                        return i.toolIndex
                                    }
                                }
                            }, {
                                key: "_getInsertPosition",
                                value: function(e, t, n) {
                                    var o, r = this._sculptData,
                                        a = r.points,
                                        i = r.toolSize,
                                        s = r.mousePoint,
                                        l = r.image,
                                        c = {
                                            x: (a[t].x + a[n].x) / 2,
                                            y: (a[t].y + a[n].y) / 2
                                        },
                                        u = y.cornerstoneMath.point.distance(s, c);
                                    if (u < i) {
                                        var d = {
                                            x: (c.x - s.x) / u,
                                            y: (c.y - s.y) / u
                                        };
                                        o = {
                                            x: s.x + i * d.x,
                                            y: s.y + i * d.y
                                        }
                                    } else o = c;
                                    return In(o, l), o
                                }
                            }, {
                                key: "minSpacing",
                                get: function() {
                                    return this.configuration.minSpacing
                                },
                                set: function(e) {
                                    if ("number" != typeof e) throw new Error("Attempting to set freehandSculpter minSpacing to a value other than a number.");
                                    this.configuration.minSpacing = e
                                }
                            }, {
                                key: "maxSpacing",
                                get: function() {
                                    return this.configuration.maxSpacing
                                },
                                set: function(e) {
                                    if ("number" != typeof e) throw new Error("Attempting to set freehandSculpter maxSpacing to a value other than a number.");
                                    this.configuration.maxSpacing = e
                                }
                            }, {
                                key: "showCursorOnHover",
                                get: function() {
                                    return this.configuration.showCursorOnHover
                                },
                                set: function(e) {
                                    if ("boolean" != typeof e) throw new Error("Attempting to set freehandSculpter showCursorOnHover to a value other than a boolean.");
                                    this.configuration.showCursorOnHover = e, y.cornerstone.updateImage(this.element)
                                }
                            }, {
                                key: "limitRadiusOutsideRegion",
                                get: function() {
                                    return this.configuration.limitRadiusOutsideRegion
                                },
                                set: function(e) {
                                    if ("boolean" != typeof e) throw new Error("Attempting to set freehandSculpter limitRadiusOutsideRegion to a value other than a boolean.");
                                    this.configuration.limitRadiusOutsideRegion = e, y.cornerstone.updateImage(this.element)
                                }
                            }, {
                                key: "hoverCursorFadeAlpha",
                                get: function() {
                                    return this.configuration.hoverCursorFadeAlpha
                                },
                                set: function(e) {
                                    if ("number" != typeof e) throw new Error("Attempting to set freehandSculpter hoverCursorFadeAlpha to a value other than a number.");
                                    e = Math.max(Math.min(e, 1), 0), this.configuration.hoverCursorFadeAlpha = e, y.cornerstone.updateImage(this.element)
                                }
                            }, {
                                key: "hoverCursorFadeDistance",
                                get: function() {
                                    return this.configuration.hoverCursorFadeDistance
                                },
                                set: function(e) {
                                    if ("number" != typeof e) throw new Error("Attempting to set freehandSculpter hoverCursorFadeDistance to a value other than a number.");
                                    e = Math.max(e, 1), this.configuration.hoverCursorFadeDistance = e, y.cornerstone.updateImage(this.element)
                                }
                            }], [{
                                key: "_getCorrectedPair",
                                value: function(e, t) {
                                    var n = [e[0] - t, e[1] - t];
                                    return n[1] < 0 && (n[1] = 0), n
                                }
                            }, {
                                key: "_getNextHandleIndex",
                                value: function(e, t) {
                                    return e === t - 1 ? 0 : e + 1
                                }
                            }, {
                                key: "_getPreviousHandleIndex",
                                value: function(e, t) {
                                    return 0 === e ? t - 1 : e - 1
                                }
                            }, {
                                key: "_getNextHandleIndexBeforeInsert",
                                value: function(e, t) {
                                    return e === t ? 0 : e
                                }
                            }]), t
                        }(go);

                    function tl() {
                        return {
                            mouseLocation: {
                                handles: {
                                    start: {
                                        highlight: !0,
                                        active: !0
                                    }
                                }
                            },
                            minSpacing: 1,
                            currentTool: null,
                            dragColor: un.getActiveColor(),
                            hoverColor: un.getToolColor(),
                            showCursorOnHover: !0,
                            limitRadiusOutsideRegion: !0,
                            hoverCursorFadeAlpha: .5,
                            hoverCursorFadeDistance: 1.2
                        }
                    }
                    var nl = function(e) {
                            function t() {
                                var e, n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var o = {
                                    name: "Magnify",
                                    supportedInteractionTypes: ["Mouse", "Touch"],
                                    configuration: {
                                        magnifySize: 300,
                                        magnificationLevel: 2
                                    },
                                    svgCursor: Or
                                };
                                return (e = u()(this, h()(t).call(this, n, o))).zoomCanvas = void 0, e.zoomElement = void 0, e.activeCallback = e._createMagnificationCanvas.bind(Ao()(e)), e.enabledCallback = e._createMagnificationCanvas.bind(Ao()(e)), e.disabledCallback = e._destroyMagnificationCanvas.bind(Ao()(e)), e.postTouchStartCallback = e._addMagnifyingGlass.bind(Ao()(e)), e.touchDragCallback = e._updateMagnifyingGlass.bind(Ao()(e)), e.touchEndCallback = e._removeMagnifyingGlass.bind(Ao()(e)), e.touchDragEndCallback = e._removeMagnifyingGlass.bind(Ao()(e)), e.postMouseDownCallback = e._addMagnifyingGlass.bind(Ao()(e)), e.mouseDragCallback = e._updateMagnifyingGlass.bind(Ao()(e)), e.mouseUpCallback = e._removeMagnifyingGlass.bind(Ao()(e)), e.mouseClickCallback = e._removeMagnifyingGlass.bind(Ao()(e)), e.newImageCallback = e._drawMagnificationTool.bind(Ao()(e)), e
                            }
                            return m()(t, e), l()(t, [{
                                key: "_addMagnifyingGlass",
                                value: function(e) {
                                    var t = this;
                                    this._removeZoomElement(), this._drawZoomedElement(e), window.requestAnimationFrame((function() {
                                        return t._drawMagnificationTool(e)
                                    })), St(e.detail.element), e.preventDefault(), e.stopPropagation()
                                }
                            }, {
                                key: "_updateMagnifyingGlass",
                                value: function(e) {
                                    this._drawMagnificationTool(e), e.preventDefault(), e.stopPropagation()
                                }
                            }, {
                                key: "_removeMagnifyingGlass",
                                value: function(e) {
                                    var t = e.detail.element;
                                    Et(this.element, this.svgCursor), t.querySelector(".magnifyTool").style.display = "none", this._removeZoomElement()
                                }
                            }, {
                                key: "_drawMagnificationTool",
                                value: function(e) {
                                    var t = e.detail.element,
                                        n = t.querySelector(".magnifyTool");
                                    if (n || this._createMagnificationCanvas(t), void 0 !== this.zoomCanvas) {
                                        var o = t.querySelector("canvas:not(.magnifyTool)"),
                                            r = Dn(n),
                                            a = y.cornerstone.pixelToCanvas(e.detail.element, e.detail.currentPoints.image),
                                            i = Math.min(this.configuration.magnifySize, o.width, o.height),
                                            s = this.configuration.magnificationLevel;
                                        n.width = i, n.height = i, a.x = Math.max(a.x, .5 * i / s), a.x = Math.min(a.x, o.width - .5 * i / s), a.y = Math.max(a.y, .5 * i / s), a.y = Math.min(a.y, o.height - .5 * i / s);
                                        var l = {
                                            x: a.x * s - .5 * i,
                                            y: a.y * s - .5 * i
                                        };
                                        l.x = Math.max(l.x, 0), l.y = Math.max(l.y, 0), r.drawImage(this.zoomCanvas, l.x, l.y, i, i, 0, 0, i, i);
                                        var c = e.detail.isTouchEvent ? 120 : 0,
                                            u = {
                                                top: Math.max(a.y - .5 * i - c, 0),
                                                left: Math.max(a.x - .5 * i, 0)
                                            },
                                            d = n.getBoundingClientRect();
                                        u.top = Math.min(u.top, o.height - d.height), u.left = Math.min(u.left, o.width - d.width), n.style.top = "".concat(u.top, "px"), n.style.left = "".concat(u.left, "px"), n.style.display = "block"
                                    }
                                }
                            }, {
                                key: "_drawZoomedElement",
                                value: function(e) {
                                    var t = e.detail.element,
                                        n = e.detail.enabledElement;
                                    void 0 === n && (n = y.cornerstone.getEnabledElement(t));
                                    var o = this.configuration.magnificationLevel,
                                        r = n.canvas,
                                        a = n.image;
                                    this.zoomElement || (this.zoomElement = document.createElement("div"), this.zoomElement.width = r.width * o, this.zoomElement.height = r.height * o, y.cornerstone.enable(this.zoomElement, n.options));
                                    var i = y.cornerstone.getEnabledElement(this.zoomElement),
                                        s = y.cornerstone.getViewport(n.element);
                                    this.zoomCanvas = i.canvas, this.zoomCanvas.width = r.width * o, this.zoomCanvas.height = r.height * o, i.viewport = Object.assign({}, s), s.scale *= o, y.cornerstone.displayImage(this.zoomElement, a), y.cornerstone.setViewport(this.zoomElement, s)
                                }
                            }, {
                                key: "_removeZoomElement",
                                value: function() {
                                    void 0 !== this.zoomElement && (y.cornerstone.disable(this.zoomElement), this.zoomElement = void 0, this.zoomCanvas = void 0)
                                }
                            }, {
                                key: "_createMagnificationCanvas",
                                value: function(e) {
                                    if (null === e.querySelector(".magnifyTool")) {
                                        var t = document.createElement("canvas");
                                        t.classList.add("magnifyTool"), t.width = this.configuration.magnifySize, t.height = this.configuration.magnifySize, t.style.position = "absolute", t.style.display = "none", e.appendChild(t)
                                    }
                                }
                            }, {
                                key: "_destroyMagnificationCanvas",
                                value: function(e) {
                                    var t = e.querySelector(".magnifyTool");
                                    t && e.removeChild(t)
                                }
                            }]), t
                        }(go),
                        ol = bt.globalConfiguration,
                        rl = function(e) {
                            function t() {
                                var e, n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var o = {
                                        name: "Overlay",
                                        configuration: {},
                                        mixins: ["enabledOrDisabledBinaryTool"]
                                    },
                                    r = Object.assign(o, n);
                                return (e = u()(this, h()(t).call(this, r))).initialConfiguration = r, e
                            }
                            return m()(t, e), l()(t, [{
                                key: "enabledCallback",
                                value: function(e) {
                                    this.forceImageUpdate(e)
                                }
                            }, {
                                key: "disabledCallback",
                                value: function(e) {
                                    this.forceImageUpdate(e)
                                }
                            }, {
                                key: "forceImageUpdate",
                                value: function(e) {
                                    y.cornerstone.getEnabledElement(e).image && y.cornerstone.updateImage(e)
                                }
                            }, {
                                key: "setupRender",
                                value: function(e) {
                                    if (e) {
                                        var t = y.cornerstone.metaData.get("overlayPlaneModule", e.imageId);
                                        if (t && t.overlays && t.overlays.length) return t
                                    }
                                }
                            }, {
                                key: "setupViewport",
                                value: function(e) {
                                    if (void 0 === e.overlayColor && (e.overlayColor = ol.configuration.overlayColor || "white"), !1 !== e.overlayColor) return !0
                                }
                            }, {
                                key: "renderToolData",
                                value: function(e) {
                                    var t = e.detail,
                                        n = t.enabledElement,
                                        o = t.image,
                                        r = t.viewport,
                                        a = t.canvasContext,
                                        i = this.setupRender(o);
                                    if (t && n && i && this.setupViewport(r)) {
                                        var s = o.columns,
                                            l = o.rows;
                                        i.overlays.forEach((function(e) {
                                            if (!1 !== e.visible) {
                                                var t = document.createElement("canvas");
                                                t.width = s, t.height = l;
                                                var n = t.getContext("2d");
                                                n.fillStyle = e.fillStyle || r.overlayColor, "R" === e.type && (n.fillRect(0, 0, t.width, t.height), n.globalCompositeOperation = "xor");
                                                for (var o = 0, i = 0; i < e.rows; i++)
                                                    for (var c = 0; c < e.columns; c++) e.pixelData[o++] > 0 && n.fillRect(c, i, 1, 1);
                                                var u = !isNaN(parseFloat(e.x)) && isFinite(e.x) ? e.x : 0,
                                                    d = !isNaN(parseFloat(e.y)) && isFinite(e.y) ? e.y : 0;
                                                a.drawImage(t, u, d)
                                            }
                                        }))
                                    }
                                }
                            }]), t
                        }(go),
                        al = {
                            getOrientationString: function(e) {
                                for (var t = en(e), n = "", o = t.x < 0 ? "R" : "L", r = t.y < 0 ? "A" : "P", a = t.z < 0 ? "F" : "H", i = new y.cornerstoneMath.Vector3(Math.abs(t.x), Math.abs(t.y), Math.abs(t.z)), s = 1e-4, l = 0; l < 3; l++)
                                    if (i.x > s && i.x > i.y && i.x > i.z) n += o, i.x = 0;
                                    else if (i.y > s && i.y > i.x && i.y > i.z) n += r, i.y = 0;
                                else if (i.z > s && i.z > i.x && i.z > i.y) n += a, i.z = 0;
                                else if (i.x > s && i.y > s && i.x === i.y) n += o + r, i.x = 0, i.y = 0;
                                else if (i.x > s && i.z > s && i.x === i.z) n += o + a, i.x = 0, i.z = 0;
                                else {
                                    if (!(i.y > s && i.z > s && i.y === i.z)) break;
                                    n += r + a, i.y = 0, i.z = 0
                                }
                                return n
                            },
                            invertOrientationString: function(e) {
                                var t = e.replace("H", "f");
                                return (t = (t = (t = (t = (t = t.replace("F", "h")).replace("R", "l")).replace("L", "r")).replace("A", "p")).replace("P", "a")).toUpperCase()
                            }
                        },
                        il = function(e) {
                            function t() {
                                var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var n = {
                                    name: "OrientationMarkers",
                                    configuration: {
                                        drawAllMarkers: !0
                                    },
                                    mixins: ["enabledOrDisabledBinaryTool"]
                                };
                                return u()(this, h()(t).call(this, e, n))
                            }
                            return m()(t, e), l()(t, [{
                                key: "enabledCallback",
                                value: function(e) {
                                    this.forceImageUpdate(e)
                                }
                            }, {
                                key: "disabledCallback",
                                value: function(e) {
                                    this.forceImageUpdate(e)
                                }
                            }, {
                                key: "forceImageUpdate",
                                value: function(e) {
                                    var t = y.cornerstone;
                                    t.getEnabledElement(e).image && t.updateImage(e)
                                }
                            }, {
                                key: "renderToolData",
                                value: function(e) {
                                    var t = e.detail,
                                        n = Dn(t.canvasContext.canvas),
                                        o = t.element,
                                        r = cl(o);
                                    if (r) {
                                        var a = ul(o, r),
                                            i = un.getToolColor(),
                                            s = {
                                                top: wn(n, r.top, 0),
                                                left: wn(n, r.left, 0),
                                                right: wn(n, r.right, 0),
                                                bottom: wn(n, r.bottom, 0),
                                                height: wn(n, "M", 0)
                                            };
                                        sl(n, r, a, s, i), this.configuration.drawAllMarkers && ll(n, r, a, s, i)
                                    }
                                }
                            }]), t
                        }(go),
                        sl = function(e, t, n, o, r) {
                            xn(e, t.top, n.top.x - o.top / 2, n.top.y, r), xn(e, t.left, n.left.x - o.left / 2, n.left.y, r)
                        },
                        ll = function(e, t, n, o, r) {
                            xn(e, t.right, n.right.x - o.right, n.right.y, r), xn(e, t.bottom, n.bottom.x - o.bottom / 2, n.bottom.y - o.height, r)
                        },
                        cl = function(e) {
                            var t = y.cornerstone,
                                n = t.getEnabledElement(e),
                                o = t.metaData.get("imagePlaneModule", n.image.imageId);
                            if (o && o.rowCosines && o.columnCosines) {
                                var r = al.getOrientationString(o.rowCosines),
                                    a = al.getOrientationString(o.columnCosines),
                                    i = al.invertOrientationString(r);
                                return {
                                    top: al.invertOrientationString(a),
                                    bottom: a,
                                    left: i,
                                    right: r
                                }
                            }
                        },
                        ul = function(e) {
                            var t = y.cornerstone.getEnabledElement(e);
                            return {
                                top: y.cornerstone.pixelToCanvas(e, {
                                    x: t.image.width / 2,
                                    y: 5
                                }),
                                bottom: y.cornerstone.pixelToCanvas(e, {
                                    x: t.image.width / 2,
                                    y: t.image.height - 15
                                }),
                                left: y.cornerstone.pixelToCanvas(e, {
                                    x: 5,
                                    y: t.image.height / 2
                                }),
                                right: y.cornerstone.pixelToCanvas(e, {
                                    x: t.image.width - 10,
                                    y: t.image.height / 2
                                })
                            }
                        },
                        dl = function(e) {
                            function t() {
                                var e, n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var o = {
                                    name: "PanMultiTouch",
                                    supportedInteractionTypes: ["MultiTouch"],
                                    configuration: {
                                        touchPointers: 2
                                    }
                                };
                                return (e = u()(this, h()(t).call(this, n, o))).multiTouchDragCallback = e._dragCallback.bind(Ao()(e)), e
                            }
                            return m()(t, e), l()(t, [{
                                key: "_dragCallback",
                                value: function(e) {
                                    var t = e.detail,
                                        n = t.element,
                                        o = t.viewport;
                                    if (t.numPointers === this.configuration.touchPointers) {
                                        var r = this._getTranslation(t);
                                        this._applyTranslation(o, r), y.cornerstone.setViewport(n, o)
                                    }
                                }
                            }, {
                                key: "_getTranslation",
                                value: function(e) {
                                    var t = e.viewport,
                                        n = e.image,
                                        o = e.deltaPoints,
                                        r = t.scale,
                                        a = t.scale;
                                    return n.rowPixelSpacing < n.columnPixelSpacing ? r *= n.columnPixelSpacing / n.rowPixelSpacing : n.columnPixelSpacing < n.rowPixelSpacing && (a *= n.rowPixelSpacing / n.columnPixelSpacing), {
                                        x: o.page.x / r,
                                        y: o.page.y / a
                                    }
                                }
                            }, {
                                key: "_applyTranslation",
                                value: function(e, t) {
                                    e.translation.x += t.x, e.translation.y += t.y
                                }
                            }]), t
                        }(go),
                        hl = function(e) {
                            function t() {
                                var e, n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var o = {
                                    name: "Pan",
                                    supportedInteractionTypes: ["Mouse", "Touch"],
                                    svgCursor: Rr
                                };
                                return (e = u()(this, h()(t).call(this, n, o))).touchDragCallback = e._dragCallback.bind(Ao()(e)), e.mouseDragCallback = e._dragCallback.bind(Ao()(e)), e
                            }
                            return m()(t, e), l()(t, [{
                                key: "_dragCallback",
                                value: function(e) {
                                    var t = e.detail,
                                        n = t.element,
                                        o = t.viewport,
                                        r = this._getTranslation(t);
                                    this._applyTranslation(o, r), y.cornerstone.setViewport(n, o)
                                }
                            }, {
                                key: "_getTranslation",
                                value: function(e) {
                                    var t = e.viewport,
                                        n = e.image,
                                        o = e.deltaPoints,
                                        r = t.scale,
                                        a = t.scale;
                                    return n.rowPixelSpacing < n.columnPixelSpacing ? r *= n.columnPixelSpacing / n.rowPixelSpacing : n.columnPixelSpacing < n.rowPixelSpacing && (a *= n.rowPixelSpacing / n.columnPixelSpacing), {
                                        x: o.page.x / r,
                                        y: o.page.y / a
                                    }
                                }
                            }, {
                                key: "_applyTranslation",
                                value: function(e, t) {
                                    e.translation.x += t.x, e.translation.y += t.y
                                }
                            }]), t
                        }(go),
                        fl = n(11),
                        ml = n.n(fl),
                        gl = n(13),
                        pl = n.n(gl),
                        vl = function(e, t, n, o) {
                            var r = y.cornerstone,
                                a = r.getEnabledElement(n).image,
                                i = r.getEnabledElement(o).image;
                            if (a && i) {
                                var s = r.metaData.get("imagePlaneModule", a.imageId),
                                    l = r.metaData.get("imagePlaneModule", i.imageId);
                                if (s && l && s.rowCosines && s.columnCosines && s.imagePositionPatient && l.rowCosines && l.columnCosines && l.imagePositionPatient && s.frameOfReferenceUID === l.frameOfReferenceUID) {
                                    s.rowCosines = en(s.rowCosines), s.columnCosines = en(s.columnCosines), s.imagePositionPatient = en(s.imagePositionPatient), l.rowCosines = en(l.rowCosines), l.columnCosines = en(l.columnCosines), l.imagePositionPatient = en(l.imagePositionPatient);
                                    var c = s.rowCosines.clone().cross(s.columnCosines),
                                        u = l.rowCosines.clone().cross(l.columnCosines),
                                        d = c.angleTo(u);
                                    if (!((d = Math.abs(d)) < .5)) {
                                        var h = function(e, t) {
                                            var n = on(e, t);
                                            if (n) return {
                                                start: tn(n.start, e),
                                                end: tn(n.end, e)
                                            }
                                        }(s, l);
                                        if (h) {
                                            var f = un.getActiveColor();
                                            e.setTransform(1, 0, 0, 1, 0, 0), Wt(e, (function(e) {
                                                Xt(e, t.element, h.start, h.end, {
                                                    color: f
                                                })
                                            }))
                                        }
                                    }
                                }
                            }
                        },
                        yl = function(e) {
                            return new Promise((function(t) {
                                return setTimeout(t, e)
                            }))
                        };

                    function bl(e) {
                        try {
                            var t = y.cornerstone.getEnabledElement(e);
                            return t.image ? t : yl(250).then((function() {
                                return bl(e)
                            }))
                        } catch (e) {
                            return null
                        }
                    }
                    var wl = B("tools:ReferenceLinesTool"),
                        xl = function(e) {
                            function t() {
                                var e, n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var o = {
                                    name: "ReferenceLines",
                                    mixins: ["enabledOrDisabledBinaryTool"],
                                    configuration: {
                                        renderer: vl
                                    }
                                };
                                return (e = u()(this, h()(t).call(this, n, o))).renderer = null, e.synchronizationContext = null, e
                            }
                            var n;
                            return m()(t, e), l()(t, [{
                                key: "enabledCallback",
                                value: (n = pl()(ml.a.mark((function e(t) {
                                    var n, o, r, a = arguments;
                                    return ml.a.wrap((function(e) {
                                        for (;;) switch (e.prev = e.next) {
                                            case 0:
                                                return n = a.length > 1 && void 0 !== a[1] ? a[1] : {}, o = n.synchronizationContext, r = this.configuration.renderer, e.next = 4, bl(t);
                                            case 4:
                                                if (e.sent && r && o) {
                                                    e.next = 8;
                                                    break
                                                }
                                                return wl.warn("Unable to enable ".concat(this.name, ". Exiting enable callback. Tool will be enabled, but will not render.")), e.abrupt("return");
                                            case 8:
                                                this.renderer = r, this.synchronizationContext = o, this.forceImageUpdate(t);
                                            case 11:
                                            case "end":
                                                return e.stop()
                                        }
                                    }), e, this)
                                }))), function(e) {
                                    return n.apply(this, arguments)
                                })
                            }, {
                                key: "disabledCallback",
                                value: function(e) {
                                    this.forceImageUpdate(e)
                                }
                            }, {
                                key: "forceImageUpdate",
                                value: function(e) {
                                    y.cornerstone.getEnabledElement(e).image && y.cornerstone.updateImage(e)
                                }
                            }, {
                                key: "renderToolData",
                                value: function(e) {
                                    var t = this,
                                        n = e.detail;
                                    if (this.renderer && this.synchronizationContext) {
                                        var o = this.synchronizationContext.getSourceElements(),
                                            r = Dn(n.canvasContext.canvas);
                                        y.cornerstone.setToPixelCoordinateSystem(n.enabledElement, r), o.forEach((function(o) {
                                            o !== e.currentTarget && t.renderer(r, n, e.currentTarget, o)
                                        }))
                                    }
                                }
                            }]), t
                        }(go),
                        Tl = function(e, t, n) {
                            var o = Math.sqrt(Math.pow(e.x - t.x, 2) + Math.pow(e.y - t.y, 2)),
                                r = Math.sqrt(Math.pow(e.x - n.x, 2) + Math.pow(e.y - n.y, 2)),
                                a = Math.sqrt(Math.pow(t.x - n.x, 2) + Math.pow(t.y - n.y, 2));
                            return {
                                angle: 180 * Math.acos((Math.pow(o, 2) + Math.pow(r, 2) - Math.pow(a, 2)) / (2 * o * r)) / Math.PI,
                                direction: (t.x - e.x) * (n.y - e.y) - (t.y - e.y) * (n.x - e.x)
                            }
                        },
                        Il = function(e) {
                            function t() {
                                var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var n = {
                                    name: "Rotate",
                                    strategies: {
                                        default: El,
                                        horizontal: Sl,
                                        vertical: Al
                                    },
                                    defaultStrategy: "default",
                                    supportedInteractionTypes: ["Mouse", "Touch"],
                                    configuration: {
                                        roundAngles: !1,
                                        flipHorizontal: !1,
                                        flipVertical: !1,
                                        rotateScale: 1
                                    },
                                    svgCursor: Nr
                                };
                                return u()(this, h()(t).call(this, e, n))
                            }
                            return m()(t, e), l()(t, [{
                                key: "touchDragCallback",
                                value: function(e) {
                                    this.dragCallback(e)
                                }
                            }, {
                                key: "mouseDragCallback",
                                value: function(e) {
                                    this.dragCallback(e)
                                }
                            }, {
                                key: "postMouseDownCallback",
                                value: function(e) {
                                    this.initialRotation = e.detail.viewport.rotation
                                }
                            }, {
                                key: "dragCallback",
                                value: function(e) {
                                    e.detail.viewport.initialRotation = this.initialRotation, this.applyActiveStrategy(e), y.cornerstone.setViewport(e.detail.element, e.detail.viewport)
                                }
                            }]), t
                        }(go);

                    function El(e) {
                        var t = this.configuration,
                            n = t.roundAngles,
                            o = t.rotateScale,
                            r = e.detail,
                            a = r.element,
                            i = r.viewport,
                            s = r.startPoints,
                            l = r.currentPoints,
                            c = i.initialRotation ? i.initialRotation : i.rotation,
                            u = a.getBoundingClientRect(a),
                            d = a.clientWidth,
                            h = a.clientHeight,
                            f = i.scale,
                            m = i.translation,
                            g = {
                                x: u.left + d / 2 + m.x * f,
                                y: u.top + h / 2 + m.y * f
                            },
                            p = Tl(g, s.client, l.client);
                        p.angle *= o, n && (p.angle = Math.ceil(p.angle)), p.direction < 0 && (p.angle = -p.angle), i.rotation = c + p.angle
                    }

                    function Sl(e) {
                        var t = this.configuration,
                            n = t.roundAngles,
                            o = t.flipHorizontal,
                            r = t.rotateScale,
                            a = e.detail,
                            i = a.viewport,
                            s = a.startPoints,
                            l = a.currentPoints,
                            c = i.initialRotation,
                            u = s.client.x,
                            d = (l.client.x - u) * r;
                        n && (d = Math.round(Math.abs(d)) * (d > 0 ? 1 : -1)), o && (d = -d), i.rotation = c + d
                    }

                    function Al(e) {
                        var t = this.configuration,
                            n = t.roundAngles,
                            o = t.flipVertical,
                            r = t.rotateScale,
                            a = e.detail,
                            i = a.viewport,
                            s = a.startPoints,
                            l = a.currentPoints,
                            c = i.initialRotation,
                            u = s.client.y,
                            d = (l.client.y - u) * r;
                        n && (d = Math.round(Math.abs(d)) * (d > 0 ? 1 : -1)), o && (d = -d), i.rotation = c + d
                    }
                    var Cl = function(e) {
                            function t() {
                                var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var n = {
                                    name: "RotateTouch",
                                    supportedInteractionTypes: ["TouchRotate"]
                                };
                                return u()(this, h()(t).call(this, e, n))
                            }
                            return m()(t, e), l()(t, [{
                                key: "touchRotateCallback",
                                value: function(e) {
                                    var t = e.detail,
                                        n = t.element,
                                        o = t.viewport,
                                        r = t.rotation;
                                    o.rotation += r, y.cornerstone.setViewport(n, o)
                                }
                            }]), t
                        }(go),
                        Ml = B("tools:ScaleOverlayTool"),
                        Dl = function(e) {
                            function t() {
                                var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var n = {
                                    name: "ScaleOverlay",
                                    configuration: {
                                        minorTickLength: 12.5,
                                        majorTickLength: 25
                                    },
                                    mixins: ["enabledOrDisabledBinaryTool"]
                                };
                                return u()(this, h()(t).call(this, e, n))
                            }
                            return m()(t, e), l()(t, [{
                                key: "enabledCallback",
                                value: function(e) {
                                    this.forceImageUpdate(e)
                                }
                            }, {
                                key: "disabledCallback",
                                value: function(e) {
                                    this.forceImageUpdate(e)
                                }
                            }, {
                                key: "forceImageUpdate",
                                value: function(e) {
                                    y.cornerstone.getEnabledElement(e).image && y.cornerstone.updateImage(e)
                                }
                            }, {
                                key: "renderToolData",
                                value: function(e) {
                                    var t = e.detail,
                                        n = Dn(t.canvasContext.canvas),
                                        o = t.image,
                                        r = t.viewport,
                                        a = t.element,
                                        i = o.rowPixelSpacing,
                                        s = o.columnPixelSpacing,
                                        l = y.cornerstone.metaData.get("imagePlaneModule", o.imageId);
                                    if (l && (i = l.rowPixelSpacing || l.rowImagePixelSpacing, s = l.columnPixelSpacing || l.colImagePixelSpacing), i && s) {
                                        var c = {
                                                width: n.canvas.width,
                                                height: n.canvas.height
                                            },
                                            u = 10 / i * r.scale,
                                            d = 10 / s * r.scale,
                                            h = Pl(c, .25, .05),
                                            f = Pl(c, .05, .15);
                                        if (c.width && c.height && h && f) {
                                            var m = un.getToolColor(),
                                                g = Zt.getToolWidth(),
                                                p = Object.assign({}, {
                                                    hscaleBounds: h,
                                                    vscaleBounds: f,
                                                    verticalMinorTick: u,
                                                    horizontalMinorTick: d,
                                                    verticalLine: {
                                                        start: {
                                                            x: f.bottomRight.x,
                                                            y: f.topLeft.y
                                                        },
                                                        end: {
                                                            x: f.bottomRight.x,
                                                            y: f.bottomRight.y
                                                        }
                                                    },
                                                    horizontalLine: {
                                                        start: {
                                                            x: h.topLeft.x,
                                                            y: h.bottomRight.y
                                                        },
                                                        end: {
                                                            x: h.bottomRight.x,
                                                            y: h.bottomRight.y
                                                        }
                                                    },
                                                    color: m,
                                                    lineWidth: g
                                                }, this.configuration);
                                            Wt(n, (function(e) {
                                                kn(e, p), Xt(e, a, p.verticalLine.start, p.verticalLine.end, {
                                                    color: p.color,
                                                    lineWidth: p.lineWidth
                                                }, "canvas"), kl(e, a, p), Xt(e, a, p.horizontalLine.start, p.horizontalLine.end, {
                                                    color: p.color,
                                                    lineWidth: p.lineWidth
                                                }, "canvas"), _l(e, a, p)
                                            }))
                                        }
                                    } else Ml.warn("unable to define rowPixelSpacing or colPixelSpacing from data on ".concat(this.name, "'s renderToolData"))
                                }
                            }]), t
                        }(go),
                        Pl = function(e, t, n) {
                            var o = t * Math.min(1e3, e.width),
                                r = n * Math.min(1e3, e.height),
                                a = {
                                    left: o,
                                    top: r,
                                    width: e.width - 2 * o,
                                    height: e.height - 2 * r
                                };
                            return {
                                topLeft: {
                                    x: a.left,
                                    y: a.top
                                },
                                bottomRight: {
                                    x: a.left + a.width,
                                    y: a.top + a.height
                                }
                            }
                        },
                        kl = function(e, t, n) {
                            for (var o = 0; n.verticalLine.start.y + o * n.verticalMinorTick <= n.vscaleBounds.bottomRight.y;) {
                                var r = n.color,
                                    a = n.lineWidth,
                                    i = {
                                        x: n.verticalLine.start.x,
                                        y: n.verticalLine.start.y + o * n.verticalMinorTick
                                    },
                                    s = {
                                        x: 0,
                                        y: n.verticalLine.start.y + o * n.verticalMinorTick
                                    };
                                s.x = o % 5 == 0 ? n.verticalLine.start.x - n.majorTickLength : n.verticalLine.start.x - n.minorTickLength, Xt(e, t, i, s, {
                                    color: r,
                                    lineWidth: a
                                }, "canvas"), o++
                            }
                        },
                        _l = function(e, t, n) {
                            for (var o = 0; n.horizontalLine.start.x + o * n.horizontalMinorTick <= n.hscaleBounds.bottomRight.x;) {
                                var r = n.color,
                                    a = n.lineWidth,
                                    i = {
                                        x: n.horizontalLine.start.x + o * n.horizontalMinorTick,
                                        y: n.horizontalLine.start.y
                                    },
                                    s = {
                                        x: n.horizontalLine.start.x + o * n.horizontalMinorTick,
                                        y: 0
                                    };
                                s.y = o % 5 == 0 ? n.horizontalLine.start.y - n.majorTickLength : n.horizontalLine.start.y - n.minorTickLength, Xt(e, t, i, s, {
                                    color: r,
                                    lineWidth: a
                                }, "canvas"), o++
                            }
                        },
                        Ll = function(e, t) {
                            var n = _(e, "stack");
                            if (n && n.data && n.data.length) {
                                var o, r = y.cornerstone;
                                if (n.data.length > 1) {
                                    var a = _(e, "stackRenderer");
                                    a && a.data && a.data.length && (o = a.data[0])
                                }
                                var i = n.data[0];
                                t < 0 && (t += i.imageIds.length);
                                var s = js.getStartLoadHandler(e),
                                    l = js.getEndLoadHandler(e),
                                    c = js.getErrorLoadingHandler(e);
                                if (t !== i.currentImageIdIndex) {
                                    s && s(e);
                                    var u = {
                                        newImageIdIndex: t,
                                        direction: t - i.currentImageIdIndex
                                    };
                                    i.currentImageIdIndex = t;
                                    var d = i.imageIds[t];
                                    (Boolean(i.preventCache) ? r.loadImage(d) : r.loadAndCacheImage(d)).then((function(a) {
                                        if (i.currentImageIdIndex === t) {
                                            try {
                                                r.getEnabledElement(e)
                                            } catch (e) {
                                                return
                                            }
                                            o ? (o.currentImageIdIndex = t, o.render(e, n.data)) : r.displayImage(e, a), l && l(e, a)
                                        }
                                    }), (function(n) {
                                        var o = i.imageIds[t];
                                        c && c(e, o, n)
                                    })), T(e, x.STACK_SCROLL, u)
                                }
                            }
                        },
                        Ol = function(e, t) {
                            var n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2],
                                o = !(arguments.length > 3 && void 0 !== arguments[3]) || arguments[3],
                                r = _(e, "stack");
                            if (r && r.data && r.data.length) {
                                var a = r.data[0];
                                a.pending || (a.pending = []);
                                var i = a.currentImageIdIndex + t;
                                if (n ? i %= a.imageIds.length : i = An(i, 0, a.imageIds.length - 1), o) Ll(e, i);
                                else {
                                    var s = {
                                        index: i
                                    };
                                    a.pending.push(s), Rl(a, s, e)
                                }
                            }
                        };

                    function Rl(e, t, n) {
                        if (e.pending[0] === t) {
                            if (e.currentImageIdIndex === t.index) return e.pending.splice(e.pending.indexOf(t), 1), void(e.pending.length > 0 && Rl(e, e.pending[0], n));
                            n.addEventListener(y.cornerstone.EVENTS.NEW_IMAGE, (function o(r) {
                                e.imageIds.indexOf(r.detail.image.imageId) === t.index && (e.pending.splice(e.pending.indexOf(t), 1), n.removeEventListener(y.cornerstone.EVENTS.NEW_IMAGE, o), e.pending.length > 0 && Rl(e, e.pending[0], n))
                            })), Ll(n, t.index)
                        }
                    }
                    var Nl = function(e) {
                            function t() {
                                var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var n = {
                                    name: "StackScrollMouseWheel",
                                    supportedInteractionTypes: ["MouseWheel"],
                                    configuration: {
                                        loop: !1,
                                        allowSkipping: !0,
                                        invert: !1
                                    }
                                };
                                return u()(this, h()(t).call(this, e, n))
                            }
                            return m()(t, e), l()(t, [{
                                key: "mouseWheelCallback",
                                value: function(e) {
                                    var t = e.detail,
                                        n = t.direction,
                                        o = t.element,
                                        r = this.configuration,
                                        a = r.loop,
                                        i = r.allowSkipping,
                                        s = r.invert;
                                    Ol(o, s ? -n : n, a, i)
                                }
                            }]), t
                        }(go),
                        Ul = function(e) {
                            function t() {
                                var e, n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var o = {
                                    name: "StackScrollMultiTouch",
                                    supportedInteractionTypes: ["MultiTouch"],
                                    configuration: {
                                        loop: !1,
                                        allowSkipping: !0,
                                        touchPointers: 3
                                    }
                                };
                                return (e = u()(this, h()(t).call(this, n, o))).multiTouchDragCallback = e._dragCallback.bind(Ao()(e)), e
                            }
                            return m()(t, e), l()(t, [{
                                key: "_dragCallback",
                                value: function(e) {
                                    var t = e.detail;
                                    if (t.numPointers === this.configuration.touchPointers) {
                                        var n = t.element,
                                            o = t.deltaPoints,
                                            r = this.configuration,
                                            a = r.loop,
                                            i = r.allowSkipping,
                                            s = Ws(this.name, n),
                                            l = this._getPixelPerImage(n),
                                            c = this._getDeltaY(n, o.page.y);
                                        if (!l) return;
                                        if (Math.abs(c) >= l) {
                                            var u = Math.round(c / l);
                                            Ol(n, u, a, i), s.deltaY = c % l
                                        } else s.deltaY = c;
                                        Gs(this.name, n, s)
                                    }
                                }
                            }, {
                                key: "_getDeltaY",
                                value: function(e, t) {
                                    return (Ws(this.name, e).deltaY || 0) + t
                                }
                            }, {
                                key: "_getPixelPerImage",
                                value: function(e) {
                                    var t = _(e, "stack");
                                    if (t && t.data && t.data.length) {
                                        var n = t.data[0];
                                        return this.configuration.stackScrollSpeed || Math.max(2, e.offsetHeight / Math.max(n.imageIds.length, 8))
                                    }
                                }
                            }]), t
                        }(go),
                        Bl = function(e) {
                            function t() {
                                var e, n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var o = {
                                    name: "StackScroll",
                                    supportedInteractionTypes: ["Mouse", "Touch"],
                                    configuration: {
                                        loop: !1,
                                        allowSkipping: !0
                                    },
                                    svgCursor: Ur
                                };
                                return (e = u()(this, h()(t).call(this, n, o))).mouseDragCallback = e._dragCallback.bind(Ao()(e)), e.touchDragCallback = e._dragCallback.bind(Ao()(e)), e
                            }
                            return m()(t, e), l()(t, [{
                                key: "_dragCallback",
                                value: function(e) {
                                    var t = e.detail,
                                        n = t.element,
                                        o = t.deltaPoints,
                                        r = this.configuration,
                                        a = r.loop,
                                        i = r.allowSkipping,
                                        s = Ws(this.name, n),
                                        l = this._getPixelPerImage(n),
                                        c = this._getDeltaY(n, o.page.y);
                                    if (l) {
                                        if (Math.abs(c) >= l) {
                                            var u = Math.round(c / l);
                                            Ol(n, u, a, i), s.deltaY = c % l
                                        } else s.deltaY = c;
                                        Gs(this.name, n, s)
                                    }
                                }
                            }, {
                                key: "_getDeltaY",
                                value: function(e, t) {
                                    return (Ws(this.name, e).deltaY || 0) + t
                                }
                            }, {
                                key: "_getPixelPerImage",
                                value: function(e) {
                                    var t = _(e, "stack");
                                    if (t && t.data && t.data.length) {
                                        var n = t.data[0];
                                        return this.configuration.stackScrollSpeed || Math.max(2, e.offsetHeight / Math.max(n.imageIds.length, 8))
                                    }
                                }
                            }]), t
                        }(go),
                        Vl = function(e, t, n, o, r) {
                            if (!e) throw new Error("getLuminance: parameter element must not be undefined");
                            t = Math.round(t), n = Math.round(n);
                            var a, i, s, l = y.cornerstone.getEnabledElement(e).image,
                                c = [],
                                u = 0,
                                d = l.getPixelData();
                            if (l.color)
                                for (i = 0; i < r; i++)
                                    for (s = 0; s < o; s++) {
                                        var h = d[a = 4 * ((i + n) * l.columns + (s + t))],
                                            f = d[a + 1],
                                            m = d[a + 2];
                                        c[u++] = .2126 * h + .7152 * f + .0722 * m
                                    } else
                                        for (i = 0; i < r; i++)
                                            for (s = 0; s < o; s++) a = (i + n) * l.columns + (s + t), c[u++] = d[a] * l.slope + l.intercept;
                            return c
                        },
                        Fl = function(e) {
                            function t() {
                                var e, n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var o = {
                                    name: "WwwcRegion",
                                    supportedInteractionTypes: ["Mouse", "Touch"],
                                    configuration: {
                                        minWindowWidth: 10
                                    },
                                    svgCursor: Br
                                };
                                return (e = u()(this, h()(t).call(this, n, o)))._resetHandles(), e.postTouchStartCallback = e._startOutliningRegion.bind(Ao()(e)), e.touchDragCallback = e._setHandlesAndUpdate.bind(Ao()(e)), e.touchEndCallback = e._applyStrategy.bind(Ao()(e)), e.postMouseDownCallback = e._startOutliningRegion.bind(Ao()(e)), e.mouseClickCallback = e._startOutliningRegion.bind(Ao()(e)), e.mouseDragCallback = e._setHandlesAndUpdate.bind(Ao()(e)), e.mouseMoveCallback = e._setHandlesAndUpdate.bind(Ao()(e)), e.mouseUpCallback = e._applyStrategy.bind(Ao()(e)), e
                            }
                            return m()(t, e), l()(t, [{
                                key: "renderToolData",
                                value: function(e) {
                                    var t = this,
                                        n = e.detail,
                                        o = n.element,
                                        r = un.getColorIfActive({
                                            active: !0
                                        }),
                                        a = Dn(n.canvasContext.canvas);
                                    Wt(a, (function(e) {
                                        Mn(e, o, t.handles.start, t.handles.end, {
                                            color: r
                                        })
                                    }))
                                }
                            }, {
                                key: "_startOutliningRegion",
                                value: function(e) {
                                    var t = e.detail.element,
                                        n = e.detail.currentPoints.image;
                                    return Hl(this.handles.start) ? this.handles.start = n : (this.handles.end = n, this._applyStrategy(e)), y.cornerstone.updateImage(t), !0
                                }
                            }, {
                                key: "_setHandlesAndUpdate",
                                value: function(e) {
                                    var t = e.detail.element,
                                        n = e.detail.currentPoints.image;
                                    this.handles.end = n, y.cornerstone.updateImage(t)
                                }
                            }, {
                                key: "_applyStrategy",
                                value: function(e) {
                                    Hl(this.handles.start) || Hl(this.handles.end) || (e.detail.handles = this.handles, ql(e, this.configuration), this._resetHandles())
                                }
                            }, {
                                key: "_resetHandles",
                                value: function() {
                                    this.handles = {
                                        start: {},
                                        end: {}
                                    }
                                }
                            }]), t
                        }(go),
                        Hl = function(e) {
                            return 0 === Object.keys(e).length && e.constructor === Object
                        },
                        ql = function(e, t) {
                            var n = e.detail,
                                o = n.image,
                                r = n.element,
                                a = e.detail.handles,
                                i = a.start,
                                s = a.end,
                                l = Math.min(i.x, s.x),
                                c = Math.min(i.y, s.y),
                                u = Math.abs(i.x - s.x),
                                d = Math.abs(i.y - s.y);
                            l = An(l, 0, o.width), c = An(c, 0, o.height), u = Math.floor(Math.min(u, Math.abs(o.width - l))), d = Math.floor(Math.min(d, Math.abs(o.height - c)));
                            var h = Vl(r, l, c, u, d),
                                f = jl(h, o.minPixelValue, o.maxPixelValue),
                                m = n.viewport;
                            void 0 === t.minWindowWidth && (t.minWindowWidth = 10), m.voi.windowWidth = Math.max(Math.abs(f.max - f.min), t.minWindowWidth), m.voi.windowCenter = f.mean, m.voiLUT = void 0, y.cornerstone.setViewport(r, m), y.cornerstone.updateImage(r)
                        },
                        jl = function(e, t, n) {
                            var o = e.length,
                                r = n,
                                a = t,
                                i = 0;
                            if (o < 2) return {
                                min: r,
                                max: a,
                                mean: (t + n) / 2
                            };
                            for (var s = 0; s < o; s++) {
                                var l = e[s];
                                r = Math.min(r, l), a = Math.max(a, l), i += l
                            }
                            return {
                                min: r,
                                max: a,
                                mean: i / o
                            }
                        },
                        zl = function(e) {
                            function t() {
                                var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var n = {
                                    name: "Wwwc",
                                    strategies: {
                                        basicLevelingStrategy: Wl
                                    },
                                    supportedInteractionTypes: ["Mouse", "Touch"],
                                    configuration: {
                                        orientation: 0
                                    },
                                    svgCursor: Vr
                                };
                                return u()(this, h()(t).call(this, e, n))
                            }
                            return m()(t, e), l()(t, [{
                                key: "mouseDragCallback",
                                value: function(e) {
                                    this.applyActiveStrategy(e), y.cornerstone.setViewport(e.detail.element, e.detail.viewport)
                                }
                            }, {
                                key: "touchDragCallback",
                                value: function(e) {
                                    e.stopImmediatePropagation(), this.applyActiveStrategy(e), y.cornerstone.setViewport(e.detail.element, e.detail.viewport)
                                }
                            }]), t
                        }(go);

                    function Wl(e) {
                        var t = this.configuration.orientation,
                            n = e.detail,
                            o = (n.image.maxPixelValue * n.image.slope + n.image.intercept - (n.image.minPixelValue * n.image.slope + n.image.intercept)) / 1024,
                            r = n.deltaPoints.page.x * o,
                            a = n.deltaPoints.page.y * o;
                        0 === t ? (n.viewport.voi.windowWidth += r, n.viewport.voi.windowCenter += a) : (n.viewport.voi.windowWidth += a, n.viewport.voi.windowCenter += r), n.viewport.voiLUT = void 0
                    }
                    var Gl = function(e, t, n) {
                            var o = n.maxScale,
                                r = n.minScale,
                                a = Math.log(e.scale) / Math.log(1.7) + t,
                                i = Math.pow(1.7, a);
                            return e.scale = o && i > o ? o : r && i < r ? r : i, e
                        },
                        Yl = {
                            changeViewportScale: Gl,
                            correctShift: function(e, t) {
                                var n = t.hflip,
                                    o = t.vflip,
                                    r = t.rotation;
                                if (e.x *= n ? -1 : 1, e.y *= o ? -1 : 1, 0 !== r) {
                                    var a = r * Math.PI / 180,
                                        i = Math.cos(a),
                                        s = Math.sin(a),
                                        l = e.x * i - e.y * s,
                                        c = e.x * s + e.y * i;
                                    e.x = l, e.y = c
                                }
                                return e
                            }
                        },
                        Zl = function(e) {
                            function t() {
                                var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var n = {
                                    name: "ZoomMouseWheel",
                                    supportedInteractionTypes: ["MouseWheel"],
                                    configuration: {
                                        minScale: .25,
                                        maxScale: 20,
                                        invert: !1
                                    }
                                };
                                return u()(this, h()(t).call(this, e, n))
                            }
                            return m()(t, e), l()(t, [{
                                key: "mouseWheelCallback",
                                value: function(e) {
                                    var t = e.detail,
                                        n = t.element,
                                        o = t.viewport,
                                        r = t.spinY,
                                        a = this.configuration,
                                        i = a.invert,
                                        s = a.maxScale,
                                        l = a.minScale,
                                        c = Gl(o, i ? r / 4 : -r / 4, {
                                            maxScale: s,
                                            minScale: l
                                        });
                                    y.cornerstone.setViewport(n, c)
                                }
                            }]), t
                        }(go),
                        Kl = Yl.correctShift,
                        Xl = Yl.changeViewportScale,
                        Jl = function(e) {
                            function t() {
                                var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var n = {
                                    name: "Zoom",
                                    strategies: {
                                        default: $l,
                                        translate: ec,
                                        zoomToCenter: tc
                                    },
                                    defaultStrategy: "default",
                                    supportedInteractionTypes: ["Mouse", "Touch"],
                                    configuration: {
                                        invert: !1,
                                        preventZoomOutsideImage: !1,
                                        minScale: .25,
                                        maxScale: 20
                                    },
                                    svgCursor: Fr
                                };
                                return u()(this, h()(t).call(this, e, n))
                            }
                            return m()(t, e), l()(t, [{
                                key: "touchDragCallback",
                                value: function(e) {
                                    Ql.call(this, e)
                                }
                            }, {
                                key: "mouseDragCallback",
                                value: function(e) {
                                    Ql.call(this, e)
                                }
                            }]), t
                        }(go),
                        Ql = function(e) {
                            if (!e.detail.deltaPoints.page.y) return !1;
                            this.applyActiveStrategy(e, this.configuration), y.cornerstone.setViewport(e.detail.element, e.detail.viewport)
                        };

                    function $l(e) {
                        var t = this.configuration,
                            n = t.invert,
                            o = t.maxScale,
                            r = t.minScale,
                            a = e.detail.deltaPoints.page.y,
                            i = n ? -a / 100 : a / 100,
                            s = e.detail,
                            l = s.element,
                            c = s.viewport,
                            u = [e.detail.startPoints.page.x, e.detail.startPoints.page.y, e.detail.startPoints.image.x, e.detail.startPoints.image.y],
                            d = u[0],
                            h = u[1],
                            f = u[2],
                            m = u[3],
                            g = Xl(c, i, {
                                maxScale: o,
                                minScale: r
                            });
                        y.cornerstone.setViewport(l, g);
                        var p = y.cornerstone.pageToPixel(l, d, h),
                            v = {
                                x: f - p.x,
                                y: m - p.y
                            };
                        v = Kl(v, g), c.translation.x -= v.x, c.translation.y -= v.y
                    }

                    function ec(e) {
                        var t = this.configuration,
                            n = t.invert,
                            o = t.preventZoomOutsideImage,
                            r = t.maxScale,
                            a = t.minScale,
                            i = e.detail.deltaPoints.page.y,
                            s = n ? -i / 100 : i / 100,
                            l = e.detail.image,
                            c = e.detail.viewport,
                            u = [e.detail.startPoints.image.x, e.detail.startPoints.image.y],
                            d = u[0],
                            h = u[1],
                            f = Xl(c, s, {
                                maxScale: r,
                                minScale: a
                            }),
                            m = {
                                x: 0,
                                y: 0
                            };
                        if (s < 0) f.scale < 3 && (Math.abs(f.translation.x) < .01 ? f.translation.x = 0 : m.x = f.translation.x / 8, Math.abs(f.translation.y) < .01 ? f.translation.y = 0 : m.y = f.translation.y / 8);
                        else {
                            o && In(e.detail.startPoints.image, l);
                            var g = {
                                x: l.width / 2 - d,
                                y: l.height / 2 - h
                            };
                            g = Kl(g, f);
                            var p = {
                                x: f.translation.x - g.x,
                                y: f.translation.y - g.y
                            };
                            Math.abs(p.x) < .01 ? f.translation.x = g.x : m.x = p.x / 8, Math.abs(p.y) < .01 ? f.translation.y = g.y : m.y = p.y / 8
                        }
                        f.translation.x -= m.x, f.translation.y -= m.y
                    }

                    function tc(e) {
                        var t = this.configuration,
                            n = t.invert,
                            o = t.maxScale,
                            r = t.minScale,
                            a = e.detail.deltaPoints.page.y,
                            i = n ? -a / 100 : a / 100,
                            s = e.detail.viewport;
                        Xl(s, i, {
                            maxScale: o,
                            minScale: r
                        })
                    }
                    var nc = Yl.correctShift,
                        oc = function(e) {
                            function t() {
                                var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                                i()(this, t);
                                var n = {
                                    name: "ZoomTouchPinch",
                                    supportedInteractionTypes: ["TouchPinch"],
                                    configuration: {
                                        minScale: .25,
                                        maxScale: 20
                                    }
                                };
                                return u()(this, h()(t).call(this, e, n))
                            }
                            return m()(t, e), l()(t, [{
                                key: "touchPinchCallback",
                                value: function(e) {
                                    var t = e.detail,
                                        n = t.element,
                                        o = t.viewport,
                                        r = t.scaleChange,
                                        a = [e.detail.startPoints.page.x, e.detail.startPoints.page.y, e.detail.startPoints.image.x, e.detail.startPoints.image.y],
                                        i = a[0],
                                        s = a[1],
                                        l = a[2],
                                        c = a[3],
                                        u = this.configuration,
                                        d = u.maxScale,
                                        h = u.minScale;
                                    o.scale += r * o.scale, d && o.scale > d ? o.scale = d : h && o.scale < h && (o.scale = h), y.cornerstone.setViewport(n, o);
                                    var f = y.cornerstone.pageToPixel(n, i, s),
                                        m = {
                                            x: l - f.x,
                                            y: c - f.y
                                        };
                                    m = nc(m, o), o.translation.x -= m.x, o.translation.y -= m.y, y.cornerstone.setViewport(n, o)
                                }
                            }]), t
                        }(go),
                        rc = function(e) {
                            return {
                                page: ac(e.page),
                                image: ac(e.image),
                                client: ac(e.client),
                                canvas: ac(e.canvas)
                            }
                        };

                    function ac() {
                        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                        return {
                            x: e.x,
                            y: e.y
                        }
                    }
                    var ic, sc = B("eventListeners:mouseEventListeners"),
                        lc = !0,
                        cc = new Map;

                    function uc(e) {
                        if ("number" == typeof e.buttons) return e.buttons;
                        switch (e.which) {
                            case 0:
                                return 0;
                            case 1:
                                return 1;
                            case 2:
                                return 4;
                            case 3:
                                return 2
                        }
                        return 0
                    }

                    function dc() {
                        lc = !1
                    }

                    function hc(e) {
                        var t = e.currentTarget,
                            n = y.cornerstone.getEnabledElement(t);
                        if (n.image) {
                            var o = x.MOUSE_DOUBLE_CLICK,
                                r = {
                                    page: y.cornerstoneMath.point.pageToPoint(e),
                                    image: y.cornerstone.pageToPixel(t, e.pageX, e.pageY),
                                    client: {
                                        x: e.clientX,
                                        y: e.clientY
                                    }
                                };
                            r.canvas = y.cornerstone.pixelToCanvas(t, r.image);
                            var a = rc(r);
                            sc.log("double-click: %o", uc(e)), T(t, o, {
                                event: e,
                                buttons: uc(e),
                                viewport: y.cornerstone.getViewport(t),
                                image: n.image,
                                element: t,
                                startPoints: r,
                                lastPoints: a,
                                currentPoints: r,
                                deltaPoints: {
                                    x: 0,
                                    y: 0
                                },
                                type: o
                            })
                        }
                    }

                    function fc(e) {
                        var t = e.currentTarget,
                            n = y.cornerstone.getEnabledElement(t);
                        if (n.image) {
                            ic = setTimeout(dc, 200), t.removeEventListener("mousemove", mc);
                            var o = {
                                page: y.cornerstoneMath.point.pageToPoint(e),
                                image: y.cornerstone.pageToPixel(t, e.pageX, e.pageY),
                                client: {
                                    x: e.clientX,
                                    y: e.clientY
                                }
                            };
                            o.canvas = y.cornerstone.pixelToCanvas(t, o.image);
                            var r = rc(o),
                                a = {
                                    event: e,
                                    buttons: uc(e),
                                    viewport: y.cornerstone.getViewport(t),
                                    image: n.image,
                                    element: t,
                                    startPoints: o,
                                    lastPoints: r,
                                    currentPoints: o,
                                    deltaPoints: {
                                        x: 0,
                                        y: 0
                                    },
                                    type: x.MOUSE_DOWN
                                };
                            T(a.element, x.MOUSE_DOWN, a) && (a.type = x.MOUSE_DOWN_ACTIVATE, T(a.element, x.MOUSE_DOWN_ACTIVATE, a)), document.addEventListener("mousemove", i), document.addEventListener("mouseup", s), cc.set(i, "mousemove"), cc.set(s, "mouseup")
                        }

                        function i(e) {
                            var a = x.MOUSE_DRAG,
                                i = {
                                    page: y.cornerstoneMath.point.pageToPoint(e),
                                    image: y.cornerstone.pageToPixel(t, e.pageX, e.pageY),
                                    client: {
                                        x: e.clientX,
                                        y: e.clientY
                                    }
                                };
                            i.canvas = y.cornerstone.pixelToCanvas(t, i.image);
                            var s = {
                                page: y.cornerstoneMath.point.subtract(i.page, r.page),
                                image: y.cornerstoneMath.point.subtract(i.image, r.image),
                                client: y.cornerstoneMath.point.subtract(i.client, r.client),
                                canvas: y.cornerstoneMath.point.subtract(i.canvas, r.canvas)
                            };
                            sc.log("mousemove: %o", uc(e));
                            var l = {
                                buttons: uc(e),
                                viewport: y.cornerstone.getViewport(t),
                                image: n.image,
                                element: t,
                                startPoints: o,
                                lastPoints: r,
                                currentPoints: i,
                                deltaPoints: s,
                                type: a,
                                ctrlKey: e.ctrlKey,
                                metaKey: e.metaKey,
                                shiftKey: e.shiftKey
                            };
                            T(l.element, a, l), r = rc(i)
                        }

                        function s(e) {
                            clearTimeout(ic);
                            var a = x.MOUSE_UP;
                            lc && (a = x.MOUSE_CLICK);
                            var l = {
                                page: y.cornerstoneMath.point.pageToPoint(e),
                                image: y.cornerstone.pageToPixel(t, e.pageX, e.pageY),
                                client: {
                                    x: e.clientX,
                                    y: e.clientY
                                }
                            };
                            l.canvas = y.cornerstone.pixelToCanvas(t, l.image);
                            var c = {
                                page: y.cornerstoneMath.point.subtract(l.page, r.page),
                                image: y.cornerstoneMath.point.subtract(l.image, r.image),
                                client: y.cornerstoneMath.point.subtract(l.client, r.client),
                                canvas: y.cornerstoneMath.point.subtract(l.canvas, r.canvas)
                            };
                            sc.log("mouseup: %o", uc(e));
                            var u = {
                                event: e,
                                buttons: uc(e),
                                viewport: y.cornerstone.getViewport(t),
                                image: n.image,
                                element: t,
                                startPoints: o,
                                lastPoints: r,
                                currentPoints: l,
                                deltaPoints: c,
                                type: a
                            };
                            T(u.element, a, u), document.removeEventListener("mousemove", i), document.removeEventListener("mouseup", s), cc.delete(i), cc.delete(s), t.addEventListener("mousemove", mc), lc = !0
                        }
                    }

                    function mc(e) {
                        var t = e.currentTarget,
                            n = y.cornerstone.getEnabledElement(t);
                        if (n.image) {
                            var o = x.MOUSE_MOVE,
                                r = {
                                    page: y.cornerstoneMath.point.pageToPoint(e),
                                    image: y.cornerstone.pageToPixel(t, e.pageX, e.pageY),
                                    client: {
                                        x: e.clientX,
                                        y: e.clientY
                                    }
                                };
                            r.canvas = y.cornerstone.pixelToCanvas(t, r.image);
                            var a = rc(r),
                                i = {
                                    page: y.cornerstoneMath.point.pageToPoint(e),
                                    image: y.cornerstone.pageToPixel(t, e.pageX, e.pageY),
                                    client: {
                                        x: e.clientX,
                                        y: e.clientY
                                    }
                                };
                            i.canvas = y.cornerstone.pixelToCanvas(t, i.image);
                            var s = {
                                page: y.cornerstoneMath.point.subtract(i.page, a.page),
                                image: y.cornerstoneMath.point.subtract(i.image, a.image),
                                client: y.cornerstoneMath.point.subtract(i.client, a.client),
                                canvas: y.cornerstoneMath.point.subtract(i.canvas, a.canvas)
                            };
                            T(t, o, {
                                viewport: y.cornerstone.getViewport(t),
                                image: n.image,
                                element: t,
                                startPoints: r,
                                lastPoints: a,
                                currentPoints: i,
                                deltaPoints: s,
                                type: o
                            }), a = rc(i)
                        }
                    }

                    function gc(e) {
                        e.removeEventListener("mousedown", fc), e.removeEventListener("mousemove", mc), e.removeEventListener("dblclick", hc), cc.forEach((function(e, t) {
                            document.removeEventListener(e, t)
                        })), cc.clear()
                    }
                    var pc = {
                        enable: function(e) {
                            gc(e), e.addEventListener("mousedown", fc), e.addEventListener("mousemove", mc), e.addEventListener("dblclick", hc)
                        },
                        disable: gc
                    };

                    function vc(e) {
                        var t = e.currentTarget,
                            n = y.cornerstone.getEnabledElement(t);
                        if (n.image && !(e.deltaY > -1 && e.deltaY < 1)) {
                            e.preventDefault();
                            var o = e.pageX,
                                r = e.pageY,
                                a = y.cornerstone.pageToPixel(t, o, r),
                                i = function(e) {
                                    var t = 0,
                                        n = 0,
                                        o = 0,
                                        r = 0;
                                    return "detail" in e && (n = e.detail), "wheelDelta" in e && (n = -e.wheelDelta / 120), "wheelDeltaY" in e && (n = -e.wheelDeltaY / 120), "wheelDeltaX" in e && (t = -e.wheelDeltaX / 120), o = 10 * t, r = 10 * n, "deltaY" in e && (r = e.deltaY), "deltaX" in e && (o = e.deltaX), (o || r) && e.deltaMode && (1 === e.deltaMode ? (o *= 40, r *= 40) : (o *= 800, r *= 800)), o && !t && (t = o < 1 ? -1 : 1), r && !n && (n = r < 1 ? -1 : 1), {
                                        spinX: t,
                                        spinY: n,
                                        pixelX: o,
                                        pixelY: r
                                    }
                                }(e),
                                s = i.spinX,
                                l = i.spinY,
                                c = i.pixelX,
                                u = i.pixelY,
                                d = l < 0 ? -1 : 1,
                                h = {
                                    element: t,
                                    viewport: y.cornerstone.getViewport(t),
                                    detail: e,
                                    image: n.image,
                                    direction: d,
                                    spinX: s,
                                    spinY: l,
                                    pixelX: c,
                                    pixelY: u,
                                    pageX: o,
                                    pageY: r,
                                    imageX: a.x,
                                    imageY: a.y
                                };
                            T(t, x.MOUSE_WHEEL, h)
                        }
                    }

                    function yc(e) {
                        e.removeEventListener("wheel", vc, {
                            passive: !1
                        })
                    }
                    var bc, wc, xc = {
                            enable: function(e) {
                                yc(e), e.addEventListener("wheel", vc, {
                                    passive: !1
                                })
                            },
                            disable: yc
                        },
                        Tc = 0,
                        Ic = 1;

                    function Ec(e, t) {
                        var n = Date.now();
                        if (e !== bc) {
                            if (n - wc <= 2e3) return t.preventDefault(), t.stopPropagation(), t.stopImmediatePropagation(), !1;
                            bc = e
                        }
                        wc = n
                    }
                    var Sc = Ec.bind(null, Tc),
                        Ac = Ec.bind(null, Ic);

                    function Cc(e, t, n) {
                        var o = n ? Sc : Ac;
                        t.forEach((function(t) {
                            e.addEventListener(t, o, {
                                passive: !1
                            })
                        }))
                    }

                    function Mc(e, t, n) {
                        var o = n ? Sc : Ac;
                        t.forEach((function(t) {
                            e.removeEventListener(t, o)
                        }))
                    }
                    var Dc = ["mousedown", "mouseup"],
                        Pc = ["touchstart", "touchend"];

                    function kc(e) {
                        Mc(e, Dc, Tc), Mc(e, Pc, Ic)
                    }
                    var _c, Lc, Oc, Rc, Nc, Uc, Bc, Vc, Fc, Hc = {
                            enable: function(e) {
                                kc(e), Cc(e, Dc, Tc), Cc(e, Pc, Ic)
                            },
                            disable: kc
                        },
                        qc = 1,
                        jc = 0,
                        zc = !1,
                        Wc = !1;

                    function Gc(e) {
                        var t = e.currentTarget || e.srcEvent.currentTarget,
                            n = y.cornerstone.getEnabledElement(t);
                        if (n.image) {
                            var o, r, a, i;
                            switch (e.preventDefault(), (e.pointers && e.pointers.length > 1 || e.touches && e.touches.length > 1) && (Wc = !1, clearTimeout(Bc)), e.type) {
                                case "tap":
                                    Wc = !1, clearTimeout(Bc), (Lc = {
                                        page: y.cornerstoneMath.point.pageToPoint(e.pointers[0]),
                                        image: y.cornerstone.pageToPixel(t, e.pointers[0].pageX, e.pointers[0].pageY),
                                        client: {
                                            x: e.pointers[0].clientX,
                                            y: e.pointers[0].clientY
                                        }
                                    }).canvas = y.cornerstone.pixelToCanvas(t, Lc.image), o = x.TAP, Nc = {
                                        event: e,
                                        viewport: y.cornerstone.getViewport(t),
                                        image: n.image,
                                        element: t,
                                        currentPoints: Lc,
                                        type: o,
                                        isTouchEvent: !0
                                    }, T(t, o, Nc);
                                    break;
                                case "doubletap":
                                    Wc = !1, clearTimeout(Bc), (Lc = {
                                        page: y.cornerstoneMath.point.pageToPoint(e.pointers[0]),
                                        image: y.cornerstone.pageToPixel(t, e.pointers[0].pageX, e.pointers[0].pageY),
                                        client: {
                                            x: e.pointers[0].clientX,
                                            y: e.pointers[0].clientY
                                        }
                                    }).canvas = y.cornerstone.pixelToCanvas(t, Lc.image), o = x.DOUBLE_TAP, Nc = {
                                        event: e,
                                        viewport: y.cornerstone.getViewport(t),
                                        image: n.image,
                                        element: t,
                                        currentPoints: Lc,
                                        type: o,
                                        isTouchEvent: !0
                                    }, T(t, o, Nc);
                                    break;
                                case "pinchstart":
                                    Wc = !1, clearTimeout(Bc), qc = 1;
                                    break;
                                case "pinchmove":
                                    if (Wc = !1, clearTimeout(Bc), !0 === zc) {
                                        qc = e.scale, zc = !1;
                                        break
                                    }
                                    r = (e.scale - qc) / qc, (_c = {
                                        page: e.center,
                                        image: y.cornerstone.pageToPixel(t, e.center.x, e.center.y)
                                    }).canvas = y.cornerstone.pixelToCanvas(t, _c.image), o = x.TOUCH_PINCH, Nc = {
                                        event: e,
                                        startPoints: _c,
                                        viewport: y.cornerstone.getViewport(t),
                                        image: n.image,
                                        element: t,
                                        direction: e.scale < 1 ? 1 : -1,
                                        scaleChange: r,
                                        type: o,
                                        isTouchEvent: !0
                                    }, T(t, o, Nc), qc = e.scale;
                                    break;
                                case "touchstart":
                                    qc = 1, clearTimeout(Bc), clearTimeout(Uc), Uc = setTimeout((function() {
                                        (_c = {
                                            page: y.cornerstoneMath.point.pageToPoint(e.touches[0]),
                                            image: y.cornerstone.pageToPixel(t, e.touches[0].pageX, e.touches[0].pageY),
                                            client: {
                                                x: e.touches[0].clientX,
                                                y: e.touches[0].clientY
                                            }
                                        }).canvas = y.cornerstone.pixelToCanvas(t, _c.image), o = x.TOUCH_START, e.touches.length > 1 && (o = x.MULTI_TOUCH_START), Nc = {
                                            event: e,
                                            viewport: y.cornerstone.getViewport(t),
                                            image: n.image,
                                            element: t,
                                            startPoints: _c,
                                            currentPoints: _c,
                                            type: o,
                                            isTouchEvent: !0
                                        }, !0 === T(t, o, Nc) && (o = x.TOUCH_START_ACTIVE, e.touches.length > 1 && (o = x.MULTI_TOUCH_START_ACTIVE), Nc.type = o, T(t, o, Nc)), Oc = rc(_c)
                                    }), 50), Wc = !0, Vc = 0, Bc = setTimeout((function() {
                                        Wc && ((Lc = {
                                            page: y.cornerstoneMath.point.pageToPoint(e.touches[0]),
                                            image: y.cornerstone.pageToPixel(t, e.touches[0].pageX, e.touches[0].pageY),
                                            client: {
                                                x: e.touches[0].clientX,
                                                y: e.touches[0].clientY
                                            }
                                        }).canvas = y.cornerstone.pixelToCanvas(t, _c.image), o = x.TOUCH_PRESS, Nc = {
                                            event: e,
                                            viewport: y.cornerstone.getViewport(t),
                                            image: n.image,
                                            element: t,
                                            currentPoints: Lc,
                                            type: o,
                                            isTouchEvent: !0
                                        }, T(t, o, Nc))
                                    }), 700);
                                    break;
                                case "touchend":
                                    qc = 1, Wc = !1, clearTimeout(Bc), setTimeout((function() {
                                        (_c = {
                                            page: y.cornerstoneMath.point.pageToPoint(e.changedTouches[0]),
                                            image: y.cornerstone.pageToPixel(t, e.changedTouches[0].pageX, e.changedTouches[0].pageY),
                                            client: {
                                                x: e.changedTouches[0].clientX,
                                                y: e.changedTouches[0].clientY
                                            }
                                        }).canvas = y.cornerstone.pixelToCanvas(t, _c.image), o = x.TOUCH_END, Nc = {
                                            event: e,
                                            viewport: y.cornerstone.getViewport(t),
                                            image: n.image,
                                            element: t,
                                            startPoints: _c,
                                            currentPoints: _c,
                                            type: o,
                                            isTouchEvent: !0
                                        }, T(t, o, Nc)
                                    }), 50);
                                    break;
                                case "panmove":
                                    a = {
                                        x: e.deltaX - Fc.x,
                                        y: e.deltaY - Fc.y
                                    }, Fc = {
                                        x: e.deltaX,
                                        y: e.deltaY
                                    }, (Lc = {
                                        page: {
                                            x: Oc.page.x + a.x,
                                            y: Oc.page.y + a.y
                                        },
                                        image: y.cornerstone.pageToPixel(t, Oc.page.x + a.x, Oc.page.y + a.y),
                                        client: {
                                            x: Oc.client.x + a.x,
                                            y: Oc.client.y + a.y
                                        }
                                    }).canvas = y.cornerstone.pixelToCanvas(t, Lc.image), Rc = {
                                        page: y.cornerstoneMath.point.subtract(Lc.page, Oc.page),
                                        image: y.cornerstoneMath.point.subtract(Lc.image, Oc.image),
                                        client: y.cornerstoneMath.point.subtract(Lc.client, Oc.client),
                                        canvas: y.cornerstoneMath.point.subtract(Lc.canvas, Oc.canvas)
                                    }, (Vc += Math.sqrt(Rc.page.x * Rc.page.x + Rc.page.y * Rc.page.y)) > 5 && (Wc = !1, clearTimeout(Bc)), o = x.TOUCH_DRAG, e.pointers.length > 1 && (o = x.MULTI_TOUCH_DRAG), Nc = {
                                        viewport: y.cornerstone.getViewport(t),
                                        image: n.image,
                                        element: t,
                                        startPoints: _c,
                                        lastPoints: Oc,
                                        currentPoints: Lc,
                                        deltaPoints: Rc,
                                        numPointers: e.pointers.length,
                                        type: o,
                                        isTouchEvent: !0
                                    }, T(t, o, Nc), Oc = rc(Lc);
                                    break;
                                case "panstart":
                                    Fc = {
                                        x: e.deltaX,
                                        y: e.deltaY
                                    }, (Lc = {
                                        page: y.cornerstoneMath.point.pageToPoint(e.pointers[0]),
                                        image: y.cornerstone.pageToPixel(t, e.pointers[0].pageX, e.pointers[0].pageY),
                                        client: {
                                            x: e.pointers[0].clientX,
                                            y: e.pointers[0].clientY
                                        }
                                    }).canvas = y.cornerstone.pixelToCanvas(t, Lc.image), Oc = rc(Lc);
                                    break;
                                case "panend":
                                    if (Wc = !1, clearTimeout(Bc), !Oc) return !1;
                                    (Lc = {
                                        page: y.cornerstoneMath.point.pageToPoint(e.pointers[0]),
                                        image: y.cornerstone.pageToPixel(t, e.pointers[0].pageX, e.pointers[0].pageY),
                                        client: {
                                            x: e.pointers[0].clientX,
                                            y: e.pointers[0].clientY
                                        }
                                    }).canvas = y.cornerstone.pixelToCanvas(t, Lc.image), Rc = {
                                        page: y.cornerstoneMath.point.subtract(Lc.page, Oc.page),
                                        image: y.cornerstoneMath.point.subtract(Lc.image, Oc.image),
                                        client: y.cornerstoneMath.point.subtract(Lc.client, Oc.client),
                                        canvas: y.cornerstoneMath.point.subtract(Lc.canvas, Oc.canvas)
                                    }, o = x.TOUCH_DRAG_END, Nc = {
                                        event: e.srcEvent,
                                        viewport: y.cornerstone.getViewport(t),
                                        image: n.image,
                                        element: t,
                                        startPoints: _c,
                                        lastPoints: Oc,
                                        currentPoints: Lc,
                                        deltaPoints: Rc,
                                        type: o,
                                        isTouchEvent: !0
                                    }, T(t, o, Nc), 2 == e.pointers.length - e.changedPointers.length && (zc = !0);
                                    break;
                                case "rotatemove":
                                    Wc = !1, clearTimeout(Bc), i = e.rotation - jc, jc = e.rotation, o = x.TOUCH_ROTATE, Nc = {
                                        event: e.srcEvent,
                                        viewport: y.cornerstone.getViewport(t),
                                        image: n.image,
                                        element: t,
                                        rotation: i,
                                        type: o
                                    }, T(t, o, Nc)
                            }
                            return !1
                        }
                    }

                    function Yc(e) {
                        Hc.disable(e), ["touchstart", "touchend"].forEach((function(t) {
                            e.removeEventListener(t, Gc)
                        }));
                        var t = Ws("touchInput", e),
                            n = t.hammer;
                        n && (n.off("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove", Gc), n.input.destroy()), t.hammer = null,
                            function(e, t) {
                                var n = zs[e];
                                n && (zs[e] = n.filter((function(e) {
                                    return e.element !== t
                                })))
                            }("touchInput", e)
                    }
                    var Zc = {
                            enable: function(e) {
                                Yc(e);
                                var t = y.Hammer,
                                    n = {
                                        inputClass: t.SUPPORT_POINTER_EVENTS ? t.PointerEventInput : t.TouchInput
                                    },
                                    o = new t.Manager(e, n),
                                    r = {
                                        pointers: 0,
                                        direction: t.DIRECTION_ALL,
                                        threshold: 0
                                    },
                                    a = new t.Pan(r),
                                    i = new t.Pinch({
                                        threshold: 0
                                    }),
                                    s = new t.Rotate({
                                        threshold: 0
                                    });
                                i.recognizeWith(a), i.recognizeWith(s), s.recognizeWith(a);
                                var l = new t.Tap({
                                    event: "doubletap",
                                    taps: 2,
                                    interval: 1500,
                                    threshold: 50,
                                    posThreshold: 50
                                });
                                l.recognizeWith(a), o.add([l, a, s, i]), o.on("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove", Gc), Hc.enable(e), ["touchstart", "touchend"].forEach((function(t) {
                                    e.addEventListener(t, Gc, {
                                        passive: !1
                                    })
                                }));
                                var c = Ws("touchInput", e);
                                c.hammer = o, Gs("touchInput", e, c)
                            },
                            disable: Yc
                        },
                        Kc = wt("segmentation");

                    function Xc(e, t, n, o, r) {
                        ! function(e, t, n) {
                            var o = Kc.configuration,
                                r = e.detail,
                                a = r.canvasContext,
                                i = r.element,
                                s = r.image,
                                l = r.viewport,
                                c = a.getTransform(),
                                u = Dn(a.canvas),
                                d = y.cornerstone.pixelToCanvas(i, {
                                    x: 0,
                                    y: 0
                                }),
                                h = y.cornerstone.pixelToCanvas(i, {
                                    x: s.width,
                                    y: 0
                                }),
                                f = y.cornerstone.pixelToCanvas(i, {
                                    x: s.width,
                                    y: s.height
                                }),
                                m = y.cornerstoneMath.point.distance(d, h),
                                g = y.cornerstoneMath.point.distance(h, f),
                                p = a.canvas,
                                v = u.imageSmoothingEnabled,
                                b = u.globalAlpha;
                            u.imageSmoothingEnabled = !1, u.globalAlpha = n ? o.fillAlpha : o.fillAlphaInactive,
                                function(e, t, n) {
                                    if (n.hflip || n.vflip || n.rotation) {
                                        var o = {
                                            x: t.width / 2 + n.translation.x * n.scale,
                                            y: t.height / 2 + n.translation.y * n.scale
                                        };
                                        e.translate(o.x, o.y), n.rotation && e.rotate(n.rotation * Math.PI / 180), n.vflip && e.scale(1, -1), n.hflip && e.scale(-1, 1), e.translate(-o.x, -o.y)
                                    }
                                }(u, p, l);
                            var w = function(e) {
                                var t = e.viewport,
                                    n = e.image,
                                    o = t.scale,
                                    r = t.scale;
                                return n.rowPixelSpacing < n.columnPixelSpacing ? o *= n.columnPixelSpacing / n.rowPixelSpacing : n.columnPixelSpacing < n.rowPixelSpacing && (r *= n.rowPixelSpacing / n.columnPixelSpacing), {
                                    x: t.translation.x * o,
                                    y: t.translation.y * r
                                }
                            }(r);
                            u.drawImage(t, p.width / 2 - m / 2 + w.x, p.height / 2 - g / 2 + w.y, m, g), u.globalAlpha = b, u.imageSmoothingEnabled = v, u.setTransform(c)
                        }(e, function(e, t, n) {
                            var o = Kc.state,
                                r = e.detail.image,
                                a = r.width,
                                i = r.height,
                                s = t.segmentsHidden,
                                l = n.pixelData,
                                c = o.colorLutTables[t.colorLUTIndex],
                                u = document.createElement("canvas");
                            u.width = a, u.height = i;
                            for (var d = Dn(u), h = new ImageData(a, i), f = h.data, m = 0; m < l.length; m++) {
                                var g = l[m];
                                if (0 !== g && !s[g]) {
                                    var p = c[l[m]];
                                    f[4 * m] = p[0], f[4 * m + 1] = p[1], f[4 * m + 2] = p[2], f[4 * m + 3] = p[3]
                                }
                            }
                            return d.putImageData(h, 0, 0), u
                        }(e, t, n), r)
                    }
                    var Jc = wt("segmentation");

                    function Qc(e, t, n, o, r) {
                        ! function(e, t, n) {
                            var o = !(arguments.length > 3 && void 0 !== arguments[3]) || arguments[3],
                                r = Jc.configuration,
                                a = Jc.state,
                                i = e.detail,
                                s = i.element,
                                l = i.canvasContext,
                                c = r.outlineWidth || 1,
                                u = l.getTransform(),
                                d = Dn(l.canvas),
                                h = a.colorLutTables[n],
                                f = d.globalAlpha;
                            d.globalAlpha = o ? r.outlineAlpha : r.outlineAlphaInactive, Wt(d, (function(e) {
                                for (var n = 1; n < t.length; n++)
                                    if (t[n]) {
                                        var o = h[n];
                                        hn(e, s, t[n], {
                                            color: "rgba(".concat(o[0], ", ").concat(o[1], ", ").concat(o[2], ", 1.0 )"),
                                            lineWidth: c
                                        }, "canvas")
                                    }
                            })), d.globalAlpha = f, d.setTransform(u)
                        }(e, function(e, t, n, o) {
                            var r = e.detail,
                                a = r.element,
                                i = r.image,
                                s = r.viewport,
                                l = i.width,
                                c = i.height;
                            o = o || 1;
                            var u, d = t.segmentsHidden,
                                h = n.pixelData,
                                f = t.activeSegmentIndex,
                                m = [];
                            n.segmentsOnLabelmap.forEach((function(e) {
                                !d[e] && (m[e] = [])
                            })), m[f] || (m[f] = []);
                            for (var g = function(e, t) {
                                    var n = t / 2,
                                        o = e.rotation;
                                    o *= Math.PI / 180;
                                    var r = Math.cos(o),
                                        a = Math.sin(o),
                                        i = [r, a],
                                        s = [-a, r],
                                        l = {
                                            x: n * i[0],
                                            y: n * i[1]
                                        },
                                        c = {
                                            x: n * s[0],
                                            y: n * s[1]
                                        };
                                    return e.hflip && (l.x *= -1, l.y *= -1), e.vflip && (c.x *= -1, c.y *= -1), {
                                        i: l,
                                        j: c
                                    }
                                }(s, o), p = 0; p < h.length; p++) {
                                var v = h[p];
                                if (0 !== v && !d[v]) {
                                    var y = {
                                            x: (u = p) % l,
                                            y: Math.floor(u / l)
                                        },
                                        b = $c(y, c, l);
                                    void 0 !== b.top && h[b.top] === v || ru(m[v], a, y, g), void 0 !== b.bottom && h[b.bottom] === v || au(m[v], a, y, g), void 0 !== b.left && h[b.left] === v || iu(m[v], a, y, g), void 0 !== b.right && h[b.right] === v || su(m[v], a, y, g), void 0 !== b.topLeft && h[b.topLeft] !== v && h[b.top] === v && h[b.left] === v && eu(m[v], a, y, g), void 0 !== b.topRight && h[b.topRight] !== v && h[b.top] === v && h[b.right] === v && tu(m[v], a, y, g), void 0 !== b.bottomLeft && h[b.bottomLeft] !== v && h[b.bottom] === v && h[b.left] === v && nu(m[v], a, y, g), void 0 !== b.bottomRight && h[b.bottomRight] !== v && h[b.bottom] === v && h[b.right] === v && ou(m[v], a, y, g)
                                }
                            }
                            return m
                        }(e, t, n, Jc.configuration.outlineWidth), t.colorLUTIndex, r)
                    }

                    function $c(e, t, n) {
                        var o = e.y * n + e.x,
                            r = {},
                            a = e.y - 1 >= 0,
                            i = e.y + 1 < t,
                            s = e.x - 1 >= 0,
                            l = e.x + 1 < n;
                        return a && (r.top = o - n, l && (r.topRight = r.top + 1), s && (r.topLeft = r.top - 1)), i && (r.bottom = o + n, l && (r.bottomRight = r.bottom + 1), s && (r.bottomLeft = r.bottom - 1)), s && (r.left = o - 1), l && (r.right = o + 1), r
                    }

                    function eu(e, t, n, o) {
                        var r = (0, y.cornerstone.pixelToCanvas)(t, n);
                        r.x += o.j.x, r.y += o.j.y;
                        var a = {
                            x: r.x,
                            y: r.y
                        };
                        a.x += 2 * o.i.x, a.y += 2 * o.i.y, e.push({
                            start: r,
                            end: a
                        })
                    }

                    function tu(e, t, n, o) {
                        var r = (0, y.cornerstone.pixelToCanvas)(t, {
                            x: n.x + 1,
                            y: n.y
                        });
                        r.x += o.j.x, r.y += o.j.y;
                        var a = {
                            x: r.x,
                            y: r.y
                        };
                        a.x -= 2 * o.i.x, a.y -= 2 * o.i.y, e.push({
                            start: r,
                            end: a
                        })
                    }

                    function nu(e, t, n, o) {
                        var r = (0, y.cornerstone.pixelToCanvas)(t, {
                            x: n.x,
                            y: n.y + 1
                        });
                        r.x -= o.j.x, r.y -= o.j.y;
                        var a = {
                            x: r.x,
                            y: r.y
                        };
                        a.x += 2 * o.i.x, a.y += 2 * o.i.y, e.push({
                            start: r,
                            end: a
                        })
                    }

                    function ou(e, t, n, o) {
                        var r = (0, y.cornerstone.pixelToCanvas)(t, {
                            x: n.x + 1,
                            y: n.y + 1
                        });
                        r.x -= o.j.x, r.y -= o.j.y;
                        var a = {
                            x: r.x,
                            y: r.y
                        };
                        a.x -= 2 * o.i.x, a.y -= 2 * o.i.y, e.push({
                            start: r,
                            end: a
                        })
                    }

                    function ru(e, t, n, o) {
                        var r = y.cornerstone.pixelToCanvas,
                            a = r(t, n),
                            i = r(t, {
                                x: n.x + 1,
                                y: n.y
                            });
                        a.x += o.j.x, a.y += o.j.y, i.x += o.j.x, i.y += o.j.y, e.push({
                            start: a,
                            end: i
                        })
                    }

                    function au(e, t, n, o) {
                        var r = y.cornerstone.pixelToCanvas,
                            a = r(t, {
                                x: n.x,
                                y: n.y + 1
                            }),
                            i = r(t, {
                                x: n.x + 1,
                                y: n.y + 1
                            });
                        a.x -= o.j.x, a.y -= o.j.y, i.x -= o.j.x, i.y -= o.j.y, e.push({
                            start: a,
                            end: i
                        })
                    }

                    function iu(e, t, n, o) {
                        var r = y.cornerstone.pixelToCanvas,
                            a = r(t, n),
                            i = r(t, {
                                x: n.x,
                                y: n.y + 1
                            });
                        a.x += o.i.x, a.y += o.i.y, i.x += o.i.x, i.y += o.i.y, e.push({
                            start: a,
                            end: i
                        })
                    }

                    function su(e, t, n, o) {
                        var r = y.cornerstone.pixelToCanvas,
                            a = r(t, {
                                x: n.x + 1,
                                y: n.y
                            }),
                            i = r(t, {
                                x: n.x + 1,
                                y: n.y + 1
                            });
                        a.x -= o.i.x, a.y -= o.i.y, i.x -= o.i.x, i.y -= o.i.y, e.push({
                            start: a,
                            end: i
                        })
                    }
                    var lu = wt("segmentation");

                    function cu(e, t, n, o, r) {
                        (function(e) {
                            var t = lu.configuration;
                            return t.renderFill && (e && 0 !== t.fillAlpha || !e && 0 !== t.fillAlphaInactive)
                        })(r) && Xc(e, t, o, 0, r),
                            function(e) {
                                var t = lu.configuration;
                                return t.renderOutline && (e && 0 !== t.outlineAlpha || !e && 0 !== t.outlineAlphaInactive)
                            }(r) && Qc(e, t, o, 0, r)
                    }
                    var uu = wt("segmentation"),
                        du = function(e) {
                            var t = e.detail.element,
                                n = uu.configuration,
                                o = uu.getters.labelmaps3D(t),
                                r = o.activeLabelmapIndex,
                                a = o.labelmaps3D,
                                i = o.currentImageIdIndex;
                            a && (n.shouldRenderInactiveLabelmaps && function(e, t, n, o) {
                                for (var r = 0; r < t.length; r++) {
                                    var a = t[r];
                                    if (r !== n && a) {
                                        var i = a.labelmaps2D[o];
                                        i && cu(e, a, 0, i, !1)
                                    }
                                }
                            }(e, a, r, i), function(e, t, n, o) {
                                var r = t[n];
                                if (r) {
                                    var a = r.labelmaps2D[o];
                                    a && cu(e, r, 0, a, !0)
                                }
                            }(e, a, r, i))
                        },
                        hu = wt("segmentation"),
                        fu = function(e) {
                            var t = e.detail,
                                n = t.element,
                                o = vt.tools.filter((function(e) {
                                    return e.element === n && ("active" === e.mode || "passive" === e.mode || "enabled" === e.mode)
                                })),
                                r = _(n, "stack"),
                                a = hu.configuration;
                            r && (a.renderFill || a.renderOutline) && du(e);
                            var i = t.canvasContext.canvas.getContext("2d");
                            o.forEach((function(t) {
                                t.renderToolData && (i.save(), t.renderToolData(e), i.restore())
                            }))
                        },
                        mu = function(e) {
                            e.addEventListener(y.cornerstone.EVENTS.IMAGE_RENDERED, fu)
                        },
                        gu = function(e) {
                            e.removeEventListener(y.cornerstone.EVENTS.IMAGE_RENDERED, fu)
                        },
                        pu = function(e, t, n) {
                            if (vt.isToolLocked) return !1;
                            var o = n.detail.element,
                                r = vt.tools.filter((function(t) {
                                    return t.supportedInteractionTypes.includes(e)
                                }));
                            if (r = (r = Eo(o, r, e)).filter((function(e) {
                                    return "function" == typeof e[t]
                                })), vt.isMultiPartToolActive && (r = Po(r)), 0 === r.length) return !1;
                            r[0][t](n)
                        },
                        vu = function(e, t, n) {
                            var o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : "mouse";
                            return t.filter((function(t) {
                                for (var r = lr(o, t.name), a = _(e, t.name), i = 0; i < a.data.length; i++)
                                    if (void 0 !== yo(e, a.data[i].handles, n, r)) return !0;
                                return !1
                            }))
                        },
                        yu = function(e, t) {
                            return t.filter((function(t) {
                                return t.element === e && ("active" === t.mode || "passive" === t.mode)
                            }))
                        },
                        bu = function(e, t) {
                            return t.filter((function(t) {
                                var n = _(e, t.name);
                                return n && n.data.length > 0
                            }))
                        },
                        wu = function(e) {
                            if (!vt.isToolLocked) {
                                var t = e.detail,
                                    n = e.detail.element,
                                    o = e.detail.currentPoints.canvas,
                                    r = yu(n, yt.mouseTools()),
                                    a = r.filter((function(e) {
                                        return "active" === e.mode && Array.isArray(e.options.mouseButtonMask) && e.options.mouseButtonMask.includes(t.buttons) && e.options.isMouseActive
                                    }));
                                if (vt.isMultiPartToolActive && (a = Po(a)), a.length > 0) {
                                    var i = a.find((function(e) {
                                        return "function" == typeof e.preMouseDownCallback
                                    }));
                                    if (i && i.preMouseDownCallback(e)) return
                                }
                                if (!vt.isMultiPartToolActive) {
                                    var s = bu(n, r),
                                        l = vu(n, s, o, "mouse");
                                    if (l.length > 0) {
                                        var c = l[0],
                                            u = _(n, c.name),
                                            d = hr(n, u, c.name, o),
                                            h = d.handle,
                                            f = d.data;
                                        c.handleSelectedCallback(e, f, h, "mouse")
                                    } else {
                                        var m = r.filter((function(e) {
                                            var t = _(n, e.name);
                                            return t && t.data && e.pointNearTool && t.data.some((function(t) {
                                                return e.pointNearTool(n, t, o, "mouse")
                                            }))
                                        }));
                                        if (m.length > 0) {
                                            var g = m[0],
                                                p = _(n, g.name).data.find((function(e) {
                                                    return g.pointNearTool(n, e, o)
                                                }));
                                            g.toolSelectedCallback(e, p, "mouse")
                                        } else if (a.length > 0) {
                                            var v = a.find((function(e) {
                                                return "function" == typeof e.postMouseDownCallback
                                            }));
                                            if (v && v.postMouseDownCallback(e)) return
                                        }
                                    }
                                }
                            }
                        },
                        xu = B("eventDispatchers:mouseEventHandlers"),
                        Tu = function(e) {
                            if (!vt.isToolLocked) {
                                var t = e.detail,
                                    n = ko(t.element, t.buttons, "mouse");
                                if (n) {
                                    if ("function" == typeof n.preMouseDownActivateCallback && n.preMouseDownActivateCallback(e)) return;
                                    vt.isMultiPartToolActive || (n.addNewMeasurement ? n.addNewMeasurement(e, "mouse") : n instanceof gr && function(e, t) {
                                        xu.log("addNewMeasurement"), e.preventDefault(), e.stopPropagation();
                                        var n = e.detail,
                                            o = n.element,
                                            r = t.createNewMeasurement(n);
                                        if (r) {
                                            k(o, t.name, r), y.cornerstone.updateImage(o);
                                            var a = 1 === Object.keys(r.handles).length ? Go : nr,
                                                i = (new Date).getTime();
                                            a(n, t.name, r, r.handles.end, t.options, "mouse", (function(e) {
                                                if (!r.cancelled) {
                                                    var n = !(!t.configuration || !Object(t.configuration).hasOwnProperty("measurementCreationThreshold")) && (new Date).getTime() - i < t.configuration.measurementCreationThreshold;
                                                    if (e && !1 === n) {
                                                        var a = x.MEASUREMENT_COMPLETED,
                                                            s = {
                                                                toolName: t.name,
                                                                toolType: t.name,
                                                                element: o,
                                                                measurementData: r
                                                            };
                                                        T(o, a, s)
                                                    } else L(o, t.name, r)
                                                }
                                            }))
                                        }
                                    }(e, n))
                                }
                            }
                        },
                        Iu = function(e) {
                            if (!vt.isToolLocked) {
                                var t, n = e.detail,
                                    o = n.element;
                                t = (t = (t = Eo(o, yt.mouseTools())).filter((function(e) {
                                    return Array.isArray(e.options.mouseButtonMask) && e.options.mouseButtonMask.includes(n.buttons) && e.options.isMouseActive
                                }))).filter((function(e) {
                                    return "function" == typeof e.mouseDragCallback
                                })), vt.isMultiPartToolActive && (t = Po(t)), 0 !== t.length && t[0].mouseDragCallback(e)
                            }
                        },
                        Eu = function(e) {
                            if (!vt.isToolLocked && !vt.isMultiPartToolActive) {
                                var t, n = e.detail,
                                    o = n.element,
                                    r = n.currentPoints;
                                vt.mousePositionImage = r.image;
                                var a = (t = yu(o, yt.mouseTools())).filter((function(e) {
                                        return "active" === e.mode && e.options.isMouseActive
                                    })),
                                    i = !1;
                                a.length > 0 && (i = a.some((function(e) {
                                    return e.updateOnMouseMove
                                }))), t = bu(o, t);
                                for (var s = 0; s < t.length; s++) {
                                    var l = t[s];
                                    "function" == typeof l.mouseMoveCallback && (i = l.mouseMoveCallback(e) || i)
                                }!0 === i && y.cornerstone.updateImage(o)
                            }
                        },
                        Su = pu.bind(null, "Mouse", "mouseClickCallback"),
                        Au = pu.bind(null, "Mouse", "doubleClickCallback"),
                        Cu = pu.bind(null, "Mouse", "mouseUpCallback"),
                        Mu = pu.bind(null, "MouseWheel", "mouseWheelCallback"),
                        Du = function(e) {
                            e.addEventListener(x.MOUSE_CLICK, Su), e.addEventListener(x.MOUSE_DOWN, wu), e.addEventListener(x.MOUSE_DOWN_ACTIVATE, Tu), e.addEventListener(x.MOUSE_DOUBLE_CLICK, Au), e.addEventListener(x.MOUSE_DRAG, Iu), e.addEventListener(x.MOUSE_MOVE, Eu), e.addEventListener(x.MOUSE_UP, Cu), e.addEventListener(x.MOUSE_WHEEL, Mu)
                        },
                        Pu = function(e) {
                            e.removeEventListener(x.MOUSE_CLICK, Su), e.removeEventListener(x.MOUSE_DOWN, wu), e.removeEventListener(x.MOUSE_DOWN_ACTIVATE, Tu), e.removeEventListener(x.MOUSE_DOUBLE_CLICK, Au), e.removeEventListener(x.MOUSE_DRAG, Iu), e.removeEventListener(x.MOUSE_MOVE, Eu), e.removeEventListener(x.MOUSE_UP, Cu), e.removeEventListener(x.MOUSE_WHEEL, Mu)
                        },
                        ku = function(e) {
                            if (vt.isToolLocked) return !1;
                            var t = e.detail.element,
                                n = vt.tools.filter((function(e) {
                                    return e.element === t && ("active" === e.mode || "passive" === e.mode || "enabled" === e.mode)
                                }));
                            if (0 === n.length) return !1;
                            n.forEach((function(t) {
                                t.newImageCallback && t.newImageCallback(e)
                            }))
                        },
                        _u = function(e) {
                            e.addEventListener(y.cornerstone.EVENTS.NEW_IMAGE, ku)
                        },
                        Lu = function(e) {
                            e.removeEventListener(y.cornerstone.EVENTS.NEW_IMAGE, ku)
                        },
                        Ou = function(e) {
                            if (vt.isToolLocked) return !1;
                            var t = e.detail,
                                n = t.element,
                                o = t.numPointers,
                                r = vt.tools.filter((function(e) {
                                    return e.supportedInteractionTypes.includes("MultiTouch")
                                }));
                            if (r = (r = Eo(n, r, "MultiTouch")).filter((function(e) {
                                    return "function" == typeof e.multiTouchDragCallback && o === e.configuration.touchPointers
                                })), vt.isMultiPartToolActive && (r = Po(r)), 0 === r.length) return !1;
                            r[0].multiTouchDragCallback(e)
                        },
                        Ru = B("eventDispatchers:touchEventHandlers"),
                        Nu = function(e) {
                            if (!vt.isToolLocked && !vt.isMultiPartToolActive) {
                                var t = ko(e.detail.element, null, "touch");
                                t && t.addNewMeasurement ? t.addNewMeasurement(e, "touch") : t instanceof gr && function(e, t) {
                                    Ru.log("addNewMeasurement"), e.preventDefault(), e.stopPropagation();
                                    var n = e.detail,
                                        o = n.element,
                                        r = t.createNewMeasurement(n);
                                    if (r) {
                                        if (k(o, t.name, r), 1 === Object.keys(r.handles).length && n.type === x.TAP) return r.active = !1, r.handles.end.active = !1, r.handles.end.highlight = !1, r.invalidated = !0, (vt.deleteIfHandleOutsideImage || t.options.deleteIfHandleOutsideImage) && To(n, r.handles) && L(o, t.name, r), void y.cornerstone.updateImage(o);
                                        y.cornerstone.updateImage(o), nr(n, t.name, r, r.handles.end, t.options, "touch", (function() {
                                            var e = x.MEASUREMENT_COMPLETED,
                                                n = {
                                                    toolName: t.name,
                                                    toolType: t.name,
                                                    element: o,
                                                    measurementData: r
                                                };
                                            T(o, e, n)
                                        }))
                                    }
                                }(e, t)
                            }
                        },
                        Uu = function(e) {
                            if (e)
                                for (var t = 0; t < e.data.length; t++) {
                                    var n = e.data[t];
                                    n.active = !1, n.handles && Bu(n.handles)
                                }
                        };

                    function Bu(e) {
                        Object.keys(e).forEach((function(t) {
                            e[t].active = !1
                        }))
                    }
                    var Vu, Fu = function(e) {
                            if (!vt.isToolLocked && !vt.isMultiPartToolActive) {
                                var t, n = e.detail.element,
                                    o = e.detail.currentPoints.canvas;
                                t = Eo(n, yt.touchTools());
                                var r = (t = bu(n, t)).filter((function(e) {
                                    for (var t = _(n, e.name), r = 0; r < t.data.length; r++)
                                        if (void 0 !== yo(n, t.data[r].handles, o, 28)) return !0;
                                    return !1
                                }));
                                if (r.length > 0) {
                                    var a = r[0],
                                        i = _(n, a.name),
                                        s = i.data.find((function(e) {
                                            return void 0 !== yo(n, e.handles, o, 28)
                                        }));
                                    return i.data.active = !0, s.active = !0, y.cornerstone.updateImage(n), Go(e.detail, a.name, i.data, s, a.options, "touch", (function() {
                                        return Uu(i)
                                    })), e.stopImmediatePropagation(), void e.preventDefault()
                                }
                                var l = t.filter((function(e) {
                                    var t = _(n, e.name);
                                    return t && t.data && e.pointNearTool && t.data.some((function(t) {
                                        return e.pointNearTool(n, t, o)
                                    }))
                                }));
                                if (l.length > 0) {
                                    var c = l[0],
                                        u = _(n, c.name),
                                        d = u.data.find((function(e) {
                                            return c.pointNearTool(n, e, o)
                                        }));
                                    return d.active = !0, y.cornerstone.updateImage(n), No(e.detail, c.name, d, null, c.options, "touch", (function() {
                                        return Uu(u)
                                    })), e.stopImmediatePropagation(), void e.preventDefault()
                                }
                                var h = Eo(n, yt.touchTools());
                                return h.length > 0 && h[0].touchStartActiveCallback ? h[0].touchStartActiveCallback(e) : Nu(e), !1
                            }
                        },
                        Hu = function(e) {
                            if (!vt.isToolLocked) {
                                var t = e.detail,
                                    n = t.element,
                                    o = t.startPoints.canvas,
                                    r = yu(n, yt.touchTools()),
                                    a = r.filter((function(e) {
                                        return "active" === e.mode && e.options.isTouchActive
                                    }));
                                if (vt.isMultiPartToolActive && (a = Po(a)), a.length > 0) {
                                    var i = a.find((function(e) {
                                        return "function" == typeof e.preTouchStartCallback
                                    }));
                                    if (i && i.preTouchStartCallback(e)) return
                                }
                                if (!vt.isMultiPartToolActive) {
                                    var s = bu(n, r),
                                        l = vu(n, s, o, "touch");
                                    if (l.length > 0) {
                                        var c = l[0],
                                            u = _(n, c.name),
                                            d = hr(n, u, c.name, o, "touch"),
                                            h = d.handle,
                                            f = d.data;
                                        c.handleSelectedCallback(e, f, h, "touch")
                                    } else {
                                        var m = s.filter((function(e) {
                                            var t = _(n, e.name);
                                            return t && t.data && e.pointNearTool && t.data.some((function(t) {
                                                return e.pointNearTool(n, t, o, "touch")
                                            }))
                                        }));
                                        if (m.length > 0) {
                                            var g = m[0],
                                                p = _(n, g.name).data.find((function(e) {
                                                    return g.pointNearTool(n, e, o)
                                                }));
                                            g.toolSelectedCallback(e, p, "touch")
                                        } else if (a.length > 0) {
                                            var v = a.find((function(e) {
                                                return "function" == typeof e.postTouchStartCallback
                                            }));
                                            if (v && v.postTouchStartCallback(e)) return
                                        }
                                    }
                                }
                            }
                        },
                        qu = pu.bind(null, "DoubleTap", "doubleTapCallback"),
                        ju = pu.bind(null, "Touch", "touchDragCallback"),
                        zu = pu.bind(null, "Touch", "touchEndCallback"),
                        Wu = pu.bind(null, "TouchPinch", "touchPinchCallback"),
                        Gu = pu.bind(null, "Touch", "touchPressCallback"),
                        Yu = pu.bind(null, "TouchRotate", "touchRotateCallback"),
                        Zu = function(e) {
                            e.addEventListener(x.TAP, Fu), e.addEventListener(x.TOUCH_START, Hu, {
                                passive: !1
                            }), e.addEventListener(x.TOUCH_DRAG, ju, {
                                passive: !1
                            }), e.addEventListener(x.TOUCH_END, zu), e.addEventListener(x.TOUCH_START_ACTIVE, Nu), e.addEventListener(x.TOUCH_PRESS, Gu), e.addEventListener(x.DOUBLE_TAP, qu), e.addEventListener(x.TOUCH_PINCH, Wu), e.addEventListener(x.TOUCH_ROTATE, Yu), e.addEventListener(x.MULTI_TOUCH_DRAG, Ou)
                        },
                        Ku = function(e) {
                            e.removeEventListener(x.TAP, Fu), e.removeEventListener(x.TOUCH_START, Hu), e.removeEventListener(x.TOUCH_DRAG, ju), e.removeEventListener(x.TOUCH_END, zu), e.removeEventListener(x.TOUCH_START_ACTIVE, Nu), e.removeEventListener(x.TOUCH_PRESS, Gu), e.removeEventListener(x.DOUBLE_TAP, qu), e.removeEventListener(x.TOUCH_PINCH, Wu), e.removeEventListener(x.TOUCH_ROTATE, Yu), e.removeEventListener(x.MULTI_TOUCH_DRAG, Ou)
                        },
                        Xu = B("addTool"),
                        Ju = function(e, t, n) {
                            var o = new t(n);
                            Tt(e, o.name) ? Xu.warn("%s has already been added to the target element", o.name) : (o.element = e, xt.state.tools.push(o))
                        },
                        Qu = function(e, t) {
                            $u(e, t), xt.state.enabledElements.forEach((function(n) {
                                Ju(n, e, t)
                            }))
                        },
                        $u = function(e, t) {
                            if (wt("globalConfiguration").configuration.globalToolSyncEnabled) {
                                var n = new e(t);
                                void 0 !== xt.state.globalTools[n.name] ? Xu.warn("%s has already been added globally", n.name) : xt.state.globalTools[n.name] = {
                                    tool: e,
                                    props: t,
                                    activeBindings: []
                                }
                            }
                        },
                        ed = B("internals:addEnabledElement"),
                        td = function(e) {
                            ed.log("EVENT:ELEMENT_ENABLED");
                            var t = e.detail.element;
                            mu(t), _u(t);
                            var n = wt("globalConfiguration").configuration;
                            n.mouseEnabled && (pc.enable(t), xc.enable(t), Du(t)), n.touchEnabled && (Zc.enable(t), Zu(t)), nd(t)
                        },
                        nd = function(e) {
                            xt.state.enabledElements.push(e), xt.modules && function(e) {
                                    var t = xt.modules;
                                    Object.keys(t).forEach((function(n) {
                                        "function" == typeof t[n].enabledElementCallback && t[n].enabledElementCallback(e)
                                    }))
                                }(e),
                                function(e) {
                                    wt("globalConfiguration").configuration.globalToolSyncEnabled && Object.keys(xt.state.globalTools).forEach((function(t) {
                                        var n = xt.state.globalTools[t],
                                            o = n.tool,
                                            r = n.props;
                                        Ju(e, o, r)
                                    }))
                                }(e),
                                function(e) {
                                    if (wt("globalConfiguration").configuration.globalToolSyncEnabled) {
                                        var t = {
                                            active: Dt,
                                            passive: Rt,
                                            enabled: Lt,
                                            disabled: kt
                                        };
                                        xt.state.globalToolChangeHistory.forEach((function(n) {
                                            var o = n.args.slice(0);
                                            o.unshift(e), t[n.mode].apply(null, o)
                                        }))
                                    }
                                }(e)
                        },
                        od = B("internals:removeEnabledElement"),
                        rd = function(e) {
                            od.log("EVENT:ELEMENT_DISABLED");
                            var t = e.detail.element,
                                n = wt("globalConfiguration").configuration;
                            gu(t), Lu(t), n.mouseEnabled && (pc.disable(t), xc.disable(t), Pu(t)), n.touchEnabled && (Zc.disable(t), Ku(t)), ad(t), id(t), sd(t)
                        },
                        ad = function(e) {
                            xt.state.tools.forEach((function(t) {
                                t.element === e && kt(t.element, t.name)
                            })), xt.state.tools = xt.state.tools.filter((function(t) {
                                return t.element !== e
                            }))
                        },
                        id = function(e) {
                            xt.modules && function(e) {
                                var t = xt.modules;
                                Object.keys(t).forEach((function(n) {
                                    "function" == typeof t[n].removeEnabledElementCallback && t[n].removeEnabledElementCallback(e)
                                }))
                            }(e);
                            var t = xt.state.enabledElements.findIndex((function(t) {
                                return t === e
                            }));
                            t > -1 ? xt.state.enabledElements.splice(t, 1) : od.warn("unable to remove element")
                        },
                        sd = function(e) {
                            js.removeHandlers(e)
                        },
                        ld = function() {
                            window.removeEventListener("resize", cd, !1)
                        };

                    function cd() {
                        Vu || (Vu = setTimeout((function() {
                            Vu = null, ud()
                        }), 66))
                    }
                    var ud = function() {
                            vt.enabledElements.forEach((function(e) {
                                y.cornerstone.resize(e)
                            }))
                        },
                        dd = function() {
                            ld(), window.addEventListener("resize", cd, !1)
                        },
                        hd = function() {
                            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                            fd(), md();
                            var t = wt("globalConfiguration");
                            Array.isArray(e) ? e.forEach((function(e) {
                                var t = e.moduleName,
                                    n = e.configuration,
                                    o = wt(t);
                                o && (o.configuration = Object.assign({}, o.configuration, n))
                            })) : t.configuration = Object.assign({}, t.configuration, e), t.configuration.autoResizeViewports && dd()
                        };

                    function fd() {
                        ! function() {
                            var e = y.cornerstone,
                                t = e.EVENTS.ELEMENT_ENABLED,
                                n = e.EVENTS.ELEMENT_DISABLED;
                            e.events.removeEventListener(t, td), e.events.removeEventListener(n, rd)
                        }();
                        var e = y.cornerstone,
                            t = e.EVENTS.ELEMENT_ENABLED,
                            n = e.EVENTS.ELEMENT_DISABLED;
                        e.events.addEventListener(t, td), e.events.addEventListener(n, rd)
                    }

                    function md() {
                        var e = xt.modules;
                        Object.keys(e).forEach((function(t) {
                            "function" == typeof e[t].onRegisterCallback && e[t].onRegisterCallback()
                        }))
                    }
                    var gd, pd = B("stackTools:stackPrefetch"),
                        vd = {
                            maxImagesToPrefetch: 1 / 0,
                            preserveExistingPool: !1
                        };

                    function yd(e, t) {
                        e = Math.round(e) || 0;
                        var n = [],
                            o = (t = Math.round(t) || 0) - e + 1;
                        if (o <= 0) return n;
                        for (; o--;) n[o] = t--;
                        return n
                    }

                    function bd(e) {
                        var t = _(e, "stack");
                        if (t && t.data && t.data.length) {
                            var n = t.data[0],
                                o = _(e, "stackPrefetch");
                            if (o) {
                                var r = o.data[0] || {};
                                if (r.indicesToRequest && r.indicesToRequest.length || (r.enabled = !1), !1 !== r.enabled && (o.data[0].indicesToRequest.sort((function(e, t) {
                                        return e - t
                                    })), r.indicesToRequest.slice().forEach((function(e) {
                                        var t = n.imageIds[e];
                                        t && y.cornerstone.imageCache.getImageLoadObject(t) && x(e)
                                    })), r.indicesToRequest.length)) {
                                    vd.preserveExistingPool || y.cornerstone.imageLoadPoolManager.clearRequestStack("prefetch");
                                    for (var a, i, s, l, c, u, d, h = (a = r.indicesToRequest, i = n.currentImageIdIndex, s = 0, l = a.length - 1, a.forEach((function(e, t) {
                                            e < i ? s = Math.max(t, s) : e > i && (l = Math.min(t, l))
                                        })), {
                                            low: s,
                                            high: l
                                        }), f = (js.getErrorLoadingHandler(e), h.low), m = h.high, g = []; f >= 0 || m < r.indicesToRequest.length;) {
                                        var p = n.currentImageIdIndex,
                                            v = !(p - r.indicesToRequest[f] > vd.maxImagesToPrefetch) && f >= 0,
                                            b = !(r.indicesToRequest[m] - p > vd.maxImagesToPrefetch) && m < r.indicesToRequest.length;
                                        if (!b && !v) break;
                                        v && (u = r.indicesToRequest[f--], c = n.imageIds[u], g.push(c)), b && (u = r.indicesToRequest[m++], c = n.imageIds[u], g.push(c))
                                    }
                                    var w = {
                                        addToBeginning: !0,
                                        priority: 0,
                                        requestType: "prefetch"
                                    };
                                    d = function(e) {
                                        return y.cornerstone.loadAndCacheImage(e, w)
                                    }, g.reverse().forEach((function(e) {
                                        y.cornerstone.imageLoadPoolManager.addRequest(d.bind(null, e), "prefetch", {
                                            imageId: e
                                        }, 0, !0)
                                    }))
                                }
                            }
                        }

                        function x(e) {
                            var t = r.indicesToRequest.indexOf(e);
                            t > -1 && r.indicesToRequest.splice(t, 1)
                        }
                    }

                    function wd(e) {
                        return function(t) {
                            var n, o = t.detail;
                            try {
                                n = _(e, "stack")
                            } catch (e) {
                                return
                            }
                            if (n && n.data && n.data.length) {
                                var r = n.data[0].imageIds.indexOf(o.imageId);
                                if (!(r < 0)) {
                                    var a = _(e, "stackPrefetch");
                                    a && a.data && a.data.length && a.data[0].indicesToRequest.push(r)
                                }
                            }
                        }
                    }

                    function xd(e) {
                        clearTimeout(gd), gd = setTimeout((function() {
                            var t = e.target;
                            try {
                                bd(t)
                            } catch (e) {
                                return
                            }
                        }), 10)
                    }
                    var Td = {
                            enable: function(e) {
                                _(e, "stackPrefetch").data = [];
                                var t = _(e, "stack");
                                if (t && t.data && t.data.length) {
                                    var n = t.data[0];
                                    if (!0 !== n.preventCache) {
                                        var o = {
                                                indicesToRequest: yd(0, n.imageIds.length - 1),
                                                enabled: !0,
                                                direction: 1
                                            },
                                            r = o.indicesToRequest.indexOf(n.currentImageIdIndex);
                                        o.indicesToRequest.splice(r, 1), k(e, "stackPrefetch", o), bd(e), e.removeEventListener(y.cornerstone.EVENTS.NEW_IMAGE, xd), e.addEventListener(y.cornerstone.EVENTS.NEW_IMAGE, xd);
                                        var a = wd(e);
                                        y.cornerstone.events.removeEventListener(y.cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED, a), y.cornerstone.events.addEventListener(y.cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED, a)
                                    } else pd.warn("A stack that should not be cached was given the stackPrefetch")
                                }
                            },
                            disable: function(e) {
                                clearTimeout(gd), e.removeEventListener(y.cornerstone.EVENTS.NEW_IMAGE, xd);
                                var t = wd(e);
                                y.cornerstone.events.removeEventListener(y.cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED, t);
                                var n = _(e, "stackPrefetch");
                                n && n.data.length && (n.data[0].enabled = !1, y.cornerstone.imageLoadPoolManager.clearRequestStack("prefetch"))
                            },
                            getConfiguration: function() {
                                return vd
                            },
                            setConfiguration: function(e) {
                                vd = e
                            }
                        },
                        Id = function() {
                            function e() {
                                i()(this, e), this.currentImageIdIndex = 0, this.layerIds = [], this.findImageFn = void 0
                            }
                            return l()(e, [{
                                key: "render",
                                value: function(e, t) {
                                    var n = this;
                                    if (!Number.isInteger(this.currentImageIdIndex)) throw new Error("FusionRenderer: render - Image ID Index is not an integer");
                                    if (!this.findImageFn) throw new Error("No findImage function has been defined");
                                    t || (t = _(e, "stack").data);
                                    var o = y.cornerstone,
                                        r = t[0],
                                        a = r.imageIds[this.currentImageIdIndex],
                                        i = t.slice(1, t.length);
                                    o.loadAndCacheImage(a).then((function(t) {
                                        var s = n.layerIds[0];
                                        s ? o.setLayerImage(e, t, s) : (s = o.addLayer(e, t, r.options), n.layerIds.push(s)), o.displayImage(e, t), i.forEach((function(t, r) {
                                            var i = n.findImageFn(t.imageIds, a),
                                                l = r + 1,
                                                c = n.layerIds[l];
                                            c || (c = o.addLayer(e, void 0, t.options), n.layerIds.push(c)), i ? o.loadAndCacheImage(i).then((function(t) {
                                                o.setLayerImage(e, t, c), o.updateImage(e)
                                            })) : (o.setLayerImage(e, void 0, c), o.setActiveLayer(e, s), o.updateImage(e))
                                        }))
                                    }))
                                }
                            }]), e
                        }(),
                        Ed = {};
                    Ed.FusionRenderer = Id;
                    var Sd = Ed;

                    function Ad(e) {
                        var t = e.intervalId;
                        void 0 !== t && (e.intervalId = void 0, e.usingFrameTimeVector ? clearTimeout(t) : clearInterval(t))
                    }

                    function Cd(e, t) {
                        var n, o;
                        if (void 0 === e) throw new Error("playClip: element must not be undefined");
                        var r = _(e, "stack");
                        if (r && r.data && r.data.length) {
                            var a, i = y.cornerstone;
                            if (r.data.length > 1) {
                                var s = _(e, "stackRenderer");
                                s && s.data && s.data.length && (a = s.data[0])
                            }
                            var l = r.data[0],
                                c = _(e, "playClip");
                            c && c.data && c.data.length ? Ad(n = c.data[0]) : k(e, "playClip", n = {
                                intervalId: void 0,
                                framesPerSecond: 30,
                                lastFrameTimeStamp: void 0,
                                frameRate: 0,
                                frameTimeVector: void 0,
                                ignoreFrameTimeVector: !1,
                                usingFrameTimeVector: !1,
                                speed: 1,
                                reverse: !1,
                                loop: !0
                            }), (t < 0 || t > 0) && (n.framesPerSecond = Number(t), n.reverse = n.framesPerSecond < 0, n.ignoreFrameTimeVector = !0), !0 !== n.ignoreFrameTimeVector && n.frameTimeVector && n.frameTimeVector.length === l.imageIds.length && (o = function(e, t) {
                                var n, o, r, a = 0,
                                    i = e.length,
                                    s = [];
                                for (s.isTimeVarying = !1, ("number" != typeof t || t <= 0) && (t = 1), n = 1; n < i; n++) r = Number(e[n]) / t | 0, s.push(r), 1 === n ? o = r : r !== o && (s.isTimeVarying = !0), a += r;
                                return s.length > 0 && (r = s.isTimeVarying ? a / s.length | 0 : s[0], s.push(r)), s
                            }(n.frameTimeVector, n.speed));
                            var u = function() {
                                var t, o, s, c = l.currentImageIdIndex,
                                    u = l.imageIds.length;
                                if (n.reverse ? c-- : c++, !n.loop && (c < 0 || c >= u)) return Ad(n), void
                                function(e) {
                                    T(e, x.CLIP_STOPPED, {
                                        element: e
                                    })
                                }(e);
                                c >= u && (c = 0), c < 0 && (c = u - 1), c !== l.currentImageIdIndex && (t = js.getStartLoadHandler(e), o = js.getEndLoadHandler(e), s = js.getErrorLoadingHandler(e), t && t(e), (!0 === l.preventCache ? i.loadImage(l.imageIds[c]) : i.loadAndCacheImage(l.imageIds[c])).then((function(t) {
                                    try {
                                        l.currentImageIdIndex = c, a ? (a.currentImageIdIndex = c, a.render(e, r.data)) : i.displayImage(e, t), o && o(e, t)
                                    } catch (e) {
                                        return
                                    }
                                }), (function(t) {
                                    var n = l.imageIds[c];
                                    s && s(e, n, t)
                                })))
                            };
                            o && o.length > 0 && o.isTimeVarying ? (n.usingFrameTimeVector = !0, n.intervalId = setTimeout((function e() {
                                n.intervalId = setTimeout(e, o[l.currentImageIdIndex]), u()
                            }), 0)) : (n.usingFrameTimeVector = !1, n.intervalId = setInterval(u, 1e3 / Math.abs(n.framesPerSecond)))
                        }
                    }

                    function Md(e) {
                        var t = _(e, "playClip");
                        t && t.data && t.data.length && Ad(t.data[0])
                    }
                    var Dd = function(e, t) {
                            var n = xt.state.tools.findIndex((function(n) {
                                return n.element === e && n.name === t
                            }));
                            n >= 0 && xt.state.tools.splice(n, 1)
                        },
                        Pd = function(e) {
                            kd(e), xt.state.enabledElements.forEach((function(t) {
                                Dd(t, e)
                            }))
                        },
                        kd = function(e) {
                            wt("globalConfiguration").configuration.globalToolSyncEnabled && xt.state.globalTools[e] && delete xt.state.globalTools[e]
                        },
                        _d = function(e, t, n) {
                            var o = Tt(e, t);
                            o && o.mergeOptions(n)
                        },
                        Ld = function(e, t) {
                            vt.enabledElements.forEach((function(n) {
                                _d(n, e, t)
                            }))
                        };

                    function Od(e, t) {
                        var n = {};
                        return {
                            get: function(o, r) {
                                return e.indexOf(r) >= 0 ? (!1 === n.hasOwnProperty(r) && (n[r] = {
                                    data: []
                                }), n[r]) : t.get(o, r)
                            },
                            add: function(o, r, a) {
                                if (!(e.indexOf(r) >= 0)) return t.add(o, r, a);
                                !1 === n.hasOwnProperty(r) && (n[r] = {
                                    data: []
                                }), n[r].data.push(a)
                            },
                            saveToolState: function() {
                                return n
                            },
                            restoreToolState: function(e) {
                                n = e
                            },
                            toolState: n
                        }
                    }
                    var Rd = [];

                    function Nd(e, t) {
                        var n = P(e);
                        n || (n = D);
                        var o = ["stack", "stackPrefetch", "playClip", "volume", "slab", "referenceLines", "crosshairs", "stackRenderer"];
                        t && (o = o.concat(t));
                        var r = Od(o, n);
                        Rd.push(r), R(e, r)
                    }
                    var Ud = {
                        newStackSpecificToolStateManager: Od,
                        addStackStateManager: Nd
                    };

                    function Bd() {
                        var e = {};
                        return {
                            get: function(t, n) {
                                if (!1 !== e.hasOwnProperty(t)) {
                                    var o = e[t];
                                    if (!1 !== o.hasOwnProperty(n)) return o[n]
                                }
                            },
                            add: function(t, n, o) {
                                !1 === e.hasOwnProperty(t) && (e[t] = {});
                                var r = e[t];
                                !1 === r.hasOwnProperty(n) && (r[n] = {
                                    data: []
                                }), r[n].data.push(o)
                            },
                            remove: function(t, n, o) {
                                if (!1 !== e.hasOwnProperty(t)) {
                                    var r = e[t];
                                    if (!1 !== r.hasOwnProperty(n)) {
                                        for (var a = r[n], i = -1, s = 0; s < a.data.length; s++) a.data[s] === o && (i = s); - 1 !== i && a.data.splice(i, 1)
                                    }
                                }
                            }
                        }
                    }
                    var Vd = Bd(),
                        Fd = function(e, t) {
                            var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : "image/png",
                                o = e.querySelector("canvas");
                            if (o.msToBlob) {
                                var r = o.msToBlob();
                                return window.navigator.msSaveBlob(r, t)
                            }
                            var a = document.createElement("a");
                            if (a.download = t, a.href = o.toDataURL(n, 1), document.createEvent) {
                                var i = document.createEvent("MouseEvents");
                                i.initMouseEvent("click", !0, !0, window, 0, 0, 0, 0, 0, !1, !1, !1, !1, 0, null), a.dispatchEvent(i)
                            } else a.fireEvent && a.fireEvent("onclick")
                        },
                        Hd = B("thirdParty:registerModule"),
                        qd = function(e, t) {
                            var n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2],
                                o = jd(e);
                            !o || n ? (o && Hd.warn("Overwriting module %s", e), bt[e] = t, "function" == typeof bt[e].onRegisterCallback && bt[e].onRegisterCallback()) : Hd.warn("A module with the name %s is already registered", e)
                        };

                    function jd(e) {
                        return void 0 !== bt[e]
                    }

                    function zd() {
                        var e, t = navigator.userAgent,
                            n = t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i) || [];
                        return /trident/i.test(n[1]) ? (e = /\brv[ :]+(\d+)/g.exec(t) || [], "IE ".concat(e[1] || "")) : "Chrome" === n[1] && null !== (e = t.match(/\b(OPR|Edge)\/(\d+)/)) ? e.slice(1).join(" ").replace("OPR", "Opera") : (n = n[2] ? [n[1], n[2]] : [navigator.appName, navigator.appVersion, "-?"], null !== (e = t.match(/version\/(\d+)/i)) && n.splice(1, 1, e[1]), n.join(" "))
                    }
                    var Wd = {
                            "base/BaseTool": go,
                            "base/BaseAnnotationTool": gr,
                            "base/BaseBrushTool": Do,
                            "tools/cursors/MouseCursor": br,
                            "tools/cursors": r,
                            "manipulators/anyHandlesOutsideImage": To,
                            "manipulators/getHandleNearImagePoint": yo,
                            "manipulators/getHandlePixelPosition": Io,
                            "manipulators/handleActivator": bo,
                            "manipulators/moveAllHandles": No,
                            "manipulators/moveHandle": Go,
                            "manipulators/moveNewHandle": nr,
                            "manipulators/moveHandleNearImagePoint": dr,
                            "manipulators/findHandleDataNearImagePoint": hr,
                            "manipulators/moveAnnotation": fr,
                            "mixins/activeOrDisabledBinaryTool": ao.activeOrDisabledBinaryTool,
                            "mixins/enabledOrDisabledBinaryTool": ao.enabledOrDisabledBinaryTool,
                            "drawing/getNewContext": Dn,
                            "drawing/draw": Wt,
                            "drawing/path": Kt,
                            "drawing/setShadow": kn,
                            "drawing/drawLine": Xt,
                            "drawing/drawLines": hn,
                            "drawing/drawJoinedLines": Jt,
                            "drawing/drawCircle": $t,
                            "drawing/drawEllipse": an,
                            "drawing/drawRect": Mn,
                            "drawing/fillOutsideRect": function(e, t, n, o, r) {
                                if ("pixel" === (arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : "pixel")) {
                                    var a = y.cornerstone;
                                    n = a.pixelToCanvas(t, n), o = a.pixelToCanvas(t, o)
                                }
                                var i = Math.min(n.x, o.x),
                                    s = Math.min(n.y, o.y),
                                    l = Math.abs(n.x - o.x),
                                    c = Math.abs(n.y - o.y);
                                Kt(e, r, (function(e) {
                                    e.rect(0, 0, e.canvas.clientWidth, e.canvas.clientHeight), e.rect(i + l, s, -l, c)
                                }))
                            },
                            "drawing/drawTextBox": xn,
                            "drawing/drawArrow": Qt,
                            "drawing/fillBox": bn,
                            "drawing/fillTextLines": yn,
                            "drawing/drawLink": fn,
                            "drawing/drawLinkedTextBox": Cn,
                            "drawing/drawHandles": dn,
                            "drawing/textBoxWidth": wn,
                            "util/getActiveTool": ko,
                            "util/getLuminance": Vl,
                            "util/getROITextBoxCoords": ni,
                            "util/copyPoints": rc,
                            "util/calculateSUV": Ja,
                            "util/setContextToDisplayFontSize": function(e, t, n) {
                                return y.cornerstone.setToPixelCoordinateSystem(e, t, .1), {
                                    fontSize: n / e.viewport.scale / .1,
                                    lineHeight: n / e.viewport.scale / .1,
                                    fontScale: .1
                                }
                            },
                            "util/scrollToIndex": Ll,
                            "util/scroll": Ol,
                            "util/roundToDecimal": vr,
                            "util/projectPatientPointToImagePlane": tn,
                            "util/imagePointToPatientPoint": nn,
                            "util/planePlaneIntersection": on,
                            "util/pointInsideBoundingBox": po,
                            "util/makeUnselectable": function(e, t) {
                                e.style.webkitUserSelect = "none", e.style.webkitTouchCallout = "none", e.style.mozUserSelect = "none", e.style.msUserSelect = "none", e.style.oUserSelect = "none", e.style.khtmlUserSelect = "none", e.style.userSelect = "none", e.unselectable = "on", e.oncontextmenu = function() {
                                    return !1
                                }, !0 === t && (e.style.pointerEvents = "none")
                            },
                            "util/getRGBPixels": ji,
                            "util/getBrowserInfo": zd,
                            "util/isMobileDevice": function() {
                                return new RegExp("Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini").test(navigator.userAgent)
                            },
                            "util/angleBetweenPoints": Tl,
                            "util/numbersWithCommas": oi,
                            "util/lineSegDistance": pr,
                            "util/triggerEvent": T,
                            "util/convertToVector3": en,
                            "util/clip": Tn,
                            "util/clipToBox": In,
                            "util/clipBoxToDisplayedArea": Sn,
                            "util/debounce": sa,
                            "util/deepmerge": ho,
                            "util/getDefault": Pn,
                            "util/getProximityThreshold": lr,
                            "util/getPixelSpacing": aa,
                            "util/isEmptyObject": _n,
                            "util/isObject": ia,
                            "util/isPointInImage": Ge,
                            "util/isPointInPolygon": us,
                            "util/getLogger": B,
                            "util/throttle": la,
                            "util/wait": yl,
                            "util/waitForEnabledElementImageToLoad": bl,
                            "util/getKeyPressData": function(e) {
                                var t = y.cornerstone,
                                    n = e.currentTarget,
                                    o = t.getEnabledElement(n);
                                if (o && o.image) {
                                    var r = xt.state.mousePositionImage;
                                    return {
                                        event: window.event || e,
                                        element: n,
                                        viewport: t.getViewport(n),
                                        image: o.image,
                                        currentPoints: {
                                            image: r,
                                            canvas: t.pixelToCanvas(n, r)
                                        },
                                        keyCode: e.keyCode,
                                        which: e.which
                                    }
                                }
                            },
                            "util/ellipseUtils": ti,
                            "util/freehandUtils": _i,
                            "util/segmentationUtils": o,
                            "util/zoomUtils": Yl
                        },
                        Gd = B("thirdParty:registerMixin"),
                        Yd = function(e, t) {
                            var n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2],
                                o = Zd(e);
                            !o || n ? (o && Gd.warn("Overwriting mixins/%s", e), ao[e] = t, Wd["mixins/".concat(e)] = ao[e]) : Gd.warn("mixins/%s is already registered", e)
                        };

                    function Zd(e) {
                        return void 0 !== ao[e]
                    }
                    var Kd = B("thirdParty:registerType"),
                        Xd = function(e, t, n) {
                            var o = arguments.length > 3 && void 0 !== arguments[3] && arguments[3],
                                r = "".concat(e, "/").concat(t),
                                a = Jd(r);
                            !a || o ? (a && Kd.warn("Overwriting %s", r), Wd[r] = n) : Kd.warn("%s is already registered", r)
                        };

                    function Jd(e) {
                        return void 0 !== Wd[e]
                    }
                    var Qd = B("thirdParty:register"),
                        $d = function(e, t, n) {
                            var o = arguments.length > 3 && void 0 !== arguments[3] && arguments[3];
                            if (eh(e, t, n)) switch (e) {
                                case "module":
                                    qd(t, n, o);
                                    break;
                                case "mixin":
                                    Yd(t, n, o);
                                    break;
                                default:
                                    Xd(e, t, n, o)
                            }
                        };

                    function eh(e, t, n) {
                        return e ? t ? "object" === w()(n) || "function" == typeof n || (Qd.warn("The %s is a %s, it should be an Object or a function.", n, w()(n)), !1) : (Qd.warn("The %s must have a name in order to register.", e), !1) : (Qd.warn("The type must be given in order to register."), !1)
                    }
                    var th = function(e) {
                            var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
                            e.forEach((function(e) {
                                var n = e.type,
                                    o = e.name,
                                    r = e.item;
                                $d(n, o, r, t)
                            }))
                        },
                        nh = function(e, t, n) {
                            if (n !== t) {
                                var o = y.cornerstone,
                                    r = o.getViewport(t),
                                    a = o.getViewport(n);
                                a.voi.windowWidth === r.voi.windowWidth && a.voi.windowCenter === r.voi.windowCenter && a.invert === r.invert || (a.voi.windowWidth = r.voi.windowWidth, a.voi.windowCenter = r.voi.windowCenter, a.invert = r.invert, e.setViewport(n, a))
                            }
                        },
                        oh = function(e, t, n) {
                            n !== t && y.cornerstone.updateImage(n)
                        };

                    function rh(e) {
                        return e.filter((function(e, t, n) {
                            return n.indexOf(e) === t
                        }))
                    }
                    var ah = function(e, t) {
                            y.cornerstone;
                            var n = this,
                                o = [],
                                r = [],
                                a = !1,
                                i = {},
                                s = t;

                            function l(e) {
                                var t = e.detail.element;
                                n.remove(t),
                                    function(e) {
                                        for (var t in zs) zs[t] = zs[t].filter((function(t) {
                                            return t.element !== e
                                        }))
                                    }(t)
                            }
                            this.enabled = !0, this.setHandler = function(e) {
                                s = e
                            }, this.getHandler = function() {
                                return s
                            }, this.getDistances = function() {
                                if (o.length && r.length) {
                                    var e = y.cornerstone;
                                    i.distances = {}, i.imageIds = {
                                        sourceElements: [],
                                        targetElements: []
                                    }, o.forEach((function(t) {
                                        var n = e.getEnabledElement(t);
                                        if (n && n.image) {
                                            var o = n.image.imageId,
                                                a = e.metaData.get("imagePlaneModule", o);
                                            if (a && a.imagePositionPatient) {
                                                var s = en(a.imagePositionPatient);
                                                i.hasOwnProperty(n) || (i.distances[o] = {}, i.imageIds.sourceElements.push(o), r.forEach((function(n) {
                                                    var r = e.getEnabledElement(n);
                                                    if (r && r.image) {
                                                        var a = r.image.imageId;
                                                        if (i.imageIds.targetElements.push(a), t !== n && o !== a && !i.distances[o].hasOwnProperty(a)) {
                                                            var l = e.metaData.get("imagePlaneModule", a);
                                                            if (l && l.imagePositionPatient) {
                                                                var c = en(l.imagePositionPatient);
                                                                i.distances[o][a] = c.clone().sub(s)
                                                            }
                                                        }
                                                    }
                                                })), Object.keys(i.distances[o]).length || delete i.distances[o])
                                            }
                                        }
                                    }))
                                }
                            }, this.fireEvent = function(e, t) {
                                var l = !n.enabled,
                                    c = !o.length || !r.length;
                                l || c || (a = !0, r.forEach((function(a) {
                                    var l = r.indexOf(a);
                                    if (-1 !== l) {
                                        var c = i.imageIds.targetElements[l],
                                            u = o.indexOf(e);
                                        if (-1 !== u) {
                                            var d, h = i.imageIds.sourceElements[u];
                                            h === c ? d = 0 : void 0 !== i.distances[h] && (d = i.distances[h][c]), s(n, e, a, t, d)
                                        }
                                    }
                                })), a = !1)
                            }, this.onEvent = function(e) {
                                var t = e.detail;
                                !0 !== a && n.fireEvent(e.currentTarget, t)
                            }, this.addSource = function(t) {
                                -1 === o.indexOf(t) && (o.push(t), e.split(" ").forEach((function(e) {
                                    t.addEventListener(e, n.onEvent)
                                })), n.getDistances(), n.updateDisableHandlers())
                            }, this.addTarget = function(e) {
                                -1 === r.indexOf(e) && (r.push(e), n.getDistances(), s(n, e, e, 0), n.updateDisableHandlers())
                            }, this.add = function(e) {
                                n.addSource(e), n.addTarget(e)
                            }, this.removeSource = function(t) {
                                var r = o.indexOf(t); - 1 !== r && (o.splice(r, 1), e.split(" ").forEach((function(e) {
                                    t.removeEventListener(e, n.onEvent)
                                })), n.getDistances(), n.fireEvent(t), n.updateDisableHandlers())
                            }, this.removeTarget = function(e) {
                                var t = r.indexOf(e); - 1 !== t && (r.splice(t, 1), n.getDistances(), s(n, e, e, 0), n.updateDisableHandlers())
                            }, this.remove = function(e) {
                                n.removeTarget(e), n.removeSource(e)
                            }, this.getSourceElements = function() {
                                return o
                            }, this.getTargetElements = function() {
                                return r
                            }, this.displayImage = function(e, t, n) {
                                a = !0, y.cornerstone.displayImage(e, t, n), a = !1
                            }, this.setViewport = function(e, t) {
                                a = !0, y.cornerstone.setViewport(e, t), a = !1
                            }, this.updateDisableHandlers = function() {
                                rh(o.concat(r)).forEach((function(e) {
                                    e.removeEventListener(y.cornerstone.EVENTS.ELEMENT_DISABLED, l), e.addEventListener(y.cornerstone.EVENTS.ELEMENT_DISABLED, l)
                                }))
                            }, this.destroy = function() {
                                rh(o.concat(r)).forEach((function(e) {
                                    n.remove(e)
                                }))
                            }
                        },
                        ih = function(e, t, n, o) {
                            if (t !== n && o && o.direction) {
                                var r = y.cornerstone,
                                    a = _(n, "stack").data[0],
                                    i = a.currentImageIdIndex + o.direction;
                                if (i = An(i, 0, a.imageIds.length - 1), a.currentImageIdIndex !== i) {
                                    var s = js.getStartLoadHandler(n),
                                        l = js.getEndLoadHandler(n),
                                        c = js.getErrorLoadingHandler(n);
                                    a.currentImageIdIndex = i;
                                    var u = a.imageIds[i];
                                    s && s(n), (!0 === a.preventCache ? r.loadImage(u) : r.loadAndCacheImage(u)).then((function(t) {
                                        var o = r.getViewport(n);
                                        a.currentImageIdIndex === i && (e.displayImage(n, t, o), l && l(n, t))
                                    }), (function(e) {
                                        var t = a.imageIds[i];
                                        c && c(n, t, e)
                                    }))
                                }
                            }
                        },
                        sh = function(e, t, n) {
                            if (n !== t) {
                                var o = y.cornerstone,
                                    r = _(t, "stack").data[0],
                                    a = r.imageIds[r.currentImageIdIndex],
                                    i = o.metaData.get("imagePlaneModule", a);
                                if (void 0 !== i && void 0 !== i.imagePositionPatient) {
                                    var s = en(i.imagePositionPatient),
                                        l = _(n, "stack").data[0],
                                        c = Number.MAX_VALUE,
                                        u = -1;
                                    if (l.imageIds.forEach((function(e, t) {
                                            var n = o.metaData.get("imagePlaneModule", e);
                                            if (void 0 !== n && void 0 !== n.imagePositionPatient) {
                                                var r = en(n.imagePositionPatient).distanceToSquared(s);
                                                r < c && (c = r, u = t)
                                            }
                                        })), u !== l.currentImageIdIndex) {
                                        var d = js.getStartLoadHandler(n),
                                            h = js.getEndLoadHandler(n),
                                            f = js.getErrorLoadingHandler(n);
                                        l.currentImageIdIndex = u;
                                        var m = l.imageIds[u];
                                        d && d(n), -1 !== u && (!0 === l.preventCache ? o.loadImage(m) : o.loadAndCacheImage(m)).then((function(t) {
                                            var r = o.getViewport(n);
                                            l.currentImageIdIndex === u && (e.displayImage(n, t, r), h && h(n, t))
                                        }), (function(e) {
                                            var t = l.imageIds[u];
                                            f && f(n, t, e)
                                        }))
                                    }
                                }
                            }
                        },
                        lh = function(e, t, n, o, r) {
                            if (n !== t) {
                                var a = y.cornerstone,
                                    i = _(t, "stack").data[0],
                                    s = i.imageIds[i.currentImageIdIndex],
                                    l = a.metaData.get("imagePlaneModule", s);
                                if (void 0 !== l && void 0 !== l.imagePositionPatient) {
                                    var c = en(l.imagePositionPatient),
                                        u = _(n, "stack").data[0],
                                        d = Number.MAX_VALUE,
                                        h = -1;
                                    if (r) {
                                        var f = c.clone().add(r);
                                        if (u.imageIds.forEach((function(e, t) {
                                                var n = a.metaData.get("imagePlaneModule", e);
                                                if (void 0 !== n && void 0 !== n.imagePositionPatient) {
                                                    var o = en(n.imagePositionPatient),
                                                        r = f.distanceToSquared(o);
                                                    r < d && (d = r, h = t)
                                                }
                                            })), h !== u.currentImageIdIndex && -1 !== h) {
                                            var m = js.getStartLoadHandler(n),
                                                g = js.getEndLoadHandler(n),
                                                p = js.getErrorLoadingHandler(n);
                                            u.currentImageIdIndex = h;
                                            var v = u.imageIds[h];
                                            m && m(n), (!0 === u.preventCache ? a.loadImage(v) : a.loadAndCacheImage(v)).then((function(t) {
                                                var o = a.getViewport(n);
                                                u.currentImageIdIndex === h && (e.displayImage(n, t, o), g && g(n, t))
                                            }), (function(e) {
                                                var t = u.imageIds[h];
                                                p && p(n, t, e)
                                            }))
                                        }
                                    }
                                }
                            }
                        },
                        ch = function(e, t, n) {
                            if (n !== t) {
                                var o = y.cornerstone,
                                    r = _(t, "stack").data[0],
                                    a = _(n, "stack").data[0],
                                    i = r.currentImageIdIndex;
                                if ((i = An(i, 0, a.imageIds.length - 1)) !== a.currentImageIdIndex) {
                                    var s = js.getStartLoadHandler(n),
                                        l = js.getEndLoadHandler(n),
                                        c = js.getErrorLoadingHandler(n);
                                    s && s(n), (!0 === a.preventCache ? o.loadImage(a.imageIds[i]) : o.loadAndCacheImage(a.imageIds[i])).then((function(t) {
                                        var r = o.getViewport(n);
                                        a.currentImageIdIndex = i, e.displayImage(n, t, r), l && l(n, t)
                                    }), (function(e) {
                                        var t = a.imageIds[i];
                                        c && c(n, t, e)
                                    }))
                                }
                            }
                        },
                        uh = function(e, t, n) {
                            if (n !== t) {
                                var o = y.cornerstone,
                                    r = o.getViewport(t),
                                    a = o.getViewport(n);
                                a.scale === r.scale && a.translation.x === r.translation.x && a.translation.y === r.translation.y || (a.scale = r.scale, a.translation.x = r.translation.x, a.translation.y = r.translation.y, e.setViewport(n, a))
                            }
                        },
                        dh = function(e) {
                            return Wd[e]
                        };
                    n.d(t, "AngleTool", (function() {
                        return ca
                    })), n.d(t, "ArrowAnnotateTool", (function() {
                        return ha
                    })), n.d(t, "BidirectionalTool", (function() {
                        return Xa
                    })), n.d(t, "CircleRoiTool", (function() {
                        return ai
                    })), n.d(t, "CobbAngleTool", (function() {
                        return ui
                    })), n.d(t, "EllipticalRoiTool", (function() {
                        return hi
                    })), n.d(t, "FreehandRoiTool", (function() {
                        return Vi
                    })), n.d(t, "LengthTool", (function() {
                        return qi
                    })), n.d(t, "ProbeTool", (function() {
                        return Wi
                    })), n.d(t, "RectangleRoiTool", (function() {
                        return Yi
                    })), n.d(t, "TextMarkerTool", (function() {
                        return Qi
                    })), n.d(t, "BrushTool", (function() {
                        return ts
                    })), n.d(t, "SphericalBrushTool", (function() {
                        return rs
                    })), n.d(t, "RectangleScissorsTool", (function() {
                        return Ns
                    })), n.d(t, "FreehandScissorsTool", (function() {
                        return Rs
                    })), n.d(t, "CircleScissorsTool", (function() {
                        return Us
                    })), n.d(t, "CorrectionScissorsTool", (function() {
                        return Bs
                    })), n.d(t, "CrosshairsTool", (function() {
                        return Ys
                    })), n.d(t, "DoubleTapFitToWindowTool", (function() {
                        return Zs
                    })), n.d(t, "DragProbeTool", (function() {
                        return Ks
                    })), n.d(t, "EraserTool", (function() {
                        return Qs
                    })), n.d(t, "FreehandRoiSculptorTool", (function() {
                        return el
                    })), n.d(t, "MagnifyTool", (function() {
                        return nl
                    })), n.d(t, "OverlayTool", (function() {
                        return rl
                    })), n.d(t, "OrientationMarkersTool", (function() {
                        return il
                    })), n.d(t, "PanMultiTouchTool", (function() {
                        return dl
                    })), n.d(t, "PanTool", (function() {
                        return hl
                    })), n.d(t, "ReferenceLinesTool", (function() {
                        return xl
                    })), n.d(t, "RotateTool", (function() {
                        return Il
                    })), n.d(t, "RotateTouchTool", (function() {
                        return Cl
                    })), n.d(t, "ScaleOverlayTool", (function() {
                        return Dl
                    })), n.d(t, "StackScrollMouseWheelTool", (function() {
                        return Nl
                    })), n.d(t, "StackScrollMultiTouchTool", (function() {
                        return Ul
                    })), n.d(t, "StackScrollTool", (function() {
                        return Bl
                    })), n.d(t, "WwwcRegionTool", (function() {
                        return Fl
                    })), n.d(t, "WwwcTool", (function() {
                        return zl
                    })), n.d(t, "ZoomMouseWheelTool", (function() {
                        return Zl
                    })), n.d(t, "ZoomTool", (function() {
                        return Jl
                    })), n.d(t, "ZoomTouchPinchTool", (function() {
                        return oc
                    })), n.d(t, "init", (function() {
                        return hd
                    })), n.d(t, "stackPrefetch", (function() {
                        return Td
                    })), n.d(t, "stackRenderers", (function() {
                        return Sd
                    })), n.d(t, "playClip", (function() {
                        return Cd
                    })), n.d(t, "stopClip", (function() {
                        return Md
                    })), n.d(t, "store", (function() {
                        return xt
                    })), n.d(t, "getModule", (function() {
                        return wt
                    })), n.d(t, "getToolForElement", (function() {
                        return Tt
                    })), n.d(t, "addTool", (function() {
                        return Qu
                    })), n.d(t, "addToolForElement", (function() {
                        return Ju
                    })), n.d(t, "removeTool", (function() {
                        return Pd
                    })), n.d(t, "removeToolForElement", (function() {
                        return Dd
                    })), n.d(t, "setToolOptions", (function() {
                        return Ld
                    })), n.d(t, "setToolOptionsForElement", (function() {
                        return _d
                    })), n.d(t, "isToolActiveForElement", (function() {
                        return Co
                    })), n.d(t, "setToolActive", (function() {
                        return Pt
                    })), n.d(t, "setToolActiveForElement", (function() {
                        return Dt
                    })), n.d(t, "setToolEnabled", (function() {
                        return Ot
                    })), n.d(t, "setToolEnabledForElement", (function() {
                        return Lt
                    })), n.d(t, "setToolDisabled", (function() {
                        return _t
                    })), n.d(t, "setToolDisabledForElement", (function() {
                        return kt
                    })), n.d(t, "setToolPassive", (function() {
                        return Nt
                    })), n.d(t, "setToolPassiveForElement", (function() {
                        return Rt
                    })), n.d(t, "addToolState", (function() {
                        return k
                    })), n.d(t, "getToolState", (function() {
                        return _
                    })), n.d(t, "removeToolState", (function() {
                        return L
                    })), n.d(t, "clearToolState", (function() {
                        return O
                    })), n.d(t, "setElementToolStateManager", (function() {
                        return R
                    })), n.d(t, "getElementToolStateManager", (function() {
                        return P
                    })), n.d(t, "textStyle", (function() {
                        return vn
                    })), n.d(t, "toolStyle", (function() {
                        return Zt
                    })), n.d(t, "toolColors", (function() {
                        return un
                    })), n.d(t, "toolCoordinates", (function() {
                        return Aa
                    })), n.d(t, "stackSpecificStateManager", (function() {
                        return Ud
                    })), n.d(t, "newStackSpecificToolStateManager", (function() {
                        return Od
                    })), n.d(t, "addStackStateManager", (function() {
                        return Nd
                    })), n.d(t, "loadHandlerManager", (function() {
                        return js
                    })), n.d(t, "newImageIdSpecificToolStateManager", (function() {
                        return M
                    })), n.d(t, "globalImageIdSpecificToolStateManager", (function() {
                        return D
                    })), n.d(t, "newFrameOfReferenceSpecificToolStateManager", (function() {
                        return Bd
                    })), n.d(t, "globalFrameOfReferenceSpecificToolStateManager", (function() {
                        return Vd
                    })), n.d(t, "forceEnabledElementResize", (function() {
                        return ud
                    })), n.d(t, "orientation", (function() {
                        return al
                    })), n.d(t, "SaveAs", (function() {
                        return Fd
                    })), n.d(t, "enableLogger", (function() {
                        return V
                    })), n.d(t, "disableLogger", (function() {
                        return F
                    })), n.d(t, "register", (function() {
                        return $d
                    })), n.d(t, "registerSome", (function() {
                        return th
                    })), n.d(t, "wwwcSynchronizer", (function() {
                        return nh
                    })), n.d(t, "updateImageSynchronizer", (function() {
                        return oh
                    })), n.d(t, "Synchronizer", (function() {
                        return ah
                    })), n.d(t, "stackScrollSynchronizer", (function() {
                        return ih
                    })), n.d(t, "stackImagePositionSynchronizer", (function() {
                        return sh
                    })), n.d(t, "stackImagePositionOffsetSynchronizer", (function() {
                        return lh
                    })), n.d(t, "stackImageIndexSynchronizer", (function() {
                        return ch
                    })), n.d(t, "panZoomSynchronizer", (function() {
                        return uh
                    })), n.d(t, "importInternal", (function() {
                        return dh
                    })), n.d(t, "external", (function() {
                        return y
                    })), n.d(t, "EVENTS", (function() {
                        return x
                    })), n.d(t, "version", (function() {
                        return "6.0.10"
                    })), n.d(t, "import", (function() {
                        return dh
                    }));
                    var hh = {
                        AngleTool: ca,
                        ArrowAnnotateTool: ha,
                        BidirectionalTool: Xa,
                        CircleRoiTool: ai,
                        CobbAngleTool: ui,
                        EllipticalRoiTool: hi,
                        FreehandRoiTool: Vi,
                        LengthTool: qi,
                        ProbeTool: Wi,
                        RectangleRoiTool: Yi,
                        TextMarkerTool: Qi,
                        BrushTool: ts,
                        SphericalBrushTool: rs,
                        RectangleScissorsTool: Ns,
                        FreehandScissorsTool: Rs,
                        CircleScissorsTool: Us,
                        CorrectionScissorsTool: Bs,
                        CrosshairsTool: Ys,
                        DoubleTapFitToWindowTool: Zs,
                        DragProbeTool: Ks,
                        EraserTool: Qs,
                        FreehandRoiSculptorTool: el,
                        MagnifyTool: nl,
                        OverlayTool: rl,
                        OrientationMarkersTool: il,
                        PanMultiTouchTool: dl,
                        PanTool: hl,
                        ReferenceLinesTool: xl,
                        RotateTool: Il,
                        RotateTouchTool: Cl,
                        ScaleOverlayTool: Dl,
                        StackScrollMouseWheelTool: Nl,
                        StackScrollMultiTouchTool: Ul,
                        StackScrollTool: Bl,
                        WwwcRegionTool: Fl,
                        WwwcTool: zl,
                        ZoomMouseWheelTool: Zl,
                        ZoomTool: Jl,
                        ZoomTouchPinchTool: oc,
                        init: hd,
                        stackPrefetch: Td,
                        stackRenderers: Sd,
                        playClip: Cd,
                        stopClip: Md,
                        store: xt,
                        getModule: wt,
                        getToolForElement: Tt,
                        addTool: Qu,
                        addToolForElement: Ju,
                        removeTool: Pd,
                        removeToolForElement: Dd,
                        setToolOptions: Ld,
                        setToolOptionsForElement: _d,
                        isToolActiveForElement: Co,
                        setToolActive: Pt,
                        setToolActiveForElement: Dt,
                        setToolEnabled: Ot,
                        setToolEnabledForElement: Lt,
                        setToolDisabled: _t,
                        setToolDisabledForElement: kt,
                        setToolPassive: Nt,
                        setToolPassiveForElement: Rt,
                        addToolState: k,
                        getToolState: _,
                        removeToolState: L,
                        clearToolState: O,
                        setElementToolStateManager: R,
                        getElementToolStateManager: P,
                        textStyle: vn,
                        toolStyle: Zt,
                        toolColors: un,
                        toolCoordinates: Aa,
                        stackSpecificStateManager: Ud,
                        newStackSpecificToolStateManager: Od,
                        addStackStateManager: Nd,
                        loadHandlerManager: js,
                        newImageIdSpecificToolStateManager: M,
                        globalImageIdSpecificToolStateManager: D,
                        newFrameOfReferenceSpecificToolStateManager: Bd,
                        globalFrameOfReferenceSpecificToolStateManager: Vd,
                        forceEnabledElementResize: ud,
                        orientation: al,
                        SaveAs: Fd,
                        enableLogger: V,
                        disableLogger: F,
                        importInternal: dh,
                        import: dh,
                        register: $d,
                        registerSome: th,
                        wwwcSynchronizer: nh,
                        updateImageSynchronizer: oh,
                        Synchronizer: ah,
                        stackScrollSynchronizer: ih,
                        stackImagePositionSynchronizer: sh,
                        stackImagePositionOffsetSynchronizer: lh,
                        stackImageIndexSynchronizer: ch,
                        panZoomSynchronizer: uh,
                        external: y,
                        EVENTS: x,
                        version: "6.0.10"
                    };
                    t.default = hh
                }])
            },
            296: (e, t, n) => {
                "use strict";
                n.d(t, {
                    A: () => r
                });
                var o = n(7800);

                function r(e, t) {
                    return function(e) {
                        if (Array.isArray(e)) return e
                    }(e) || function(e, t) {
                        var n = null == e ? null : "undefined" != typeof Symbol && e[Symbol.iterator] || e["@@iterator"];
                        if (null != n) {
                            var o, r, a, i, s = [],
                                l = !0,
                                c = !1;
                            try {
                                if (a = (n = n.call(e)).next, 0 === t) {
                                    if (Object(n) !== n) return;
                                    l = !1
                                } else
                                    for (; !(l = (o = a.call(n)).done) && (s.push(o.value), s.length !== t); l = !0);
                            } catch (e) {
                                c = !0, r = e
                            } finally {
                                try {
                                    if (!l && null != n.return && (i = n.return(), Object(i) !== i)) return
                                } finally {
                                    if (c) throw r
                                }
                            }
                            return s
                        }
                    }(e, t) || (0, o.A)(e, t) || function() {
                        throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                    }()
                }
            },
            334: (e, t, n) => {
                "use strict";
                n.d(t, {
                    E4: () => i,
                    KB: () => l,
                    RF: () => r,
                    xJ: () => a
                });
                var o = n(2117);
                const r = new Map,
                    a = {},
                    i = {
                        store: {},
                        IDArr: [],
                        add: function(e, t) {
                            this.store[e] || (this.store[e] = []), this.store[e].push(Number(t))
                        },
                        sort: function() {
                            this.IDArr = [];
                            for (const e in this.store) this.IDArr.push(e), this.store[e].sort(((e, t) => e - t))
                        },
                        getFirstIndex: function(e) {
                            var t;
                            return null === (t = this.store[e]) || void 0 === t ? void 0 : t[0]
                        },
                        getSeriesIDArr: function() {
                            if (!this.IDArr.length) {
                                this.IDArr = [];
                                for (const e in this.store) this.IDArr.push(e)
                            }
                            return this.IDArr
                        }
                    };
                let s;
                const l = (e, t) => {
                    s = s || (0, o.Tl)("AI"), a[t] = !0;
                    for (const t of e) {
                        const {
                            nodule_bbox: e,
                            seriesID: n,
                            nodule_type: o,
                            nodule_bm_prob: a
                        } = t;
                        for (const s in e) {
                            const l = Number(s) - 1,
                                {
                                    position: h,
                                    size: f
                                } = e[s],
                                m = `${n}?index=${l}`,
                                g = r.get(m),
                                p = h.x - f.w,
                                v = h.y - f.h,
                                y = h.x + f.w,
                                b = h.y + f.h,
                                w = Object.assign(Object.assign({}, t), {
                                    noduleType: c(o),
                                    noduleBmProbCN: u(a) || "",
                                    instanceNumber: Number(s),
                                    visible: !0,
                                    active: !1,
                                    invalidated: !0,
                                    handles: {
                                        start: {
                                            x: p,
                                            y: v,
                                            movesIndependently: !0,
                                            hasBoundingBox: !0
                                        },
                                        end: {
                                            x: y,
                                            y: b,
                                            movesIndependently: !0,
                                            hasBoundingBox: !0
                                        },
                                        textBox: {
                                            x: y,
                                            y: b,
                                            active: !1,
                                            hasMoved: !0,
                                            movesIndependently: !1,
                                            drawnIndependently: !0,
                                            allowedOutsideImage: !0,
                                            hasBoundingBox: !0
                                        }
                                    }
                                });
                            w.textBoxContent = d(w), r.set(m, [...g || [], w]), i.add(n, l)
                        }
                    }
                    i.sort()
                };

                function c(e) {
                    const t = {
                        Calcification: s.calcification,
                        Ground_Glass: s.groundGlass,
                        Part_Solid: s.partSolid,
                        Solid: s.solid,
                        pleural: s.pleural
                    };
                    let n = [];
                    for (const o in e) {
                        const r = {
                            name: o,
                            value: e[o],
                            typeText: t[o]
                        };
                        n.push(r)
                    }
                    return n.sort(((e, t) => t.value - e.value)), n[0].typeText
                }

                function u(e) {
                    return e < .25 ? s.benign : e < .5 ? s.borderlineBenign : e < .75 ? s.borderlineMalignant : e < 1 ? s.malignant : void 0
                }

                function d(e) {
                    const {
                        nodule_no: t,
                        nodule_volume: n,
                        nodule_maxHU: o,
                        nodule_minHU: r,
                        nodule_cross: [{
                            major_diameter_length_mm: a,
                            minor_diameter_length_mm: i
                        }],
                        noduleType: l,
                        noduleBmProbCN: c
                    } = e;
                    return [`${s.number}:N${t}`, `${s.longShortMeridian}: ${a.toFixed(2)}*${i.toFixed(2)}mm`, `${s.volume}: ${n.toFixed(2)}mm${String.fromCharCode(179)}`, `Min: ${r}HU  Max: ${o}HU`, `${s.type}: ${l}  ${s.lesions}: ${c}`]
                }
            },
            346: function(e, t, n) {
                var o, r, a;
                void 0 !== n.g ? n.g : window || this.window || this.global, r = [], o = function() {
                    "use strict";
                    var e = {},
                        t = "iziToast",
                        n = (document.querySelector("body"), !!/Mobi/.test(navigator.userAgent)),
                        o = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor),
                        r = "undefined" != typeof InstallTrigger,
                        a = "ontouchstart" in document.documentElement,
                        i = ["bottomRight", "bottomLeft", "bottomCenter", "topRight", "topLeft", "topCenter", "center"],
                        s = {
                            info: {
                                color: "blue",
                                icon: "ico-info"
                            },
                            success: {
                                color: "green",
                                icon: "ico-success"
                            },
                            warning: {
                                color: "orange",
                                icon: "ico-warning"
                            },
                            error: {
                                color: "red",
                                icon: "ico-error"
                            },
                            question: {
                                color: "yellow",
                                icon: "ico-question"
                            }
                        },
                        l = 568,
                        c = {};
                    e.children = {};
                    var u = {
                        id: null,
                        class: "",
                        title: "",
                        titleColor: "",
                        titleSize: "",
                        titleLineHeight: "",
                        message: "",
                        messageColor: "",
                        messageSize: "",
                        messageLineHeight: "",
                        backgroundColor: "",
                        theme: "light",
                        color: "",
                        icon: "",
                        iconText: "",
                        iconColor: "",
                        iconUrl: null,
                        image: "",
                        imageWidth: 50,
                        maxWidth: null,
                        zindex: null,
                        layout: 1,
                        balloon: !1,
                        close: !0,
                        closeOnEscape: !1,
                        closeOnClick: !1,
                        displayMode: 0,
                        position: "bottomRight",
                        target: "",
                        targetFirst: !0,
                        timeout: 5e3,
                        rtl: !1,
                        animateInside: !0,
                        drag: !0,
                        pauseOnHover: !0,
                        resetOnHover: !1,
                        progressBar: !0,
                        progressBarColor: "",
                        progressBarEasing: "linear",
                        overlay: !1,
                        overlayClose: !1,
                        overlayColor: "rgba(0, 0, 0, 0.6)",
                        transitionIn: "fadeInUp",
                        transitionOut: "fadeOut",
                        transitionInMobile: "fadeInUp",
                        transitionOutMobile: "fadeOutDown",
                        buttons: {},
                        inputs: {},
                        onOpening: function() {},
                        onOpened: function() {},
                        onClosing: function() {},
                        onClosed: function() {}
                    };
                    if ("remove" in Element.prototype || (Element.prototype.remove = function() {
                            this.parentNode && this.parentNode.removeChild(this)
                        }), "function" != typeof window.CustomEvent) {
                        var d = function(e, t) {
                            t = t || {
                                bubbles: !1,
                                cancelable: !1,
                                detail: void 0
                            };
                            var n = document.createEvent("CustomEvent");
                            return n.initCustomEvent(e, t.bubbles, t.cancelable, t.detail), n
                        };
                        d.prototype = window.Event.prototype, window.CustomEvent = d
                    }
                    var h = function(e, t, n) {
                            if ("[object Object]" === Object.prototype.toString.call(e))
                                for (var o in e) Object.prototype.hasOwnProperty.call(e, o) && t.call(n, e[o], o, e);
                            else if (e)
                                for (var r = 0, a = e.length; a > r; r++) t.call(n, e[r], r, e)
                        },
                        f = function(e, t) {
                            var n = {};
                            return h(e, (function(t, o) {
                                n[o] = e[o]
                            })), h(t, (function(e, o) {
                                n[o] = t[o]
                            })), n
                        },
                        m = function(e) {
                            var t = document.createDocumentFragment(),
                                n = document.createElement("div");
                            for (n.innerHTML = e; n.firstChild;) t.appendChild(n.firstChild);
                            return t
                        },
                        g = function(e) {
                            return btoa(encodeURIComponent(e)).replace(/=/g, "")
                        },
                        p = function(e) {
                            return "#" == e.substring(0, 1) || "rgb" == e.substring(0, 3) || "hsl" == e.substring(0, 3)
                        },
                        v = function(e) {
                            try {
                                return btoa(atob(e)) == e
                            } catch (e) {
                                return !1
                            }
                        },
                        y = {
                            move: function(e, n, a, i) {
                                var s, l = .3,
                                    c = 180;
                                0 !== i && (e.classList.add(t + "-dragged"), e.style.transform = "translateX(" + i + "px)", i > 0 ? l > (s = (c - i) / c) && n.hide(f(a, {
                                    transitionOut: "fadeOutRight",
                                    transitionOutMobile: "fadeOutRight"
                                }), e, "drag") : l > (s = (c + i) / c) && n.hide(f(a, {
                                    transitionOut: "fadeOutLeft",
                                    transitionOutMobile: "fadeOutLeft"
                                }), e, "drag"), e.style.opacity = s, l > s && ((o || r) && (e.style.left = i + "px"), e.parentNode.style.opacity = l, this.stopMoving(e, null)))
                            },
                            startMoving: function(e, t, n, o) {
                                o = o || window.event;
                                var r = a ? o.touches[0].clientX : o.clientX,
                                    i = e.style.transform.replace("px)", ""),
                                    s = r - (i = i.replace("translateX(", ""));
                                n.transitionIn && e.classList.remove(n.transitionIn), n.transitionInMobile && e.classList.remove(n.transitionInMobile), e.style.transition = "", a ? document.ontouchmove = function(o) {
                                    o.preventDefault();
                                    var r = (o = o || window.event).touches[0].clientX - s;
                                    y.move(e, t, n, r)
                                } : document.onmousemove = function(o) {
                                    o.preventDefault();
                                    var r = (o = o || window.event).clientX - s;
                                    y.move(e, t, n, r)
                                }
                            },
                            stopMoving: function(e, n) {
                                a ? document.ontouchmove = function() {} : document.onmousemove = function() {}, e.style.opacity = "", e.style.transform = "", e.classList.contains(t + "-dragged") && (e.classList.remove(t + "-dragged"), e.style.transition = "transform 0.4s ease, opacity 0.4s ease", setTimeout((function() {
                                    e.style.transition = ""
                                }), 400))
                            }
                        };
                    return e.setSetting = function(t, n, o) {
                        e.children[t][n] = o
                    }, e.getSetting = function(t, n) {
                        return e.children[t][n]
                    }, e.destroy = function() {
                        h(document.querySelectorAll("." + t + "-overlay"), (function(e, t) {
                            e.remove()
                        })), h(document.querySelectorAll("." + t + "-wrapper"), (function(e, t) {
                            e.remove()
                        })), h(document.querySelectorAll("." + t), (function(e, t) {
                            e.remove()
                        })), this.children = {}, document.removeEventListener(t + "-opened", {}, !1), document.removeEventListener(t + "-opening", {}, !1), document.removeEventListener(t + "-closing", {}, !1), document.removeEventListener(t + "-closed", {}, !1), document.removeEventListener("keyup", {}, !1), c = {}
                    }, e.settings = function(t) {
                        e.destroy(), c = t, u = f(u, t || {})
                    }, h(s, (function(t, n) {
                        e[n] = function(e) {
                            var n = f(c, e || {});
                            n = f(t, n || {}), this.show(n)
                        }
                    })), e.progress = function(e, n, o) {
                        var r = this,
                            a = n.getAttribute("data-iziToast-ref"),
                            i = f(this.children[a], e || {}),
                            s = n.querySelector("." + t + "-progressbar div");
                        return {
                            start: function() {
                                void 0 === i.time.REMAINING && (n.classList.remove(t + "-reseted"), null !== s && (s.style.transition = "width " + i.timeout + "ms " + i.progressBarEasing, s.style.width = "0%"), i.time.START = (new Date).getTime(), i.time.END = i.time.START + i.timeout, i.time.TIMER = setTimeout((function() {
                                    clearTimeout(i.time.TIMER), n.classList.contains(t + "-closing") || (r.hide(i, n, "timeout"), "function" == typeof o && o.apply(r))
                                }), i.timeout), r.setSetting(a, "time", i.time))
                            },
                            pause: function() {
                                if (void 0 !== i.time.START && !n.classList.contains(t + "-paused") && !n.classList.contains(t + "-reseted")) {
                                    if (n.classList.add(t + "-paused"), i.time.REMAINING = i.time.END - (new Date).getTime(), clearTimeout(i.time.TIMER), r.setSetting(a, "time", i.time), null !== s) {
                                        var e = window.getComputedStyle(s).getPropertyValue("width");
                                        s.style.transition = "none", s.style.width = e
                                    }
                                    "function" == typeof o && setTimeout((function() {
                                        o.apply(r)
                                    }), 10)
                                }
                            },
                            resume: function() {
                                void 0 !== i.time.REMAINING ? (n.classList.remove(t + "-paused"), null !== s && (s.style.transition = "width " + i.time.REMAINING + "ms " + i.progressBarEasing, s.style.width = "0%"), i.time.END = (new Date).getTime() + i.time.REMAINING, i.time.TIMER = setTimeout((function() {
                                    clearTimeout(i.time.TIMER), n.classList.contains(t + "-closing") || (r.hide(i, n, "timeout"), "function" == typeof o && o.apply(r))
                                }), i.time.REMAINING), r.setSetting(a, "time", i.time)) : this.start()
                            },
                            reset: function() {
                                clearTimeout(i.time.TIMER), delete i.time.REMAINING, r.setSetting(a, "time", i.time), n.classList.add(t + "-reseted"), n.classList.remove(t + "-paused"), null !== s && (s.style.transition = "none", s.style.width = "100%"), "function" == typeof o && setTimeout((function() {
                                    o.apply(r)
                                }), 10)
                            }
                        }
                    }, e.hide = function(e, o, r) {
                        "object" != typeof o && (o = document.querySelector(o));
                        var a = this,
                            i = f(this.children[o.getAttribute("data-iziToast-ref")], e || {});
                        i.closedBy = r || null, delete i.time.REMAINING, o.classList.add(t + "-closing"),
                            function() {
                                var e = document.querySelector("." + t + "-overlay");
                                if (null !== e) {
                                    var n = e.getAttribute("data-iziToast-ref"),
                                        o = (n = n.split(",")).indexOf(String(i.ref)); - 1 !== o && n.splice(o, 1), e.setAttribute("data-iziToast-ref", n.join()), 0 === n.length && (e.classList.remove("fadeIn"), e.classList.add("fadeOut"), setTimeout((function() {
                                        e.remove()
                                    }), 700))
                                }
                            }(), i.transitionIn && o.classList.remove(i.transitionIn), i.transitionInMobile && o.classList.remove(i.transitionInMobile), n || window.innerWidth <= l ? i.transitionOutMobile && o.classList.add(i.transitionOutMobile) : i.transitionOut && o.classList.add(i.transitionOut);
                        var s = o.parentNode.offsetHeight;
                        o.parentNode.style.height = s + "px", o.style.pointerEvents = "none", (!n || window.innerWidth > l) && (o.parentNode.style.transitionDelay = "0.2s");
                        try {
                            var c = new CustomEvent(t + "-closing", {
                                detail: i,
                                bubbles: !0,
                                cancelable: !0
                            });
                            document.dispatchEvent(c)
                        } catch (e) {
                            console.warn(e)
                        }
                        setTimeout((function() {
                            o.parentNode.style.height = "0px", o.parentNode.style.overflow = "", setTimeout((function() {
                                delete a.children[i.ref], o.parentNode.remove();
                                try {
                                    var e = new CustomEvent(t + "-closed", {
                                        detail: i,
                                        bubbles: !0,
                                        cancelable: !0
                                    });
                                    document.dispatchEvent(e)
                                } catch (e) {
                                    console.warn(e)
                                }
                                void 0 !== i.onClosed && i.onClosed.apply(null, [i, o, r])
                            }), 1e3)
                        }), 200), void 0 !== i.onClosing && i.onClosing.apply(null, [i, o, r])
                    }, e.show = function(o) {
                        var r = this,
                            s = f(c, o || {});
                        if ((s = f(u, s)).time = {}, null === s.id && (s.id = g(s.title + s.message + s.color)), 1 === s.displayMode || "once" == s.displayMode) try {
                            if (document.querySelectorAll("." + t + "#" + s.id).length > 0) return !1
                        } catch (e) {
                            console.warn("[" + t + "] Could not find an element with this selector: #" + s.id + ". Try to set an valid id.")
                        }
                        if (2 === s.displayMode || "replace" == s.displayMode) try {
                            h(document.querySelectorAll("." + t + "#" + s.id), (function(e, t) {
                                r.hide(s, e, "replaced")
                            }))
                        } catch (e) {
                            console.warn("[" + t + "] Could not find an element with this selector: #" + s.id + ". Try to set an valid id.")
                        }
                        s.ref = (new Date).getTime() + Math.floor(1e7 * Math.random() + 1), e.children[s.ref] = s;
                        var d, b = {
                            body: document.querySelector("body"),
                            overlay: document.createElement("div"),
                            toast: document.createElement("div"),
                            toastBody: document.createElement("div"),
                            toastTexts: document.createElement("div"),
                            toastCapsule: document.createElement("div"),
                            cover: document.createElement("div"),
                            buttons: document.createElement("div"),
                            inputs: document.createElement("div"),
                            icon: s.iconUrl ? document.createElement("img") : document.createElement("i"),
                            wrapper: null
                        };
                        b.toast.setAttribute("data-iziToast-ref", s.ref), b.toast.appendChild(b.toastBody), b.toastCapsule.appendChild(b.toast),
                            function() {
                                if (b.toast.classList.add(t), b.toast.classList.add(t + "-opening"), b.toastCapsule.classList.add(t + "-capsule"), b.toastBody.classList.add(t + "-body"), b.toastTexts.classList.add(t + "-texts"), n || window.innerWidth <= l ? s.transitionInMobile && b.toast.classList.add(s.transitionInMobile) : s.transitionIn && b.toast.classList.add(s.transitionIn), s.class) {
                                    var e = s.class.split(" ");
                                    h(e, (function(e, t) {
                                        b.toast.classList.add(e)
                                    }))
                                }
                                s.id && (b.toast.id = s.id), s.rtl && (b.toast.classList.add(t + "-rtl"), b.toast.setAttribute("dir", "rtl")), s.layout > 1 && b.toast.classList.add(t + "-layout" + s.layout), s.balloon && b.toast.classList.add(t + "-balloon"), s.maxWidth && (isNaN(s.maxWidth) ? b.toast.style.maxWidth = s.maxWidth : b.toast.style.maxWidth = s.maxWidth + "px"), "" === s.theme && "light" === s.theme || b.toast.classList.add(t + "-theme-" + s.theme), s.color && (p(s.color) ? b.toast.style.background = s.color : b.toast.classList.add(t + "-color-" + s.color)), s.backgroundColor && (b.toast.style.background = s.backgroundColor, s.balloon && (b.toast.style.borderColor = s.backgroundColor))
                            }(), s.image && (b.cover.classList.add(t + "-cover"), b.cover.style.width = s.imageWidth + "px", v(s.image.replace(/ /g, "")) ? b.cover.style.backgroundImage = "url(data:image/png;base64," + s.image.replace(/ /g, "") + ")" : b.cover.style.backgroundImage = "url(" + s.image + ")", s.rtl ? b.toastBody.style.marginRight = s.imageWidth + 10 + "px" : b.toastBody.style.marginLeft = s.imageWidth + 10 + "px", b.toast.appendChild(b.cover)), s.close ? (b.buttonClose = document.createElement("button"), b.buttonClose.type = "button", b.buttonClose.classList.add(t + "-close"), b.buttonClose.addEventListener("click", (function(e) {
                                e.target, r.hide(s, b.toast, "button")
                            })), b.toast.appendChild(b.buttonClose)) : s.rtl ? b.toast.style.paddingLeft = "18px" : b.toast.style.paddingRight = "18px", s.progressBar && (b.progressBar = document.createElement("div"), b.progressBarDiv = document.createElement("div"), b.progressBar.classList.add(t + "-progressbar"), b.progressBarDiv.style.background = s.progressBarColor, b.progressBar.appendChild(b.progressBarDiv), b.toast.appendChild(b.progressBar)), s.timeout && (s.pauseOnHover && !s.resetOnHover && (b.toast.addEventListener("mouseenter", (function(e) {
                                r.progress(s, b.toast).pause()
                            })), b.toast.addEventListener("mouseleave", (function(e) {
                                r.progress(s, b.toast).resume()
                            }))), s.resetOnHover && (b.toast.addEventListener("mouseenter", (function(e) {
                                r.progress(s, b.toast).reset()
                            })), b.toast.addEventListener("mouseleave", (function(e) {
                                r.progress(s, b.toast).start()
                            })))), s.iconUrl ? (b.icon.setAttribute("class", t + "-icon"), b.icon.setAttribute("src", s.iconUrl)) : s.icon && (b.icon.setAttribute("class", t + "-icon " + s.icon), s.iconText && b.icon.appendChild(document.createTextNode(s.iconText)), s.iconColor && (b.icon.style.color = s.iconColor)), (s.icon || s.iconUrl) && (s.rtl ? b.toastBody.style.paddingRight = "33px" : b.toastBody.style.paddingLeft = "33px", b.toastBody.appendChild(b.icon)), s.title.length > 0 && (b.strong = document.createElement("strong"), b.strong.classList.add(t + "-title"), b.strong.appendChild(m(s.title)), b.toastTexts.appendChild(b.strong), s.titleColor && (b.strong.style.color = s.titleColor), s.titleSize && (isNaN(s.titleSize) ? b.strong.style.fontSize = s.titleSize : b.strong.style.fontSize = s.titleSize + "px"), s.titleLineHeight && (isNaN(s.titleSize) ? b.strong.style.lineHeight = s.titleLineHeight : b.strong.style.lineHeight = s.titleLineHeight + "px")), s.message.length > 0 && (b.p = document.createElement("p"), b.p.classList.add(t + "-message"), b.p.appendChild(m(s.message)), b.toastTexts.appendChild(b.p), s.messageColor && (b.p.style.color = s.messageColor), s.messageSize && (isNaN(s.titleSize) ? b.p.style.fontSize = s.messageSize : b.p.style.fontSize = s.messageSize + "px"), s.messageLineHeight && (isNaN(s.titleSize) ? b.p.style.lineHeight = s.messageLineHeight : b.p.style.lineHeight = s.messageLineHeight + "px")), s.title.length > 0 && s.message.length > 0 && (s.rtl ? b.strong.style.marginLeft = "10px" : 2 === s.layout || s.rtl || (b.strong.style.marginRight = "10px")), b.toastBody.appendChild(b.toastTexts), s.inputs.length > 0 && (b.inputs.classList.add(t + "-inputs"), h(s.inputs, (function(e, n) {
                                b.inputs.appendChild(m(e[0])), (d = b.inputs.childNodes)[n].classList.add(t + "-inputs-child"), e[3] && setTimeout((function() {
                                    d[n].focus()
                                }), 300), d[n].addEventListener(e[1], (function(t) {
                                    return (0, e[2])(r, b.toast, this, t)
                                }))
                            })), b.toastBody.appendChild(b.inputs)), s.buttons.length > 0 && (b.buttons.classList.add(t + "-buttons"), h(s.buttons, (function(e, n) {
                                b.buttons.appendChild(m(e[0]));
                                var o = b.buttons.childNodes;
                                o[n].classList.add(t + "-buttons-child"), e[2] && setTimeout((function() {
                                    o[n].focus()
                                }), 300), o[n].addEventListener("click", (function(t) {
                                    return t.preventDefault(), (0, e[1])(r, b.toast, this, t, d)
                                }))
                            }))), b.toastBody.appendChild(b.buttons), s.message.length > 0 && (s.inputs.length > 0 || s.buttons.length > 0) && (b.p.style.marginBottom = "0"), (s.inputs.length > 0 || s.buttons.length > 0) && (s.rtl ? b.toastTexts.style.marginLeft = "10px" : b.toastTexts.style.marginRight = "10px", s.inputs.length > 0 && s.buttons.length > 0 && (s.rtl ? b.inputs.style.marginLeft = "8px" : b.inputs.style.marginRight = "8px")), b.toastCapsule.style.visibility = "hidden", setTimeout((function() {
                                var e = b.toast.offsetHeight,
                                    t = b.toast.currentStyle || window.getComputedStyle(b.toast),
                                    n = t.marginTop;
                                n = n.split("px"), n = parseInt(n[0]);
                                var o = t.marginBottom;
                                o = o.split("px"), o = parseInt(o[0]), b.toastCapsule.style.visibility = "", b.toastCapsule.style.height = e + o + n + "px", setTimeout((function() {
                                    b.toastCapsule.style.height = "auto", s.target && (b.toastCapsule.style.overflow = "visible")
                                }), 500), s.timeout && r.progress(s, b.toast).start()
                            }), 100),
                            function() {
                                var e = s.position;
                                if (s.target) b.wrapper = document.querySelector(s.target), b.wrapper.classList.add(t + "-target"), s.targetFirst ? b.wrapper.insertBefore(b.toastCapsule, b.wrapper.firstChild) : b.wrapper.appendChild(b.toastCapsule);
                                else {
                                    if (-1 == i.indexOf(s.position)) return void console.warn("[" + t + "] Incorrect position.\nIt can be  " + i);
                                    e = n || window.innerWidth <= l ? "bottomLeft" == s.position || "bottomRight" == s.position || "bottomCenter" == s.position ? t + "-wrapper-bottomCenter" : "topLeft" == s.position || "topRight" == s.position || "topCenter" == s.position ? t + "-wrapper-topCenter" : t + "-wrapper-center" : t + "-wrapper-" + e, b.wrapper = document.querySelector("." + t + "-wrapper." + e), b.wrapper || (b.wrapper = document.createElement("div"), b.wrapper.classList.add(t + "-wrapper"), b.wrapper.classList.add(e), document.body.appendChild(b.wrapper)), "topLeft" == s.position || "topCenter" == s.position || "topRight" == s.position ? b.wrapper.insertBefore(b.toastCapsule, b.wrapper.firstChild) : b.wrapper.appendChild(b.toastCapsule)
                                }
                                isNaN(s.zindex) ? console.warn("[" + t + "] Invalid zIndex.") : b.wrapper.style.zIndex = s.zindex
                            }(), s.overlay && (null !== document.querySelector("." + t + "-overlay.fadeIn") ? (b.overlay = document.querySelector("." + t + "-overlay"), b.overlay.setAttribute("data-iziToast-ref", b.overlay.getAttribute("data-iziToast-ref") + "," + s.ref), isNaN(s.zindex) || null === s.zindex || (b.overlay.style.zIndex = s.zindex - 1)) : (b.overlay.classList.add(t + "-overlay"), b.overlay.classList.add("fadeIn"), b.overlay.style.background = s.overlayColor, b.overlay.setAttribute("data-iziToast-ref", s.ref), isNaN(s.zindex) || null === s.zindex || (b.overlay.style.zIndex = s.zindex - 1), document.querySelector("body").appendChild(b.overlay)), s.overlayClose ? (b.overlay.removeEventListener("click", {}), b.overlay.addEventListener("click", (function(e) {
                                r.hide(s, b.toast, "overlay")
                            }))) : b.overlay.removeEventListener("click", {})),
                            function() {
                                if (s.animateInside) {
                                    b.toast.classList.add(t + "-animateInside");
                                    var e = [200, 100, 300];
                                    "bounceInLeft" != s.transitionIn && "bounceInRight" != s.transitionIn || (e = [400, 200, 400]), s.title.length > 0 && setTimeout((function() {
                                        b.strong.classList.add("slideIn")
                                    }), e[0]), s.message.length > 0 && setTimeout((function() {
                                        b.p.classList.add("slideIn")
                                    }), e[1]), (s.icon || s.iconUrl) && setTimeout((function() {
                                        b.icon.classList.add("revealIn")
                                    }), e[2]);
                                    var n = 150;
                                    s.buttons.length > 0 && b.buttons && setTimeout((function() {
                                        h(b.buttons.childNodes, (function(e, t) {
                                            setTimeout((function() {
                                                e.classList.add("revealIn")
                                            }), n), n += 150
                                        }))
                                    }), s.inputs.length > 0 ? 150 : 0), s.inputs.length > 0 && b.inputs && (n = 150, h(b.inputs.childNodes, (function(e, t) {
                                        setTimeout((function() {
                                            e.classList.add("revealIn")
                                        }), n), n += 150
                                    })))
                                }
                            }(), s.onOpening.apply(null, [s, b.toast]);
                        try {
                            var w = new CustomEvent(t + "-opening", {
                                detail: s,
                                bubbles: !0,
                                cancelable: !0
                            });
                            document.dispatchEvent(w)
                        } catch (e) {
                            console.warn(e)
                        }
                        setTimeout((function() {
                            b.toast.classList.remove(t + "-opening"), b.toast.classList.add(t + "-opened");
                            try {
                                var e = new CustomEvent(t + "-opened", {
                                    detail: s,
                                    bubbles: !0,
                                    cancelable: !0
                                });
                                document.dispatchEvent(e)
                            } catch (e) {
                                console.warn(e)
                            }
                            s.onOpened.apply(null, [s, b.toast])
                        }), 1e3), s.drag && (a ? (b.toast.addEventListener("touchstart", (function(e) {
                            y.startMoving(this, r, s, e)
                        }), !1), b.toast.addEventListener("touchend", (function(e) {
                            y.stopMoving(this, e)
                        }), !1)) : (b.toast.addEventListener("mousedown", (function(e) {
                            e.preventDefault(), y.startMoving(this, r, s, e)
                        }), !1), b.toast.addEventListener("mouseup", (function(e) {
                            e.preventDefault(), y.stopMoving(this, e)
                        }), !1))), s.closeOnEscape && document.addEventListener("keyup", (function(e) {
                            27 == (e = e || window.event).keyCode && r.hide(s, b.toast, "esc")
                        })), s.closeOnClick && b.toast.addEventListener("click", (function(e) {
                            r.hide(s, b.toast, "toast")
                        })), r.toast = b.toast
                    }, e
                }(), void 0 === (a = "function" == typeof o ? o.apply(t, r) : o) || (e.exports = a)
            },
            414: e => {
                "use strict";
                e.exports = Math.round
            },
            453: (e, t, n) => {
                "use strict";
                var o, r = n(9612),
                    a = n(9383),
                    i = n(1237),
                    s = n(9290),
                    l = n(9538),
                    c = n(8068),
                    u = n(9675),
                    d = n(5345),
                    h = n(1514),
                    f = n(8968),
                    m = n(6188),
                    g = n(8002),
                    p = n(5880),
                    v = n(414),
                    y = n(3093),
                    b = Function,
                    w = function(e) {
                        try {
                            return b('"use strict"; return (' + e + ").constructor;")()
                        } catch (e) {}
                    },
                    x = n(5795),
                    T = n(655),
                    I = function() {
                        throw new u
                    },
                    E = x ? function() {
                        try {
                            return I
                        } catch (e) {
                            try {
                                return x(arguments, "callee").get
                            } catch (e) {
                                return I
                            }
                        }
                    }() : I,
                    S = n(4039)(),
                    A = n(3628),
                    C = n(1064),
                    M = n(8648),
                    D = n(1002),
                    P = n(76),
                    k = {},
                    _ = "undefined" != typeof Uint8Array && A ? A(Uint8Array) : o,
                    L = {
                        __proto__: null,
                        "%AggregateError%": "undefined" == typeof AggregateError ? o : AggregateError,
                        "%Array%": Array,
                        "%ArrayBuffer%": "undefined" == typeof ArrayBuffer ? o : ArrayBuffer,
                        "%ArrayIteratorPrototype%": S && A ? A([][Symbol.iterator]()) : o,
                        "%AsyncFromSyncIteratorPrototype%": o,
                        "%AsyncFunction%": k,
                        "%AsyncGenerator%": k,
                        "%AsyncGeneratorFunction%": k,
                        "%AsyncIteratorPrototype%": k,
                        "%Atomics%": "undefined" == typeof Atomics ? o : Atomics,
                        "%BigInt%": "undefined" == typeof BigInt ? o : BigInt,
                        "%BigInt64Array%": "undefined" == typeof BigInt64Array ? o : BigInt64Array,
                        "%BigUint64Array%": "undefined" == typeof BigUint64Array ? o : BigUint64Array,
                        "%Boolean%": Boolean,
                        "%DataView%": "undefined" == typeof DataView ? o : DataView,
                        "%Date%": Date,
                        "%decodeURI%": decodeURI,
                        "%decodeURIComponent%": decodeURIComponent,
                        "%encodeURI%": encodeURI,
                        "%encodeURIComponent%": encodeURIComponent,
                        "%Error%": a,
                        "%eval%": eval,
                        "%EvalError%": i,
                        "%Float16Array%": "undefined" == typeof Float16Array ? o : Float16Array,
                        "%Float32Array%": "undefined" == typeof Float32Array ? o : Float32Array,
                        "%Float64Array%": "undefined" == typeof Float64Array ? o : Float64Array,
                        "%FinalizationRegistry%": "undefined" == typeof FinalizationRegistry ? o : FinalizationRegistry,
                        "%Function%": b,
                        "%GeneratorFunction%": k,
                        "%Int8Array%": "undefined" == typeof Int8Array ? o : Int8Array,
                        "%Int16Array%": "undefined" == typeof Int16Array ? o : Int16Array,
                        "%Int32Array%": "undefined" == typeof Int32Array ? o : Int32Array,
                        "%isFinite%": isFinite,
                        "%isNaN%": isNaN,
                        "%IteratorPrototype%": S && A ? A(A([][Symbol.iterator]())) : o,
                        "%JSON%": "object" == typeof JSON ? JSON : o,
                        "%Map%": "undefined" == typeof Map ? o : Map,
                        "%MapIteratorPrototype%": "undefined" != typeof Map && S && A ? A((new Map)[Symbol.iterator]()) : o,
                        "%Math%": Math,
                        "%Number%": Number,
                        "%Object%": r,
                        "%Object.getOwnPropertyDescriptor%": x,
                        "%parseFloat%": parseFloat,
                        "%parseInt%": parseInt,
                        "%Promise%": "undefined" == typeof Promise ? o : Promise,
                        "%Proxy%": "undefined" == typeof Proxy ? o : Proxy,
                        "%RangeError%": s,
                        "%ReferenceError%": l,
                        "%Reflect%": "undefined" == typeof Reflect ? o : Reflect,
                        "%RegExp%": RegExp,
                        "%Set%": "undefined" == typeof Set ? o : Set,
                        "%SetIteratorPrototype%": "undefined" != typeof Set && S && A ? A((new Set)[Symbol.iterator]()) : o,
                        "%SharedArrayBuffer%": "undefined" == typeof SharedArrayBuffer ? o : SharedArrayBuffer,
                        "%String%": String,
                        "%StringIteratorPrototype%": S && A ? A("" [Symbol.iterator]()) : o,
                        "%Symbol%": S ? Symbol : o,
                        "%SyntaxError%": c,
                        "%ThrowTypeError%": E,
                        "%TypedArray%": _,
                        "%TypeError%": u,
                        "%Uint8Array%": "undefined" == typeof Uint8Array ? o : Uint8Array,
                        "%Uint8ClampedArray%": "undefined" == typeof Uint8ClampedArray ? o : Uint8ClampedArray,
                        "%Uint16Array%": "undefined" == typeof Uint16Array ? o : Uint16Array,
                        "%Uint32Array%": "undefined" == typeof Uint32Array ? o : Uint32Array,
                        "%URIError%": d,
                        "%WeakMap%": "undefined" == typeof WeakMap ? o : WeakMap,
                        "%WeakRef%": "undefined" == typeof WeakRef ? o : WeakRef,
                        "%WeakSet%": "undefined" == typeof WeakSet ? o : WeakSet,
                        "%Function.prototype.call%": P,
                        "%Function.prototype.apply%": D,
                        "%Object.defineProperty%": T,
                        "%Object.getPrototypeOf%": C,
                        "%Math.abs%": h,
                        "%Math.floor%": f,
                        "%Math.max%": m,
                        "%Math.min%": g,
                        "%Math.pow%": p,
                        "%Math.round%": v,
                        "%Math.sign%": y,
                        "%Reflect.getPrototypeOf%": M
                    };
                if (A) try {
                    null.error
                } catch (e) {
                    var O = A(A(e));
                    L["%Error.prototype%"] = O
                }
                var R = function e(t) {
                        var n;
                        if ("%AsyncFunction%" === t) n = w("async function () {}");
                        else if ("%GeneratorFunction%" === t) n = w("function* () {}");
                        else if ("%AsyncGeneratorFunction%" === t) n = w("async function* () {}");
                        else if ("%AsyncGenerator%" === t) {
                            var o = e("%AsyncGeneratorFunction%");
                            o && (n = o.prototype)
                        } else if ("%AsyncIteratorPrototype%" === t) {
                            var r = e("%AsyncGenerator%");
                            r && A && (n = A(r.prototype))
                        }
                        return L[t] = n, n
                    },
                    N = {
                        __proto__: null,
                        "%ArrayBufferPrototype%": ["ArrayBuffer", "prototype"],
                        "%ArrayPrototype%": ["Array", "prototype"],
                        "%ArrayProto_entries%": ["Array", "prototype", "entries"],
                        "%ArrayProto_forEach%": ["Array", "prototype", "forEach"],
                        "%ArrayProto_keys%": ["Array", "prototype", "keys"],
                        "%ArrayProto_values%": ["Array", "prototype", "values"],
                        "%AsyncFunctionPrototype%": ["AsyncFunction", "prototype"],
                        "%AsyncGenerator%": ["AsyncGeneratorFunction", "prototype"],
                        "%AsyncGeneratorPrototype%": ["AsyncGeneratorFunction", "prototype", "prototype"],
                        "%BooleanPrototype%": ["Boolean", "prototype"],
                        "%DataViewPrototype%": ["DataView", "prototype"],
                        "%DatePrototype%": ["Date", "prototype"],
                        "%ErrorPrototype%": ["Error", "prototype"],
                        "%EvalErrorPrototype%": ["EvalError", "prototype"],
                        "%Float32ArrayPrototype%": ["Float32Array", "prototype"],
                        "%Float64ArrayPrototype%": ["Float64Array", "prototype"],
                        "%FunctionPrototype%": ["Function", "prototype"],
                        "%Generator%": ["GeneratorFunction", "prototype"],
                        "%GeneratorPrototype%": ["GeneratorFunction", "prototype", "prototype"],
                        "%Int8ArrayPrototype%": ["Int8Array", "prototype"],
                        "%Int16ArrayPrototype%": ["Int16Array", "prototype"],
                        "%Int32ArrayPrototype%": ["Int32Array", "prototype"],
                        "%JSONParse%": ["JSON", "parse"],
                        "%JSONStringify%": ["JSON", "stringify"],
                        "%MapPrototype%": ["Map", "prototype"],
                        "%NumberPrototype%": ["Number", "prototype"],
                        "%ObjectPrototype%": ["Object", "prototype"],
                        "%ObjProto_toString%": ["Object", "prototype", "toString"],
                        "%ObjProto_valueOf%": ["Object", "prototype", "valueOf"],
                        "%PromisePrototype%": ["Promise", "prototype"],
                        "%PromiseProto_then%": ["Promise", "prototype", "then"],
                        "%Promise_all%": ["Promise", "all"],
                        "%Promise_reject%": ["Promise", "reject"],
                        "%Promise_resolve%": ["Promise", "resolve"],
                        "%RangeErrorPrototype%": ["RangeError", "prototype"],
                        "%ReferenceErrorPrototype%": ["ReferenceError", "prototype"],
                        "%RegExpPrototype%": ["RegExp", "prototype"],
                        "%SetPrototype%": ["Set", "prototype"],
                        "%SharedArrayBufferPrototype%": ["SharedArrayBuffer", "prototype"],
                        "%StringPrototype%": ["String", "prototype"],
                        "%SymbolPrototype%": ["Symbol", "prototype"],
                        "%SyntaxErrorPrototype%": ["SyntaxError", "prototype"],
                        "%TypedArrayPrototype%": ["TypedArray", "prototype"],
                        "%TypeErrorPrototype%": ["TypeError", "prototype"],
                        "%Uint8ArrayPrototype%": ["Uint8Array", "prototype"],
                        "%Uint8ClampedArrayPrototype%": ["Uint8ClampedArray", "prototype"],
                        "%Uint16ArrayPrototype%": ["Uint16Array", "prototype"],
                        "%Uint32ArrayPrototype%": ["Uint32Array", "prototype"],
                        "%URIErrorPrototype%": ["URIError", "prototype"],
                        "%WeakMapPrototype%": ["WeakMap", "prototype"],
                        "%WeakSetPrototype%": ["WeakSet", "prototype"]
                    },
                    U = n(6743),
                    B = n(9957),
                    V = U.call(P, Array.prototype.concat),
                    F = U.call(D, Array.prototype.splice),
                    H = U.call(P, String.prototype.replace),
                    q = U.call(P, String.prototype.slice),
                    j = U.call(P, RegExp.prototype.exec),
                    z = /[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,
                    W = /\\(\\)?/g,
                    G = function(e, t) {
                        var n, o = e;
                        if (B(N, o) && (o = "%" + (n = N[o])[0] + "%"), B(L, o)) {
                            var r = L[o];
                            if (r === k && (r = R(o)), void 0 === r && !t) throw new u("intrinsic " + e + " exists, but is not available. Please file an issue!");
                            return {
                                alias: n,
                                name: o,
                                value: r
                            }
                        }
                        throw new c("intrinsic " + e + " does not exist!")
                    };
                e.exports = function(e, t) {
                    if ("string" != typeof e || 0 === e.length) throw new u("intrinsic name must be a non-empty string");
                    if (arguments.length > 1 && "boolean" != typeof t) throw new u('"allowMissing" argument must be a boolean');
                    if (null === j(/^%?[^%]*%?$/, e)) throw new c("`%` may not be present anywhere but at the beginning and end of the intrinsic name");
                    var n = function(e) {
                            var t = q(e, 0, 1),
                                n = q(e, -1);
                            if ("%" === t && "%" !== n) throw new c("invalid intrinsic syntax, expected closing `%`");
                            if ("%" === n && "%" !== t) throw new c("invalid intrinsic syntax, expected opening `%`");
                            var o = [];
                            return H(e, z, (function(e, t, n, r) {
                                o[o.length] = n ? H(r, W, "$1") : t || e
                            })), o
                        }(e),
                        o = n.length > 0 ? n[0] : "",
                        r = G("%" + o + "%", t),
                        a = r.name,
                        i = r.value,
                        s = !1,
                        l = r.alias;
                    l && (o = l[0], F(n, V([0, 1], l)));
                    for (var d = 1, h = !0; d < n.length; d += 1) {
                        var f = n[d],
                            m = q(f, 0, 1),
                            g = q(f, -1);
                        if (('"' === m || "'" === m || "`" === m || '"' === g || "'" === g || "`" === g) && m !== g) throw new c("property names with quotes must have matching quotes");
                        if ("constructor" !== f && h || (s = !0), B(L, a = "%" + (o += "." + f) + "%")) i = L[a];
                        else if (null != i) {
                            if (!(f in i)) {
                                if (!t) throw new u("base intrinsic for " + e + " exists, but the property is not available.");
                                return
                            }
                            if (x && d + 1 >= n.length) {
                                var p = x(i, f);
                                i = (h = !!p) && "get" in p && !("originalValue" in p.get) ? p.get : i[f]
                            } else h = B(i, f), i = i[f];
                            h && !s && (L[a] = i)
                        }
                    }
                    return i
                }
            },
            467: (e, t, n) => {
                "use strict";

                function o(e, t, n, o, r, a, i) {
                    try {
                        var s = e[a](i),
                            l = s.value
                    } catch (e) {
                        return void n(e)
                    }
                    s.done ? t(l) : Promise.resolve(l).then(o, r)
                }

                function r(e) {
                    return function() {
                        var t = this,
                            n = arguments;
                        return new Promise((function(r, a) {
                            var i = e.apply(t, n);

                            function s(e) {
                                o(i, r, a, s, l, "next", e)
                            }

                            function l(e) {
                                o(i, r, a, s, l, "throw", e)
                            }
                            s(void 0)
                        }))
                    }
                }
                n.d(t, {
                    A: () => r
                })
            },
            507: (e, t, n) => {
                "use strict";
                var o = n(453),
                    r = n(6556),
                    a = n(8859),
                    i = n(9675),
                    s = o("%Map%", !0),
                    l = r("Map.prototype.get", !0),
                    c = r("Map.prototype.set", !0),
                    u = r("Map.prototype.has", !0),
                    d = r("Map.prototype.delete", !0),
                    h = r("Map.prototype.size", !0);
                e.exports = !!s && function() {
                    var e, t = {
                        assert: function(e) {
                            if (!t.has(e)) throw new i("Side channel does not contain " + a(e))
                        },
                        delete: function(t) {
                            if (e) {
                                var n = d(e, t);
                                return 0 === h(e) && (e = void 0), n
                            }
                            return !1
                        },
                        get: function(t) {
                            if (e) return l(e, t)
                        },
                        has: function(t) {
                            return !!e && u(e, t)
                        },
                        set: function(t, n) {
                            e || (e = new s), c(e, t, n)
                        }
                    };
                    return t
                }
            },
            642: e => {
                "use strict";
                e.exports = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAwFBMVEUAAAAcEQkqGQ+QXTgTCwYhFAxoQiiJVzVWNiF/UjE6JRYKBgJ3TC5ySSwwHhJsRSqNWzdFKxo0IRMmFw6VYDtjPiZRMx9JLxxbOiNvRitePCT4wHmhaEB6UDCma0I/KBiEVTROMR6ZYjyCUzP7xn3osG+pbkTnqWvKhlTDfk7bpGeqd0q4d0nuuHT3t3PUn2TYmF/ElF7EjVi6iFa7gFCwgE+wekywcUbem2HNll3WklvUiVXBhFKjdkqaa0LdqmwjTj//AAACZElEQVQ4y9WNZ3LbMBBG0RtRBBAk2CmqWJJ7d5qd+98qsJ0fyeQEeYMZLPZ7iwX/GUVBILII2TArRIp/clqixTVJJdMulRYK/a0UKDMrs1kLOUlVmUQD+Ug+/yq87bhszDBZADfTdpg2jfXkQyAkT9fCnE1nl8cTzq3qdMqPoUWhJAQoCGtlxXqahuny+/eYhfZ4moYYV6xEHQUeemZr0bhxGIbL0wsqFX8ZIu+8SgmKBSDKVOogRTPHcTNsJMb4JTpPIUKEIAegrWnVElIywyq+kTJuYuQBohnBoihqQAKCzEOkOHbLiIfnH894WwfrnEAlJRRQBImCXutRp2Tw137X/1y5ruw61gpUFABZSArScGlcmpO56q+vd3dpQXXVmab0BNhACPGyYkwbrVd9ZncnWM5r4RBLwFWkoJ02Yzy7PcrX3f7mvN+Pa66ZEE1gLfgW85pQm/vD7f7i6/5Ka/m029+fHc8fmYJNBXZvBSCZ8fxwOH7peync3e769tvh8IAUUQnsdQEKWBDqLh4vn5/O9w83V/dvFz++xFqVUNXgackCoKKumNaicg99f2FchbEzWw/DAph6X5G4bJ3QsmXm5nEr16t1K3FkJbVABEJmlCfWzLdSjuJVy+1WtwZvYlPaAJKyoRYMY12HxjBW86YzvJ0bzqvZtwyMmnWMtVz6cm61ECw23vExoKoR1RZjgFerFd9KKRAtgwpKsKR88nNntOQ4xixgnCXpGoUy1lqESkrRMuYg81vIOAtzv8xhWeYKWqHXnHPwnnK+No2FH9B3PisUfC0Az+nIFpub+RDyfv3JL+wXNhoUBI2IAAAAAElFTkSuQmCC"
            },
            655: e => {
                "use strict";
                var t = Object.defineProperty || !1;
                if (t) try {
                    t({}, "a", {
                        value: 1
                    })
                } catch (e) {
                    t = !1
                }
                e.exports = t
            },
            730: (e, t, n) => {
                var o;
                /*! Hammer.JS - v2.0.7 - 2016-04-22
                 * http://hammerjs.github.io/
                 *
                 * Copyright (c) 2016 Jorik Tangelder;
                 * Licensed under the MIT license */
                ! function(r, a, i, s) {
                    "use strict";

                    function l(e, t, n) {
                        return setTimeout(f(e, n), t)
                    }

                    function c(e, t, n) {
                        return !!Array.isArray(e) && (u(e, n[t], n), !0)
                    }

                    function u(e, t, n) {
                        var o;
                        if (e)
                            if (e.forEach) e.forEach(t, n);
                            else if (e.length !== s)
                            for (o = 0; o < e.length;) t.call(n, e[o], o, e), o++;
                        else
                            for (o in e) e.hasOwnProperty(o) && t.call(n, e[o], o, e)
                    }

                    function d(e, t, n) {
                        var o = "DEPRECATED METHOD: " + t + "\n" + n + " AT \n";
                        return function() {
                            var t = new Error("get-stack-trace"),
                                n = t && t.stack ? t.stack.replace(/^[^\(]+?[\n$]/gm, "").replace(/^\s+at\s+/gm, "").replace(/^Object.<anonymous>\s*\(/gm, "{anonymous}()@") : "Unknown Stack Trace",
                                a = r.console && (r.console.warn || r.console.log);
                            return a && a.call(r.console, o, n), e.apply(this, arguments)
                        }
                    }

                    function h(e, t, n) {
                        var o, r = t.prototype;
                        (o = e.prototype = Object.create(r)).constructor = e, o._super = r, n && se(o, n)
                    }

                    function f(e, t) {
                        return function() {
                            return e.apply(t, arguments)
                        }
                    }

                    function m(e, t) {
                        return typeof e == ue ? e.apply(t && t[0] || s, t) : e
                    }

                    function g(e, t) {
                        return e === s ? t : e
                    }

                    function p(e, t, n) {
                        u(w(t), (function(t) {
                            e.addEventListener(t, n, !1)
                        }))
                    }

                    function v(e, t, n) {
                        u(w(t), (function(t) {
                            e.removeEventListener(t, n, !1)
                        }))
                    }

                    function y(e, t) {
                        for (; e;) {
                            if (e == t) return !0;
                            e = e.parentNode
                        }
                        return !1
                    }

                    function b(e, t) {
                        return e.indexOf(t) > -1
                    }

                    function w(e) {
                        return e.trim().split(/\s+/g)
                    }

                    function x(e, t, n) {
                        if (e.indexOf && !n) return e.indexOf(t);
                        for (var o = 0; o < e.length;) {
                            if (n && e[o][n] == t || !n && e[o] === t) return o;
                            o++
                        }
                        return -1
                    }

                    function T(e) {
                        return Array.prototype.slice.call(e, 0)
                    }

                    function I(e, t, n) {
                        for (var o = [], r = [], a = 0; a < e.length;) {
                            var i = t ? e[a][t] : e[a];
                            x(r, i) < 0 && o.push(e[a]), r[a] = i, a++
                        }
                        return n && (o = t ? o.sort((function(e, n) {
                            return e[t] > n[t]
                        })) : o.sort()), o
                    }

                    function E(e, t) {
                        for (var n, o, r = t[0].toUpperCase() + t.slice(1), a = 0; a < le.length;) {
                            if ((o = (n = le[a]) ? n + r : t) in e) return o;
                            a++
                        }
                        return s
                    }

                    function S(e) {
                        var t = e.ownerDocument || e;
                        return t.defaultView || t.parentWindow || r
                    }

                    function A(e, t) {
                        var n = this;
                        this.manager = e, this.callback = t, this.element = e.element, this.target = e.options.inputTarget, this.domHandler = function(t) {
                            m(e.options.enable, [e]) && n.handler(t)
                        }, this.init()
                    }

                    function C(e, t, n) {
                        var o = n.pointers.length,
                            r = n.changedPointers.length,
                            a = t & Ie && o - r == 0,
                            i = t & (Se | Ae) && o - r == 0;
                        n.isFirst = !!a, n.isFinal = !!i, a && (e.session = {}), n.eventType = t,
                            function(e, t) {
                                var n = e.session,
                                    o = t.pointers,
                                    r = o.length;
                                n.firstInput || (n.firstInput = D(t)), r > 1 && !n.firstMultiple ? n.firstMultiple = D(t) : 1 === r && (n.firstMultiple = !1);
                                var a = n.firstInput,
                                    i = n.firstMultiple,
                                    s = i ? i.center : a.center,
                                    l = t.center = P(o);
                                t.timeStamp = fe(), t.deltaTime = t.timeStamp - a.timeStamp, t.angle = O(s, l), t.distance = L(s, l),
                                    function(e, t) {
                                        var n = t.center,
                                            o = e.offsetDelta || {},
                                            r = e.prevDelta || {},
                                            a = e.prevInput || {};
                                        t.eventType !== Ie && a.eventType !== Se || (r = e.prevDelta = {
                                            x: a.deltaX || 0,
                                            y: a.deltaY || 0
                                        }, o = e.offsetDelta = {
                                            x: n.x,
                                            y: n.y
                                        }), t.deltaX = r.x + (n.x - o.x), t.deltaY = r.y + (n.y - o.y)
                                    }(n, t), t.offsetDirection = _(t.deltaX, t.deltaY);
                                var c = k(t.deltaTime, t.deltaX, t.deltaY);
                                t.overallVelocityX = c.x, t.overallVelocityY = c.y, t.overallVelocity = he(c.x) > he(c.y) ? c.x : c.y, t.scale = i ? function(e, t) {
                                    return L(t[0], t[1], Ne) / L(e[0], e[1], Ne)
                                }(i.pointers, o) : 1, t.rotation = i ? function(e, t) {
                                    return O(t[1], t[0], Ne) + O(e[1], e[0], Ne)
                                }(i.pointers, o) : 0, t.maxPointers = n.prevInput ? t.pointers.length > n.prevInput.maxPointers ? t.pointers.length : n.prevInput.maxPointers : t.pointers.length, M(n, t);
                                var u = e.element;
                                y(t.srcEvent.target, u) && (u = t.srcEvent.target), t.target = u
                            }(e, n), e.emit("hammer.input", n), e.recognize(n), e.session.prevInput = n
                    }

                    function M(e, t) {
                        var n, o, r, a, i = e.lastInterval || t,
                            l = t.timeStamp - i.timeStamp;
                        if (t.eventType != Ae && (l > Te || i.velocity === s)) {
                            var c = t.deltaX - i.deltaX,
                                u = t.deltaY - i.deltaY,
                                d = k(l, c, u);
                            o = d.x, r = d.y, n = he(d.x) > he(d.y) ? d.x : d.y, a = _(c, u), e.lastInterval = t
                        } else n = i.velocity, o = i.velocityX, r = i.velocityY, a = i.direction;
                        t.velocity = n, t.velocityX = o, t.velocityY = r, t.direction = a
                    }

                    function D(e) {
                        for (var t = [], n = 0; n < e.pointers.length;) t[n] = {
                            clientX: de(e.pointers[n].clientX),
                            clientY: de(e.pointers[n].clientY)
                        }, n++;
                        return {
                            timeStamp: fe(),
                            pointers: t,
                            center: P(t),
                            deltaX: e.deltaX,
                            deltaY: e.deltaY
                        }
                    }

                    function P(e) {
                        var t = e.length;
                        if (1 === t) return {
                            x: de(e[0].clientX),
                            y: de(e[0].clientY)
                        };
                        for (var n = 0, o = 0, r = 0; t > r;) n += e[r].clientX, o += e[r].clientY, r++;
                        return {
                            x: de(n / t),
                            y: de(o / t)
                        }
                    }

                    function k(e, t, n) {
                        return {
                            x: t / e || 0,
                            y: n / e || 0
                        }
                    }

                    function _(e, t) {
                        return e === t ? Ce : he(e) >= he(t) ? 0 > e ? Me : De : 0 > t ? Pe : ke
                    }

                    function L(e, t, n) {
                        n || (n = Re);
                        var o = t[n[0]] - e[n[0]],
                            r = t[n[1]] - e[n[1]];
                        return Math.sqrt(o * o + r * r)
                    }

                    function O(e, t, n) {
                        n || (n = Re);
                        var o = t[n[0]] - e[n[0]],
                            r = t[n[1]] - e[n[1]];
                        return 180 * Math.atan2(r, o) / Math.PI
                    }

                    function R() {
                        this.evEl = Be, this.evWin = Ve, this.pressed = !1, A.apply(this, arguments)
                    }

                    function N() {
                        this.evEl = qe, this.evWin = je, A.apply(this, arguments), this.store = this.manager.session.pointerEvents = []
                    }

                    function U() {
                        this.evTarget = We, this.evWin = Ge, this.started = !1, A.apply(this, arguments)
                    }

                    function B(e, t) {
                        var n = T(e.touches),
                            o = T(e.changedTouches);
                        return t & (Se | Ae) && (n = I(n.concat(o), "identifier", !0)), [n, o]
                    }

                    function V() {
                        this.evTarget = Ze, this.targetIds = {}, A.apply(this, arguments)
                    }

                    function F(e, t) {
                        var n = T(e.touches),
                            o = this.targetIds;
                        if (t & (Ie | Ee) && 1 === n.length) return o[n[0].identifier] = !0, [n, n];
                        var r, a, i = T(e.changedTouches),
                            s = [],
                            l = this.target;
                        if (a = n.filter((function(e) {
                                return y(e.target, l)
                            })), t === Ie)
                            for (r = 0; r < a.length;) o[a[r].identifier] = !0, r++;
                        for (r = 0; r < i.length;) o[i[r].identifier] && s.push(i[r]), t & (Se | Ae) && delete o[i[r].identifier], r++;
                        return s.length ? [I(a.concat(s), "identifier", !0), s] : void 0
                    }

                    function H() {
                        A.apply(this, arguments);
                        var e = f(this.handler, this);
                        this.touch = new V(this.manager, e), this.mouse = new R(this.manager, e), this.primaryTouch = null, this.lastTouches = []
                    }

                    function q(e, t) {
                        e & Ie ? (this.primaryTouch = t.changedPointers[0].identifier, j.call(this, t)) : e & (Se | Ae) && j.call(this, t)
                    }

                    function j(e) {
                        var t = e.changedPointers[0];
                        if (t.identifier === this.primaryTouch) {
                            var n = {
                                x: t.clientX,
                                y: t.clientY
                            };
                            this.lastTouches.push(n);
                            var o = this.lastTouches;
                            setTimeout((function() {
                                var e = o.indexOf(n);
                                e > -1 && o.splice(e, 1)
                            }), Ke)
                        }
                    }

                    function z(e) {
                        for (var t = e.srcEvent.clientX, n = e.srcEvent.clientY, o = 0; o < this.lastTouches.length; o++) {
                            var r = this.lastTouches[o],
                                a = Math.abs(t - r.x),
                                i = Math.abs(n - r.y);
                            if (Xe >= a && Xe >= i) return !0
                        }
                        return !1
                    }

                    function W(e, t) {
                        this.manager = e, this.set(t)
                    }

                    function G(e) {
                        this.options = se({}, this.defaults, e || {}), this.id = pe++, this.manager = null, this.options.enable = g(this.options.enable, !0), this.state = it, this.simultaneous = {}, this.requireFail = []
                    }

                    function Y(e) {
                        return e & dt ? "cancel" : e & ct ? "end" : e & lt ? "move" : e & st ? "start" : ""
                    }

                    function Z(e) {
                        return e == ke ? "down" : e == Pe ? "up" : e == Me ? "left" : e == De ? "right" : ""
                    }

                    function K(e, t) {
                        var n = t.manager;
                        return n ? n.get(e) : e
                    }

                    function X() {
                        G.apply(this, arguments)
                    }

                    function J() {
                        X.apply(this, arguments), this.pX = null, this.pY = null
                    }

                    function Q() {
                        X.apply(this, arguments)
                    }

                    function $() {
                        G.apply(this, arguments), this._timer = null, this._input = null
                    }

                    function ee() {
                        X.apply(this, arguments)
                    }

                    function te() {
                        X.apply(this, arguments)
                    }

                    function ne() {
                        G.apply(this, arguments), this.pTime = !1, this.pCenter = !1, this._timer = null, this._input = null, this.count = 0
                    }

                    function oe(e, t) {
                        return (t = t || {}).recognizers = g(t.recognizers, oe.defaults.preset), new re(e, t)
                    }

                    function re(e, t) {
                        this.options = se({}, oe.defaults, t || {}), this.options.inputTarget = this.options.inputTarget || e, this.handlers = {}, this.session = {}, this.recognizers = [], this.oldCssProps = {}, this.element = e, this.input = function(e) {
                            var t = e.options.inputClass;
                            return new(t || (ye ? N : be ? V : ve ? H : R))(e, C)
                        }(this), this.touchAction = new W(this, this.options.touchAction), ae(this, !0), u(this.options.recognizers, (function(e) {
                            var t = this.add(new e[0](e[1]));
                            e[2] && t.recognizeWith(e[2]), e[3] && t.requireFailure(e[3])
                        }), this)
                    }

                    function ae(e, t) {
                        var n, o = e.element;
                        o.style && (u(e.options.cssProps, (function(r, a) {
                            n = E(o.style, a), t ? (e.oldCssProps[n] = o.style[n], o.style[n] = r) : o.style[n] = e.oldCssProps[n] || ""
                        })), t || (e.oldCssProps = {}))
                    }

                    function ie(e, t) {
                        var n = a.createEvent("Event");
                        n.initEvent(e, !0, !0), n.gesture = t, t.target.dispatchEvent(n)
                    }
                    var se, le = ["", "webkit", "Moz", "MS", "ms", "o"],
                        ce = a.createElement("div"),
                        ue = "function",
                        de = Math.round,
                        he = Math.abs,
                        fe = Date.now;
                    se = "function" != typeof Object.assign ? function(e) {
                        if (e === s || null === e) throw new TypeError("Cannot convert undefined or null to object");
                        for (var t = Object(e), n = 1; n < arguments.length; n++) {
                            var o = arguments[n];
                            if (o !== s && null !== o)
                                for (var r in o) o.hasOwnProperty(r) && (t[r] = o[r])
                        }
                        return t
                    } : Object.assign;
                    var me = d((function(e, t, n) {
                            for (var o = Object.keys(t), r = 0; r < o.length;)(!n || n && e[o[r]] === s) && (e[o[r]] = t[o[r]]), r++;
                            return e
                        }), "extend", "Use `assign`."),
                        ge = d((function(e, t) {
                            return me(e, t, !0)
                        }), "merge", "Use `assign`."),
                        pe = 1,
                        ve = "ontouchstart" in r,
                        ye = E(r, "PointerEvent") !== s,
                        be = ve && /mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),
                        we = "touch",
                        xe = "mouse",
                        Te = 25,
                        Ie = 1,
                        Ee = 2,
                        Se = 4,
                        Ae = 8,
                        Ce = 1,
                        Me = 2,
                        De = 4,
                        Pe = 8,
                        ke = 16,
                        _e = Me | De,
                        Le = Pe | ke,
                        Oe = _e | Le,
                        Re = ["x", "y"],
                        Ne = ["clientX", "clientY"];
                    A.prototype = {
                        handler: function() {},
                        init: function() {
                            this.evEl && p(this.element, this.evEl, this.domHandler), this.evTarget && p(this.target, this.evTarget, this.domHandler), this.evWin && p(S(this.element), this.evWin, this.domHandler)
                        },
                        destroy: function() {
                            this.evEl && v(this.element, this.evEl, this.domHandler), this.evTarget && v(this.target, this.evTarget, this.domHandler), this.evWin && v(S(this.element), this.evWin, this.domHandler)
                        }
                    };
                    var Ue = {
                            mousedown: Ie,
                            mousemove: Ee,
                            mouseup: Se
                        },
                        Be = "mousedown",
                        Ve = "mousemove mouseup";
                    h(R, A, {
                        handler: function(e) {
                            var t = Ue[e.type];
                            t & Ie && 0 === e.button && (this.pressed = !0), t & Ee && 1 !== e.which && (t = Se), this.pressed && (t & Se && (this.pressed = !1), this.callback(this.manager, t, {
                                pointers: [e],
                                changedPointers: [e],
                                pointerType: xe,
                                srcEvent: e
                            }))
                        }
                    });
                    var Fe = {
                            pointerdown: Ie,
                            pointermove: Ee,
                            pointerup: Se,
                            pointercancel: Ae,
                            pointerout: Ae
                        },
                        He = {
                            2: we,
                            3: "pen",
                            4: xe,
                            5: "kinect"
                        },
                        qe = "pointerdown",
                        je = "pointermove pointerup pointercancel";
                    r.MSPointerEvent && !r.PointerEvent && (qe = "MSPointerDown", je = "MSPointerMove MSPointerUp MSPointerCancel"), h(N, A, {
                        handler: function(e) {
                            var t = this.store,
                                n = !1,
                                o = e.type.toLowerCase().replace("ms", ""),
                                r = Fe[o],
                                a = He[e.pointerType] || e.pointerType,
                                i = a == we,
                                s = x(t, e.pointerId, "pointerId");
                            r & Ie && (0 === e.button || i) ? 0 > s && (t.push(e), s = t.length - 1) : r & (Se | Ae) && (n = !0), 0 > s || (t[s] = e, this.callback(this.manager, r, {
                                pointers: t,
                                changedPointers: [e],
                                pointerType: a,
                                srcEvent: e
                            }), n && t.splice(s, 1))
                        }
                    });
                    var ze = {
                            touchstart: Ie,
                            touchmove: Ee,
                            touchend: Se,
                            touchcancel: Ae
                        },
                        We = "touchstart",
                        Ge = "touchstart touchmove touchend touchcancel";
                    h(U, A, {
                        handler: function(e) {
                            var t = ze[e.type];
                            if (t === Ie && (this.started = !0), this.started) {
                                var n = B.call(this, e, t);
                                t & (Se | Ae) && n[0].length - n[1].length == 0 && (this.started = !1), this.callback(this.manager, t, {
                                    pointers: n[0],
                                    changedPointers: n[1],
                                    pointerType: we,
                                    srcEvent: e
                                })
                            }
                        }
                    });
                    var Ye = {
                            touchstart: Ie,
                            touchmove: Ee,
                            touchend: Se,
                            touchcancel: Ae
                        },
                        Ze = "touchstart touchmove touchend touchcancel";
                    h(V, A, {
                        handler: function(e) {
                            var t = Ye[e.type],
                                n = F.call(this, e, t);
                            n && this.callback(this.manager, t, {
                                pointers: n[0],
                                changedPointers: n[1],
                                pointerType: we,
                                srcEvent: e
                            })
                        }
                    });
                    var Ke = 2500,
                        Xe = 25;
                    h(H, A, {
                        handler: function(e, t, n) {
                            var o = n.pointerType == we,
                                r = n.pointerType == xe;
                            if (!(r && n.sourceCapabilities && n.sourceCapabilities.firesTouchEvents)) {
                                if (o) q.call(this, t, n);
                                else if (r && z.call(this, n)) return;
                                this.callback(e, t, n)
                            }
                        },
                        destroy: function() {
                            this.touch.destroy(), this.mouse.destroy()
                        }
                    });
                    var Je = E(ce.style, "touchAction"),
                        Qe = Je !== s,
                        $e = "compute",
                        et = "auto",
                        tt = "manipulation",
                        nt = "none",
                        ot = "pan-x",
                        rt = "pan-y",
                        at = function() {
                            if (!Qe) return !1;
                            var e = {},
                                t = r.CSS && r.CSS.supports;
                            return ["auto", "manipulation", "pan-y", "pan-x", "pan-x pan-y", "none"].forEach((function(n) {
                                e[n] = !t || r.CSS.supports("touch-action", n)
                            })), e
                        }();
                    W.prototype = {
                        set: function(e) {
                            e == $e && (e = this.compute()), Qe && this.manager.element.style && at[e] && (this.manager.element.style[Je] = e), this.actions = e.toLowerCase().trim()
                        },
                        update: function() {
                            this.set(this.manager.options.touchAction)
                        },
                        compute: function() {
                            var e = [];
                            return u(this.manager.recognizers, (function(t) {
                                    m(t.options.enable, [t]) && (e = e.concat(t.getTouchAction()))
                                })),
                                function(e) {
                                    if (b(e, nt)) return nt;
                                    var t = b(e, ot),
                                        n = b(e, rt);
                                    return t && n ? nt : t || n ? t ? ot : rt : b(e, tt) ? tt : et
                                }(e.join(" "))
                        },
                        preventDefaults: function(e) {
                            var t = e.srcEvent,
                                n = e.offsetDirection;
                            if (!this.manager.session.prevented) {
                                var o = this.actions,
                                    r = b(o, nt) && !at[nt],
                                    a = b(o, rt) && !at[rt],
                                    i = b(o, ot) && !at[ot];
                                if (r) {
                                    var s = 1 === e.pointers.length,
                                        l = e.distance < 2,
                                        c = e.deltaTime < 250;
                                    if (s && l && c) return
                                }
                                return i && a ? void 0 : r || a && n & _e || i && n & Le ? this.preventSrc(t) : void 0
                            }
                            t.preventDefault()
                        },
                        preventSrc: function(e) {
                            this.manager.session.prevented = !0, e.preventDefault()
                        }
                    };
                    var it = 1,
                        st = 2,
                        lt = 4,
                        ct = 8,
                        ut = ct,
                        dt = 16,
                        ht = 32;
                    G.prototype = {
                        defaults: {},
                        set: function(e) {
                            return se(this.options, e), this.manager && this.manager.touchAction.update(), this
                        },
                        recognizeWith: function(e) {
                            if (c(e, "recognizeWith", this)) return this;
                            var t = this.simultaneous;
                            return t[(e = K(e, this)).id] || (t[e.id] = e, e.recognizeWith(this)), this
                        },
                        dropRecognizeWith: function(e) {
                            return c(e, "dropRecognizeWith", this) || (e = K(e, this), delete this.simultaneous[e.id]), this
                        },
                        requireFailure: function(e) {
                            if (c(e, "requireFailure", this)) return this;
                            var t = this.requireFail;
                            return -1 === x(t, e = K(e, this)) && (t.push(e), e.requireFailure(this)), this
                        },
                        dropRequireFailure: function(e) {
                            if (c(e, "dropRequireFailure", this)) return this;
                            e = K(e, this);
                            var t = x(this.requireFail, e);
                            return t > -1 && this.requireFail.splice(t, 1), this
                        },
                        hasRequireFailures: function() {
                            return this.requireFail.length > 0
                        },
                        canRecognizeWith: function(e) {
                            return !!this.simultaneous[e.id]
                        },
                        emit: function(e) {
                            function t(t) {
                                n.manager.emit(t, e)
                            }
                            var n = this,
                                o = this.state;
                            ct > o && t(n.options.event + Y(o)), t(n.options.event), e.additionalEvent && t(e.additionalEvent), o >= ct && t(n.options.event + Y(o))
                        },
                        tryEmit: function(e) {
                            return this.canEmit() ? this.emit(e) : void(this.state = ht)
                        },
                        canEmit: function() {
                            for (var e = 0; e < this.requireFail.length;) {
                                if (!(this.requireFail[e].state & (ht | it))) return !1;
                                e++
                            }
                            return !0
                        },
                        recognize: function(e) {
                            var t = se({}, e);
                            return m(this.options.enable, [this, t]) ? (this.state & (ut | dt | ht) && (this.state = it), this.state = this.process(t), void(this.state & (st | lt | ct | dt) && this.tryEmit(t))) : (this.reset(), void(this.state = ht))
                        },
                        process: function(e) {},
                        getTouchAction: function() {},
                        reset: function() {}
                    }, h(X, G, {
                        defaults: {
                            pointers: 1
                        },
                        attrTest: function(e) {
                            var t = this.options.pointers;
                            return 0 === t || e.pointers.length === t
                        },
                        process: function(e) {
                            var t = this.state,
                                n = e.eventType,
                                o = t & (st | lt),
                                r = this.attrTest(e);
                            return o && (n & Ae || !r) ? t | dt : o || r ? n & Se ? t | ct : t & st ? t | lt : st : ht
                        }
                    }), h(J, X, {
                        defaults: {
                            event: "pan",
                            threshold: 10,
                            pointers: 1,
                            direction: Oe
                        },
                        getTouchAction: function() {
                            var e = this.options.direction,
                                t = [];
                            return e & _e && t.push(rt), e & Le && t.push(ot), t
                        },
                        directionTest: function(e) {
                            var t = this.options,
                                n = !0,
                                o = e.distance,
                                r = e.direction,
                                a = e.deltaX,
                                i = e.deltaY;
                            return r & t.direction || (t.direction & _e ? (r = 0 === a ? Ce : 0 > a ? Me : De, n = a != this.pX, o = Math.abs(e.deltaX)) : (r = 0 === i ? Ce : 0 > i ? Pe : ke, n = i != this.pY, o = Math.abs(e.deltaY))), e.direction = r, n && o > t.threshold && r & t.direction
                        },
                        attrTest: function(e) {
                            return X.prototype.attrTest.call(this, e) && (this.state & st || !(this.state & st) && this.directionTest(e))
                        },
                        emit: function(e) {
                            this.pX = e.deltaX, this.pY = e.deltaY;
                            var t = Z(e.direction);
                            t && (e.additionalEvent = this.options.event + t), this._super.emit.call(this, e)
                        }
                    }), h(Q, X, {
                        defaults: {
                            event: "pinch",
                            threshold: 0,
                            pointers: 2
                        },
                        getTouchAction: function() {
                            return [nt]
                        },
                        attrTest: function(e) {
                            return this._super.attrTest.call(this, e) && (Math.abs(e.scale - 1) > this.options.threshold || this.state & st)
                        },
                        emit: function(e) {
                            if (1 !== e.scale) {
                                var t = e.scale < 1 ? "in" : "out";
                                e.additionalEvent = this.options.event + t
                            }
                            this._super.emit.call(this, e)
                        }
                    }), h($, G, {
                        defaults: {
                            event: "press",
                            pointers: 1,
                            time: 251,
                            threshold: 9
                        },
                        getTouchAction: function() {
                            return [et]
                        },
                        process: function(e) {
                            var t = this.options,
                                n = e.pointers.length === t.pointers,
                                o = e.distance < t.threshold,
                                r = e.deltaTime > t.time;
                            if (this._input = e, !o || !n || e.eventType & (Se | Ae) && !r) this.reset();
                            else if (e.eventType & Ie) this.reset(), this._timer = l((function() {
                                this.state = ut, this.tryEmit()
                            }), t.time, this);
                            else if (e.eventType & Se) return ut;
                            return ht
                        },
                        reset: function() {
                            clearTimeout(this._timer)
                        },
                        emit: function(e) {
                            this.state === ut && (e && e.eventType & Se ? this.manager.emit(this.options.event + "up", e) : (this._input.timeStamp = fe(), this.manager.emit(this.options.event, this._input)))
                        }
                    }), h(ee, X, {
                        defaults: {
                            event: "rotate",
                            threshold: 0,
                            pointers: 2
                        },
                        getTouchAction: function() {
                            return [nt]
                        },
                        attrTest: function(e) {
                            return this._super.attrTest.call(this, e) && (Math.abs(e.rotation) > this.options.threshold || this.state & st)
                        }
                    }), h(te, X, {
                        defaults: {
                            event: "swipe",
                            threshold: 10,
                            velocity: .3,
                            direction: _e | Le,
                            pointers: 1
                        },
                        getTouchAction: function() {
                            return J.prototype.getTouchAction.call(this)
                        },
                        attrTest: function(e) {
                            var t, n = this.options.direction;
                            return n & (_e | Le) ? t = e.overallVelocity : n & _e ? t = e.overallVelocityX : n & Le && (t = e.overallVelocityY), this._super.attrTest.call(this, e) && n & e.offsetDirection && e.distance > this.options.threshold && e.maxPointers == this.options.pointers && he(t) > this.options.velocity && e.eventType & Se
                        },
                        emit: function(e) {
                            var t = Z(e.offsetDirection);
                            t && this.manager.emit(this.options.event + t, e), this.manager.emit(this.options.event, e)
                        }
                    }), h(ne, G, {
                        defaults: {
                            event: "tap",
                            pointers: 1,
                            taps: 1,
                            interval: 300,
                            time: 250,
                            threshold: 9,
                            posThreshold: 10
                        },
                        getTouchAction: function() {
                            return [tt]
                        },
                        process: function(e) {
                            var t = this.options,
                                n = e.pointers.length === t.pointers,
                                o = e.distance < t.threshold,
                                r = e.deltaTime < t.time;
                            if (this.reset(), e.eventType & Ie && 0 === this.count) return this.failTimeout();
                            if (o && r && n) {
                                if (e.eventType != Se) return this.failTimeout();
                                var a = !this.pTime || e.timeStamp - this.pTime < t.interval,
                                    i = !this.pCenter || L(this.pCenter, e.center) < t.posThreshold;
                                if (this.pTime = e.timeStamp, this.pCenter = e.center, i && a ? this.count += 1 : this.count = 1, this._input = e, 0 === this.count % t.taps) return this.hasRequireFailures() ? (this._timer = l((function() {
                                    this.state = ut, this.tryEmit()
                                }), t.interval, this), st) : ut
                            }
                            return ht
                        },
                        failTimeout: function() {
                            return this._timer = l((function() {
                                this.state = ht
                            }), this.options.interval, this), ht
                        },
                        reset: function() {
                            clearTimeout(this._timer)
                        },
                        emit: function() {
                            this.state == ut && (this._input.tapCount = this.count, this.manager.emit(this.options.event, this._input))
                        }
                    }), oe.VERSION = "2.0.7", oe.defaults = {
                        domEvents: !1,
                        touchAction: $e,
                        enable: !0,
                        inputTarget: null,
                        inputClass: null,
                        preset: [
                            [ee, {
                                enable: !1
                            }],
                            [Q, {
                                    enable: !1
                                },
                                ["rotate"]
                            ],
                            [te, {
                                direction: _e
                            }],
                            [J, {
                                    direction: _e
                                },
                                ["swipe"]
                            ],
                            [ne],
                            [ne, {
                                    event: "doubletap",
                                    taps: 2
                                },
                                ["tap"]
                            ],
                            [$]
                        ],
                        cssProps: {
                            userSelect: "none",
                            touchSelect: "none",
                            touchCallout: "none",
                            contentZooming: "none",
                            userDrag: "none",
                            tapHighlightColor: "rgba(0,0,0,0)"
                        }
                    };
                    re.prototype = {
                        set: function(e) {
                            return se(this.options, e), e.touchAction && this.touchAction.update(), e.inputTarget && (this.input.destroy(), this.input.target = e.inputTarget, this.input.init()), this
                        },
                        stop: function(e) {
                            this.session.stopped = e ? 2 : 1
                        },
                        recognize: function(e) {
                            var t = this.session;
                            if (!t.stopped) {
                                this.touchAction.preventDefaults(e);
                                var n, o = this.recognizers,
                                    r = t.curRecognizer;
                                (!r || r && r.state & ut) && (r = t.curRecognizer = null);
                                for (var a = 0; a < o.length;) n = o[a], 2 === t.stopped || r && n != r && !n.canRecognizeWith(r) ? n.reset() : n.recognize(e), !r && n.state & (st | lt | ct) && (r = t.curRecognizer = n), a++
                            }
                        },
                        get: function(e) {
                            if (e instanceof G) return e;
                            for (var t = this.recognizers, n = 0; n < t.length; n++)
                                if (t[n].options.event == e) return t[n];
                            return null
                        },
                        add: function(e) {
                            if (c(e, "add", this)) return this;
                            var t = this.get(e.options.event);
                            return t && this.remove(t), this.recognizers.push(e), e.manager = this, this.touchAction.update(), e
                        },
                        remove: function(e) {
                            if (c(e, "remove", this)) return this;
                            if (e = this.get(e)) {
                                var t = this.recognizers,
                                    n = x(t, e); - 1 !== n && (t.splice(n, 1), this.touchAction.update())
                            }
                            return this
                        },
                        on: function(e, t) {
                            if (e !== s && t !== s) {
                                var n = this.handlers;
                                return u(w(e), (function(e) {
                                    n[e] = n[e] || [], n[e].push(t)
                                })), this
                            }
                        },
                        off: function(e, t) {
                            if (e !== s) {
                                var n = this.handlers;
                                return u(w(e), (function(e) {
                                    t ? n[e] && n[e].splice(x(n[e], t), 1) : delete n[e]
                                })), this
                            }
                        },
                        emit: function(e, t) {
                            this.options.domEvents && ie(e, t);
                            var n = this.handlers[e] && this.handlers[e].slice();
                            if (n && n.length) {
                                t.type = e, t.preventDefault = function() {
                                    t.srcEvent.preventDefault()
                                };
                                for (var o = 0; o < n.length;) n[o](t), o++
                            }
                        },
                        destroy: function() {
                            this.element && ae(this, !1), this.handlers = {}, this.session = {}, this.input.destroy(), this.element = null
                        }
                    }, se(oe, {
                        INPUT_START: Ie,
                        INPUT_MOVE: Ee,
                        INPUT_END: Se,
                        INPUT_CANCEL: Ae,
                        STATE_POSSIBLE: it,
                        STATE_BEGAN: st,
                        STATE_CHANGED: lt,
                        STATE_ENDED: ct,
                        STATE_RECOGNIZED: ut,
                        STATE_CANCELLED: dt,
                        STATE_FAILED: ht,
                        DIRECTION_NONE: Ce,
                        DIRECTION_LEFT: Me,
                        DIRECTION_RIGHT: De,
                        DIRECTION_UP: Pe,
                        DIRECTION_DOWN: ke,
                        DIRECTION_HORIZONTAL: _e,
                        DIRECTION_VERTICAL: Le,
                        DIRECTION_ALL: Oe,
                        Manager: re,
                        Input: A,
                        TouchAction: W,
                        TouchInput: V,
                        MouseInput: R,
                        PointerEventInput: N,
                        TouchMouseInput: H,
                        SingleTouchInput: U,
                        Recognizer: G,
                        AttrRecognizer: X,
                        Tap: ne,
                        Pan: J,
                        Swipe: te,
                        Pinch: Q,
                        Rotate: ee,
                        Press: $,
                        on: p,
                        off: v,
                        each: u,
                        merge: ge,
                        extend: me,
                        assign: se,
                        inherit: h,
                        bindFn: f,
                        prefixed: E
                    }), (void 0 !== r ? r : "undefined" != typeof self ? self : {}).Hammer = oe, void 0 === (o = function() {
                        return oe
                    }.call(t, n, t, e)) || (e.exports = o)
                }(window, document)
            },
            736: (e, t, n) => {
                "use strict";
                n.d(t, {
                    A: () => l
                });
                var o = n(9584),
                    r = n(281),
                    a = n(8398),
                    i = n(3399),
                    s = function(e, t, n, o) {
                        return new(n || (n = Promise))((function(r, a) {
                            function i(e) {
                                try {
                                    l(o.next(e))
                                } catch (e) {
                                    a(e)
                                }
                            }

                            function s(e) {
                                try {
                                    l(o.throw(e))
                                } catch (e) {
                                    a(e)
                                }
                            }

                            function l(e) {
                                var t;
                                e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                                    e(t)
                                }))).then(i, s)
                            }
                            l((o = o.apply(e, t || [])).next())
                        }))
                    };

                function l(e) {
                    return s(this, void 0, void 0, (function*() {
                        const t = (0, o.getEnabledElements)().filter((({
                            element: e
                        }) => (0, i.Ss)(e)));
                        let n;
                        return e && (n = t.find((({
                            element: e,
                            image: t
                        }) => !t || !(0, r.getToolState)(e, "stack")))), 0 === t.length || n ? (0, a.uk)(250).then((() => l(e))) : t
                    }))
                }
            },
            816: (e, t, n) => {
                "use strict";
                n.d(t, {
                    A: () => r
                });
                var o = n(2284);

                function r(e) {
                    var t = function(e, t) {
                        if ("object" != (0, o.A)(e) || !e) return e;
                        var n = e[Symbol.toPrimitive];
                        if (void 0 !== n) {
                            var r = n.call(e, t || "default");
                            if ("object" != (0, o.A)(r)) return r;
                            throw new TypeError("@@toPrimitive must return a primitive value.")
                        }
                        return ("string" === t ? String : Number)(e)
                    }(e, "string");
                    return "symbol" == (0, o.A)(t) ? t : t + ""
                }
            },
            904: e => {
                "use strict";
                e.exports = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAACtVBMVEUHAH8VBPMUAup4/5dx/6Cn/WATAeMWAvsdMPN0/5wRAtVm+LRu/6V//o5+BgIXDPsVAu8PA8le+sNg9L8JA5chSPsYFPpJ5OgXHNpU6tVU29ERBc8NAbZs/qqI84eH/4We/WscLvsgPPo7vfgylfgoYvhAy/I1l/IZHvEnW+syd+oYG+pFz+c6oeQdLeJL3uBP3NhY+MxW5ssYK8Jm6rIMA68NEowbJ/kqcPgfOfExgO88rOwbKew6lug/qOUlN+VI1ONGx+M0a+EtX+ETBN5LztoaKdofRco4bcgQC8VVo8Fe378OAr1ctKwLAah16KAKA59nnp0IAY19fnDm6yKAHhUznfwkVvo1ovktf/kwh/cmWvNC0/I5q/Izh+8/v+4zj+0iSOw+supK3uQlWOMXEOMoUOAZGeBLvd4UDN5Q8d1Cl9sfQNpEq9dHutZM0tQxctQTEdJBhdEcLMtJkchUuMVc7cRLnsNIgMJPqsBavb4eRLoPDbpFe7Vo/7Bt8qgOEKR31J0eR514+poSIJF82omO+X5zaHKc9W2GuGldN2aRklay/lXJ8TyyoDqDSDKcUCLTkBWwXA+HEgOjBwCSBAAvjvwaHPspavhG2+06pew5huQ1Wd8pVts1gNowaNhQtM9OoMs7kctW0sVc1sIQEMAxd7sXKrpg6rlv+KZrzqRutKJwxZsTFZYhQpGN6XmV/XaFo3RuY1++/UlqI0etv0SHXD+TXTRzMTTMwy2pgCzb6SrFkByDLBz01Q+vKwetEQBDw+lV+tNLoc84Wcw9gMNdrrQcObQlWa8THK9HZK5Zlq1jo6t24JpJipo0ZZV565N8xo84RH0eIHxfTHOX0G6Jjm56cVyAfll5b1Wlv1JwSFC51kmBPEi/30aNezySNht2EhqVIhmuRg72xgmVGQHHHABfgbLgAAADTklEQVQ4y9XL03pcYQCF4X9rOnvUsW17Gtt2bce2k8ZGbdu2bdu4ju706VmvoOv0/Rb4zzaFe7Ct7U5cXMHikl1tK6b847tjjfMXhaxRR9ZVzpgnClpc/zfJ/HuP4y+zzAq41dnxqAc7EFZRt2FJwYo/kizlTvgue83TA/kpSuwZeH4S29eNHa4gxxMFF1BYkpZ64/pNDzCsfyA7+x1Rv84+34/1K+vK427fZQF1dO7NpeT5rRimxAYu/RgkgreXzmNH5PIntZ76aiHQwTcS/eaWlSXu7z6iHMj+dOjQ447jSkVz6KyNJZspNY0geEliWGSFBOYvTaPTFcpO72E5cpxeGbWMYrE0SMtTACk4cEl1ipRiKRRvuf6wk+NSKOTyjjCSfbOdkp7uawSUAGNpUXxp8GJqe2VgUnt3T1/PPq9ZFVa81hYrFPo8AOLDrI2eku0ilyjS7Ez7PMZgnMmIWecp0sx22OypqWDSalKyL3lbMztP4D/NPz5n/NeVlScWzLAb9BpHYeymFuCnYkmlUd55+tl5TvGO+2Pj40Rgtmo1mlXTiwus28CWQmmqMMglSmp9efrc/l7GxVNDjK+N3ozE/LlT5wQsEoCRo9xM4QJtyuD3kS9Zpy/nbBWJjzG+nXo1ONy33CQJ0oOVXdzMnQ0JB3uHR0fPjvxk3NOGvmdcvnBhePRjualh1gyQU5MO0hNSW3aXdZ38kJU1dLH3TM6xjKyz5zI2LF0mWbAKvDBzgY/rsQXqI3a4tZrlbxhjRx3h89LSBGJOFClgJljI82UmJMfLOAKBtootmL18qI/DpqJUBxuhV0OQH5hKlrBMsbU4TrXqHGzXtaldtRwORxTjRBT0fIjsB/x5ZNVMQxGCJM0nz8nTr53Zagh1NoVPC93bvJCnc0aAPe7wIKt1EW2PyRJV7DZMj5CHrAnfW6U2Lpwz/aoXxwGCo6iMynYZJkOQSq3ihWz15+kiTdNsYneVjK6gA5SGojhKY8es400mtprPnzxpEsTkm5PaEQTBEYCgCB1BURotJpgEMQmcGESMvH47VSajARwnVEYV28iUaBLMhCeMCcNMEgwZ1bq5IaCJ1kR1RwSSIUKZMIUVnSuUsBJ2lubCJBIMw9G/AXbV85RKPEmDAAAAAElFTkSuQmCC"
            },
            920: (e, t, n) => {
                "use strict";
                var o = n(9675),
                    r = n(8859),
                    a = n(4803),
                    i = n(507),
                    s = n(2271) || i || a;
                e.exports = function() {
                    var e, t = {
                        assert: function(e) {
                            if (!t.has(e)) throw new o("Side channel does not contain " + r(e))
                        },
                        delete: function(t) {
                            return !!e && e.delete(t)
                        },
                        get: function(t) {
                            return e && e.get(t)
                        },
                        has: function(t) {
                            return !!e && e.has(t)
                        },
                        set: function(t, n) {
                            e || (e = s()), e.set(t, n)
                        }
                    };
                    return t
                }
            },
            1002: e => {
                "use strict";
                e.exports = Function.prototype.apply
            },
            1008: e => {
                "use strict";
                e.exports = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAnFBMVEUAAAAXFxd0dHQdHR0jIyMQEBBWVlZoaGhfX18JCQkwMDApKSlubm5bW1tJSUlGRkY5OTlRUVF4eHhkZGR7e3s9PT1BQUF+fn5NTU01NTWFhYX4+PiMjIyIiIitra2jo6NDQ0O+vr7y8vKdnZ3Pz8+SkpL+/v7s7OzV1dWmpqaZmZnn5+fi4uLf39/a2trExMS5ubmxsbGXl5fJycmVOdM0AAACQklEQVQ4y9VRR5IbMQxkBHOanEc5bV7//2+mtPLB5Re4D0CRaDaAJvrPoJTC7A6tNePqnzqmrAYfdS1dk6TX7G+KYpSyXsvWBjELnWSkhj+FHzEyb0Unh9kg3s5imFvP4oPBOVeMbYKc5un7uhb5Kq37aZoGyQzlHGmMN9oEO0/DfFu+2kxwyzoNVUWA0o6iHkcwm+BdOQzDbT0yqslxqGzX67rmvkYMg647jqm2RdEOrSiq4li5iDmlXFGHMGtocoqzJCGRVoiqzeoGs57hPHyDuMkaETNtCdQlmffLvrKNMQ4CpVhhRBnmGkcpy7KuZbEdT+N7BZ52CVygSt0JSvFsgnSxr8vz+HIet7Fhm9Q5T7MVxnClepESyKzSjrvdbtwGCKlrPDCoEXRK0a7MtenjS+xPr78uu1drSQkheAMOfVYIUdO45X37dtu+nUUp1tPb53E5XEFzn9A4K8Qz7OFyWT52Iwlue3r52L5fFqZ5X6OXUiGUx8Byv37vr4fXr8P5c/pef7WNplxv0LVBKO8S6vuUIcEy7m53ywonRcSmQaBVFohWOAhlDvKwCmGJddnzRKlBwXDe00SIheiEKP2xFCKbIou28pQZFLXJnwlFUW6MlwAN8Z2zrvfWJh0dIFFCBwBERNo7GTxUPuaTYckHEISggmRYIQLNDbXRHmod677vZClsboPIDwR4zZ7IVMwaQYr7Y0RyfqgAw/QPMKbYbKR9EB6w0udt8A/oMzMdm4DyyraExvzcZs+f4Z5wzr8B8scsKGLwyjkAAAAASUVORK5CYII="
            },
            1064: (e, t, n) => {
                "use strict";
                var o = n(9612);
                e.exports = o.getPrototypeOf || null
            },
            1237: e => {
                "use strict";
                e.exports = EvalError
            },
            1278: () => {
                ! function() {
                    const e = {
                            aboutUs: {
                                copyright: "",
                                description: "2DMPR",
                                fullVersion: "",
                                releaseVersion: "",
                                tel: "400 800 5557"
                            },
                            AI: {
                                benign: "",
                                borderlineBenign: "",
                                borderlineMalignant: "",
                                calcification: "",
                                groundGlass: "",
                                lesions: "",
                                longShortMeridian: "",
                                malignant: "",
                                number: "",
                                partSolid: "",
                                pleural: "",
                                solid: "",
                                type: "",
                                volume: ""
                            },
                            DICOMInfo: {
                                device: "",
                                examinations: "",
                                image: "",
                                other: "",
                                patient: "",
                                series: "",
                                UID: "UID"
                            },
                            DICOMTags: {
                                accessionNumber: "",
                                acquisitionDate: "",
                                acquisitionTime: "",
                                age: "",
                                birthday: "",
                                bitsAllocated: "",
                                bitsStored: "",
                                blocks: "",
                                cols: "",
                                date: "",
                                description: "",
                                descriptionLite: "",
                                fileName: "",
                                highBit: "",
                                hospitals: "",
                                imageNumber: "",
                                imageOrientation: "",
                                imagePosition: "",
                                KVP: "",
                                manufacturer: "",
                                modality: "",
                                name: "",
                                orientationBottom: "",
                                orientationLeft: "",
                                orientationRight: "",
                                orientationTop: "",
                                patientID: "ID",
                                photometricInterpretation: "",
                                pixelRepresentation: "",
                                pixelSpacingX: "X",
                                pixelSpacingY: "Y",
                                rescaleIntercept: "",
                                rescaleSlope: "",
                                rows: "",
                                samplesPerPixel: "",
                                scale: "",
                                seriesDescription: "",
                                seriesID: "ID",
                                seriesUID: "UID",
                                sex: "",
                                sopInstanceUID: "",
                                studyDate: "",
                                studyID: "ID",
                                studyTime: "",
                                studyUID: "UID",
                                thickness: "",
                                transferSyntaxUID: "UID",
                                windowCenter: "",
                                windowWidth: ""
                            },
                            other: {
                                close: "",
                                custom: "",
                                toggleStudy: ""
                            },
                            player: {
                                custom: "",
                                first: "",
                                last: "",
                                next: "",
                                pause: "",
                                play: "",
                                prev: ""
                            },
                            print: {
                                applyGlobalLayout: "",
                                filmConfig: {
                                    blue: "",
                                    colorful: "",
                                    gray: "",
                                    horizontal: "",
                                    vertical: "",
                                    white: ""
                                },
                                label: {
                                    color: "",
                                    direction: "",
                                    mouseActive: "",
                                    size: "",
                                    studyInfo: "",
                                    syncRange: "",
                                    type: ""
                                },
                                layoutGrid: "",
                                pageButton: {
                                    first: "",
                                    last: "",
                                    next: "",
                                    prev: ""
                                },
                                save: "",
                                show: "",
                                synchronizer: {
                                    image: "",
                                    series: "",
                                    study: ""
                                },
                                tools: {
                                    orientation: "",
                                    remove: "",
                                    removeAll: "",
                                    scaleOverlay: ""
                                }
                            },
                            response: {
                                AIDataError: "AI",
                                DCMPathDataError: "dcm",
                                fail: "!",
                                metaDataError: "Metauuid",
                                statusCode: {
                                    401: "",
                                    403: "",
                                    404: ""
                                },
                                unknown: "",
                                VRTPathDataError: "3D"
                            },
                            rotate: {
                                HFlip: "",
                                left90: "90",
                                restore: "",
                                right90: "90",
                                VFlip: ""
                            },
                            stitching: {
                                tools: {
                                    addToStudy: "",
                                    remove: "",
                                    removeAll: ""
                                }
                            },
                            synchronizerSwitch: {
                                off: "",
                                on: "",
                                onError: "",
                                title: ""
                            },
                            toast: {
                                "3D": {
                                    close: "3D",
                                    error: "3D!",
                                    loading: "3D,",
                                    noURL: "3D"
                                },
                                AIConfigError: "AI",
                                concurrencyLow: "",
                                deviceTypeChange: "",
                                disCacheImage: {
                                    reconfirm: "!",
                                    reconfirmForAllLoad: ""
                                },
                                globalContainerExistence: "destroy",
                                imageLayoutError: "!",
                                indexedDBDelete: ":",
                                inputDataError: "",
                                interGPU: {
                                    close: "",
                                    disReminders: ",",
                                    tips: ["intel", "MPR/", "", ""],
                                    title: ""
                                },
                                is32System: "32(Chrome)(Edge)64",
                                kernelVersionLow: "(Chrome)(Edge)64",
                                languagePackageInit: "",
                                languagePackageNoInit: "",
                                languagePackageReLoad: "",
                                loadAndCacheImage: {
                                    acquisitionFailed: "",
                                    dataError: "",
                                    networkDis: "",
                                    notSupportedBlocks: "",
                                    parsingFailed: "",
                                    validationFailed: "",
                                    versionLow: ""
                                },
                                memoryRatioTips: "",
                                MPR: {
                                    bufferAllocationFailed: "64",
                                    crossOrigin: '""httpshttps',
                                    GPUBenchmarksURL: {
                                        error: "GPUBenchmarksURLGPU",
                                        null: "GPUBenchmarksURL"
                                    },
                                    loading: ",",
                                    outOfMemory: "",
                                    renderError: "",
                                    sharedArrayBuffer: {
                                        disabled: '""',
                                        enabled: '""',
                                        http: '""!',
                                        https: '""crossOriginIsolated',
                                        manual: '""',
                                        unEnabled: '""'
                                    },
                                    versionError: (e, t) => `${e},${t};`
                                },
                                MPRLevel: "()",
                                noImagePosition3D: "3D",
                                noImagePositionMPR: "",
                                noImages: "",
                                NoPTData: "PET/CT,PETCT",
                                noRenderSerise: e => "" + (e ? "" : ""),
                                noSerise: "",
                                print: {
                                    continue: "",
                                    renderLoading: "",
                                    uploadLoading: "",
                                    verifyEmpty: (e, t) => `${e}${t}`
                                },
                                prompt: {
                                    cancel: "",
                                    changeComment: "",
                                    changeText: "",
                                    CTLabel: "CT",
                                    enter: "",
                                    enterComment: "",
                                    enterKeyImageDescription: "",
                                    enterScale: "",
                                    enterText: "",
                                    enterWL: "",
                                    example: "",
                                    fusionTitle: "",
                                    layoutCancelTip: "",
                                    OK: "",
                                    printTitle: "",
                                    PTLabel: "PET",
                                    stitchingTitle: "",
                                    verificationError: ""
                                },
                                reDestroy: ",nullundefined",
                                referenceLinesWarn: "1.2.",
                                saveFail: "",
                                saveImage: "",
                                saveSuccess: "",
                                seriesNumLow: e => `${e},`,
                                setLanguage: "!",
                                speedPriority: "!",
                                stitching: {
                                    renderLoading: "",
                                    uploadLoading: "",
                                    verify: {
                                        isAlready: "!",
                                        isColor: "PNG",
                                        isInconsistent: "!",
                                        isPixelData: "",
                                        modalityError: "DRDXCRX"
                                    }
                                },
                                studiesLoading: "",
                                studyLoading: "",
                                studyUIDUnequal: "",
                                unModule: ""
                            },
                            tools: {
                                "2D": "2D",
                                "3D": "3D",
                                aboutUs: "",
                                AI: "AI",
                                angle: "",
                                annotate: "",
                                annotateArrow: "",
                                annotateText: "",
                                aroundInfo: "",
                                blendAverage: "",
                                blendComposite: "",
                                blendMax: "",
                                blendMin: "",
                                blendModes: "",
                                blur: "",
                                blurDefault: "",
                                blurHeight: "",
                                blurLow: "",
                                blurMedium: "",
                                cancelLabels: "",
                                circleRoi: "",
                                cobbAngle: "cobb",
                                colorMap: "",
                                crosshairs: "",
                                crosshairs2D: "3D",
                                CTR: "",
                                deleteLabel: "",
                                DICOMInfo: "DICOM",
                                disSeries: "",
                                ellipticalRoi: "",
                                enhance: "",
                                freehandRoi: "",
                                fusion: "",
                                fusionLayout: "",
                                fusionLayoutAxial: "Axial",
                                fusionLayoutCoronal: "Coronal",
                                fusionLayoutDefault: " (C/S/A)",
                                fusionLayoutSagittal: "Sagittal",
                                imageCacheType: "",
                                imagesLayout: "",
                                imageStitching: "DR",
                                invert: "",
                                knifeIn: "",
                                knifeOut: "",
                                length: "",
                                magnifier: "",
                                major: "",
                                markerL: "",
                                markerR: "",
                                markersImage: "",
                                measure: "",
                                modes: {
                                    major: "",
                                    speed: "",
                                    standard: ""
                                },
                                modulation: "",
                                modulationPreset: "",
                                more: "",
                                MPR: "MPR",
                                pan: "",
                                player: "",
                                print: "",
                                probeCT: "CT",
                                quality: "",
                                rectangleRoi: "",
                                referenceLine: "",
                                release: "",
                                reload: "",
                                reset: "",
                                restore: "",
                                rotate: "",
                                saveImage: "",
                                saveLabels: "",
                                seriesBar: "",
                                seriesLayout: "",
                                sharpen: "",
                                sharpenDefault: "",
                                sharpenHeight: "",
                                sharpenLow: "",
                                sharpenMedium: "",
                                stackIndexSynchronizer: "",
                                stackPositionSynchronizer: "",
                                stackScroll: "",
                                stackScrollSynchronizer: "",
                                synchronizer: "",
                                thickness: "",
                                useCacheImage: "",
                                viewportPresets: "",
                                viewportPresetsDefault: "",
                                visibilityLabels: "",
                                volume: "",
                                VRTModulation: "",
                                zoom: ""
                            }
                        },
                        t = "zh-CN";
                    window.webDicomViewLocal || (window.webDicomViewLocal = {
                        default: void 0
                    }), window.webDicomViewLocal[t] ? console.info(`${t} ${e.toast.languagePackageReLoad}`) : console.info(`${t} ${e.toast.languagePackageInit}`), window.webDicomViewLocal[t] = {
                        language: t,
                        locale: e,
                        name: ""
                    }, void 0 === window.webDicomViewLocal.default && (window.webDicomViewLocal.default = window.webDicomViewLocal[t])
                }()
            },
            1333: e => {
                "use strict";
                e.exports = function() {
                    if ("function" != typeof Symbol || "function" != typeof Object.getOwnPropertySymbols) return !1;
                    if ("symbol" == typeof Symbol.iterator) return !0;
                    var e = {},
                        t = Symbol("test"),
                        n = Object(t);
                    if ("string" == typeof t) return !1;
                    if ("[object Symbol]" !== Object.prototype.toString.call(t)) return !1;
                    if ("[object Symbol]" !== Object.prototype.toString.call(n)) return !1;
                    for (var o in e[t] = 42, e) return !1;
                    if ("function" == typeof Object.keys && 0 !== Object.keys(e).length) return !1;
                    if ("function" == typeof Object.getOwnPropertyNames && 0 !== Object.getOwnPropertyNames(e).length) return !1;
                    var r = Object.getOwnPropertySymbols(e);
                    if (1 !== r.length || r[0] !== t) return !1;
                    if (!Object.prototype.propertyIsEnumerable.call(e, t)) return !1;
                    if ("function" == typeof Object.getOwnPropertyDescriptor) {
                        var a = Object.getOwnPropertyDescriptor(e, t);
                        if (42 !== a.value || !0 !== a.enumerable) return !1
                    }
                    return !0
                }
            },
            1468: (e, t, n) => {
                "use strict";
                n.d(t, {
                    A: () => a
                });
                var o = n(8398);
                const r = "cornerstone-canvas";

                function a(e) {
                    const t = `canvas.${r}`;
                    return e.querySelector(t) || function(e) {
                        const t = document.createElement("canvas");
                        return t.style.display = "block", (0, o.wf)(t, !0, r), e.appendChild(t), t
                    }(e)
                }
            },
            1514: e => {
                "use strict";
                e.exports = Math.abs
            },
            1584: (e, t, n) => {
                "use strict";
                var o;
                n.r(t), n.d(t, {
                        SpeedUnit: () => o
                    }),
                    function(e) {
                        e.FRAME = "f", e.SECOND = "s"
                    }(o || (o = {}))
            },
            1706: (e, t, n) => {
                "use strict";
                n.r(t), n.d(t, {
                    BlendModes: () => l.A,
                    CalibrationTypes: () => p.A,
                    ContourType: () => d,
                    DynamicOperatorType: () => m,
                    Events: () => r.A,
                    GenerateImageType: () => g,
                    GeometryType: () => u.A,
                    ImageQualityStatus: () => y.A,
                    InterpolationType: () => s.A,
                    MetadataModules: () => w.A,
                    OrientationAxis: () => c.A,
                    RequestType: () => a.A,
                    VOILUTFunctionType: () => f.A,
                    VideoEnums: () => b,
                    ViewportStatus: () => v.A,
                    ViewportType: () => i.A,
                    VoxelManagerEnum: () => x.A
                });
                var o, r = n(7426),
                    a = n(9770),
                    i = n(6269),
                    s = n(3577),
                    l = n(2518),
                    c = n(4012),
                    u = n(4663);
                ! function(e) {
                    e.CLOSED_PLANAR = "CLOSED_PLANAR", e.OPEN_PLANAR = "OPEN_PLANAR"
                }(o || (o = {}));
                const d = o;
                var h, f = n(4824);
                ! function(e) {
                    e.SUM = "SUM", e.AVERAGE = "AVERAGE", e.SUBTRACT = "SUBTRACT"
                }(h || (h = {}));
                const m = h;
                var g, p = n(2062),
                    v = n(2259),
                    y = n(5255),
                    b = n(1584),
                    w = n(6733);
                ! function(e) {
                    e.SUM = "SUM", e.SUBTRACT = "SUBTRACT", e.AVERAGE = "AVERAGE"
                }(g || (g = {}));
                var x = n(4637)
            },
            1948: function(e, t, n) {
                var o;
                o = e => (() => {
                    "use strict";
                    var t = {
                            578: (e, t, n) => {
                                const o = n(823),
                                    r = n(187),
                                    a = n(592),
                                    i = n(604),
                                    s = n(249),
                                    l = n(968),
                                    c = Object.prototype.toString,
                                    {
                                        Z_NO_FLUSH: u,
                                        Z_FINISH: d,
                                        Z_OK: h,
                                        Z_STREAM_END: f,
                                        Z_NEED_DICT: m,
                                        Z_STREAM_ERROR: g,
                                        Z_DATA_ERROR: p,
                                        Z_MEM_ERROR: v
                                    } = n(684);

                                function y(e) {
                                    this.options = r.assign({
                                        chunkSize: 65536,
                                        windowBits: 15,
                                        to: ""
                                    }, e || {});
                                    const t = this.options;
                                    t.raw && t.windowBits >= 0 && t.windowBits < 16 && (t.windowBits = -t.windowBits, 0 === t.windowBits && (t.windowBits = -15)), !(t.windowBits >= 0 && t.windowBits < 16) || e && e.windowBits || (t.windowBits += 32), t.windowBits > 15 && t.windowBits < 48 && !(15 & t.windowBits) && (t.windowBits |= 15), this.err = 0, this.msg = "", this.ended = !1, this.chunks = [], this.strm = new s, this.strm.avail_out = 0;
                                    let n = o.inflateInit2(this.strm, t.windowBits);
                                    if (n !== h) throw new Error(i[n]);
                                    if (this.header = new l, o.inflateGetHeader(this.strm, this.header), t.dictionary && ("string" == typeof t.dictionary ? t.dictionary = a.string2buf(t.dictionary) : "[object ArrayBuffer]" === c.call(t.dictionary) && (t.dictionary = new Uint8Array(t.dictionary)), t.raw && (n = o.inflateSetDictionary(this.strm, t.dictionary), n !== h))) throw new Error(i[n])
                                }
                                y.prototype.push = function(e, t) {
                                    const n = this.strm,
                                        r = this.options.chunkSize,
                                        i = this.options.dictionary;
                                    let s, l, y;
                                    if (this.ended) return !1;
                                    for (l = t === ~~t ? t : !0 === t ? d : u, "[object ArrayBuffer]" === c.call(e) ? n.input = new Uint8Array(e) : n.input = e, n.next_in = 0, n.avail_in = n.input.length;;) {
                                        for (0 === n.avail_out && (n.output = new Uint8Array(r), n.next_out = 0, n.avail_out = r), s = o.inflate(n, l), s === m && i && (s = o.inflateSetDictionary(n, i), s === h ? s = o.inflate(n, l) : s === p && (s = m)); n.avail_in > 0 && s === f && n.state.wrap > 0 && 0 !== e[n.next_in];) o.inflateReset(n), s = o.inflate(n, l);
                                        switch (s) {
                                            case g:
                                            case p:
                                            case m:
                                            case v:
                                                return this.onEnd(s), this.ended = !0, !1
                                        }
                                        if (y = n.avail_out, n.next_out && (0 === n.avail_out || s === f))
                                            if ("string" === this.options.to) {
                                                let e = a.utf8border(n.output, n.next_out),
                                                    t = n.next_out - e,
                                                    o = a.buf2string(n.output, e);
                                                n.next_out = t, n.avail_out = r - t, t && n.output.set(n.output.subarray(e, e + t), 0), this.onData(o)
                                            } else this.onData(n.output.length === n.next_out ? n.output : n.output.subarray(0, n.next_out));
                                        if (s !== h || 0 !== y) {
                                            if (s === f) return s = o.inflateEnd(this.strm), this.onEnd(s), this.ended = !0, !0;
                                            if (0 === n.avail_in) break
                                        }
                                    }
                                    return !0
                                }, y.prototype.onData = function(e) {
                                    this.chunks.push(e)
                                }, y.prototype.onEnd = function(e) {
                                    e === h && ("string" === this.options.to ? this.result = this.chunks.join("") : this.result = r.flattenChunks(this.chunks)), this.chunks = [], this.err = e, this.msg = this.strm.msg
                                }, e.exports.Hq = function(e, t) {
                                    return (t = t || {}).raw = !0,
                                        function(e, t) {
                                            const n = new y(t);
                                            if (n.push(e), n.err) throw n.msg || i[n.err];
                                            return n.result
                                        }(e, t)
                                }, n(684)
                            },
                            187: e => {
                                const t = (e, t) => Object.prototype.hasOwnProperty.call(e, t);
                                e.exports.assign = function(e) {
                                    const n = Array.prototype.slice.call(arguments, 1);
                                    for (; n.length;) {
                                        const o = n.shift();
                                        if (o) {
                                            if ("object" != typeof o) throw new TypeError(o + "must be non-object");
                                            for (const n in o) t(o, n) && (e[n] = o[n])
                                        }
                                    }
                                    return e
                                }, e.exports.flattenChunks = e => {
                                    let t = 0;
                                    for (let n = 0, o = e.length; n < o; n++) t += e[n].length;
                                    const n = new Uint8Array(t);
                                    for (let t = 0, o = 0, r = e.length; t < r; t++) {
                                        let r = e[t];
                                        n.set(r, o), o += r.length
                                    }
                                    return n
                                }
                            },
                            592: e => {
                                let t = !0;
                                try {
                                    String.fromCharCode.apply(null, new Uint8Array(1))
                                } catch (e) {
                                    t = !1
                                }
                                const n = new Uint8Array(256);
                                for (let e = 0; e < 256; e++) n[e] = e >= 252 ? 6 : e >= 248 ? 5 : e >= 240 ? 4 : e >= 224 ? 3 : e >= 192 ? 2 : 1;
                                n[254] = n[254] = 1, e.exports.string2buf = e => {
                                    if ("function" == typeof TextEncoder && TextEncoder.prototype.encode) return (new TextEncoder).encode(e);
                                    let t, n, o, r, a, i = e.length,
                                        s = 0;
                                    for (r = 0; r < i; r++) n = e.charCodeAt(r), 55296 == (64512 & n) && r + 1 < i && (o = e.charCodeAt(r + 1), 56320 == (64512 & o) && (n = 65536 + (n - 55296 << 10) + (o - 56320), r++)), s += n < 128 ? 1 : n < 2048 ? 2 : n < 65536 ? 3 : 4;
                                    for (t = new Uint8Array(s), a = 0, r = 0; a < s; r++) n = e.charCodeAt(r), 55296 == (64512 & n) && r + 1 < i && (o = e.charCodeAt(r + 1), 56320 == (64512 & o) && (n = 65536 + (n - 55296 << 10) + (o - 56320), r++)), n < 128 ? t[a++] = n : n < 2048 ? (t[a++] = 192 | n >>> 6, t[a++] = 128 | 63 & n) : n < 65536 ? (t[a++] = 224 | n >>> 12, t[a++] = 128 | n >>> 6 & 63, t[a++] = 128 | 63 & n) : (t[a++] = 240 | n >>> 18, t[a++] = 128 | n >>> 12 & 63, t[a++] = 128 | n >>> 6 & 63, t[a++] = 128 | 63 & n);
                                    return t
                                }, e.exports.buf2string = (e, o) => {
                                    const r = o || e.length;
                                    if ("function" == typeof TextDecoder && TextDecoder.prototype.decode) return (new TextDecoder).decode(e.subarray(0, o));
                                    let a, i;
                                    const s = new Array(2 * r);
                                    for (i = 0, a = 0; a < r;) {
                                        let t = e[a++];
                                        if (t < 128) {
                                            s[i++] = t;
                                            continue
                                        }
                                        let o = n[t];
                                        if (o > 4) s[i++] = 65533, a += o - 1;
                                        else {
                                            for (t &= 2 === o ? 31 : 3 === o ? 15 : 7; o > 1 && a < r;) t = t << 6 | 63 & e[a++], o--;
                                            o > 1 ? s[i++] = 65533 : t < 65536 ? s[i++] = t : (t -= 65536, s[i++] = 55296 | t >> 10 & 1023, s[i++] = 56320 | 1023 & t)
                                        }
                                    }
                                    return ((e, n) => {
                                        if (n < 65534 && e.subarray && t) return String.fromCharCode.apply(null, e.length === n ? e : e.subarray(0, n));
                                        let o = "";
                                        for (let t = 0; t < n; t++) o += String.fromCharCode(e[t]);
                                        return o
                                    })(s, i)
                                }, e.exports.utf8border = (e, t) => {
                                    (t = t || e.length) > e.length && (t = e.length);
                                    let o = t - 1;
                                    for (; o >= 0 && 128 == (192 & e[o]);) o--;
                                    return o < 0 || 0 === o ? t : o + n[e[o]] > t ? o : t
                                }
                            },
                            693: e => {
                                e.exports = (e, t, n, o) => {
                                    let r = 65535 & e,
                                        a = e >>> 16 & 65535,
                                        i = 0;
                                    for (; 0 !== n;) {
                                        i = n > 2e3 ? 2e3 : n, n -= i;
                                        do {
                                            r = r + t[o++] | 0, a = a + r | 0
                                        } while (--i);
                                        r %= 65521, a %= 65521
                                    }
                                    return r | a << 16
                                }
                            },
                            684: e => {
                                e.exports = {
                                    Z_NO_FLUSH: 0,
                                    Z_PARTIAL_FLUSH: 1,
                                    Z_SYNC_FLUSH: 2,
                                    Z_FULL_FLUSH: 3,
                                    Z_FINISH: 4,
                                    Z_BLOCK: 5,
                                    Z_TREES: 6,
                                    Z_OK: 0,
                                    Z_STREAM_END: 1,
                                    Z_NEED_DICT: 2,
                                    Z_ERRNO: -1,
                                    Z_STREAM_ERROR: -2,
                                    Z_DATA_ERROR: -3,
                                    Z_MEM_ERROR: -4,
                                    Z_BUF_ERROR: -5,
                                    Z_NO_COMPRESSION: 0,
                                    Z_BEST_SPEED: 1,
                                    Z_BEST_COMPRESSION: 9,
                                    Z_DEFAULT_COMPRESSION: -1,
                                    Z_FILTERED: 1,
                                    Z_HUFFMAN_ONLY: 2,
                                    Z_RLE: 3,
                                    Z_FIXED: 4,
                                    Z_DEFAULT_STRATEGY: 0,
                                    Z_BINARY: 0,
                                    Z_TEXT: 1,
                                    Z_UNKNOWN: 2,
                                    Z_DEFLATED: 8
                                }
                            },
                            464: e => {
                                const t = new Uint32Array((() => {
                                    let e, t = [];
                                    for (var n = 0; n < 256; n++) {
                                        e = n;
                                        for (var o = 0; o < 8; o++) e = 1 & e ? 3988292384 ^ e >>> 1 : e >>> 1;
                                        t[n] = e
                                    }
                                    return t
                                })());
                                e.exports = (e, n, o, r) => {
                                    const a = t,
                                        i = r + o;
                                    e ^= -1;
                                    for (let t = r; t < i; t++) e = e >>> 8 ^ a[255 & (e ^ n[t])];
                                    return ~e
                                }
                            },
                            968: e => {
                                e.exports = function() {
                                    this.text = 0, this.time = 0, this.xflags = 0, this.os = 0, this.extra = null, this.extra_len = 0, this.name = "", this.comment = "", this.hcrc = 0, this.done = !1
                                }
                            },
                            365: e => {
                                const t = 16209;
                                e.exports = function(e, n) {
                                    let o, r, a, i, s, l, c, u, d, h, f, m, g, p, v, y, b, w, x, T, I, E, S, A;
                                    const C = e.state;
                                    o = e.next_in, S = e.input, r = o + (e.avail_in - 5), a = e.next_out, A = e.output, i = a - (n - e.avail_out), s = a + (e.avail_out - 257), l = C.dmax, c = C.wsize, u = C.whave, d = C.wnext, h = C.window, f = C.hold, m = C.bits, g = C.lencode, p = C.distcode, v = (1 << C.lenbits) - 1, y = (1 << C.distbits) - 1;
                                    e: do {
                                        m < 15 && (f += S[o++] << m, m += 8, f += S[o++] << m, m += 8), b = g[f & v];
                                        t: for (;;) {
                                            if (w = b >>> 24, f >>>= w, m -= w, w = b >>> 16 & 255, 0 === w) A[a++] = 65535 & b;
                                            else {
                                                if (!(16 & w)) {
                                                    if (!(64 & w)) {
                                                        b = g[(65535 & b) + (f & (1 << w) - 1)];
                                                        continue t
                                                    }
                                                    if (32 & w) {
                                                        C.mode = 16191;
                                                        break e
                                                    }
                                                    e.msg = "invalid literal/length code", C.mode = t;
                                                    break e
                                                }
                                                x = 65535 & b, w &= 15, w && (m < w && (f += S[o++] << m, m += 8), x += f & (1 << w) - 1, f >>>= w, m -= w), m < 15 && (f += S[o++] << m, m += 8, f += S[o++] << m, m += 8), b = p[f & y];
                                                n: for (;;) {
                                                    if (w = b >>> 24, f >>>= w, m -= w, w = b >>> 16 & 255, !(16 & w)) {
                                                        if (!(64 & w)) {
                                                            b = p[(65535 & b) + (f & (1 << w) - 1)];
                                                            continue n
                                                        }
                                                        e.msg = "invalid distance code", C.mode = t;
                                                        break e
                                                    }
                                                    if (T = 65535 & b, w &= 15, m < w && (f += S[o++] << m, m += 8, m < w && (f += S[o++] << m, m += 8)), T += f & (1 << w) - 1, T > l) {
                                                        e.msg = "invalid distance too far back", C.mode = t;
                                                        break e
                                                    }
                                                    if (f >>>= w, m -= w, w = a - i, T > w) {
                                                        if (w = T - w, w > u && C.sane) {
                                                            e.msg = "invalid distance too far back", C.mode = t;
                                                            break e
                                                        }
                                                        if (I = 0, E = h, 0 === d) {
                                                            if (I += c - w, w < x) {
                                                                x -= w;
                                                                do {
                                                                    A[a++] = h[I++]
                                                                } while (--w);
                                                                I = a - T, E = A
                                                            }
                                                        } else if (d < w) {
                                                            if (I += c + d - w, w -= d, w < x) {
                                                                x -= w;
                                                                do {
                                                                    A[a++] = h[I++]
                                                                } while (--w);
                                                                if (I = 0, d < x) {
                                                                    w = d, x -= w;
                                                                    do {
                                                                        A[a++] = h[I++]
                                                                    } while (--w);
                                                                    I = a - T, E = A
                                                                }
                                                            }
                                                        } else if (I += d - w, w < x) {
                                                            x -= w;
                                                            do {
                                                                A[a++] = h[I++]
                                                            } while (--w);
                                                            I = a - T, E = A
                                                        }
                                                        for (; x > 2;) A[a++] = E[I++], A[a++] = E[I++], A[a++] = E[I++], x -= 3;
                                                        x && (A[a++] = E[I++], x > 1 && (A[a++] = E[I++]))
                                                    } else {
                                                        I = a - T;
                                                        do {
                                                            A[a++] = A[I++], A[a++] = A[I++], A[a++] = A[I++], x -= 3
                                                        } while (x > 2);
                                                        x && (A[a++] = A[I++], x > 1 && (A[a++] = A[I++]))
                                                    }
                                                    break
                                                }
                                            }
                                            break
                                        }
                                    } while (o < r && a < s);
                                    x = m >> 3, o -= x, m -= x << 3, f &= (1 << m) - 1, e.next_in = o, e.next_out = a, e.avail_in = o < r ? r - o + 5 : 5 - (o - r), e.avail_out = a < s ? s - a + 257 : 257 - (a - s), C.hold = f, C.bits = m
                                }
                            },
                            823: (e, t, n) => {
                                const o = n(693),
                                    r = n(464),
                                    a = n(365),
                                    i = n(446),
                                    {
                                        Z_FINISH: s,
                                        Z_BLOCK: l,
                                        Z_TREES: c,
                                        Z_OK: u,
                                        Z_STREAM_END: d,
                                        Z_NEED_DICT: h,
                                        Z_STREAM_ERROR: f,
                                        Z_DATA_ERROR: m,
                                        Z_MEM_ERROR: g,
                                        Z_BUF_ERROR: p,
                                        Z_DEFLATED: v
                                    } = n(684),
                                    y = 16180,
                                    b = 16190,
                                    w = 16191,
                                    x = 16192,
                                    T = 16194,
                                    I = 16199,
                                    E = 16200,
                                    S = 16206,
                                    A = 16209,
                                    C = 16210,
                                    M = e => (e >>> 24 & 255) + (e >>> 8 & 65280) + ((65280 & e) << 8) + ((255 & e) << 24);

                                function D() {
                                    this.strm = null, this.mode = 0, this.last = !1, this.wrap = 0, this.havedict = !1, this.flags = 0, this.dmax = 0, this.check = 0, this.total = 0, this.head = null, this.wbits = 0, this.wsize = 0, this.whave = 0, this.wnext = 0, this.window = null, this.hold = 0, this.bits = 0, this.length = 0, this.offset = 0, this.extra = 0, this.lencode = null, this.distcode = null, this.lenbits = 0, this.distbits = 0, this.ncode = 0, this.nlen = 0, this.ndist = 0, this.have = 0, this.next = null, this.lens = new Uint16Array(320), this.work = new Uint16Array(288), this.lendyn = null, this.distdyn = null, this.sane = 0, this.back = 0, this.was = 0
                                }
                                const P = e => {
                                        if (!e) return 1;
                                        const t = e.state;
                                        return !t || t.strm !== e || t.mode < y || t.mode > 16211 ? 1 : 0
                                    },
                                    k = e => {
                                        if (P(e)) return f;
                                        const t = e.state;
                                        return e.total_in = e.total_out = t.total = 0, e.msg = "", t.wrap && (e.adler = 1 & t.wrap), t.mode = y, t.last = 0, t.havedict = 0, t.flags = -1, t.dmax = 32768, t.head = null, t.hold = 0, t.bits = 0, t.lencode = t.lendyn = new Int32Array(852), t.distcode = t.distdyn = new Int32Array(592), t.sane = 1, t.back = -1, u
                                    },
                                    _ = e => {
                                        if (P(e)) return f;
                                        const t = e.state;
                                        return t.wsize = 0, t.whave = 0, t.wnext = 0, k(e)
                                    },
                                    L = (e, t) => {
                                        let n;
                                        if (P(e)) return f;
                                        const o = e.state;
                                        return t < 0 ? (n = 0, t = -t) : (n = 5 + (t >> 4), t < 48 && (t &= 15)), t && (t < 8 || t > 15) ? f : (null !== o.window && o.wbits !== t && (o.window = null), o.wrap = n, o.wbits = t, _(e))
                                    },
                                    O = (e, t) => {
                                        if (!e) return f;
                                        const n = new D;
                                        e.state = n, n.strm = e, n.window = null, n.mode = y;
                                        const o = L(e, t);
                                        return o !== u && (e.state = null), o
                                    };
                                let R, N, U = !0;
                                const B = e => {
                                        if (U) {
                                            R = new Int32Array(512), N = new Int32Array(32);
                                            let t = 0;
                                            for (; t < 144;) e.lens[t++] = 8;
                                            for (; t < 256;) e.lens[t++] = 9;
                                            for (; t < 280;) e.lens[t++] = 7;
                                            for (; t < 288;) e.lens[t++] = 8;
                                            for (i(1, e.lens, 0, 288, R, 0, e.work, {
                                                    bits: 9
                                                }), t = 0; t < 32;) e.lens[t++] = 5;
                                            i(2, e.lens, 0, 32, N, 0, e.work, {
                                                bits: 5
                                            }), U = !1
                                        }
                                        e.lencode = R, e.lenbits = 9, e.distcode = N, e.distbits = 5
                                    },
                                    V = (e, t, n, o) => {
                                        let r;
                                        const a = e.state;
                                        return null === a.window && (a.wsize = 1 << a.wbits, a.wnext = 0, a.whave = 0, a.window = new Uint8Array(a.wsize)), o >= a.wsize ? (a.window.set(t.subarray(n - a.wsize, n), 0), a.wnext = 0, a.whave = a.wsize) : (r = a.wsize - a.wnext, r > o && (r = o), a.window.set(t.subarray(n - o, n - o + r), a.wnext), (o -= r) ? (a.window.set(t.subarray(n - o, n), 0), a.wnext = o, a.whave = a.wsize) : (a.wnext += r, a.wnext === a.wsize && (a.wnext = 0), a.whave < a.wsize && (a.whave += r))), 0
                                    };
                                e.exports.inflateReset = _, e.exports.inflateReset2 = L, e.exports.inflateResetKeep = k, e.exports.inflateInit = e => O(e, 15), e.exports.inflateInit2 = O, e.exports.inflate = (e, t) => {
                                    let n, D, k, _, L, O, R, N, U, F, H, q, j, z, W, G, Y, Z, K, X, J, Q, $ = 0;
                                    const ee = new Uint8Array(4);
                                    let te, ne;
                                    const oe = new Uint8Array([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);
                                    if (P(e) || !e.output || !e.input && 0 !== e.avail_in) return f;
                                    n = e.state, n.mode === w && (n.mode = x), L = e.next_out, k = e.output, R = e.avail_out, _ = e.next_in, D = e.input, O = e.avail_in, N = n.hold, U = n.bits, F = O, H = R, Q = u;
                                    e: for (;;) switch (n.mode) {
                                        case y:
                                            if (0 === n.wrap) {
                                                n.mode = x;
                                                break
                                            }
                                            for (; U < 16;) {
                                                if (0 === O) break e;
                                                O--, N += D[_++] << U, U += 8
                                            }
                                            if (2 & n.wrap && 35615 === N) {
                                                0 === n.wbits && (n.wbits = 15), n.check = 0, ee[0] = 255 & N, ee[1] = N >>> 8 & 255, n.check = r(n.check, ee, 2, 0), N = 0, U = 0, n.mode = 16181;
                                                break
                                            }
                                            if (n.head && (n.head.done = !1), !(1 & n.wrap) || (((255 & N) << 8) + (N >> 8)) % 31) {
                                                e.msg = "incorrect header check", n.mode = A;
                                                break
                                            }
                                            if ((15 & N) !== v) {
                                                e.msg = "unknown compression method", n.mode = A;
                                                break
                                            }
                                            if (N >>>= 4, U -= 4, J = 8 + (15 & N), 0 === n.wbits && (n.wbits = J), J > 15 || J > n.wbits) {
                                                e.msg = "invalid window size", n.mode = A;
                                                break
                                            }
                                            n.dmax = 1 << n.wbits, n.flags = 0, e.adler = n.check = 1, n.mode = 512 & N ? 16189 : w, N = 0, U = 0;
                                            break;
                                        case 16181:
                                            for (; U < 16;) {
                                                if (0 === O) break e;
                                                O--, N += D[_++] << U, U += 8
                                            }
                                            if (n.flags = N, (255 & n.flags) !== v) {
                                                e.msg = "unknown compression method", n.mode = A;
                                                break
                                            }
                                            if (57344 & n.flags) {
                                                e.msg = "unknown header flags set", n.mode = A;
                                                break
                                            }
                                            n.head && (n.head.text = N >> 8 & 1), 512 & n.flags && 4 & n.wrap && (ee[0] = 255 & N, ee[1] = N >>> 8 & 255, n.check = r(n.check, ee, 2, 0)), N = 0, U = 0, n.mode = 16182;
                                        case 16182:
                                            for (; U < 32;) {
                                                if (0 === O) break e;
                                                O--, N += D[_++] << U, U += 8
                                            }
                                            n.head && (n.head.time = N), 512 & n.flags && 4 & n.wrap && (ee[0] = 255 & N, ee[1] = N >>> 8 & 255, ee[2] = N >>> 16 & 255, ee[3] = N >>> 24 & 255, n.check = r(n.check, ee, 4, 0)), N = 0, U = 0, n.mode = 16183;
                                        case 16183:
                                            for (; U < 16;) {
                                                if (0 === O) break e;
                                                O--, N += D[_++] << U, U += 8
                                            }
                                            n.head && (n.head.xflags = 255 & N, n.head.os = N >> 8), 512 & n.flags && 4 & n.wrap && (ee[0] = 255 & N, ee[1] = N >>> 8 & 255, n.check = r(n.check, ee, 2, 0)), N = 0, U = 0, n.mode = 16184;
                                        case 16184:
                                            if (1024 & n.flags) {
                                                for (; U < 16;) {
                                                    if (0 === O) break e;
                                                    O--, N += D[_++] << U, U += 8
                                                }
                                                n.length = N, n.head && (n.head.extra_len = N), 512 & n.flags && 4 & n.wrap && (ee[0] = 255 & N, ee[1] = N >>> 8 & 255, n.check = r(n.check, ee, 2, 0)), N = 0, U = 0
                                            } else n.head && (n.head.extra = null);
                                            n.mode = 16185;
                                        case 16185:
                                            if (1024 & n.flags && (q = n.length, q > O && (q = O), q && (n.head && (J = n.head.extra_len - n.length, n.head.extra || (n.head.extra = new Uint8Array(n.head.extra_len)), n.head.extra.set(D.subarray(_, _ + q), J)), 512 & n.flags && 4 & n.wrap && (n.check = r(n.check, D, q, _)), O -= q, _ += q, n.length -= q), n.length)) break e;
                                            n.length = 0, n.mode = 16186;
                                        case 16186:
                                            if (2048 & n.flags) {
                                                if (0 === O) break e;
                                                q = 0;
                                                do {
                                                    J = D[_ + q++], n.head && J && n.length < 65536 && (n.head.name += String.fromCharCode(J))
                                                } while (J && q < O);
                                                if (512 & n.flags && 4 & n.wrap && (n.check = r(n.check, D, q, _)), O -= q, _ += q, J) break e
                                            } else n.head && (n.head.name = null);
                                            n.length = 0, n.mode = 16187;
                                        case 16187:
                                            if (4096 & n.flags) {
                                                if (0 === O) break e;
                                                q = 0;
                                                do {
                                                    J = D[_ + q++], n.head && J && n.length < 65536 && (n.head.comment += String.fromCharCode(J))
                                                } while (J && q < O);
                                                if (512 & n.flags && 4 & n.wrap && (n.check = r(n.check, D, q, _)), O -= q, _ += q, J) break e
                                            } else n.head && (n.head.comment = null);
                                            n.mode = 16188;
                                        case 16188:
                                            if (512 & n.flags) {
                                                for (; U < 16;) {
                                                    if (0 === O) break e;
                                                    O--, N += D[_++] << U, U += 8
                                                }
                                                if (4 & n.wrap && N !== (65535 & n.check)) {
                                                    e.msg = "header crc mismatch", n.mode = A;
                                                    break
                                                }
                                                N = 0, U = 0
                                            }
                                            n.head && (n.head.hcrc = n.flags >> 9 & 1, n.head.done = !0), e.adler = n.check = 0, n.mode = w;
                                            break;
                                        case 16189:
                                            for (; U < 32;) {
                                                if (0 === O) break e;
                                                O--, N += D[_++] << U, U += 8
                                            }
                                            e.adler = n.check = M(N), N = 0, U = 0, n.mode = b;
                                        case b:
                                            if (0 === n.havedict) return e.next_out = L, e.avail_out = R, e.next_in = _, e.avail_in = O, n.hold = N, n.bits = U, h;
                                            e.adler = n.check = 1, n.mode = w;
                                        case w:
                                            if (t === l || t === c) break e;
                                        case x:
                                            if (n.last) {
                                                N >>>= 7 & U, U -= 7 & U, n.mode = S;
                                                break
                                            }
                                            for (; U < 3;) {
                                                if (0 === O) break e;
                                                O--, N += D[_++] << U, U += 8
                                            }
                                            switch (n.last = 1 & N, N >>>= 1, U -= 1, 3 & N) {
                                                case 0:
                                                    n.mode = 16193;
                                                    break;
                                                case 1:
                                                    if (B(n), n.mode = I, t === c) {
                                                        N >>>= 2, U -= 2;
                                                        break e
                                                    }
                                                    break;
                                                case 2:
                                                    n.mode = 16196;
                                                    break;
                                                case 3:
                                                    e.msg = "invalid block type", n.mode = A
                                            }
                                            N >>>= 2, U -= 2;
                                            break;
                                        case 16193:
                                            for (N >>>= 7 & U, U -= 7 & U; U < 32;) {
                                                if (0 === O) break e;
                                                O--, N += D[_++] << U, U += 8
                                            }
                                            if ((65535 & N) != (N >>> 16 ^ 65535)) {
                                                e.msg = "invalid stored block lengths", n.mode = A;
                                                break
                                            }
                                            if (n.length = 65535 & N, N = 0, U = 0, n.mode = T, t === c) break e;
                                        case T:
                                            n.mode = 16195;
                                        case 16195:
                                            if (q = n.length, q) {
                                                if (q > O && (q = O), q > R && (q = R), 0 === q) break e;
                                                k.set(D.subarray(_, _ + q), L), O -= q, _ += q, R -= q, L += q, n.length -= q;
                                                break
                                            }
                                            n.mode = w;
                                            break;
                                        case 16196:
                                            for (; U < 14;) {
                                                if (0 === O) break e;
                                                O--, N += D[_++] << U, U += 8
                                            }
                                            if (n.nlen = 257 + (31 & N), N >>>= 5, U -= 5, n.ndist = 1 + (31 & N), N >>>= 5, U -= 5, n.ncode = 4 + (15 & N), N >>>= 4, U -= 4, n.nlen > 286 || n.ndist > 30) {
                                                e.msg = "too many length or distance symbols", n.mode = A;
                                                break
                                            }
                                            n.have = 0, n.mode = 16197;
                                        case 16197:
                                            for (; n.have < n.ncode;) {
                                                for (; U < 3;) {
                                                    if (0 === O) break e;
                                                    O--, N += D[_++] << U, U += 8
                                                }
                                                n.lens[oe[n.have++]] = 7 & N, N >>>= 3, U -= 3
                                            }
                                            for (; n.have < 19;) n.lens[oe[n.have++]] = 0;
                                            if (n.lencode = n.lendyn, n.lenbits = 7, te = {
                                                    bits: n.lenbits
                                                }, Q = i(0, n.lens, 0, 19, n.lencode, 0, n.work, te), n.lenbits = te.bits, Q) {
                                                e.msg = "invalid code lengths set", n.mode = A;
                                                break
                                            }
                                            n.have = 0, n.mode = 16198;
                                        case 16198:
                                            for (; n.have < n.nlen + n.ndist;) {
                                                for (; $ = n.lencode[N & (1 << n.lenbits) - 1], W = $ >>> 24, G = $ >>> 16 & 255, Y = 65535 & $, !(W <= U);) {
                                                    if (0 === O) break e;
                                                    O--, N += D[_++] << U, U += 8
                                                }
                                                if (Y < 16) N >>>= W, U -= W, n.lens[n.have++] = Y;
                                                else {
                                                    if (16 === Y) {
                                                        for (ne = W + 2; U < ne;) {
                                                            if (0 === O) break e;
                                                            O--, N += D[_++] << U, U += 8
                                                        }
                                                        if (N >>>= W, U -= W, 0 === n.have) {
                                                            e.msg = "invalid bit length repeat", n.mode = A;
                                                            break
                                                        }
                                                        J = n.lens[n.have - 1], q = 3 + (3 & N), N >>>= 2, U -= 2
                                                    } else if (17 === Y) {
                                                        for (ne = W + 3; U < ne;) {
                                                            if (0 === O) break e;
                                                            O--, N += D[_++] << U, U += 8
                                                        }
                                                        N >>>= W, U -= W, J = 0, q = 3 + (7 & N), N >>>= 3, U -= 3
                                                    } else {
                                                        for (ne = W + 7; U < ne;) {
                                                            if (0 === O) break e;
                                                            O--, N += D[_++] << U, U += 8
                                                        }
                                                        N >>>= W, U -= W, J = 0, q = 11 + (127 & N), N >>>= 7, U -= 7
                                                    }
                                                    if (n.have + q > n.nlen + n.ndist) {
                                                        e.msg = "invalid bit length repeat", n.mode = A;
                                                        break
                                                    }
                                                    for (; q--;) n.lens[n.have++] = J
                                                }
                                            }
                                            if (n.mode === A) break;
                                            if (0 === n.lens[256]) {
                                                e.msg = "invalid code -- missing end-of-block", n.mode = A;
                                                break
                                            }
                                            if (n.lenbits = 9, te = {
                                                    bits: n.lenbits
                                                }, Q = i(1, n.lens, 0, n.nlen, n.lencode, 0, n.work, te), n.lenbits = te.bits, Q) {
                                                e.msg = "invalid literal/lengths set", n.mode = A;
                                                break
                                            }
                                            if (n.distbits = 6, n.distcode = n.distdyn, te = {
                                                    bits: n.distbits
                                                }, Q = i(2, n.lens, n.nlen, n.ndist, n.distcode, 0, n.work, te), n.distbits = te.bits, Q) {
                                                e.msg = "invalid distances set", n.mode = A;
                                                break
                                            }
                                            if (n.mode = I, t === c) break e;
                                        case I:
                                            n.mode = E;
                                        case E:
                                            if (O >= 6 && R >= 258) {
                                                e.next_out = L, e.avail_out = R, e.next_in = _, e.avail_in = O, n.hold = N, n.bits = U, a(e, H), L = e.next_out, k = e.output, R = e.avail_out, _ = e.next_in, D = e.input, O = e.avail_in, N = n.hold, U = n.bits, n.mode === w && (n.back = -1);
                                                break
                                            }
                                            for (n.back = 0; $ = n.lencode[N & (1 << n.lenbits) - 1], W = $ >>> 24, G = $ >>> 16 & 255, Y = 65535 & $, !(W <= U);) {
                                                if (0 === O) break e;
                                                O--, N += D[_++] << U, U += 8
                                            }
                                            if (G && !(240 & G)) {
                                                for (Z = W, K = G, X = Y; $ = n.lencode[X + ((N & (1 << Z + K) - 1) >> Z)], W = $ >>> 24, G = $ >>> 16 & 255, Y = 65535 & $, !(Z + W <= U);) {
                                                    if (0 === O) break e;
                                                    O--, N += D[_++] << U, U += 8
                                                }
                                                N >>>= Z, U -= Z, n.back += Z
                                            }
                                            if (N >>>= W, U -= W, n.back += W, n.length = Y, 0 === G) {
                                                n.mode = 16205;
                                                break
                                            }
                                            if (32 & G) {
                                                n.back = -1, n.mode = w;
                                                break
                                            }
                                            if (64 & G) {
                                                e.msg = "invalid literal/length code", n.mode = A;
                                                break
                                            }
                                            n.extra = 15 & G, n.mode = 16201;
                                        case 16201:
                                            if (n.extra) {
                                                for (ne = n.extra; U < ne;) {
                                                    if (0 === O) break e;
                                                    O--, N += D[_++] << U, U += 8
                                                }
                                                n.length += N & (1 << n.extra) - 1, N >>>= n.extra, U -= n.extra, n.back += n.extra
                                            }
                                            n.was = n.length, n.mode = 16202;
                                        case 16202:
                                            for (; $ = n.distcode[N & (1 << n.distbits) - 1], W = $ >>> 24, G = $ >>> 16 & 255, Y = 65535 & $, !(W <= U);) {
                                                if (0 === O) break e;
                                                O--, N += D[_++] << U, U += 8
                                            }
                                            if (!(240 & G)) {
                                                for (Z = W, K = G, X = Y; $ = n.distcode[X + ((N & (1 << Z + K) - 1) >> Z)], W = $ >>> 24, G = $ >>> 16 & 255, Y = 65535 & $, !(Z + W <= U);) {
                                                    if (0 === O) break e;
                                                    O--, N += D[_++] << U, U += 8
                                                }
                                                N >>>= Z, U -= Z, n.back += Z
                                            }
                                            if (N >>>= W, U -= W, n.back += W, 64 & G) {
                                                e.msg = "invalid distance code", n.mode = A;
                                                break
                                            }
                                            n.offset = Y, n.extra = 15 & G, n.mode = 16203;
                                        case 16203:
                                            if (n.extra) {
                                                for (ne = n.extra; U < ne;) {
                                                    if (0 === O) break e;
                                                    O--, N += D[_++] << U, U += 8
                                                }
                                                n.offset += N & (1 << n.extra) - 1, N >>>= n.extra, U -= n.extra, n.back += n.extra
                                            }
                                            if (n.offset > n.dmax) {
                                                e.msg = "invalid distance too far back", n.mode = A;
                                                break
                                            }
                                            n.mode = 16204;
                                        case 16204:
                                            if (0 === R) break e;
                                            if (q = H - R, n.offset > q) {
                                                if (q = n.offset - q, q > n.whave && n.sane) {
                                                    e.msg = "invalid distance too far back", n.mode = A;
                                                    break
                                                }
                                                q > n.wnext ? (q -= n.wnext, j = n.wsize - q) : j = n.wnext - q, q > n.length && (q = n.length), z = n.window
                                            } else z = k, j = L - n.offset, q = n.length;
                                            q > R && (q = R), R -= q, n.length -= q;
                                            do {
                                                k[L++] = z[j++]
                                            } while (--q);
                                            0 === n.length && (n.mode = E);
                                            break;
                                        case 16205:
                                            if (0 === R) break e;
                                            k[L++] = n.length, R--, n.mode = E;
                                            break;
                                        case S:
                                            if (n.wrap) {
                                                for (; U < 32;) {
                                                    if (0 === O) break e;
                                                    O--, N |= D[_++] << U, U += 8
                                                }
                                                if (H -= R, e.total_out += H, n.total += H, 4 & n.wrap && H && (e.adler = n.check = n.flags ? r(n.check, k, H, L - H) : o(n.check, k, H, L - H)), H = R, 4 & n.wrap && (n.flags ? N : M(N)) !== n.check) {
                                                    e.msg = "incorrect data check", n.mode = A;
                                                    break
                                                }
                                                N = 0, U = 0
                                            }
                                            n.mode = 16207;
                                        case 16207:
                                            if (n.wrap && n.flags) {
                                                for (; U < 32;) {
                                                    if (0 === O) break e;
                                                    O--, N += D[_++] << U, U += 8
                                                }
                                                if (4 & n.wrap && N !== (4294967295 & n.total)) {
                                                    e.msg = "incorrect length check", n.mode = A;
                                                    break
                                                }
                                                N = 0, U = 0
                                            }
                                            n.mode = 16208;
                                        case 16208:
                                            Q = d;
                                            break e;
                                        case A:
                                            Q = m;
                                            break e;
                                        case C:
                                            return g;
                                        default:
                                            return f
                                    }
                                    return e.next_out = L, e.avail_out = R, e.next_in = _, e.avail_in = O, n.hold = N, n.bits = U, (n.wsize || H !== e.avail_out && n.mode < A && (n.mode < S || t !== s)) && V(e, e.output, e.next_out, H - e.avail_out) ? (n.mode = C, g) : (F -= e.avail_in, H -= e.avail_out, e.total_in += F, e.total_out += H, n.total += H, 4 & n.wrap && H && (e.adler = n.check = n.flags ? r(n.check, k, H, e.next_out - H) : o(n.check, k, H, e.next_out - H)), e.data_type = n.bits + (n.last ? 64 : 0) + (n.mode === w ? 128 : 0) + (n.mode === I || n.mode === T ? 256 : 0), (0 === F && 0 === H || t === s) && Q === u && (Q = p), Q)
                                }, e.exports.inflateEnd = e => {
                                    if (P(e)) return f;
                                    let t = e.state;
                                    return t.window && (t.window = null), e.state = null, u
                                }, e.exports.inflateGetHeader = (e, t) => {
                                    if (P(e)) return f;
                                    const n = e.state;
                                    return 2 & n.wrap ? (n.head = t, t.done = !1, u) : f
                                }, e.exports.inflateSetDictionary = (e, t) => {
                                    const n = t.length;
                                    let r, a, i;
                                    return P(e) ? f : (r = e.state, 0 !== r.wrap && r.mode !== b ? f : r.mode === b && (a = 1, a = o(a, t, n, 0), a !== r.check) ? m : (i = V(e, t, n, n), i ? (r.mode = C, g) : (r.havedict = 1, u)))
                                }, e.exports.inflateInfo = "pako inflate (from Nodeca project)"
                            },
                            446: e => {
                                const t = new Uint16Array([3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258, 0, 0]),
                                    n = new Uint8Array([16, 16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 18, 18, 18, 18, 19, 19, 19, 19, 20, 20, 20, 20, 21, 21, 21, 21, 16, 72, 78]),
                                    o = new Uint16Array([1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577, 0, 0]),
                                    r = new Uint8Array([16, 16, 16, 16, 17, 17, 18, 18, 19, 19, 20, 20, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 64, 64]);
                                e.exports = (e, a, i, s, l, c, u, d) => {
                                    const h = d.bits;
                                    let f, m, g, p, v, y, b = 0,
                                        w = 0,
                                        x = 0,
                                        T = 0,
                                        I = 0,
                                        E = 0,
                                        S = 0,
                                        A = 0,
                                        C = 0,
                                        M = 0,
                                        D = null;
                                    const P = new Uint16Array(16),
                                        k = new Uint16Array(16);
                                    let _, L, O, R = null;
                                    for (b = 0; b <= 15; b++) P[b] = 0;
                                    for (w = 0; w < s; w++) P[a[i + w]]++;
                                    for (I = h, T = 15; T >= 1 && 0 === P[T]; T--);
                                    if (I > T && (I = T), 0 === T) return l[c++] = 20971520, l[c++] = 20971520, d.bits = 1, 0;
                                    for (x = 1; x < T && 0 === P[x]; x++);
                                    for (I < x && (I = x), A = 1, b = 1; b <= 15; b++)
                                        if (A <<= 1, A -= P[b], A < 0) return -1;
                                    if (A > 0 && (0 === e || 1 !== T)) return -1;
                                    for (k[1] = 0, b = 1; b < 15; b++) k[b + 1] = k[b] + P[b];
                                    for (w = 0; w < s; w++) 0 !== a[i + w] && (u[k[a[i + w]]++] = w);
                                    if (0 === e ? (D = R = u, y = 20) : 1 === e ? (D = t, R = n, y = 257) : (D = o, R = r, y = 0), M = 0, w = 0, b = x, v = c, E = I, S = 0, g = -1, C = 1 << I, p = C - 1, 1 === e && C > 852 || 2 === e && C > 592) return 1;
                                    for (;;) {
                                        _ = b - S, u[w] + 1 < y ? (L = 0, O = u[w]) : u[w] >= y ? (L = R[u[w] - y], O = D[u[w] - y]) : (L = 96, O = 0), f = 1 << b - S, m = 1 << E, x = m;
                                        do {
                                            m -= f, l[v + (M >> S) + m] = _ << 24 | L << 16 | O
                                        } while (0 !== m);
                                        for (f = 1 << b - 1; M & f;) f >>= 1;
                                        if (0 !== f ? (M &= f - 1, M += f) : M = 0, w++, 0 == --P[b]) {
                                            if (b === T) break;
                                            b = a[i + u[w]]
                                        }
                                        if (b > I && (M & p) !== g) {
                                            for (0 === S && (S = I), v += x, E = b - S, A = 1 << E; E + S < T && (A -= P[E + S], !(A <= 0));) E++, A <<= 1;
                                            if (C += 1 << E, 1 === e && C > 852 || 2 === e && C > 592) return 1;
                                            g = M & p, l[g] = I << 24 | E << 16 | v - c
                                        }
                                    }
                                    return 0 !== M && (l[v + M] = b - S << 24 | 64 << 16), d.bits = I, 0
                                }
                            },
                            604: e => {
                                e.exports = {
                                    2: "need dictionary",
                                    1: "stream end",
                                    0: "",
                                    "-1": "file error",
                                    "-2": "stream error",
                                    "-3": "data error",
                                    "-4": "insufficient memory",
                                    "-5": "buffer error",
                                    "-6": "incompatible version"
                                }
                            },
                            249: e => {
                                e.exports = function() {
                                    this.input = null, this.next_in = 0, this.avail_in = 0, this.total_in = 0, this.output = null, this.next_out = 0, this.avail_out = 0, this.total_out = 0, this.msg = "", this.state = null, this.data_type = 2, this.adler = 0
                                }
                            },
                            713: t => {
                                t.exports = e
                            }
                        },
                        n = {};

                    function o(e) {
                        var r = n[e];
                        if (void 0 !== r) return r.exports;
                        var a = n[e] = {
                            exports: {}
                        };
                        return t[e](a, a.exports, o), a.exports
                    }
                    o.d = (e, t) => {
                        for (var n in t) o.o(t, n) && !o.o(e, n) && Object.defineProperty(e, n, {
                            enumerable: !0,
                            get: t[n]
                        })
                    }, o.g = function() {
                        if ("object" == typeof globalThis) return globalThis;
                        try {
                            return this || new Function("return this")()
                        } catch (e) {
                            if ("object" == typeof window) return window
                        }
                    }(), o.o = (e, t) => Object.prototype.hasOwnProperty.call(e, t), o.r = e => {
                        "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {
                            value: "Module"
                        }), Object.defineProperty(e, "__esModule", {
                            value: !0
                        })
                    }, (() => {
                        var e;
                        o.g.importScripts && (e = o.g.location + "");
                        var t = o.g.document;
                        if (!e && t && (t.currentScript && (e = t.currentScript.src), !e)) {
                            var n = t.getElementsByTagName("script");
                            if (n.length)
                                for (var r = n.length - 1; r > -1 && !e;) e = n[r--].src
                        }
                        if (!e) throw new Error("Automatic publicPath is not supported in this browser");
                        e = e.replace(/#.*$/, "").replace(/\?.*$/, "").replace(/\/[^\/]+$/, "/"), o.p = e
                    })();
                    var r = {};
                    return (() => {
                        function e(e, t, n) {
                            if (void 0 === e) throw new Error("decodeRGB: rgbBuffer must not be undefined");
                            if (e.length % 3 != 0) throw new Error("decodeRGB: rgbBuffer length must be divisible by 3");
                            const o = e.length / 3;
                            let r = 0,
                                a = 0;
                            if (n)
                                for (let n = 0; n < o; n++) t[a++] = e[r++], t[a++] = e[r++], t[a++] = e[r++], t[a++] = 255;
                            else t.set(e)
                        }

                        function t(e, t, n) {
                            if (void 0 === e) throw new Error("decodeRGB: rgbBuffer must not be undefined");
                            if (e.length % 3 != 0) throw new Error("decodeRGB: rgbBuffer length must be divisible by 3");
                            const o = e.length / 3;
                            let r = 0,
                                a = 0,
                                i = o,
                                s = 2 * o;
                            if (n)
                                for (let n = 0; n < o; n++) t[r++] = e[a++], t[r++] = e[i++], t[r++] = e[s++], t[r++] = 255;
                            else
                                for (let n = 0; n < o; n++) t[r++] = e[a++], t[r++] = e[i++], t[r++] = e[s++]
                        }

                        function n(e, t, n) {
                            if (void 0 === e) throw new Error("decodeRGB: ybrBuffer must not be undefined");
                            if (e.length % 3 != 0) throw new Error("decodeRGB: ybrBuffer length must be divisble by 3");
                            const o = e.length / 3;
                            let r = 0,
                                a = 0;
                            if (n)
                                for (let n = 0; n < o; n++) {
                                    const n = e[r++],
                                        o = e[r++],
                                        i = e[r++];
                                    t[a++] = n + 1.402 * (i - 128), t[a++] = n - .34414 * (o - 128) - .71414 * (i - 128), t[a++] = n + 1.772 * (o - 128), t[a++] = 255
                                } else
                                    for (let n = 0; n < o; n++) {
                                        const n = e[r++],
                                            o = e[r++],
                                            i = e[r++];
                                        t[a++] = n + 1.402 * (i - 128), t[a++] = n - .34414 * (o - 128) - .71414 * (i - 128), t[a++] = n + 1.772 * (o - 128)
                                    }
                        }

                        function a(e, t, n) {
                            if (void 0 === e) throw new Error("decodeRGB: ybrBuffer must not be undefined");
                            if (e.length % 3 != 0) throw new Error("decodeRGB: ybrBuffer length must be divisble by 3");
                            const o = e.length / 3;
                            let r = 0,
                                a = 0,
                                i = o,
                                s = 2 * o;
                            if (n)
                                for (let n = 0; n < o; n++) {
                                    const n = e[a++],
                                        o = e[i++],
                                        l = e[s++];
                                    t[r++] = n + 1.402 * (l - 128), t[r++] = n - .34414 * (o - 128) - .71414 * (l - 128), t[r++] = n + 1.772 * (o - 128), t[r++] = 255
                                } else
                                    for (let n = 0; n < o; n++) {
                                        const n = e[a++],
                                            o = e[i++],
                                            l = e[s++];
                                        t[r++] = n + 1.402 * (l - 128), t[r++] = n - .34414 * (o - 128) - .71414 * (l - 128), t[r++] = n + 1.772 * (o - 128)
                                    }
                        }
                        o.r(r), o.d(r, {
                            configure: () => Qe,
                            convertColorSpace: () => B,
                            convertPALETTECOLOR: () => Je,
                            convertRGBColorByPixel: () => e,
                            convertRGBColorByPlane: () => t,
                            convertYBRFullByPixel: () => n,
                            convertYBRFullByPlane: () => a,
                            createImage: () => ie,
                            decodeImageFrame: () => te,
                            decodeJPEGBaseline8BitColor: () => V,
                            default: () => et,
                            external: () => Ke,
                            getImageFrame: () => ne,
                            getMinMax: () => N,
                            getPixelData: () => R,
                            internal: () => L,
                            isColorImage: () => oe,
                            isJPEGBaseline8BitColor: () => $e,
                            wadors: () => le,
                            wadouri: () => ze,
                            webWorkerManager: () => Q
                        });
                        const i = function(e, t, n) {
                                return t = t || 0, e && e.Value ? e.Value.length <= t ? n : e.Value[t] : n
                            },
                            s = function(e, t) {
                                const n = i(e, t);
                                if (void 0 !== n) return parseFloat(n)
                            },
                            l = function(e, t) {
                                if (!e) return;
                                if (!e.Value) return;
                                if (!Array.isArray(e.Value)) return;
                                if (t && e.Value.length < t) return;
                                const n = [];
                                for (let t = 0; t < e.Value.length; t++) n.push(parseFloat(e.Value[t]));
                                return n
                            };

                        function c(e) {
                            const t = e.indexOf(":");
                            return e.substring(t + 1)
                        }

                        function u(e) {
                            let t = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1];
                            return e && e.Value ? e.Value[0] && t ? e.Value[0] : e.Value : e
                        }

                        function d(e, t, n) {
                            return {
                                shared: (t ? Object.values(t[0]) : []).map((e => e[0])).filter((e => void 0 !== e && "object" == typeof e)),
                                perFrame: (e ? Object.values(e[n - 1]) : []).map((e => e.Value[0])).filter((e => void 0 !== e && "object" == typeof e))
                            }
                        }

                        function h(e) {
                            let {
                                52009230: t,
                                52009229: n,
                                "00280008": o,
                                ...r
                            } = e;
                            return t = u(t, !1), n = u(n, !1), o = u(o), {
                                PerFrameFunctionalGroupsSequence: t,
                                SharedFunctionalGroupsSequence: n,
                                NumberOfFrames: o,
                                rest: r
                            }
                        }

                        function f(e) {
                            const t = e.indexOf("/frames/") + 8,
                                n = e.slice(0, t),
                                o = parseInt(e.slice(t), 10);
                            return {
                                metadata: g[`${n}1`],
                                frame: o
                            }
                        }
                        const m = {
                            _retrieveMultiframeMetadata: f,
                            retrieveMultiframeMetadata: function(e) {
                                return f(c(e))
                            },
                            isMultiframe: function(e) {
                                const t = i(e["00280008"]);
                                return t && t > 1
                            }
                        };
                        let g = [],
                            p = {};
                        const v = {
                            add: function(e, t) {
                                const n = c(e);
                                t.isMultiframe = m.isMultiframe(t), g[n] = t
                            },
                            get: function(e) {
                                const t = c(e),
                                    n = g[t];
                                if (n && !n ? .isMultiframe) return n;
                                const o = p[t];
                                if (o) return o;
                                const r = m._retrieveMultiframeMetadata(t);
                                if (!r || !r.metadata) return;
                                const {
                                    metadata: a,
                                    frame: i
                                } = r;
                                if (a) {
                                    const e = function(e, t) {
                                        const {
                                            PerFrameFunctionalGroupsSequence: n,
                                            SharedFunctionalGroupsSequence: o,
                                            NumberOfFrames: r,
                                            rest: a
                                        } = h(t);
                                        if (n || r > 1) {
                                            const {
                                                shared: i,
                                                perFrame: s
                                            } = d(n, o, e), l = Object.assign(t, {
                                                frameNumber: e
                                            });
                                            return [...i, ...s].forEach((e => {
                                                Object.entries(e).forEach((e => {
                                                    let [t, n] = e;
                                                    l[t] = n
                                                }))
                                            })), Object.assign(a, {
                                                "00280008": r
                                            }, l)
                                        }
                                        return t
                                    }(i, a);
                                    return p[t] = e, e
                                }
                            },
                            remove: function(e) {
                                const t = c(e);
                                g[t] = void 0, p[t] = void 0
                            },
                            purge: function() {
                                g = [], p = {}
                            }
                        };

                        function y(e) {
                            return "RECON TOMO" === e || "RECON GATED TOMO" === e
                        }

                        function b(e) {
                            return i(e["00080060"]).includes("NM")
                        }

                        function w(e, t) {
                            const n = u(e["00080008"], !1);
                            if (n) return n[t]
                        }

                        function x(e) {
                            let t = l(e["00200037"], 6);
                            return !t && b(e) && (t = function(e) {
                                let t;
                                const n = w(e, 2);
                                if (n && y(n)) {
                                    const n = u(e["00540022"]);
                                    n && (t = l(n["00200037"], 6))
                                }
                                return t
                            }(e)), t
                        }

                        function T(e) {
                            let t = l(e["00200032"], 3);
                            return !t && b(e) && (t = function(e) {
                                let t;
                                const n = w(e, 2);
                                if (n && y(n)) {
                                    const n = u(e["00540022"]);
                                    n && (t = l(n["00200032"], 3))
                                }
                                return t
                            }(e)), t
                        }

                        function I(e, t, n) {
                            const o = {};
                            for (const r of n) try {
                                const n = t(r, e);
                                if (n) {
                                    const e = {};
                                    for (const t in n) t in n && (e[E(t)] = n[t]);
                                    Object.assign(o, e)
                                }
                            } catch (e) {
                                console.error(`Error retrieving ${r} data:`, e)
                            }
                            return o
                        }
                        const E = e => e.charAt(0).toUpperCase() + e.slice(1),
                            S = ["multiframeModule", "generalSeriesModule", "patientStudyModule", "imagePlaneModule", "nmMultiframeGeometryModule", "imagePixelModule", "modalityLutModule", "voiLutModule", "sopCommonModule", "petIsotopeModule", "overlayPlaneModule", "transferSyntax", "petSeriesModule", "petImageModule"],
                            A = function e(t, n) {
                                if ("multiframeModule" === t) {
                                    const {
                                        metadata: e,
                                        frame: t
                                    } = m.retrieveMultiframeMetadata(n);
                                    if (!e) return;
                                    const {
                                        PerFrameFunctionalGroupsSequence: o,
                                        SharedFunctionalGroupsSequence: r,
                                        NumberOfFrames: a
                                    } = h(e);
                                    if (o || a > 1) {
                                        const {
                                            shared: e,
                                            perFrame: n
                                        } = d(o, r, t);
                                        return {
                                            NumberOfFrames: a,
                                            PerFrameFunctionalInformation: n,
                                            SharedFunctionalInformation: e
                                        }
                                    }
                                    return {
                                        NumberOfFrames: a
                                    }
                                }
                                const {
                                    dicomParser: o
                                } = Ke, r = v.get(n);
                                if (r) {
                                    if ("generalSeriesModule" === t) return {
                                        modality: i(r["00080060"]),
                                        seriesInstanceUID: i(r["0020000E"]),
                                        seriesNumber: s(r["00200011"]),
                                        studyInstanceUID: i(r["0020000D"]),
                                        seriesDate: o.parseDA(i(r["00080021"])),
                                        seriesTime: o.parseTM(i(r["00080031"], 0, "")),
                                        acquisitionDate: o.parseDA(i(r["00080022"]), ""),
                                        acquisitionTime: o.parseTM(i(r["00080032"], 0, ""))
                                    };
                                    if ("patientStudyModule" === t) return {
                                        patientAge: s(r["00101010"]),
                                        patientSize: s(r["00101020"]),
                                        patientSex: i(r["00100040"]),
                                        patientWeight: s(r["00101030"])
                                    };
                                    if ("nmMultiframeGeometryModule" === t) {
                                        const e = i(r["00080060"]),
                                            t = w(r, 2);
                                        return {
                                            modality: e,
                                            imageType: i(r["00080008"]),
                                            imageSubType: t,
                                            imageOrientationPatient: x(r),
                                            imagePositionPatient: T(r),
                                            sliceThickness: s(r["00180050"]),
                                            pixelSpacing: l(r["00280030"], 2),
                                            numberOfFrames: s(r["00280008"]),
                                            isNMReconstructable: y(t) && e.includes("NM")
                                        }
                                    }
                                    if ("imagePlaneModule" === t) {
                                        const e = x(r),
                                            t = T(r),
                                            n = l(r["00280030"], 2);
                                        let o = null,
                                            a = null;
                                        n && (a = n[0], o = n[1]);
                                        let c = null,
                                            u = null;
                                        return e && (c = [parseFloat(e[0]), parseFloat(e[1]), parseFloat(e[2])], u = [parseFloat(e[3]), parseFloat(e[4]), parseFloat(e[5])]), {
                                            frameOfReferenceUID: i(r["00200052"]),
                                            rows: s(r["00280010"]),
                                            columns: s(r["00280011"]),
                                            imageOrientationPatient: e,
                                            rowCosines: c,
                                            columnCosines: u,
                                            imagePositionPatient: t,
                                            sliceThickness: s(r["00180050"]),
                                            sliceLocation: s(r["00201041"]),
                                            pixelSpacing: n,
                                            rowPixelSpacing: a,
                                            columnPixelSpacing: o
                                        }
                                    }
                                    if ("imagePixelModule" === t) return {
                                        samplesPerPixel: s(r["00280002"]),
                                        photometricInterpretation: i(r["00280004"]),
                                        rows: s(r["00280010"]),
                                        columns: s(r["00280011"]),
                                        bitsAllocated: s(r["00280100"]),
                                        bitsStored: s(r["00280101"]),
                                        highBit: i(r["00280102"]),
                                        pixelRepresentation: s(r["00280103"]),
                                        planarConfiguration: s(r["00280006"]),
                                        pixelAspectRatio: i(r["00280034"]),
                                        smallestPixelValue: s(r["00280106"]),
                                        largestPixelValue: s(r["00280107"]),
                                        redPaletteColorLookupTableDescriptor: l(r["00281101"]),
                                        greenPaletteColorLookupTableDescriptor: l(r["00281102"]),
                                        bluePaletteColorLookupTableDescriptor: l(r["00281103"]),
                                        redPaletteColorLookupTableData: l(r["00281201"]),
                                        greenPaletteColorLookupTableData: l(r["00281202"]),
                                        bluePaletteColorLookupTableData: l(r["00281203"])
                                    };
                                    if ("voiLutModule" === t) return {
                                        windowCenter: l(r["00281050"], 1),
                                        windowWidth: l(r["00281051"], 1)
                                    };
                                    if ("modalityLutModule" === t) return {
                                        rescaleIntercept: s(r["00281052"]),
                                        rescaleSlope: s(r["00281053"]),
                                        rescaleType: i(r["00281054"])
                                    };
                                    if ("sopCommonModule" === t) return {
                                        sopClassUID: i(r["00080016"]),
                                        sopInstanceUID: i(r["00080018"])
                                    };
                                    if ("petIsotopeModule" === t) {
                                        const e = i(r["00540016"]);
                                        if (void 0 === e) return;
                                        return {
                                            radiopharmaceuticalInfo: {
                                                radiopharmaceuticalStartTime: o.parseTM(i(e["00181072"], 0, "")),
                                                radiopharmaceuticalStartDateTime: i(e["00181078"], 0, ""),
                                                radionuclideTotalDose: s(e["00181074"]),
                                                radionuclideHalfLife: s(e["00181075"])
                                            }
                                        }
                                    }
                                    return "overlayPlaneModule" === t ? function(e) {
                                        const t = [];
                                        for (let n = 0; n <= 30; n += 2) {
                                            let o = `x60${n.toString(16)}`;
                                            4 === o.length && (o = `x600${n.toString(16)}`);
                                            const r = i(e[`${o}3000`]);
                                            if (!r) continue;
                                            const a = [];
                                            for (let t = 0; t < r.length; t++)
                                                for (let n = 0; n < 8; n++) {
                                                    const o = e.Value[r.dataOffset + t];
                                                    a[8 * t + n] = o >> n & 1
                                                }
                                            t.push({
                                                rows: s(e[`${o}0010`]),
                                                columns: s(e[`${o}0011`]),
                                                type: i(e[`${o}0040`]),
                                                x: s(e[`${o}0050`], 1) - 1,
                                                y: s(e[`${o}0050`], 0) - 1,
                                                pixelData: a,
                                                description: i(e[`${o}0022`]),
                                                label: i(e[`${o}1500`]),
                                                roiArea: i(e[`${o}1301`]),
                                                roiMean: i(e[`${o}1302`]),
                                                roiStandardDeviation: i(e[`${o}1303`])
                                            })
                                        }
                                        return {
                                            overlays: t
                                        }
                                    }(r) : "transferSyntax" === t ? {
                                        transferSyntaxUID: i(r["00020010"])
                                    } : "petSeriesModule" === t ? {
                                        correctedImage: i(r["00280051"]),
                                        units: i(r["00541001"]),
                                        decayCorrection: i(r["00541102"])
                                    } : "petImageModule" === t ? {
                                        frameReferenceTime: s(r["00541300"]),
                                        actualFrameDuration: s(r["00181242"])
                                    } : "instance" === t ? I(n, e, S) : void 0
                                }
                            };

                        function C(e, t, n) {
                            if (n + e.length > t.length) return !1;
                            let o = n;
                            for (let n = 0; n < e.length; n++)
                                if (e[n] !== t[o++]) return !1;
                            return !0
                        }
                        const M = function(e, t, n) {
                            n = n || 0;
                            const o = function(e) {
                                const t = new Uint8Array(e.length);
                                for (let n = 0, o = e.length; n < o; n++) t[n] = e.charCodeAt(n);
                                return t
                            }(t);
                            for (let t = n; t < e.length; t++)
                                if (o[0] === e[t] && C(o, e, t)) return t;
                            return -1
                        };
                        let D = {
                            open(e, t) {
                                e.open("get", t, !0)
                            },
                            beforeSend() {},
                            beforeProcessing: e => Promise.resolve(e.response),
                            imageCreated() {},
                            strict: !1,
                            decodeConfig: {
                                convertFloatPixelDataToInt: !0,
                                use16BitDataType: !1
                            }
                        };

                        function P(e) {
                            D = Object.assign(D, e)
                        }

                        function k() {
                            return D
                        }
                        const _ = function(e, t) {
                                let n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                                    o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : {};
                                const {
                                    cornerstone: r
                                } = Ke, a = k(), i = e => {
                                    if ("function" == typeof a.errorInterceptor) {
                                        const t = new Error("request failed");
                                        t.request = e, t.response = e.response, t.status = e.status, a.errorInterceptor(t)
                                    }
                                }, s = new XMLHttpRequest, l = new Promise(((l, c) => {
                                    a.open(s, e, n, o);
                                    const u = a.beforeSend(s, t, n, o);
                                    s.responseType = "arraybuffer";
                                    const d = Object.assign({}, n, u);
                                    Object.keys(d).forEach((function(t) {
                                        null !== d[t] && ("Accept" === t && -1 !== e.indexOf("accept=") || s.setRequestHeader(t, d[t]))
                                    })), o.deferred = {
                                        resolve: l,
                                        reject: c
                                    }, o.url = e, o.imageId = t, s.onloadstart = function(n) {
                                        a.onloadstart && a.onloadstart(n, o);
                                        const i = {
                                            url: e,
                                            imageId: t
                                        };
                                        r.triggerEvent(r.events, "cornerstoneimageloadstart", i)
                                    }, s.onloadend = function(n) {
                                        a.onloadend && a.onloadend(n, o);
                                        const i = {
                                            url: e,
                                            imageId: t
                                        };
                                        r.triggerEvent(r.events, "cornerstoneimageloadend", i)
                                    }, s.onreadystatechange = function(e) {
                                        a.onreadystatechange ? a.onreadystatechange(e, o) : 4 === s.readyState && (200 === s.status ? a.beforeProcessing(s).then(l).catch((() => {
                                            i(s), c(s)
                                        })) : (i(s), c(s)))
                                    }, s.onprogress = function(e) {
                                        const t = e.loaded;
                                        let n, r;
                                        e.lengthComputable && (n = e.total, r = Math.round(t / n * 100)), a.onprogress && a.onprogress(e, o)
                                    }, s.onerror = function() {
                                        i(s), c(s)
                                    }, s.onabort = function() {
                                        i(s), c(s)
                                    }, s.send()
                                }));
                                return l.xhr = s, l
                            },
                            L = {
                                xhrRequest: _,
                                setOptions: P,
                                getOptions: k
                            };

                        function O(e) {
                            for (let t = 0; t < e.length; t++)
                                if ("Content-Type:" === e[t].substr(0, 13)) return e[t].substr(13).trim()
                        }
                        const R = function(e, t) {
                                const n = {
                                    Accept: arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : "application/octet-stream"
                                };
                                return new Promise(((o, r) => {
                                    const a = _(e, t, n),
                                        {
                                            xhr: i
                                        } = a;
                                    a.then((function(e) {
                                        const t = new Uint8Array(e),
                                            n = i.getResponseHeader("Content-Type") || "application/octet-stream";
                                        if (-1 === n.indexOf("multipart")) return void o({
                                            contentType: n,
                                            imageFrame: {
                                                pixelData: t
                                            }
                                        });
                                        const a = M(t, "\r\n\r\n"); - 1 === a && r(new Error("invalid response - no multipart mime header"));
                                        const s = function(e, t, n) {
                                                t = t || 0, n = n || e.length - t;
                                                let o = "";
                                                for (let r = t; r < t + n; r++) o += String.fromCharCode(e[r]);
                                                return o
                                            }(t, 0, a),
                                            l = s.split("\r\n"),
                                            c = function(e) {
                                                for (let t = 0; t < e.length; t++)
                                                    if ("--" === e[t].substr(0, 2)) return e[t]
                                            }(l);
                                        c || r(new Error("invalid response - no boundary marker"));
                                        const u = a + 4,
                                            d = M(t, c, u); - 1 === d && r(new Error("invalid response - terminating boundary not found"));
                                        const h = d - u - 2;
                                        o({
                                            contentType: O(l),
                                            imageFrame: {
                                                pixelData: new Uint8Array(e, u, h)
                                            }
                                        })
                                    }), r)
                                }))
                            },
                            N = function(e) {
                                let t, n = e[0],
                                    o = e[0];
                                const r = e.length;
                                for (let a = 1; a < r; a++) t = e[a], n = Math.min(n, t), o = Math.max(o, t);
                                return {
                                    min: n,
                                    max: o
                                }
                            };

                        function U(n, o, r) {
                            0 === n.planarConfiguration ? e(n.pixelData, o, r) : t(n.pixelData, o, r)
                        }

                        function B(e, t, o) {
                            if ("RGB" === e.photometricInterpretation) U(e, t, o);
                            else if ("YBR_RCT" === e.photometricInterpretation) U(e, t, o);
                            else if ("YBR_ICT" === e.photometricInterpretation) U(e, t, o);
                            else if ("PALETTE COLOR" === e.photometricInterpretation) Je(e, t, o);
                            else if ("YBR_FULL_422" === e.photometricInterpretation) ! function(e, t, n) {
                                if (void 0 === e) throw new Error("decodeRGB: ybrBuffer must not be undefined");
                                if (e.length % 2 != 0) throw new Error("decodeRGB: ybrBuffer length must be divisble by 3");
                                const o = e.length / 2;
                                let r = 0,
                                    a = 0;
                                if (n)
                                    for (let n = 0; n < o; n += 2) {
                                        const n = e[r++],
                                            o = e[r++],
                                            i = e[r++],
                                            s = e[r++];
                                        t[a++] = n + 1.402 * (s - 128), t[a++] = n - .34414 * (i - 128) - .71414 * (s - 128), t[a++] = n + 1.772 * (i - 128), t[a++] = 255, t[a++] = o + 1.402 * (s - 128), t[a++] = o - .34414 * (i - 128) - .71414 * (s - 128), t[a++] = o + 1.772 * (i - 128), t[a++] = 255
                                    } else
                                        for (let n = 0; n < o; n += 2) {
                                            const n = e[r++],
                                                o = e[r++],
                                                i = e[r++],
                                                s = e[r++];
                                            t[a++] = n + 1.402 * (s - 128), t[a++] = n - .34414 * (i - 128) - .71414 * (s - 128), t[a++] = n + 1.772 * (i - 128), t[a++] = o + 1.402 * (s - 128), t[a++] = o - .34414 * (i - 128) - .71414 * (s - 128), t[a++] = o + 1.772 * (i - 128)
                                        }
                            }(e.pixelData, t, o);
                            else {
                                if ("YBR_FULL" !== e.photometricInterpretation) throw new Error(`No color space conversion for photometric interpretation ${e.photometricInterpretation}`);
                                ! function(e, t, o) {
                                    0 === e.planarConfiguration ? n(e.pixelData, t, o) : a(e.pixelData, t, o)
                                }(e, t, o)
                            }
                        }
                        const V = function(e, t, n) {
                            const o = (new Date).getTime(),
                                r = new Blob([t], {
                                    type: "image/jpeg"
                                });
                            return new Promise(((t, a) => {
                                const i = new FileReader;
                                void 0 === i.readAsBinaryString ? i.readAsArrayBuffer(r) : i.readAsBinaryString(r), i.onload = function() {
                                    const r = new Image;
                                    r.onload = function() {
                                        n.height = r.height, n.width = r.width, e.rows = r.height, e.columns = r.width;
                                        const a = n.getContext("2d");
                                        a.drawImage(this, 0, 0);
                                        const i = a.getImageData(0, 0, r.width, r.height),
                                            s = (new Date).getTime();
                                        e.pixelData = new Uint8Array(i.data.buffer), e.imageData = i, e.decodeTimeInMS = s - o;
                                        const l = N(e.pixelData);
                                        e.smallestPixelValue = l.min, e.largestPixelValue = l.max, e.pixelDataLength = e.pixelData.length, t(e)
                                    }, r.onerror = function(e) {
                                        a(e)
                                    }, void 0 === i.readAsBinaryString ? r.src = `data:image/jpeg;base64,${window.btoa(function(e){return function(e){let t;try{return decodeURIComponent(escape(e))}catch(n){if(t=n,t instanceof URIError)return e;throw t}}(String.fromCharCode.apply(null,Array.prototype.slice.apply(new Uint8Array(e))))}(i.result))}` : r.src = `data:image/jpeg;base64,${window.btoa(i.result)}`
                                }, i.onerror = e => {
                                    a(e)
                                }
                            }))
                        };

                        function F() {
                            return new Worker(o.p + "index.worker.e62ecca63f1a2e124230.worker.js")
                        }
                        let H = 0;
                        const q = [],
                            j = [],
                            z = k(),
                            W = {
                                maxWebWorkers: navigator.hardwareConcurrency || 1,
                                startWebWorkersOnDemand: !0,
                                webWorkerTaskPaths: [],
                                taskConfiguration: {
                                    decodeTask: {
                                        initializeCodecsOnStartup: !1,
                                        strict: z.strict
                                    }
                                }
                            };
                        let G;
                        const Y = {
                            maxWebWorkers: 0,
                            numWebWorkers: 0,
                            numTasksQueued: 0,
                            numTasksExecuting: 0,
                            numTasksCompleted: 0,
                            totalTaskTimeInMS: 0,
                            totalTimeDelayedInMS: 0
                        };

                        function Z() {
                            if (q.length) {
                                for (let e = 0; e < j.length; e++)
                                    if ("ready" === j[e].status) {
                                        j[e].status = "busy";
                                        const t = q.shift();
                                        t.start = (new Date).getTime();
                                        const n = (new Date).getTime();
                                        return Y.totalTimeDelayedInMS += n - t.added, j[e].task = t, j[e].worker.postMessage({
                                            taskType: t.taskType,
                                            workerIndex: e,
                                            data: t.data
                                        }, t.transferList), void Y.numTasksExecuting++
                                    }
                                j.length < G.maxWebWorkers && X()
                            }
                        }

                        function K(e) {
                            if ("initialize" === e.data.taskType) j[e.data.workerIndex].status = "ready", Z();
                            else {
                                const t = j[e.data.workerIndex].task.start,
                                    n = "success" === e.data.status ? "resolve" : "reject";
                                try {
                                    j[e.data.workerIndex].task.deferred[n](e.data.result)
                                } catch (e) {
                                    console.warn("Caught error delivering response", e)
                                }
                                j[e.data.workerIndex].task = void 0, Y.numTasksExecuting--, j[e.data.workerIndex].status = "ready", Y.numTasksCompleted++;
                                const o = (new Date).getTime();
                                Y.totalTaskTimeInMS += o - t, Z()
                            }
                        }

                        function X() {
                            if (j.length >= G.maxWebWorkers) return;
                            const e = new F;
                            j.push({
                                worker: e,
                                status: "initializing"
                            }), e.addEventListener("message", K), e.postMessage({
                                taskType: "initialize",
                                workerIndex: j.length - 1,
                                config: G
                            })
                        }

                        function J(e) {
                            if (G = e = e || W, G.maxWebWorkers = G.maxWebWorkers || navigator.hardwareConcurrency || 1, !G.startWebWorkersOnDemand)
                                for (let e = 0; e < G.maxWebWorkers; e++) X()
                        }
                        const Q = {
                            initialize: J,
                            loadWebWorkerTask: function(e, t) {
                                G.webWorkerTaskPaths.push(e), t && (G.taskConfiguration = Object.assign(G.taskConfiguration, t));
                                for (let t = 0; t < j.length; t++) j[t].worker.postMessage({
                                    taskType: "loadWebWorkerTask",
                                    workerIndex: j.length - 1,
                                    sourcePath: e,
                                    config: G
                                })
                            },
                            addTask: function(e, t) {
                                let n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0,
                                    o = arguments.length > 3 ? arguments[3] : void 0;
                                G || J();
                                let r = {
                                    resolve: void 0,
                                    reject: void 0
                                };
                                const a = new Promise(((e, t) => {
                                    r = {
                                        resolve: e,
                                        reject: t
                                    }
                                }));
                                let i;
                                for (i = 0; i < q.length && !(q[i].priority < n); i++);
                                const s = H++;
                                return q.splice(i, 0, {
                                    taskId: s,
                                    taskType: e,
                                    status: "ready",
                                    added: (new Date).getTime(),
                                    data: t,
                                    deferred: r,
                                    priority: n,
                                    transferList: o
                                }), Z(), {
                                    taskId: s,
                                    promise: a
                                }
                            },
                            getStatistics: function() {
                                return Y.maxWebWorkers = G.maxWebWorkers, Y.numWebWorkers = j.length, Y.numTasksQueued = q.length, Y
                            },
                            setTaskPriority: function(e) {
                                let t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
                                for (let n = 0; n < q.length; n++)
                                    if (q[n].taskId === e) {
                                        const e = q.splice(n, 1)[0];
                                        for (e.priority = t, n = 0; n < q.length && !(q[n].priority < t); n++);
                                        return q.splice(n, 0, e), !0
                                    }
                                return !1
                            },
                            cancelTask: function(e, t) {
                                for (let n = 0; n < q.length; n++)
                                    if (q[n].taskId === e) return q.splice(n, 1).deferred.reject(t), !0;
                                return !1
                            },
                            webWorkers: j,
                            terminate: function() {
                                for (let e = 0; e < j.length; e++) j[e].worker.terminate();
                                j.length = 0, G = void 0
                            }
                        };
                        var $ = o(578);

                        function ee(e, t, n, o, r) {
                            const a = o.priority || void 0,
                                i = o.transferPixelData ? [n.buffer] : void 0;
                            return Q.addTask("decodeTask", {
                                imageFrame: e,
                                transferSyntax: t,
                                pixelData: n,
                                options: o,
                                decodeConfig: r
                            }, a, i).promise
                        }
                        window.pako = {
                            inflateRaw: $.Hq
                        };
                        const te = function(e, t, n, o) {
                                let r = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : {},
                                    a = arguments.length > 5 ? arguments[5] : void 0;
                                switch (t) {
                                    case "1.2.840.10008.1.2":
                                    case "1.2.840.10008.1.2.1":
                                    case "1.2.840.10008.1.2.2":
                                    case "1.2.840.10008.1.2.1.99":
                                    case "1.2.840.10008.1.2.5":
                                    case "1.2.840.10008.1.2.4.51":
                                    case "1.2.840.10008.1.2.4.57":
                                    case "1.2.840.10008.1.2.4.70":
                                    case "1.2.840.10008.1.2.4.80":
                                    case "1.2.840.10008.1.2.4.81":
                                    case "1.2.840.10008.1.2.4.90":
                                    case "1.2.840.10008.1.2.4.91":
                                    case "3.2.840.10008.1.2.4.96":
                                        return ee(e, t, n, r, a);
                                    case "1.2.840.10008.1.2.4.50":
                                        return 8 !== e.bitsAllocated || 3 !== e.samplesPerPixel && 4 !== e.samplesPerPixel ? ee(e, t, n, r, a) : V(e, n, o)
                                }
                                return Promise.reject(new Error(`No decoder for transfer syntax ${t}`))
                            },
                            ne = function(e) {
                                const {
                                    cornerstone: t
                                } = Ke, n = t.metaData.get("imagePixelModule", e);
                                return {
                                    samplesPerPixel: n.samplesPerPixel,
                                    photometricInterpretation: n.photometricInterpretation,
                                    planarConfiguration: n.planarConfiguration,
                                    rows: n.rows,
                                    columns: n.columns,
                                    bitsAllocated: n.bitsAllocated,
                                    bitsStored: n.bitsStored,
                                    pixelRepresentation: n.pixelRepresentation,
                                    smallestPixelValue: n.smallestPixelValue,
                                    largestPixelValue: n.largestPixelValue,
                                    redPaletteColorLookupTableDescriptor: n.redPaletteColorLookupTableDescriptor,
                                    greenPaletteColorLookupTableDescriptor: n.greenPaletteColorLookupTableDescriptor,
                                    bluePaletteColorLookupTableDescriptor: n.bluePaletteColorLookupTableDescriptor,
                                    redPaletteColorLookupTableData: n.redPaletteColorLookupTableData,
                                    greenPaletteColorLookupTableData: n.greenPaletteColorLookupTableData,
                                    bluePaletteColorLookupTableData: n.bluePaletteColorLookupTableData,
                                    pixelData: void 0,
                                    imageId: e
                                }
                            };

                        function oe(e) {
                            return "RGB" === e || "PALETTE COLOR" === e || "YBR_FULL" === e || "YBR_FULL_422" === e || "YBR_PARTIAL_422" === e || "YBR_PARTIAL_420" === e || "YBR_RCT" === e || "YBR_ICT" === e
                        }
                        const re = {
                            "1.2.840.10008.1.2.1": "application/octet-stream",
                            "1.2.840.10008.1.2": "application/octet-stream",
                            "1.2.840.10008.1.2.2": "application/octet-stream",
                            "1.2.840.10008.1.2.5": "image/dicom-rle"
                        };
                        let ae = "";
                        const ie = function(e, t, n) {
                                let o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : {};
                                const r = o.useRGBA;
                                if (o.preScale = {
                                        enabled: !(!o.preScale || void 0 === o.preScale.enabled) && o.preScale.enabled
                                    }, !t || !t.length) return Promise.reject(new Error("The file does not contain image data."));
                                const {
                                    cornerstone: a
                                } = Ke, i = document.createElement("canvas"), s = ne(e);
                                if (o.preScale.enabled) {
                                    const t = function(e, t) {
                                        const n = e.get("modalityLutModule", t) || {},
                                            o = e.get("generalSeriesModule", t) || {},
                                            {
                                                modality: r
                                            } = o,
                                            a = {
                                                rescaleSlope: n.rescaleSlope,
                                                rescaleIntercept: n.rescaleIntercept,
                                                modality: r
                                            },
                                            i = e.get("scalingModule", t) || {};
                                        return { ...a,
                                            ..."PT" === r && {
                                                suvbw: i.suvbw
                                            }
                                        }
                                    }(a.metaData, e);
                                    t && (o.preScale = { ...o.preScale,
                                        scalingParameters: t
                                    })
                                }
                                o.isSharedArrayBuffer = o.targetBuffer ? .arrayBuffer && o.targetBuffer.arrayBuffer instanceof SharedArrayBuffer;
                                const {
                                    decodeConfig: l
                                } = k(), c = te(s, n, t, i, o, l), {
                                    use16BitDataType: u
                                } = l, d = oe(s.photometricInterpretation);
                                return new Promise(((t, s) => {
                                    c.then((function(s) {
                                        if (o.skipCreateImage) return t(s);
                                        let l = !1;
                                        if (o.targetBuffer && o.targetBuffer.type && !d) {
                                            const {
                                                arrayBuffer: e,
                                                type: t,
                                                offset: n = 0,
                                                length: r
                                            } = o.targetBuffer, a = s.pixelDataLength, i = n, c = null != r ? r : a - i, d = {
                                                Uint8Array,
                                                Uint16Array: u ? Uint16Array : void 0,
                                                Int16Array: u ? Int16Array : void 0,
                                                Float32Array
                                            };
                                            if (c !== s.pixelDataLength) throw new Error(`target array for image does not have the same length (${c}) as the decoded image length (${s.pixelDataLength}).`);
                                            const h = d[t],
                                                f = e ? new h(e, i, c) : new h(s.pixelData);
                                            if (c !== s.pixelDataLength) throw new Error("target array for image does not have the same length as the decoded image length.");
                                            s.pixelData = f, l = !0
                                        }
                                        l || function(e) {
                                            const t = function(e, t) {
                                                let n;
                                                return Number.isInteger(e) && Number.isInteger(t) ? e >= 0 ? t <= 255 ? n = Uint8Array : t <= 65535 && (n = Uint16Array) : e >= -128 && t <= 127 ? n = Int8Array : e >= -32768 && t <= 32767 && (n = Int16Array) : n = Float32Array, n
                                            }(e.smallestPixelValue, e.largestPixelValue);
                                            if (!t) throw new Error("Could not apply a typed array to the pixel data"); {
                                                const n = new t(e.pixelData);
                                                e.pixelData = n
                                            }
                                        }(s);
                                        const c = a.metaData.get("imagePlaneModule", e) || {},
                                            h = a.metaData.get("voiLutModule", e) || {},
                                            f = a.metaData.get("modalityLutModule", e) || {},
                                            m = a.metaData.get("sopCommonModule", e) || {};
                                        if (d) {
                                            const {
                                                rows: e,
                                                columns: t
                                            } = s;
                                            if (re[n]) {
                                                i.height = s.rows, i.width = s.columns;
                                                const e = i.getContext("2d").createImageData(s.columns, s.rows);
                                                B(s, e.data, r), s.imageData = e, s.pixelData = e.data, s.pixelDataLength = e.data.length
                                            } else if (!r && s.pixelDataLength === 4 * e * t) {
                                                const e = new Uint8Array(s.pixelData.length / 4 * 3);
                                                s.pixelData = function(e, t) {
                                                    const n = e.length / 4;
                                                    let o = 0,
                                                        r = 0;
                                                    for (let a = 0; a < n; a++) t[r++] = e[o++], t[r++] = e[o++], t[r++] = e[o++], o++;
                                                    return t
                                                }(s.pixelData, e), s.pixelDataLength = s.pixelData.length
                                            }
                                            const o = N(s.pixelData);
                                            s.smallestPixelValue = o.min, s.largestPixelValue = o.max
                                        }
                                        const g = {
                                            imageId: e,
                                            color: d,
                                            columnPixelSpacing: c.columnPixelSpacing,
                                            columns: s.columns,
                                            height: s.rows,
                                            preScale: s.preScale,
                                            intercept: f.rescaleIntercept ? f.rescaleIntercept : 0,
                                            slope: f.rescaleSlope ? f.rescaleSlope : 1,
                                            invert: "MONOCHROME1" === s.photometricInterpretation,
                                            minPixelValue: s.smallestPixelValue,
                                            maxPixelValue: s.largestPixelValue,
                                            rowPixelSpacing: c.rowPixelSpacing,
                                            rows: s.rows,
                                            sizeInBytes: s.pixelData.byteLength,
                                            width: s.columns,
                                            windowCenter: h.windowCenter ? h.windowCenter[0] : void 0,
                                            windowWidth: h.windowWidth ? h.windowWidth[0] : void 0,
                                            voiLUTFunction: h.voiLUTFunction ? h.voiLUTFunction : void 0,
                                            decodeTimeInMS: s.decodeTimeInMS,
                                            floatPixelData: void 0,
                                            imageFrame: s,
                                            rgba: d && r,
                                            getPixelData: () => s.pixelData,
                                            getCanvas: void 0,
                                            numComps: void 0
                                        };
                                        var p;
                                        if (window.image = g, g.color && (g.getCanvas = function() {
                                                if (ae === e) return i;
                                                const t = g.columns,
                                                    n = g.rows;
                                                i.height = n, i.width = t;
                                                const o = i.getContext("2d"),
                                                    r = o.createImageData(t, n),
                                                    a = s.pixelData;
                                                if (a.length === t * n * 4)
                                                    for (let e = 0; e < a.length; e++) r.data[e] = a[e];
                                                else if (a.length === t * n * 3) {
                                                    let e = 0;
                                                    for (let t = 0; t < a.length; t += 3) r.data[e++] = a[t], r.data[e++] = a[t + 1], r.data[e++] = a[t + 2], r.data[e++] = 255
                                                }
                                                return s.pixelData = r.data, s.pixelDataLength = r.data.length, s.imageData = r, o.putImageData(s.imageData, 0, 0), ae = e, i
                                            }), f.modalityLUTSequence && f.modalityLUTSequence.length > 0 && "1.2.840.10008.5.1.4.1.1.12.1" !== (p = m.sopClassUID) && "1.2.840.10008.5.1.4.1.1.12.2.1" !== p && (g.modalityLUT = f.modalityLUTSequence[0]), h.voiLUTSequence && h.voiLUTSequence.length > 0 && (g.voiLUT = h.voiLUTSequence[0]), g.color && (g.windowWidth = 256, g.windowCenter = 128), void 0 === g.windowCenter || void 0 === g.windowWidth) {
                                            const e = g.imageFrame.minAfterScale,
                                                t = g.imageFrame.maxAfterScale;
                                            g.windowWidth = t - e, g.windowCenter = (t + e) / 2
                                        }
                                        t(g)
                                    }), s)
                                }))
                            },
                            se = function(e) {
                                let t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};
                                const n = Ke.cornerstone.imageRetrievalPoolManager,
                                    o = (new Date).getTime();
                                return {
                                    promise: new Promise(((r, a) => {
                                        const i = t.requestType || "interaction",
                                            s = t.additionalDetails || {
                                                imageId: e
                                            },
                                            l = void 0 === t.priority ? 5 : t.priority,
                                            c = t.addToBeginning || !1,
                                            u = e.substring(7);
                                        n.addRequest(function(e, n, i) {
                                            return R(e, n, i).then((e => {
                                                const i = function(e) {
                                                        const t = "1.2.840.10008.1.2";
                                                        if (!e) return t;
                                                        const n = e.split(";"),
                                                            o = {};
                                                        n.forEach((e => {
                                                            const t = e.split("=");
                                                            if (2 !== t.length) return;
                                                            const n = t[1].trim().replace(/"/g, "");
                                                            o[t[0].trim()] = n
                                                        }));
                                                        const r = {
                                                            "image/jpeg": "1.2.840.10008.1.2.4.50",
                                                            "image/x-dicom-rle": "1.2.840.10008.1.2.5",
                                                            "image/x-jls": "1.2.840.10008.1.2.4.80",
                                                            "image/jls": "1.2.840.10008.1.2.4.80",
                                                            "image/jll": "1.2.840.10008.1.2.4.70",
                                                            "image/jp2": "1.2.840.10008.1.2.4.90",
                                                            "image/jpx": "1.2.840.10008.1.2.4.92",
                                                            "image/jphc": "3.2.840.10008.1.2.4.96",
                                                            "image/jxl": "1.2.840.10008.1.2.4.140"
                                                        };
                                                        return o["transfer-syntax"] ? o["transfer-syntax"] : e && !Object.keys(o).length && r[e] ? r[e] : o.type && r[o.type] ? r[o.type] : r[e] ? r[e] : t
                                                    }(e.contentType),
                                                    s = e.imageFrame.pixelData;
                                                ie(n, s, i, t).then((e => {
                                                    const t = (new Date).getTime();
                                                    e.loadTimeInMS = t - o, r(e)
                                                }), a)
                                            }), a).catch((e => {
                                                a(e)
                                            }))
                                        }.bind(this, u, e, "multipart/related; type=application/octet-stream; transfer-syntax=*"), i, s, l, c)
                                    })),
                                    cancelFn: void 0
                                }
                            },
                            le = {
                                metaData: {
                                    getNumberString: function(e, t, n) {
                                        const o = i(e, t, n);
                                        if (void 0 !== o) return parseFloat(o)
                                    },
                                    getNumberValue: s,
                                    getNumberValues: l,
                                    getValue: i,
                                    metaDataProvider: A
                                },
                                findIndexOfString: M,
                                getPixelData: R,
                                loadImage: se,
                                metaDataManager: v,
                                register: function(e) {
                                    e.registerImageLoader("wadors", se), e.metaData.addProvider(A)
                                }
                            };

                        function ce(e, t) {
                            if (e.elements[t] && 6 === e.elements[t].length) return [e.uint16(t, 0), e.uint16(t, 1), e.uint16(t, 2)]
                        }

                        function ue(e, t, n) {
                            const o = [],
                                r = e.elements[t];
                            for (let a = 0; a < n[0]; a++) 16 === n[2] ? o[a] = e.uint16(t, a) : o[a] = e.byteArray[a + r.dataOffset];
                            return o
                        }
                        const de = function(e) {
                            const t = {
                                samplesPerPixel: e.uint16("x00280002"),
                                photometricInterpretation: e.string("x00280004"),
                                rows: e.uint16("x00280010"),
                                columns: e.uint16("x00280011"),
                                bitsAllocated: e.uint16("x00280100"),
                                bitsStored: e.uint16("x00280101"),
                                highBit: e.uint16("x00280102"),
                                pixelRepresentation: e.uint16("x00280103"),
                                planarConfiguration: e.uint16("x00280006"),
                                pixelAspectRatio: e.string("x00280034")
                            };
                            return function(e, t) {
                                0 === e.uint16("x00280103") ? (t.smallestPixelValue = e.uint16("x00280106"), t.largestPixelValue = e.uint16("x00280107")) : (t.smallestPixelValue = e.int16("x00280106"), t.largestPixelValue = e.int16("x00280107"))
                            }(e, t), "PALETTE COLOR" === t.photometricInterpretation && e.elements.x00281101 && function(e, t) {
                                t.redPaletteColorLookupTableDescriptor = ce(e, "x00281101"), t.greenPaletteColorLookupTableDescriptor = ce(e, "x00281102"), t.bluePaletteColorLookupTableDescriptor = ce(e, "x00281103"), 0 === t.redPaletteColorLookupTableDescriptor[0] && (t.redPaletteColorLookupTableDescriptor[0] = 65536, t.greenPaletteColorLookupTableDescriptor[0] = 65536, t.bluePaletteColorLookupTableDescriptor[0] = 65536);
                                const n = t.redPaletteColorLookupTableDescriptor[0],
                                    o = e.elements.x00281201.length === n ? 8 : 16;
                                t.redPaletteColorLookupTableDescriptor[2] !== o && (t.redPaletteColorLookupTableDescriptor[2] = o, t.greenPaletteColorLookupTableDescriptor[2] = o, t.bluePaletteColorLookupTableDescriptor[2] = o), t.redPaletteColorLookupTableData = ue(e, "x00281201", t.redPaletteColorLookupTableDescriptor), t.greenPaletteColorLookupTableData = ue(e, "x00281202", t.greenPaletteColorLookupTableDescriptor), t.bluePaletteColorLookupTableData = ue(e, "x00281203", t.bluePaletteColorLookupTableDescriptor)
                            }(e, t), t
                        };

                        function he(e, t) {
                            let n = t.uint16("x00283002", 0);
                            0 === n && (n = 65535);
                            let o = 0;
                            o = 0 === e ? t.uint16("x00283002", 1) : t.int16("x00283002", 1);
                            const r = {
                                id: "1",
                                firstValueMapped: o,
                                numBitsPerEntry: t.uint16("x00283002", 2),
                                lut: []
                            };
                            for (let o = 0; o < n; o++) r.lut[o] = 0 === e ? t.uint16("x00283006", o) : t.int16("x00283006", o);
                            return r
                        }
                        const fe = function(e, t) {
                                if (!t || !t.items || !t.items.length) return;
                                const n = [];
                                for (let o = 0; o < t.items.length; o++) {
                                    const r = he(e, t.items[o].dataSet);
                                    r && n.push(r)
                                }
                                return n
                            },
                            me = function(e) {
                                const t = e.string("x00080016");
                                if ("1.2.840.10008.5.1.4.1.1.2" === t || "1.2.840.10008.5.1.4.1.1.2.1" === t) return 1;
                                const n = e.floatString("x00281052"),
                                    o = e.floatString("x00281053");
                                if (void 0 !== n && void 0 !== o) {
                                    const t = function(e) {
                                        const t = e.uint16("x00280103"),
                                            n = e.uint16("x00280101");
                                        return 0 === t ? 0 : -1 << n - 1
                                    }(e);
                                    return t * o + n < 0 ? 1 : 0
                                }
                                return e.elements.x00283000 && e.elements.x00283000.length > 0 ? 0 : e.uint16("x00280103")
                            },
                            ge = function(e, t, n) {
                                const o = [],
                                    r = e.string(t);
                                if (!r) return;
                                const a = r.split("\\");
                                if (!(n && a.length < n)) {
                                    for (let e = 0; e < a.length; e++) o.push(parseFloat(a[e]));
                                    return o
                                }
                            },
                            pe = function(e) {
                                const t = e.indexOf(":");
                                let n = e.substring(t + 1);
                                const o = n.indexOf("frame=");
                                let r;
                                if (-1 !== o) {
                                    const e = n.substring(o + 6);
                                    r = parseInt(e, 10), n = n.substring(0, o - 1)
                                }
                                return {
                                    scheme: e.substring(0, t),
                                    url: n,
                                    frame: r,
                                    pixelDataFrame: void 0 !== r ? r - 1 : void 0
                                }
                            };
                        async function ve(e, t, n) {
                            const o = function(e) {
                                    const {
                                        dicomParser: t
                                    } = Ke;
                                    let n, o = t.parseDicom(e, {
                                        untilTag: "x7fe00010"
                                    });
                                    o.elements.x7fe00010 || console.warn("Pixel data not found!");
                                    try {
                                        n = t.parseDicom(e)
                                    } catch (e) {
                                        console.error(e), console.log("pixel data dataset:", e.dataSet), n = e.dataSet
                                    }
                                    return o.elements.x7fe00010 = n.elements.x7fe00010, o = function(e) {
                                        const t = e.elements.x7fe00010.fragments,
                                            n = e.byteArray.length;
                                        for (const e of t) {
                                            const {
                                                position: t,
                                                length: o
                                            } = e;
                                            o > n - t && (console.log(`Truncated fragment, changing fragment length from ${e.length} to ${n-t}`), e.length = n - t)
                                        }
                                        return e
                                    }(o), o
                                }(e),
                                {
                                    uri: r,
                                    imageId: a,
                                    fileTotalLength: i
                                } = n;
                            return o.fetchMore = async function(s) {
                                const l = Object.assign({
                                        uri: r,
                                        imageId: a,
                                        fetchedLength: e.length,
                                        lengthToFetch: i - e.length
                                    }, s),
                                    {
                                        fetchedLength: c,
                                        lengthToFetch: u
                                    } = l,
                                    {
                                        arrayBuffer: d
                                    } = await t(r, a, {
                                        byteRange: `${c}-${c+u}`
                                    }),
                                    h = new Uint8Array(d),
                                    f = new Uint8Array(o.byteArray.length + h.length);
                                return f.set(o.byteArray), f.set(h, o.byteArray.length), ve(f, t, n)
                            }, o
                        }

                        function ye(e, t, n) {
                            const o = {};
                            (t ? Object.values(t.items[0].dataSet.elements) : []).map((e => o[e.tag] = e));
                            const r = {};
                            return (e ? Object.values(e.items[n - 1].dataSet.elements) : []).map((e => r[e.tag] = e)), {
                                shared: o,
                                perFrame: r
                            }
                        }

                        function be(e) {
                            if (!e) return;
                            const {
                                elements: t,
                                ...n
                            } = e, {
                                x52009230: o,
                                x52009229: r,
                                ...a
                            } = t;
                            return {
                                NumberOfFrames: e.intString("x00280008"),
                                PerFrameFunctionalGroupsSequence: o,
                                SharedFunctionalGroupsSequence: r,
                                otherElements: a,
                                otherAttributtes: n
                            }
                        }
                        const we = function(e) {
                            const t = function(e) {
                                    return e.indexOf("&frame=")
                                }(e),
                                n = -1 === t ? e : e.slice(0, t),
                                o = parseInt(e.slice(t + 7), 10) || 1;
                            let r;
                            return r = Te[n] ? Te[n].dataSet : void 0, {
                                dataSet: r,
                                frame: o
                            }
                        };
                        let xe = 0,
                            Te = {},
                            Ie = {};

                        function Ee() {
                            return {
                                cacheSizeInBytes: xe,
                                numberOfDataSetsCached: Object.keys(Te).length
                            }
                        }
                        const Se = {
                            isLoaded: function(e) {
                                return void 0 !== Te[e]
                            },
                            load: function(e) {
                                let t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : _,
                                    n = arguments.length > 2 ? arguments[2] : void 0;
                                const {
                                    cornerstone: o,
                                    dicomParser: r
                                } = Ke;
                                if (Te[e]) return new Promise((t => {
                                    Te[e].cacheCount++, t(Te[e].dataSet)
                                }));
                                if (Ie[e]) return Ie[e].cacheCount++, Ie[e];
                                const a = t(e, n),
                                    i = new Promise(((s, l) => {
                                        a.then((async function(a) {
                                            const c = {
                                                isPartialContent: !1,
                                                fileTotalLength: null
                                            };
                                            if (!(a instanceof ArrayBuffer)) {
                                                if (!a.arrayBuffer) return l(new Error("If not returning ArrayBuffer, must return object with `arrayBuffer` parameter"));
                                                c.isPartialContent = a.flags.isPartialContent, c.fileTotalLength = a.flags.fileTotalLength, a = a.arrayBuffer
                                            }
                                            const u = new Uint8Array(a);
                                            let d;
                                            try {
                                                d = c.isPartialContent ? await ve(u, t, {
                                                    uri: e,
                                                    imageId: n,
                                                    fileTotalLength: c.fileTotalLength
                                                }) : r.parseDicom(u)
                                            } catch (e) {
                                                return l(e)
                                            }
                                            Te[e] = {
                                                dataSet: d,
                                                cacheCount: i.cacheCount
                                            }, xe += d.byteArray.length, s(d), o.triggerEvent(o.events, "datasetscachechanged", {
                                                uri: e,
                                                action: "loaded",
                                                cacheInfo: Ee()
                                            })
                                        }), l).then((() => {
                                            delete Ie[e]
                                        }), (() => {
                                            delete Ie[e]
                                        }))
                                    }));
                                return i.cacheCount = 1, Ie[e] = i, i
                            },
                            unload: function(e) {
                                const {
                                    cornerstone: t
                                } = Ke;
                                Te[e] && (Te[e].cacheCount--, 0 === Te[e].cacheCount && (xe -= Te[e].dataSet.byteArray.length, delete Te[e], t.triggerEvent(t.events, "datasetscachechanged", {
                                    uri: e,
                                    action: "unloaded",
                                    cacheInfo: Ee()
                                })))
                            },
                            getInfo: Ee,
                            purge: function() {
                                Te = {}, Ie = {}, xe = 0
                            },
                            get: function(e) {
                                let t;
                                if (e.includes("&frame=")) {
                                    const {
                                        frame: n,
                                        dataSet: o
                                    } = we(e);
                                    t = function(e, t) {
                                        if (!t) return;
                                        const {
                                            NumberOfFrames: n,
                                            PerFrameFunctionalGroupsSequence: o,
                                            SharedFunctionalGroupsSequence: r,
                                            otherElements: a
                                        } = be(t);
                                        if (o || n > 1) {
                                            const {
                                                shared: n,
                                                perFrame: i
                                            } = ye(o, r, e), s = {
                                                elements: { ...a,
                                                    ...n,
                                                    ...i
                                                }
                                            }, l = Object.create(t);
                                            return Object.assign(l, s)
                                        }
                                        return t
                                    }(n, o)
                                } else Te[e] && (t = Te[e].dataSet);
                                return t
                            },
                            update: function(e, t) {
                                const n = Te[e];
                                n ? (xe -= n.dataSet.byteArray.length, n.dataSet = t, xe += t.byteArray.length, Ke.cornerstone.triggerEvent(Ke.cornerstone.events, "datasetscachechanged", {
                                    uri: e,
                                    action: "updated",
                                    cacheInfo: Ee()
                                })) : console.error(`No loaded dataSet for uri ${e}`)
                            }
                        };

                        function Ae(e, t) {
                            const n = e.string("x00080008");
                            if (n) {
                                const e = n.split("\\");
                                if (e.length > t) return e[t]
                            }
                        }

                        function Ce(e) {
                            let t = ge(e, "x00200037", 6);
                            return !t && e.elements.x00209116 && (t = ge(e.elements.x00209116.items[0].dataSet, "x00200037", 6)), t || (t = function(e) {
                                let t;
                                if (e.string("x00080060").includes("NM")) {
                                    const n = Ae(e, 2);
                                    n && y(n) && e.elements.x00540022 && (t = ge(e.elements.x00540022.items[0].dataSet, "x00200037", 6))
                                }
                                return t
                            }(e)), t
                        }

                        function Me(e) {
                            let t = ge(e, "x00200032", 3);
                            return !t && e.elements.x00209113 && (t = ge(e.elements.x00209113.items[0].dataSet, "x00200032", 3)), t || (t = function(e) {
                                let t;
                                if (e.string("x00080060").includes("NM")) {
                                    const n = Ae(e, 2);
                                    n && y(n) && e.elements.x00540022 && (t = ge(e.elements.x00540022.items[0].dataSet, "x00200032", 3))
                                }
                                return t
                            }(e)), t
                        }

                        function De(e) {
                            let t = ge(e, "x00280030", 2);
                            return !t && e.elements.x00289110 && (t = ge(e.elements.x00289110.items[0].dataSet, "x00280030", 2)), t
                        }

                        function Pe(e) {
                            let t;
                            return e.elements.x00180050 ? t = e.floatString("x00180050") : e.elements.x00289110 && e.elements.x00289110.items.length && e.elements.x00289110.items[0].dataSet.elements.x00180050 && (t = e.elements.x00289110.items[0].dataSet.floatString("x00180050")), t
                        }
                        const ke = function e(t, n) {
                            const {
                                dicomParser: o
                            } = Ke, r = pe(n);
                            if ("multiframeModule" === t) {
                                const e = we(r.url);
                                if (!e.dataSet) return;
                                const t = function(e, t) {
                                    if (!e) return;
                                    const {
                                        NumberOfFrames: n,
                                        PerFrameFunctionalGroupsSequence: o,
                                        SharedFunctionalGroupsSequence: r
                                    } = be(e);
                                    if (o || n > 1) {
                                        const {
                                            shared: e,
                                            perFrame: a
                                        } = ye(o, r, t);
                                        return {
                                            NumberOfFrames: n,
                                            PerFrameFunctionalInformation: a,
                                            SharedFunctionalInformation: e
                                        }
                                    }
                                    return {
                                        NumberOfFrames: n
                                    }
                                }(e.dataSet, e.frame);
                                return t
                            }
                            let a = r.url;
                            r.frame && (a = `${a}&frame=${r.frame}`);
                            const i = Se.get(a);
                            if (i) {
                                if ("generalSeriesModule" === t) return {
                                    modality: i.string("x00080060"),
                                    seriesInstanceUID: i.string("x0020000e"),
                                    seriesNumber: i.intString("x00200011"),
                                    studyInstanceUID: i.string("x0020000d"),
                                    seriesDate: o.parseDA(i.string("x00080021")),
                                    seriesTime: o.parseTM(i.string("x00080031") || ""),
                                    acquisitionDate: o.parseDA(i.string("x00080022") || ""),
                                    acquisitionTime: o.parseTM(i.string("x00080032") || "")
                                };
                                if ("patientStudyModule" === t) return {
                                    patientAge: i.intString("x00101010"),
                                    patientSize: i.floatString("x00101020"),
                                    patientWeight: i.floatString("x00101030")
                                };
                                if ("imagePlaneModule" === t) {
                                    const e = Ce(i),
                                        t = Me(i),
                                        n = De(i);
                                    let o;
                                    i.elements.x00200052 && (o = i.string("x00200052"));
                                    const r = Pe(i);
                                    let a;
                                    i.elements.x00201041 && (a = i.floatString("x00201041"));
                                    let s = null,
                                        l = null;
                                    n && (l = n[0], s = n[1]);
                                    let c = null,
                                        u = null;
                                    return e && (c = [parseFloat(e[0]), parseFloat(e[1]), parseFloat(e[2])], u = [parseFloat(e[3]), parseFloat(e[4]), parseFloat(e[5])]), {
                                        frameOfReferenceUID: o,
                                        rows: i.uint16("x00280010"),
                                        columns: i.uint16("x00280011"),
                                        imageOrientationPatient: e,
                                        rowCosines: c,
                                        columnCosines: u,
                                        imagePositionPatient: t,
                                        sliceThickness: r,
                                        sliceLocation: a,
                                        pixelSpacing: n,
                                        rowPixelSpacing: l,
                                        columnPixelSpacing: s
                                    }
                                }
                                if ("nmMultiframeGeometryModule" === t) {
                                    const e = i.string("x00080060"),
                                        t = Ae(i, 2);
                                    return {
                                        modality: e,
                                        imageType: i.string("x00080008"),
                                        imageSubType: t,
                                        imageOrientationPatient: Ce(i),
                                        imagePositionPatient: Me(i),
                                        sliceThickness: Pe(i),
                                        pixelSpacing: De(i),
                                        numberOfFrames: i.uint16("x00280008"),
                                        isNMReconstructable: y(t) && e.includes("NM")
                                    }
                                }
                                if ("imagePixelModule" === t) return de(i);
                                if ("modalityLutModule" === t) return {
                                    rescaleIntercept: i.floatString("x00281052"),
                                    rescaleSlope: i.floatString("x00281053"),
                                    rescaleType: i.string("x00281054"),
                                    modalityLUTSequence: fe(i.uint16("x00280103"), i.elements.x00283000)
                                };
                                if ("voiLutModule" === t) {
                                    const e = me(i);
                                    return {
                                        windowCenter: ge(i, "x00281050", 1),
                                        windowWidth: ge(i, "x00281051", 1),
                                        voiLUTSequence: fe(e, i.elements.x00283010)
                                    }
                                }
                                if ("sopCommonModule" === t) return {
                                    sopClassUID: i.string("x00080016"),
                                    sopInstanceUID: i.string("x00080018")
                                };
                                if ("petIsotopeModule" === t) {
                                    const e = i.elements.x00540016;
                                    if (void 0 === e) return;
                                    const t = e.items[0].dataSet;
                                    return {
                                        radiopharmaceuticalInfo: {
                                            radiopharmaceuticalStartTime: o.parseTM(t.string("x00181072") || ""),
                                            radionuclideTotalDose: t.floatString("x00181074"),
                                            radionuclideHalfLife: t.floatString("x00181075")
                                        }
                                    }
                                }
                                return "overlayPlaneModule" === t ? function(e) {
                                    const t = [];
                                    for (let n = 0; n <= 30; n += 2) {
                                        let o = `x60${n.toString(16)}`;
                                        4 === o.length && (o = `x600${n.toString(16)}`);
                                        const r = e.elements[`${o}3000`];
                                        if (!r) continue;
                                        const a = [];
                                        for (let t = 0; t < r.length; t++)
                                            for (let n = 0; n < 8; n++) {
                                                const o = e.byteArray[r.dataOffset + t];
                                                a[8 * t + n] = o >> n & 1
                                            }
                                        t.push({
                                            rows: e.uint16(`${o}0010`),
                                            columns: e.uint16(`${o}0011`),
                                            type: e.string(`${o}0040`),
                                            x: e.int16(`${o}0050`, 1) - 1,
                                            y: e.int16(`${o}0050`, 0) - 1,
                                            pixelData: a,
                                            description: e.string(`${o}0022`),
                                            label: e.string(`${o}1500`),
                                            roiArea: e.string(`${o}1301`),
                                            roiMean: e.string(`${o}1302`),
                                            roiStandardDeviation: e.string(`${o}1303`)
                                        })
                                    }
                                    return {
                                        overlays: t
                                    }
                                }(i) : "transferSyntax" === t ? {
                                    transferSyntaxUID: i.string("x00020010")
                                } : "petSeriesModule" === t ? {
                                    correctedImage: i.string("x00280051"),
                                    units: i.string("x00541001"),
                                    decayCorrection: i.string("x00541102")
                                } : "petImageModule" === t ? {
                                    frameReferenceTime: i.floatString(i.string("x00541300") || ""),
                                    actualFrameDuration: i.intString(i.string("x00181242"))
                                } : "instance" === t ? I(n, e, S) : void 0
                            }
                        };
                        let _e = [];
                        const Le = {
                            add: function(e) {
                                return "dicomfile:" + (_e.push(e) - 1)
                            },
                            get: function(e) {
                                return _e[e]
                            },
                            remove: function(e) {
                                _e[e] = void 0
                            },
                            purge: function() {
                                _e = []
                            }
                        };
                        var Oe = o(713);

                        function Re(e, t) {
                            const {
                                dicomParser: n
                            } = Ke;
                            if (e.elements.x7fe00010 && e.elements.x7fe00010.basicOffsetTable.length) return n.readEncapsulatedImageFrame(e, e.elements.x7fe00010, t);
                            if (function(e) {
                                    return e.intString("x00280008") !== e.elements.x7fe00010.fragments.length
                                }(e)) {
                                const o = n.createJPEGBasicOffsetTable(e, e.elements.x7fe00010);
                                return n.readEncapsulatedImageFrame(e, e.elements.x7fe00010, t, o)
                            }
                            const o = e.elements.x7fe00010.fragments,
                                r = new Oe.ByteStream(e.byteArrayParser, e.byteArray, e.elements.x7fe00010.dataOffset),
                                a = (0, Oe.readSequenceItem)(r);
                            if ("xfffee000" !== a.tag) throw "dicomParser.readEncapsulatedPixelData: missing basic offset table xfffee000";
                            r.seek(a.length);
                            const i = r.position;
                            if (t + 1 > o.length) throw "dicomParser.readEncapsulatedPixelData: frame exceeds number of fragments";
                            const s = i + o[t].offset + 8,
                                l = o[t].length;
                            return new Uint8Array(r.byteArray.buffer.slice(r.byteArray.byteOffset + s, r.byteArray.byteOffset + s + l))
                        }

                        function Ne(e, t) {
                            return e & 1 << t
                        }
                        const Ue = function(e, t, n) {
                                const o = new Uint8Array(n);
                                for (let r = 0; r < n; r++) {
                                    const n = e[Math.floor(r / 8) + t],
                                        a = r % 8;
                                    o[r] = Ne(n, a) ? 1 : 0
                                }
                                return o
                            },
                            Be = function(e, t) {
                                const n = e.elements.x7fe00010 || e.elements.x7fe00008,
                                    o = e.uint16("x00280100"),
                                    r = e.uint16("x00280010"),
                                    a = e.uint16("x00280011");
                                let i = e.uint16("x00280002");
                                "YBR_FULL_422" === e.string("x00280004") && (i = 2, console.warn("Using SamplesPerPixel of 2 for YBR_FULL_422 photometric interpretation.\n      See http://dicom.nema.org/medical/dicom/current/output/chtml/part03/sect_C.7.6.3.html for more information."));
                                const s = n.dataOffset,
                                    l = r * a * i;
                                let c;
                                if (8 === o) {
                                    if (c = s + t * l, c >= e.byteArray.length) throw new Error("frame exceeds size of pixelData");
                                    return new Uint8Array(e.byteArray.buffer.slice(c, c + l))
                                }
                                if (16 === o) {
                                    if (c = s + t * l * 2, c >= e.byteArray.length) throw new Error("frame exceeds size of pixelData");
                                    return new Uint8Array(e.byteArray.buffer.slice(c, c + 2 * l))
                                }
                                if (1 === o) {
                                    if (c = s + t * l * .125, c >= e.byteArray.length) throw new Error("frame exceeds size of pixelData");
                                    return Ue(e.byteArray, c, l)
                                }
                                if (32 === o) {
                                    if (c = s + t * l * 4, c >= e.byteArray.length) throw new Error("frame exceeds size of pixelData");
                                    return new Uint8Array(e.byteArray.buffer.slice(c, c + 4 * l))
                                }
                                throw new Error("unsupported pixel format")
                            },
                            Ve = function(e) {
                                const t = pe(e),
                                    n = parseInt(t.url, 10),
                                    o = Le.get(n);
                                return new Promise(((e, t) => {
                                    const n = new FileReader;
                                    n.onload = t => {
                                        const n = t.target.result;
                                        e(n)
                                    }, n.onerror = t, n.readAsArrayBuffer(o)
                                }))
                            },
                            Fe = function(e) {
                                let t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
                                const n = e.elements.x7fe00010 || e.elements.x7fe00008;
                                return n ? n.encapsulatedPixelData ? Re(e, t) : Be(e, t) : null
                            };

                        function He(e, t) {
                            let n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0,
                                o = arguments.length > 3 ? arguments[3] : void 0,
                                r = arguments.length > 4 ? arguments[4] : void 0,
                                a = arguments.length > 5 ? arguments[5] : void 0;
                            const i = (new Date).getTime(),
                                s = {
                                    cancelFn: void 0,
                                    promise: void 0
                                };
                            return s.promise = new Promise(((l, c) => {
                                e.then((e => {
                                    const u = Fe(e, n),
                                        d = e.string("x00020010"),
                                        h = (new Date).getTime(),
                                        f = ie(t, u, d, r);
                                    ! function(e, t) {
                                        e.decache = function() {
                                            const e = pe(t);
                                            Se.unload(e.url)
                                        }
                                    }(s, t), f.then((t => {
                                        t.data = e, t.sharedCacheKey = o;
                                        const n = (new Date).getTime();
                                        t.loadTimeInMS = h - i, t.totalTimeInMS = n - i, void 0 !== a && void 0 !== a.imageDoneCallback && a.imageDoneCallback(t), l(t)
                                    }), (function(t) {
                                        c({
                                            error: t,
                                            dataSet: e
                                        })
                                    }))
                                }), (function(e) {
                                    c({
                                        error: e
                                    })
                                }))
                            })), s
                        }

                        function qe(e) {
                            return "dicomweb" === e || "wadouri" === e ? _ : "dicomfile" === e ? Ve : void 0
                        }

                        function je(e) {
                            let t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};
                            const n = pe(e);
                            t = Object.assign({}, t);
                            let o = t.loader;
                            return void 0 === o ? o = qe(n.scheme) : delete t.loader, Se.isLoaded(n.url) ? function(e, t) {
                                let n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0,
                                    o = arguments.length > 3 ? arguments[3] : void 0,
                                    r = arguments.length > 4 ? arguments[4] : void 0;
                                const a = (new Date).getTime();
                                return {
                                    promise: new Promise(((i, s) => {
                                        const l = (new Date).getTime();
                                        let c;
                                        try {
                                            const o = Fe(e, n),
                                                a = e.string("x00020010");
                                            c = ie(t, o, a, r)
                                        } catch (t) {
                                            return void s({
                                                error: t,
                                                dataSet: e
                                            })
                                        }
                                        c.then((t => {
                                            t.data = e, t.sharedCacheKey = o;
                                            const n = (new Date).getTime();
                                            t.loadTimeInMS = l - a, t.totalTimeInMS = n - a, i(t)
                                        }), s)
                                    })),
                                    cancelFn: void 0
                                }
                            }(Se.get(n.url, o, e), e, n.pixelDataFrame, n.url, t) : He(Se.load(n.url, void 0, e), e, n.frame, n.url, t)
                        }
                        const ze = {
                                metaData: {
                                    getImagePixelModule: de,
                                    getLUTs: fe,
                                    getModalityLUTOutputPixelRepresentation: me,
                                    getNumberValues: ge,
                                    metaDataProvider: ke
                                },
                                dataSetCacheManager: Se,
                                fileManager: Le,
                                getEncapsulatedImageFrame: Re,
                                getUncompressedImageFrame: Be,
                                loadFileRequest: Ve,
                                loadImageFromPromise: He,
                                getLoaderForScheme: qe,
                                loadImage: je,
                                parseImageId: pe,
                                unpackBinaryFrame: Ue,
                                register: function(e) {
                                    e.registerImageLoader("dicomweb", je), e.registerImageLoader("wadouri", je), e.registerImageLoader("dicomfile", je), e.metaData.addProvider(ke)
                                }
                            },
                            We = function(e) {
                                le.register(e), ze.register(e)
                            };
                        let Ge, Ye;
                        const Ze = {
                                set cornerstone(e) {
                                    Ge = e, We(Ge)
                                },
                                get cornerstone() {
                                    if (!Ge) {
                                        if (Ge = window && window.cornerstone, !Ge) throw new Error("cornerstoneDICOMImageLoader requires a copy of Cornerstone to work properly. Please add cornerstoneDICOMImageLoader.external.cornerstone = cornerstone; to your application.");
                                        We(Ge)
                                    }
                                    return Ge
                                },
                                set dicomParser(e) {
                                    Ye = e
                                },
                                get dicomParser() {
                                    if (!Ye) {
                                        if (!window || !window.dicomParser) throw new Error("cornerstoneDICOMImageLoader requires a copy of dicomParser to work properly. Please add cornerstoneDICOMImageLoader.external.dicomParser = dicomParser; to your application.");
                                        Ye = window.dicomParser
                                    }
                                    return Ye
                                }
                            },
                            Ke = Ze;

                        function Xe(e, t) {
                            const n = e.length,
                                o = new Uint8ClampedArray(n);
                            for (let r = 0; r < n; ++r) o[r] = e[r] >> t;
                            return o
                        }

                        function Je(e, t, n) {
                            const o = e.columns * e.rows,
                                r = e.pixelData;
                            let a = e.redPaletteColorLookupTableData;
                            a || (a = Ke.cornerstone.metaData.get("imagePixelModule", e.imageId) ? .redPaletteColorLookupTableData);
                            let i = e.greenPaletteColorLookupTableData;
                            i || (i = Ke.cornerstone.metaData.get("imagePixelModule", e.imageId) ? .greenPaletteColorLookupTableData);
                            let s = e.bluePaletteColorLookupTableData;
                            if (s || (s = Ke.cornerstone.metaData.get("imagePixelModule", e.imageId) ? .bluePaletteColorLookupTableData), !a || !i || !s) throw new Error("The image does not have a complete color palette. R, G, and B palette data are required.");
                            const l = e.redPaletteColorLookupTableData.length;
                            let c = 0,
                                u = 0;
                            const d = e.redPaletteColorLookupTableDescriptor[1],
                                h = 8 === e.redPaletteColorLookupTableDescriptor[2] ? 0 : 8,
                                f = Xe(a, h),
                                m = Xe(i, h),
                                g = Xe(s, h);
                            if (n)
                                for (let e = 0; e < o; ++e) {
                                    let e = r[c++];
                                    e < d ? e = 0 : e > d + l - 1 ? e = l - 1 : e -= d, t[u++] = f[e], t[u++] = m[e], t[u++] = g[e], t[u++] = 255
                                } else
                                    for (let e = 0; e < o; ++e) {
                                        let e = r[c++];
                                        e < d ? e = 0 : e > d + l - 1 ? e = l - 1 : e -= d, t[u++] = f[e], t[u++] = m[e], t[u++] = g[e]
                                    }
                        }
                        const Qe = function(e) {
                                P(e)
                            },
                            $e = function(e, t) {
                                if (t = t || e.transferSyntax, 8 === e.bitsAllocated && "1.2.840.10008.1.2.4.50" === t && (3 === e.samplesPerPixel || 4 === e.samplesPerPixel)) return !0
                            },
                            et = {
                                convertRGBColorByPixel: e,
                                convertRGBColorByPlane: t,
                                convertYBRFullByPixel: n,
                                convertYBRFullByPlane: a,
                                convertPALETTECOLOR: Je,
                                wadouri: ze,
                                wadors: le,
                                configure: Qe,
                                convertColorSpace: B,
                                createImage: ie,
                                decodeImageFrame: te,
                                decodeJPEGBaseline8BitColor: V,
                                getImageFrame: ne,
                                getPixelData: R,
                                getMinMax: N,
                                isColorImage: oe,
                                isJPEGBaseline8BitColor: $e,
                                webWorkerManager: Q,
                                internal: L,
                                external: Ze
                            }
                    })(), r
                })(), e.exports = o(n(5915))
            },
            1950: (e, t, n) => {
                "use strict";
                n.d(t, {
                    A: () => r,
                    E: () => a
                });
                var o = n(2117);

                function r(e, t = (0, o.Z0)()) {
                    return e && "" != e ? (e = e.replace(/^0+/, ""), t.includes("zh") ? (e = e.replace("Y", "").replace("M", "").replace("M", "").replace("D", "")).includes("") ? e : e + "" : e) : ""
                }

                function a(e, t = (0, o.Z0)()) {
                    return e && "" != e ? (e = e.replace(/\s/g, ""), t.includes("zh") ? "F" == e ? "" : "M" == e ? "" : e : e) : ""
                }
            },
            1972: e => {
                "use strict";
                e.exports = "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTM1IiBoZWlnaHQ9IjE0MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSIjZmZmIj48cmVjdCB5PSIxMCIgd2lkdGg9IjE1IiBoZWlnaHQ9IjEyMCIgcng9IjYiPjxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9ImhlaWdodCIgYmVnaW49IjAuNXMiIGR1cj0iMXMiIHZhbHVlcz0iMTIwOzExMDsxMDA7OTA7ODA7NzA7NjA7NTA7NDA7MTQwOzEyMCIgY2FsY01vZGU9ImxpbmVhciIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiLz48YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJ5IiBiZWdpbj0iMC41cyIgZHVyPSIxcyIgdmFsdWVzPSIxMDsxNTsyMDsyNTszMDszNTs0MDs0NTs1MDswOzEwIiBjYWxjTW9kZT0ibGluZWFyIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIvPjwvcmVjdD48cmVjdCB4PSIzMCIgeT0iMTAiIHdpZHRoPSIxNSIgaGVpZ2h0PSIxMjAiIHJ4PSI2Ij48YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJoZWlnaHQiIGJlZ2luPSIwLjI1cyIgZHVyPSIxcyIgdmFsdWVzPSIxMjA7MTEwOzEwMDs5MDs4MDs3MDs2MDs1MDs0MDsxNDA7MTIwIiBjYWxjTW9kZT0ibGluZWFyIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIvPjxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9InkiIGJlZ2luPSIwLjI1cyIgZHVyPSIxcyIgdmFsdWVzPSIxMDsxNTsyMDsyNTszMDszNTs0MDs0NTs1MDswOzEwIiBjYWxjTW9kZT0ibGluZWFyIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIvPjwvcmVjdD48cmVjdCB4PSI2MCIgd2lkdGg9IjE1IiBoZWlnaHQ9IjE0MCIgcng9IjYiPjxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9ImhlaWdodCIgYmVnaW49IjBzIiBkdXI9IjFzIiB2YWx1ZXM9IjEyMDsxMTA7MTAwOzkwOzgwOzcwOzYwOzUwOzQwOzE0MDsxMjAiIGNhbGNNb2RlPSJsaW5lYXIiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIi8+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0ieSIgYmVnaW49IjBzIiBkdXI9IjFzIiB2YWx1ZXM9IjEwOzE1OzIwOzI1OzMwOzM1OzQwOzQ1OzUwOzA7MTAiIGNhbGNNb2RlPSJsaW5lYXIiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIi8+PC9yZWN0PjxyZWN0IHg9IjkwIiB5PSIxMCIgd2lkdGg9IjE1IiBoZWlnaHQ9IjEyMCIgcng9IjYiPjxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9ImhlaWdodCIgYmVnaW49IjAuMjVzIiBkdXI9IjFzIiB2YWx1ZXM9IjEyMDsxMTA7MTAwOzkwOzgwOzcwOzYwOzUwOzQwOzE0MDsxMjAiIGNhbGNNb2RlPSJsaW5lYXIiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIi8+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0ieSIgYmVnaW49IjAuMjVzIiBkdXI9IjFzIiB2YWx1ZXM9IjEwOzE1OzIwOzI1OzMwOzM1OzQwOzQ1OzUwOzA7MTAiIGNhbGNNb2RlPSJsaW5lYXIiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIi8+PC9yZWN0PjxyZWN0IHg9IjEyMCIgeT0iMTAiIHdpZHRoPSIxNSIgaGVpZ2h0PSIxMjAiIHJ4PSI2Ij48YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJoZWlnaHQiIGJlZ2luPSIwLjVzIiBkdXI9IjFzIiB2YWx1ZXM9IjEyMDsxMTA7MTAwOzkwOzgwOzcwOzYwOzUwOzQwOzE0MDsxMjAiIGNhbGNNb2RlPSJsaW5lYXIiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIi8+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0ieSIgYmVnaW49IjAuNXMiIGR1cj0iMXMiIHZhbHVlcz0iMTA7MTU7MjA7MjU7MzA7MzU7NDA7NDU7NTA7MDsxMCIgY2FsY01vZGU9ImxpbmVhciIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiLz48L3JlY3Q+PC9zdmc+"
            },
            2007: e => {
                "use strict";
                e.exports = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABBVBMVEUAAAAZGSQdHSkVFR4SERkjIzFmboZka4NOUGs9PVVSVnAHBgtJSmZgZX8oKDhpcohCQ1sPDhVueI1ZXXhWWnMzNUcuL0ErKzwLCxF2gpU7O1L2+fpdYnxbYHpPVGkgIC5KTWM3OEsyMkR6h5lsdYtAQlcEBAZMT2hESFw4OE+Rmaecoq+Qo62Cj59dZHZaXXFERV/+/v7v9PXa4OPP19zKz9XBydCdr7iImaZ8i5tHSWE9QFHq7/Di6Oq2xsu7vcSlrLaVprFye49ydYro6+7g4+bT29+2vsauvMSzt8GftLuqsbqMkZ9+hZNgaXtqbXrX2d+Zm6VygItvfYZpdoFSXGVJUlt63FDBAAACl0lEQVQ4y9WRRZIcMRBFJZVUwlIxczVzD4+HwTxkvv9RXD0bh8Mn8F+kIuM9ZS4S/GeRMjEQqRHRcYwS+Q+HEM3YKNStqGZnAdfob0UiBFGkhfd8vk7XeipCSJJXksjxjodk+rx2RDogAH8bFOnAc0jnAjAGbuJKVPPz6s3gzent8kdv/1ou+yatEIHYBRob5zHhVjpIB6cnn7/3ws+T5SD1PNogNIUgMrqGZOejapOm6elyhWBMV6lHnSgOQzxqAYKNbqfYQLE1HHrpXWkP7dWQdRAj5CaoArjO4LRKMGrEpKF3pe953pBqA0U1llK2wCUIN+FugFnNfDOd38zvrYwQxjiCRgIBrA1XG50QfhCGwv6Q7+Vf7pkDp1vFOJQSoNpIpDuySsHCKNy8zS8v8utwVmfKYSMYuoDoRCZRcaZU0Oc+37/Yz6+5yrbbjLNataCaSgmdQPje6vhh/XXv4Pgwf7e26Kbh3CGKgY/eeAxJJk7eXx3MPxy83fj+Yu/g0+rkeKFiPFIgf5Jj13Xxy9Hh4eer/fyFV9d7l1cf3x/eIO1GM3C5kWCMZQKr+e3pfHH07uHo4tPT4+3xXRZDrDOwaMdAjg0+U5Mg4NvJTb4/F0yZNhNFh8kMqFj2F+1owRj3S6HE0aIoLNNihT1sICSAE9eN4JlpWipipe/zx6AsC8GE7Q0dSAgINSEZn9h2kBFHqElGR46wWOxQ6yzumAJ+MHGUYrSIYMQCzpU36hj1Ndo6XBWmCWzTNKlV+hz2CzWJeRPqro0iRwQlHXoeMKm5U0rmxKgPqWvUqwZqfdPuP9tgV2zaKxOCIdzBHTegQbiwKKW9QE1KLeEQjLGxy45jo2+QjjIOLGpZvmoJfKU46Z/e/FN/A92MRrSJbLGPAAAAAElFTkSuQmCC"
            },
            2035: (e, t, n) => {
                "use strict";
                n.d(t, {
                    A: () => c
                });
                var o = n(2284),
                    r = function(e) {
                        return e && "object" === (0, o.A)(e) && "[object RegExp]" !== Object.prototype.toString.call(e) && "[object Date]" !== Object.prototype.toString.call(e)
                    },
                    a = function(e, t) {
                        var n;
                        return t && !0 === t.clone && r(e) ? l((n = e, Array.isArray(n) ? [] : {}), e, t) : e
                    },
                    i = function(e, t, n) {
                        var o = e.slice();
                        return t.forEach((function(t, i) {
                            void 0 === o[i] ? o[i] = a(t, n) : r(t) ? o[i] = l(e[i], t, n) : -1 === e.indexOf(t) && (o[i] = a(t, n))
                        })), o
                    },
                    s = function(e, t, n) {
                        var o = {};
                        return r(e) && Object.keys(e).forEach((function(t) {
                            o[t] = a(e[t], n)
                        })), Object.keys(t).forEach((function(i) {
                            r(t[i]) && e[i] ? o[i] = l(e[i], t[i], n) : o[i] = a(t[i], n)
                        })), o
                    },
                    l = function() {
                        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},
                            t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
                            n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : void 0,
                            o = Array.isArray(t),
                            r = (n || {
                                arrayMerge: i
                            }).arrayMerge || i;
                        return o ? Array.isArray(e) ? r(e, t, n) : a(t, n) : s(e, t, n)
                    };
                const c = l
            },
            2062: (e, t, n) => {
                "use strict";
                var o;
                n.d(t, {
                        A: () => r
                    }),
                    function(e) {
                        e.NOT_APPLICABLE = "", e.ERMF = "ERMF", e.USER = "User", e.PROJECTION = "Proj", e.REGION = "Region", e.ERROR = "Error", e.UNCALIBRATED = "Uncalibrated"
                    }(o || (o = {}));
                const r = o
            },
            2117: (e, t, n) => {
                "use strict";
                n.d(t, {
                    Ay: () => d,
                    Tl: () => u,
                    Z0: () => s,
                    _z: () => c,
                    xC: () => l
                });
                var o = n(9473);
                n(1278);
                let r = o.IG.getItem("language") || navigator.language || navigator.userLanguage || "en";
                const a = n.g.webDicomViewLocal,
                    i = (e = r) => {
                        if (!a[e]) {
                            const t = e.split("-")[0];
                            return a[t] ? (l(t, !1), !0) : (console.warn(`${e} ${u("toast.languagePackageNoInit","default")}`), l(a.default.language, !1), !1)
                        }
                        return !0
                    },
                    s = () => r,
                    l = (e, t = !0) => {
                        if (e) {
                            if (!a[e]) {
                                if (i(e)) return;
                                throw new Error(`Language '${e}' is not supported. supported language: ${Object.keys(a)}`)
                            }
                            r = e, t && o.IG.setItem("language", e)
                        }
                    },
                    c = e => {
                        try {
                            if (o.IG.getItem("language")) return;
                            l(e, !1)
                        } catch (e) {
                            console.error(e)
                        }
                    },
                    u = (e, t) => {
                        try {
                            const o = (n = a[t || r].locale, e.split(".").reduce(((e, t) => e[t]), n));
                            if (!o) throw new Error("unknown translate key");
                            return o
                        } catch (t) {
                            return console.warn(`Translation for '${e}' not found in '${r}' language.`, "error:", t), e
                        }
                        var n
                    };
                i();
                const d = {
                    getLanguage: s,
                    setLanguage: l,
                    setLanguageDefault: c,
                    translate: u
                }
            },
            2147: (e, t, n) => {
                "use strict";
                n.d(t, {
                    A: () => s
                });
                var o = n(8398),
                    r = n(4594),
                    a = n(9473),
                    i = function(e, t, n, o) {
                        return new(n || (n = Promise))((function(r, a) {
                            function i(e) {
                                try {
                                    l(o.next(e))
                                } catch (e) {
                                    a(e)
                                }
                            }

                            function s(e) {
                                try {
                                    l(o.throw(e))
                                } catch (e) {
                                    a(e)
                                }
                            }

                            function l(e) {
                                var t;
                                e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                                    e(t)
                                }))).then(i, s)
                            }
                            l((o = o.apply(e, t || [])).next())
                        }))
                    };
                const s = class {
                    constructor(e, t, n) {
                        const {
                            className: s = "",
                            layoutStyle: l,
                            mainStyle: c,
                            contentStyle: u,
                            overlay: d = !0,
                            close: h
                        } = n || {}, {
                            globalContainer: f
                        } = r.A.webDicomView;
                        this.options = n, this.layoutEl = (0, a.n)({
                            className: `popup-layout ${s}`
                        }), this.mainEl = (0, a.n)({
                            className: "popup-main-layout"
                        }), this.titleBarEl = (0, a.n)({
                            className: "title-bar"
                        }), this.titleEl = (0, a.n)({
                            className: "title",
                            innerText: e
                        }), this.titleRightContentEl = (0, o.b0)("title-right", (0, a.n)({
                            className: "slot"
                        }), (0, a.n)({
                            className: "icon-dicom-close",
                            onclick: () => i(this, void 0, void 0, (function*() {
                                yield null == h ? void 0 : h(), this.remove()
                            }))
                        })), this.contentEl = (0, a.n)({
                            className: "content"
                        }), this.titleBarEl.append(this.titleEl, this.titleRightContentEl), this.mainEl.append(this.titleBarEl, this.contentEl), this.layoutEl.appendChild(this.mainEl), f.appendChild(this.layoutEl), Object.assign(this.layoutEl.style, l), Object.assign(this.mainEl.style, c), Object.assign(this.contentEl.style, u), !d && Object.assign(this.layoutEl.style, {
                            position: "static"
                        }), "string" == typeof t ? this.contentEl.innerHTML = t : t && this.contentEl.appendChild(t)
                    }
                    remove() {
                        this.layoutEl.remove()
                    }
                }
            },
            2259: (e, t, n) => {
                "use strict";
                var o;
                n.d(t, {
                        A: () => r
                    }),
                    function(e) {
                        e.NO_DATA = "noData", e.LOADING = "loading", e.PRE_RENDER = "preRender", e.RESIZE = "resize", e.RENDERED = "rendered"
                    }(o || (o = {}));
                const r = o
            },
            2271: (e, t, n) => {
                "use strict";
                var o = n(453),
                    r = n(6556),
                    a = n(8859),
                    i = n(507),
                    s = n(9675),
                    l = o("%WeakMap%", !0),
                    c = r("WeakMap.prototype.get", !0),
                    u = r("WeakMap.prototype.set", !0),
                    d = r("WeakMap.prototype.has", !0),
                    h = r("WeakMap.prototype.delete", !0);
                e.exports = l ? function() {
                    var e, t, n = {
                        assert: function(e) {
                            if (!n.has(e)) throw new s("Side channel does not contain " + a(e))
                        },
                        delete: function(n) {
                            if (l && n && ("object" == typeof n || "function" == typeof n)) {
                                if (e) return h(e, n)
                            } else if (i && t) return t.delete(n);
                            return !1
                        },
                        get: function(n) {
                            return l && n && ("object" == typeof n || "function" == typeof n) && e ? c(e, n) : t && t.get(n)
                        },
                        has: function(n) {
                            return l && n && ("object" == typeof n || "function" == typeof n) && e ? d(e, n) : !!t && t.has(n)
                        },
                        set: function(n, o) {
                            l && n && ("object" == typeof n || "function" == typeof n) ? (e || (e = new l), u(e, n, o)) : i && (t || (t = i()), t.set(n, o))
                        }
                    };
                    return n
                } : i
            },
            2284: (e, t, n) => {
                "use strict";

                function o(e) {
                    return o = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                        return typeof e
                    } : function(e) {
                        return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
                    }, o(e)
                }
                n.d(t, {
                    A: () => o
                })
            },
            2290: (e, t, n) => {
                "use strict";
                n.d(t, {
                    H: () => s,
                    _: () => l
                });
                var o = n(4594),
                    r = n(346),
                    a = n.n(r),
                    i = n(8398);
                a().settings({
                    timeout: 5e3
                });
                const s = () => {
                        document.querySelectorAll(".iziToast").forEach((e => {
                            a().hide({}, e)
                        }))
                    },
                    l = e => {
                        var t, n;
                        try {
                            const r = null === (t = e.parentElement) || void 0 === t ? void 0 : t.parentElement,
                                a = document.querySelector(".iziToast-overlay"),
                                s = o.A.webDicomView.globalContainer;
                            a && (0, i.Wp)(a, {
                                style: `\n        display: block;\n        position: absolute;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        z-index: 997;\n        ${a.getAttribute("style")}\n    \t`
                            });
                            for (const e of [r, a]) "BODY" === (null === (n = null == e ? void 0 : e.parentElement) || void 0 === n ? void 0 : n.tagName) && s.appendChild(e)
                        } catch (e) {
                            console.error(e)
                        }
                    }
            },
            2489: e => {
                "use strict";
                e.exports = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAACqVBMVEUAAAAqpB4sqh1iAphdApsmeMorlrA1E69zAJMupVguqkhEBaVVAZ0voZwskJstpjIjYq8lAq81AqZpAJcunJIup2Irpj0pBz0rqBooWbg7JbFHHqZNAqFOEKBYApVsApMwpI9lAYxAYXlgAHkso3NWAW46zCAxuBsFDBMsL74mObkrWK08PKUya5g9QZVfEY9NBIw9F4k5SIhpAIUupIMrlX9LBHoskHY1dGk2hWcvm0490DAtrCkroygJGBojZ9DLyMYqjcQylb/JxL4jJL4neLcxb7O+wbEnP6kxoacocqcohqZMH5sxVZopb5UseY0qiYsrgXqqsHkzBm4mL2wqHGssnGorn0Z30TUOAyk92yNE1CNA4SIvshwRAhsdRckjPckaEMAsFrmqurYwm7QyRrKAma61u6gpMag6I6YnaKJVGaIofKFcnpertJU4SZQqkJDIlIwxWYsuLIMvdX97lnhBBXEtqW49Hm5MrWosgmXTbmEsn2BLAV4oB1dDAFYwA0inuzY1sDU2wTIhAywytyV56SE81yGj8h+P8B8NKhwnbLzJw7WZm7FEirA5HJ3OrpxChZo4O5p1o5ZGNpaRppNCI5KhspBSI45BOIsrl4h4r4RdfXzSh3swZHpDS3QqjmeCt2WwtWTPlGQ7VWR2k2IpmGBjvF85Yl41lluHo1oYMFcbJVJErk00fk1Dwkw5pkQ8vT6PtzwRMTA0uSs1xCpV5yJedhoXPhrc7RgjWcUkar9JdrtCZ7qWrbR/gJ9DbpsZIpUlEZQdVI5HQ4xJlIUjZ4F1aXxWP3qdhHhIHHjCx3EsVHG8xWu/q2efn2dIlGZhYWYjU2A3clsbVFYrGlBkoU0WOUm9yD4gazuRmTjZTzi5mTWZ3itduiYfACVwuB/I8RyPrxtXnw92AAADUUlEQVQ4y9WN45IcYRSGv+me6Z7uYcY2MrZnbVvZ7Mb22nZs27Zt28aVpDeVf7mCPFXnVJ163rcO+M8YWxE7cvp9ce3NmbffnI4d+48/4uKweWyzZEFLgThLl5V++G+k+m+9WO6Qz5wV6mV9jKkMZ9f57HBt7B+jbe8j9NhX2ZoTB2eHDJUXQOyPSiwy2KuRPiES34Ha4xEeRnNqQuPHjR8YGvpGdM4PDRNHJOAqPvLWA0ywcs9GlI2NG2cYHLh48ddo4OfwoKH3DCtYUhx0gInwgyBq0WgKDkYMhoHh8pGRCz3nKo2sXOsat9up2QOkyuA69zY1WbYGr6oyGiJl/f0nz51pscNqGq2h/dExwJXmKA4c01Pldb68e/jZxsazxpPH8Q0Kx51sp1DYeQCoJ6OOuu0OuVXQU2DR9UT279zfjOWg60IM2waXs6MJ0MfQPfYmd4uvUbdgAe/EziXx8VPu5s8uyUtANtmWC7sAbQys1es1OKZiTDNPuJq29XPriqXJl2alJibw8lw1QoBO8uj19jAydaqKxyudt6R1a+uipWKEkpAQRwnUMreB/Fx9uytF5/U2v3v+6cX1+Bnr5ydNucHfsnKumJIiYWaAL3v7qm/NXBw69ax7fn3h7hnLVIzpSYvW7j1VeIiZXpSKgEVbKqqLOoqELwufPv76YUXSlbjEa/G7u7sLdz1sMndMiwNpyyqAsKirqyR1dXl5/er5M6ZPSVs7r7581zzrKrnfSgHTxRWgs6/EJkYQlfdy4tTNSWmbGQzk6NGMQNlGpVQMEk2d1X7tdlYZg0HRtTGQjPWH+BgexVX8qDEoI6OAItE2pGe/hiCcOZHH5+so91fyMcy7yQsZ+3Nl0slggkky2cIugKB9qWiKCsmIa86c7RMsNGWy8LnJZh8ThPcxM5lMXkzZKrk9ULqYknWcPXEhq00yZ24KJSscjQIIIpFiBFgbm0aXocmTJrHzJpjS3VZzbqCUL6gyVgHCi4jBFmYmczhjRuHQZHSYlhOOQpBIJALEhkQkgvzlSrKMQ6PR6RwOFybDc2p24KwYEiDk6I8dtllqqpJLGDKZTnYqFFQqd45kmsUGBCSWoDTfIqWrqTCs0GqVZLLf729wKrhUAi78Gx5i6x+jvtqtAAAAAElFTkSuQmCC"
            },
            2518: (e, t, n) => {
                "use strict";
                n.d(t, {
                    A: () => a
                });
                var o, r = n(7271).Ay.BlendMode;
                ! function(e) {
                    e[e.COMPOSITE = r.COMPOSITE_BLEND] = "COMPOSITE", e[e.MAXIMUM_INTENSITY_BLEND = r.MAXIMUM_INTENSITY_BLEND] = "MAXIMUM_INTENSITY_BLEND", e[e.MINIMUM_INTENSITY_BLEND = r.MINIMUM_INTENSITY_BLEND] = "MINIMUM_INTENSITY_BLEND", e[e.AVERAGE_INTENSITY_BLEND = r.AVERAGE_INTENSITY_BLEND] = "AVERAGE_INTENSITY_BLEND", e[e.LABELMAP_EDGE_PROJECTION_BLEND = r.LABELMAP_EDGE_PROJECTION_BLEND] = "LABELMAP_EDGE_PROJECTION_BLEND"
                }(o || (o = {}));
                const a = o
            },
            2634: () => {},
            2642: (e, t, n) => {
                "use strict";
                var o = n(7720),
                    r = Object.prototype.hasOwnProperty,
                    a = Array.isArray,
                    i = {
                        allowDots: !1,
                        allowEmptyArrays: !1,
                        allowPrototypes: !1,
                        allowSparse: !1,
                        arrayLimit: 20,
                        charset: "utf-8",
                        charsetSentinel: !1,
                        comma: !1,
                        decodeDotInKeys: !1,
                        decoder: o.decode,
                        delimiter: "&",
                        depth: 5,
                        duplicates: "combine",
                        ignoreQueryPrefix: !1,
                        interpretNumericEntities: !1,
                        parameterLimit: 1e3,
                        parseArrays: !0,
                        plainObjects: !1,
                        strictDepth: !1,
                        strictNullHandling: !1,
                        throwOnLimitExceeded: !1
                    },
                    s = function(e) {
                        return e.replace(/&#(\d+);/g, (function(e, t) {
                            return String.fromCharCode(parseInt(t, 10))
                        }))
                    },
                    l = function(e, t, n) {
                        if (e && "string" == typeof e && t.comma && e.indexOf(",") > -1) return e.split(",");
                        if (t.throwOnLimitExceeded && n >= t.arrayLimit) throw new RangeError("Array limit exceeded. Only " + t.arrayLimit + " element" + (1 === t.arrayLimit ? "" : "s") + " allowed in an array.");
                        return e
                    },
                    c = function(e, t, n, a) {
                        if (e) {
                            var i = n.allowDots ? e.replace(/\.([^.[]+)/g, "[$1]") : e,
                                s = /(\[[^[\]]*])/g,
                                c = n.depth > 0 && /(\[[^[\]]*])/.exec(i),
                                u = c ? i.slice(0, c.index) : i,
                                d = [];
                            if (u) {
                                if (!n.plainObjects && r.call(Object.prototype, u) && !n.allowPrototypes) return;
                                d.push(u)
                            }
                            for (var h = 0; n.depth > 0 && null !== (c = s.exec(i)) && h < n.depth;) {
                                if (h += 1, !n.plainObjects && r.call(Object.prototype, c[1].slice(1, -1)) && !n.allowPrototypes) return;
                                d.push(c[1])
                            }
                            if (c) {
                                if (!0 === n.strictDepth) throw new RangeError("Input depth exceeded depth option of " + n.depth + " and strictDepth is true");
                                d.push("[" + i.slice(c.index) + "]")
                            }
                            return function(e, t, n, r) {
                                var a = 0;
                                if (e.length > 0 && "[]" === e[e.length - 1]) {
                                    var i = e.slice(0, -1).join("");
                                    a = Array.isArray(t) && t[i] ? t[i].length : 0
                                }
                                for (var s = r ? t : l(t, n, a), c = e.length - 1; c >= 0; --c) {
                                    var u, d = e[c];
                                    if ("[]" === d && n.parseArrays) u = n.allowEmptyArrays && ("" === s || n.strictNullHandling && null === s) ? [] : o.combine([], s);
                                    else {
                                        u = n.plainObjects ? {
                                            __proto__: null
                                        } : {};
                                        var h = "[" === d.charAt(0) && "]" === d.charAt(d.length - 1) ? d.slice(1, -1) : d,
                                            f = n.decodeDotInKeys ? h.replace(/%2E/g, ".") : h,
                                            m = parseInt(f, 10);
                                        n.parseArrays || "" !== f ? !isNaN(m) && d !== f && String(m) === f && m >= 0 && n.parseArrays && m <= n.arrayLimit ? (u = [])[m] = s : "__proto__" !== f && (u[f] = s) : u = {
                                            0: s
                                        }
                                    }
                                    s = u
                                }
                                return s
                            }(d, t, n, a)
                        }
                    };
                e.exports = function(e, t) {
                    var n = function(e) {
                        if (!e) return i;
                        if (void 0 !== e.allowEmptyArrays && "boolean" != typeof e.allowEmptyArrays) throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");
                        if (void 0 !== e.decodeDotInKeys && "boolean" != typeof e.decodeDotInKeys) throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");
                        if (null !== e.decoder && void 0 !== e.decoder && "function" != typeof e.decoder) throw new TypeError("Decoder has to be a function.");
                        if (void 0 !== e.charset && "utf-8" !== e.charset && "iso-8859-1" !== e.charset) throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");
                        if (void 0 !== e.throwOnLimitExceeded && "boolean" != typeof e.throwOnLimitExceeded) throw new TypeError("`throwOnLimitExceeded` option must be a boolean");
                        var t = void 0 === e.charset ? i.charset : e.charset,
                            n = void 0 === e.duplicates ? i.duplicates : e.duplicates;
                        if ("combine" !== n && "first" !== n && "last" !== n) throw new TypeError("The duplicates option must be either combine, first, or last");
                        return {
                            allowDots: void 0 === e.allowDots ? !0 === e.decodeDotInKeys || i.allowDots : !!e.allowDots,
                            allowEmptyArrays: "boolean" == typeof e.allowEmptyArrays ? !!e.allowEmptyArrays : i.allowEmptyArrays,
                            allowPrototypes: "boolean" == typeof e.allowPrototypes ? e.allowPrototypes : i.allowPrototypes,
                            allowSparse: "boolean" == typeof e.allowSparse ? e.allowSparse : i.allowSparse,
                            arrayLimit: "number" == typeof e.arrayLimit ? e.arrayLimit : i.arrayLimit,
                            charset: t,
                            charsetSentinel: "boolean" == typeof e.charsetSentinel ? e.charsetSentinel : i.charsetSentinel,
                            comma: "boolean" == typeof e.comma ? e.comma : i.comma,
                            decodeDotInKeys: "boolean" == typeof e.decodeDotInKeys ? e.decodeDotInKeys : i.decodeDotInKeys,
                            decoder: "function" == typeof e.decoder ? e.decoder : i.decoder,
                            delimiter: "string" == typeof e.delimiter || o.isRegExp(e.delimiter) ? e.delimiter : i.delimiter,
                            depth: "number" == typeof e.depth || !1 === e.depth ? +e.depth : i.depth,
                            duplicates: n,
                            ignoreQueryPrefix: !0 === e.ignoreQueryPrefix,
                            interpretNumericEntities: "boolean" == typeof e.interpretNumericEntities ? e.interpretNumericEntities : i.interpretNumericEntities,
                            parameterLimit: "number" == typeof e.parameterLimit ? e.parameterLimit : i.parameterLimit,
                            parseArrays: !1 !== e.parseArrays,
                            plainObjects: "boolean" == typeof e.plainObjects ? e.plainObjects : i.plainObjects,
                            strictDepth: "boolean" == typeof e.strictDepth ? !!e.strictDepth : i.strictDepth,
                            strictNullHandling: "boolean" == typeof e.strictNullHandling ? e.strictNullHandling : i.strictNullHandling,
                            throwOnLimitExceeded: "boolean" == typeof e.throwOnLimitExceeded && e.throwOnLimitExceeded
                        }
                    }(t);
                    if ("" === e || null == e) return n.plainObjects ? {
                        __proto__: null
                    } : {};
                    for (var u = "string" == typeof e ? function(e, t) {
                            var n = {
                                    __proto__: null
                                },
                                c = t.ignoreQueryPrefix ? e.replace(/^\?/, "") : e;
                            c = c.replace(/%5B/gi, "[").replace(/%5D/gi, "]");
                            var u = t.parameterLimit === 1 / 0 ? void 0 : t.parameterLimit,
                                d = c.split(t.delimiter, t.throwOnLimitExceeded ? u + 1 : u);
                            if (t.throwOnLimitExceeded && d.length > u) throw new RangeError("Parameter limit exceeded. Only " + u + " parameter" + (1 === u ? "" : "s") + " allowed.");
                            var h, f = -1,
                                m = t.charset;
                            if (t.charsetSentinel)
                                for (h = 0; h < d.length; ++h) 0 === d[h].indexOf("utf8=") && ("utf8=%E2%9C%93" === d[h] ? m = "utf-8" : "utf8=%26%2310003%3B" === d[h] && (m = "iso-8859-1"), f = h, h = d.length);
                            for (h = 0; h < d.length; ++h)
                                if (h !== f) {
                                    var g, p, v = d[h],
                                        y = v.indexOf("]="),
                                        b = -1 === y ? v.indexOf("=") : y + 1; - 1 === b ? (g = t.decoder(v, i.decoder, m, "key"), p = t.strictNullHandling ? null : "") : (g = t.decoder(v.slice(0, b), i.decoder, m, "key"), p = o.maybeMap(l(v.slice(b + 1), t, a(n[g]) ? n[g].length : 0), (function(e) {
                                        return t.decoder(e, i.decoder, m, "value")
                                    }))), p && t.interpretNumericEntities && "iso-8859-1" === m && (p = s(String(p))), v.indexOf("[]=") > -1 && (p = a(p) ? [p] : p);
                                    var w = r.call(n, g);
                                    w && "combine" === t.duplicates ? n[g] = o.combine(n[g], p) : w && "last" !== t.duplicates || (n[g] = p)
                                }
                            return n
                        }(e, n) : e, d = n.plainObjects ? {
                            __proto__: null
                        } : {}, h = Object.keys(u), f = 0; f < h.length; ++f) {
                        var m = h[f],
                            g = c(m, u[m], n, "string" == typeof e);
                        d = o.merge(d, g, n)
                    }
                    return !0 === n.allowSparse ? d : o.compact(d)
                }
            },
            2723: e => {
                "use strict";
                e.exports = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAACf1BMVEUAAAABAEACAEYAACUAADgAADEAACsAAC9SAJYAAAwGAFgdAKpaAYUAADUAACAAABMDAE8JAHEFAGADAFQBABgCABBOAJ0MAIwCAEw6AK0XAKQVAF0KADNDAKAPAJxWAJEYAI4TAIgKAIUMAHtsDWULAEgDADz98+0pALI+AKUlAaQrAKEfAKESAIQTBHgfAXYtAW00BmsGAGoHAGUMAGP//v40ALcuBKgzAKAbAJ4pAJ05AJscApglAJhEAJUSAJEkAo1YAIwZAIoKAIATAH4rBHsWAHNmB24SA2odAVyEHDeOIisAABz38fTr3uX95tYyAK0kAKxJAKRKAJnus5IbAJFMAZBVAotJBYdeB31iBXc+CW0fBWtYCWoTAGVAB2EsBl5WE1UVAlJxE1BWEEwNAECXJx+5PhrwZgvOTAr+7+bi2OT66eDjz9nIssvjy8mqlsW4qcT507mPdLjuw7C4jqs2CanZrKWldKNYO6BYHZyKU5uYZZoXAJotA5g+ApUlE5QyAZFCAo03Ao2GXIo8LYo4EolZEYk8B4ZRA4WGVHY2B3HXgGBnFF83CF9qEFoqBFJgEUyDHktKDkt7FUmBGUU0CUUkBkWNIjOLHzCIIS2SIyOmMB9sLBmqPxiXNhHXUgsSBwrSxeLDt9fNtdL84MzFoMChkrqLe7reuLjJnrKPeabCmqKMZp1rR503HZdeNJXVmpGxjI9POYswHIpJMIeSZoamaISUU4RlKIK/eXlAH3kyBHaLN3VdLHVXF3G8bWncimfqk2G/a2FvWGByHVvli1exWVd5G1F+M01tEkq8WEOpRT9lFjwlBDZ6HDVrGi7WZisSASQrCxLeVQOSa1CeAAADLklEQVQ4y9WN05ocURRGzzmlLnS53T1tG2Obse1kJrZt27Zt29YDpSbJXZ4g6+a/WGt/G/xn0AaVtPsRMjOybUyb4R+vh9DLxiWmedAG76KQiRnzN6H/jAHBAMwyw0Zt2/1172j/8EEjcVH9bVSB7sxsaPen0ckdLXt/gGNHWkfsb/0y3DzS0HmP8bwAUcPgHQdax477efSIVh862jG2dWxLGvrtGA9kkmpmxLoR+w+07BvX3n64M2jv2Ldzy6ghaXsgZQcZYs9msS45fPPolp27xnUctn//vOng9sZ1NTmm2UZu3QMQkfY3pzACjhwycKBv19vl77cMOOirH4pjEPKCfRggUQJPDVMxWL+sPjVk1JLZPp9v07YxBByKSJoWtgJMQWSVjUK5XtxD74oB2+/OXTC/f4PiX8y6IU6pFMDNBM9QTStCBYVDm8rXzArmdzl+tdyF98mz9nBDVQDQTKkGfvA6S4iVMtKqruOnnwpOa6pFnry8HjUBSQVmpU0QbP3LrNZQ4eK184ITu3UbPy1RrPlaU9QfawAbkoIBd3UvXHvv0fn7Iy7kTzp9ssuEW/0fP6hPeCoVlgUb39E0VDyDXsx8PeX2xZldrxTOnpE/Zdb6p3PuVMlYpRUE1xtojMeOvZzTu/e359263PAsnZo//dnGc72v2xk+6wUTVgmAxgSVunnpzceFMyZPOnOi69TLKz9cmzeYCWCMB5xN0ECgCbfXWra6yJRXNTc4cUEktmjNfDbqsJFKLSiTtRdtNmOYZU3dLT2sSycvtFgc/SrYMNeYxnEzMIk8n4WpaqcjlmELCgpMK1eXhsORkijna0ziogIkWVTi7iqOK42LlSErW/vE3SfaM5J19e3bR5YiZaC0KOaKFbPGilwgV9LdbSp+VSdF+pYyyFVpKq7o1w9wTp2uZ9hiiUMcMrKSrUtLstSUy9SUFC3pNaBxINBpaI2l3CUjDbMZIYjjetSwnOO4amc14HTVHKfTGXUliNTjCA/ocQgpvV4vJpdV9DIagdOpWaMjWiNiGEVRhF6DICiCpAjIZLxx4DD2dBSVJ0ScJAmC4Ns0gWloQ2oQ1C83prpOjqKhXgAAAABJRU5ErkJggg=="
            },
            2881: (e, t, n) => {
                "use strict";
                n.d(t, {
                    A: () => s
                });
                var o = n(9473),
                    r = n(346),
                    a = n.n(r),
                    i = n(9788);
                const s = (e, t, n = "error", r = [void 0, void 0], s, ...l) => {
                    var c;
                    const u = 500 * t.length + 2e3;
                    (0, i.Ay)(e, (0, o.nF)((() => {
                        var e;
                        null == s || s(...l), a()[n]({
                            title: t,
                            timeout: null !== (e = r[1]) && void 0 !== e ? e : u
                        })
                    }), null !== (c = r[0]) && void 0 !== c ? c : u, {
                        trailing: !1
                    }))
                }
            },
            2901: (e, t, n) => {
                "use strict";
                n.d(t, {
                    A: () => a
                });
                var o = n(816);

                function r(e, t) {
                    for (var n = 0; n < t.length; n++) {
                        var r = t[n];
                        r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, (0, o.A)(r.key), r)
                    }
                }

                function a(e, t, n) {
                    return t && r(e.prototype, t), n && r(e, n), Object.defineProperty(e, "prototype", {
                        writable: !1
                    }), e
                }
            },
            3029: (e, t, n) => {
                "use strict";

                function o(e, t) {
                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                }
                n.d(t, {
                    A: () => o
                })
            },
            3093: (e, t, n) => {
                "use strict";
                var o = n(4459);
                e.exports = function(e) {
                    return o(e) || 0 === e ? e : e < 0 ? -1 : 1
                }
            },
            3126: (e, t, n) => {
                "use strict";
                var o = n(6743),
                    r = n(9675),
                    a = n(76),
                    i = n(3144);
                e.exports = function(e) {
                    if (e.length < 1 || "function" != typeof e[0]) throw new r("a function is required");
                    return i(o, a, e)
                }
            },
            3144: (e, t, n) => {
                "use strict";
                var o = n(6743),
                    r = n(1002),
                    a = n(76),
                    i = n(7119);
                e.exports = i || o.call(a, r)
            },
            3145: (e, t, n) => {
                "use strict";

                function o(e, t) {
                    (null == t || t > e.length) && (t = e.length);
                    for (var n = 0, o = Array(t); n < t; n++) o[n] = e[n];
                    return o
                }
                n.d(t, {
                    A: () => o
                })
            },
            3399: (e, t, n) => {
                "use strict";
                n.d(t, {
                    Cb: () => l,
                    Ht: () => r,
                    RZ: () => c,
                    Ss: () => s,
                    _H: () => i,
                    er: () => d,
                    mI: () => h,
                    mi: () => m,
                    oc: () => f,
                    r0: () => o,
                    z9: () => u,
                    zG: () => g
                });
                const o = "layoutCellsInner",
                    r = "layoutImage",
                    a = "grid-stack-item-content",
                    i = "stitching-stack";

                function s(e) {
                    return e.classList.contains(o)
                }

                function l(e) {
                    return e.querySelector(`.${o}`)
                }

                function c(e) {
                    return e.querySelectorAll(`.${o}`)
                }

                function u(e) {
                    return e.querySelectorAll(`.${r}`)
                }

                function d(e) {
                    return e.querySelector(`.${r}.active`)
                }

                function h(e) {
                    return e.classList.contains(a)
                }

                function f(e) {
                    return e.querySelector(`.${a}`)
                }

                function m(e) {
                    return e.classList.contains(i)
                }

                function g(e) {
                    return e.querySelectorAll(`.${i}`)
                }
            },
            3522: e => {
                "use strict";
                e.exports = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABEVBMVEX3+//i7fja6fbo8vrU5fTl7/nv9v19tdne6/fO4vKky+TB2u2gyOOBt9rG3e+u0OfX5/WnzOWSwd+Ku9yPvt55sti92OyrzeaYw+Dr8/u41eq21Om71uubxuJrqNSz0+mx0eiGudsUNnJnpdHy+P7K4PCdxeGEuNvD3O6+2ex0r9ZjotBJjcWVwt8oVpIlS4WZv91WlslghK5Teqo3ZJsfQnsVO3gRMGuiw9+dvNhyrdV5rdRcnM2DqMtjjLhJcKE0XZMWP39wptF+rdCPrMt2nsRplcBAhL9Pib1nk7xcj7xGgrhQhLVAeLA4cqxAbKFHZ5g2Wo4aR4ksUIeHsdWWttRlnMg6fLtYiLc2bKcxaqcwQHXtAAACnElEQVQ4y9WRVY5cMRBFTc/c9mOmZu4enuDMhJk5+19I3FF+oqwgV7LLch3XLbnAfyZKC44IQj4RU7+g/+QhQkpWhqhGKzsrif83Qn2E0FQ0q2EfjWORzRQk+E/hCQATqvxsGPd5OxYAPhzH7fhOTxbYZQAuigL5ZZmvx+vjzeaue3Nrs1mv1612DXkFIB6sBKmj8bodHz/79tABR8824zZJBhIhy4HxlCRp2eu4bdvjzT0fLQb32mRuzXSpvL4ECEqRWgz5NEqSVXsnThJ2L9ELiDkvKNLA81OYNQXmQRNk8zthuFolyVx4yCCPUloC7DoJFEQiYlptWfvy9OWjKCVEByXisOCAI4gFXDTNNlcLzd6NLkef7ssO2c7qklMKuO8q4S4KtTRTc/v84uOD0XulUNpXuuMKA58UlJrYWjub5fn90cUDB9RZ2lWqln6WAmkphV0+2z76evYmPrncn30Y7b9En4+yOq1IIMGbu5MJJ8vZ693b/dW7/fnt/Ojk8tP101dnrwPhVRaMntAJxth7fLPbvfp5MXqcBteXH3+83e1OfYLFApzfpoBiWvBbV8+Pr05u9qcfzq+fvHh+dr8WHIslOFEOoLBUNsubtAtORxcvtLQDJnVsMFEgE86iUFEsgzQPdXbr5nsYxoNYxiwJOPRBTTCeooCxKJvKcJvXT4/CMJxJzVZJx30CjCBumJKxPCWVtoGaV72OpOiGkRVGZyDMgz7I5DA23OimrrO7lZHzkCBb1TZmDDA2GAzjcFtzCIkgogqMMEsj+iYPh8kqAQMnx4SyEuggHyHuWLQMGUvYocLA7QdEEg/C30m3nEjZRMP58GDhPKKm8w//6TnoIO9wQsSkJYjmUZQHS8Kx565x4cJvErpwwH4BGi5IMMkKl1sAAAAASUVORK5CYII="
            },
            3577: (e, t, n) => {
                "use strict";
                var o;
                n.d(t, {
                        A: () => r
                    }),
                    function(e) {
                        e[e.NEAREST = 0] = "NEAREST", e[e.LINEAR = 1] = "LINEAR", e[e.FAST_LINEAR = 2] = "FAST_LINEAR"
                    }(o || (o = {}));
                const r = o
            },
            3628: (e, t, n) => {
                "use strict";
                var o = n(8648),
                    r = n(1064),
                    a = n(7176);
                e.exports = o ? function(e) {
                    return o(e)
                } : r ? function(e) {
                    if (!e || "object" != typeof e && "function" != typeof e) throw new TypeError("getProto: not an object");
                    return r(e)
                } : a ? function(e) {
                    return a(e)
                } : null
            },
            3678: (e, t, n) => {
                "use strict";
                n.d(t, {
                    OU: () => g,
                    kX: () => m,
                    r: () => f
                });
                var o = n(9584),
                    r = n(281),
                    a = n(1948),
                    i = n(4594),
                    s = n(9473);
                const {
                    DBCacheImages: l,
                    systemInfo: c
                } = i.A, u = o.webGL.textureCache;
                let d;
                const h = e => {
                        e !== o.EVENTS.IMAGE_CACHE_FULL && (d = e)
                    },
                    f = (e, t, n = 30) => {
                        try {
                            if ("MPR" === d) return g(), h(e), !1;
                            if (h(e), t || 0 === i.A.imageCacheTypeDefault && i.A.DBCacheImages.enable && o.imageCache.cachedImages.length > n) return g(), !0
                        } catch (e) {
                            return console.error(e), !1
                        }
                    };
                (() => {
                    const e = (e => {
                        let t = 1073741824;
                        return e >= 2 ? t : e >= 1.5 ? 858993459.2 : e >= 1 ? 644245094.4 : 429496729.6
                    })(c.performanceLevel) * (l.enable ? .8 : 1);
                    o.imageCache.setMaximumSizeBytes(e)
                })();
                const m = (0, s.sg)(f, 300, {
                        leading: !1,
                        trailing: !0
                    }),
                    g = () => {
                        a.wadouri.dataSetCacheManager.purge(), o.imageCache.purgeCache(), u.purgeCache(), r.store.modules.segmentation.state.colorLutTables.length = 0
                    }
            },
            3738: e => {
                function t(n) {
                    return e.exports = t = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                        return typeof e
                    } : function(e) {
                        return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
                    }, e.exports.__esModule = !0, e.exports.default = e.exports, t(n)
                }
                e.exports = t, e.exports.__esModule = !0, e.exports.default = e.exports
            },
            3893: (e, t, n) => {
                "use strict";
                n.d(t, {
                    Qo: () => c,
                    BW: () => u,
                    ye: () => h,
                    gk: () => d,
                    d8: () => m,
                    cY: () => v,
                    rn: () => f
                });
                var o = n(9584),
                    r = n(281),
                    a = n(4594);
                const i = (0, r.importInternal)("util/convertToVector3"),
                    s = .1;

                function l(e, t, n) {
                    if ("print" == (null == e ? void 0 : e.name)) {
                        const {
                            synchronizerType: e
                        } = a.A.webDicomView.webDicomViewPrint;
                        switch (e) {
                            case "study":
                                return !0;
                            case "series":
                                {
                                    const e = o.metaData.get("generalSeriesModule", (0, o.getEnabledElement)(t).image.imageId),
                                        r = o.metaData.get("generalSeriesModule", (0, o.getEnabledElement)(n).image.imageId);
                                    return !(!e.seriesInstanceUID || !r.seriesInstanceUID) && e.seriesInstanceUID == r.seriesInstanceUID
                                }
                            case "image":
                                return !1
                        }
                    }
                    if ("stackPositionSynchronizer" === a.A.tackSynchronizerType) {
                        const e = o.metaData.get("imagePlaneModule", (0, o.getEnabledElement)(t).image.imageId),
                            r = o.metaData.get("imagePlaneModule", (0, o.getEnabledElement)(n).image.imageId);
                        if (!e.imageOrientationPatient || !r.imageOrientationPatient) return !1;
                        const a = i(e.rowCosines).distanceToSquared(i(r.rowCosines)),
                            l = i(e.columnCosines).distanceToSquared(i(r.columnCosines));
                        return a < s && l < s
                    }
                    return !0
                }

                function c(e, t, n) {
                    if (n === t) return;
                    if (!l(e, t, n)) return;
                    const r = (0, o.getViewport)(t),
                        a = (0, o.getViewport)(n);
                    a.colormap !== r.colormap && (a.colormap = r.colormap, e.setViewport(n, a))
                }

                function u(e, t, n) {
                    if (n === t) return;
                    if (!l(e, t, n)) return;
                    const r = (0, o.getViewport)(t),
                        a = (0, o.getViewport)(n);
                    a.invert !== r.invert && (a.invert = r.invert, e.setViewport(n, a))
                }

                function d(e, t, n) {
                    if (n === t) return;
                    if (!l(e, t, n)) return;
                    const r = (0, o.getViewport)(t),
                        a = (0, o.getViewport)(n);
                    a.rotation === r.rotation && a.hflip === r.hflip && a.vflip === r.vflip || (a.rotation = r.rotation, a.hflip = r.hflip, a.vflip = r.vflip, e.setViewport(n, a))
                }

                function h(e, t, n) {
                    if (n === t) return;
                    if (!l(e, t, n)) return;
                    const r = (0, o.getViewport)(t),
                        a = (0, o.getViewport)(n);
                    a.translation.x === r.translation.x && a.translation.y === r.translation.y || (a.translation.x = r.translation.x, a.translation.y = r.translation.y, e.setViewport(n, a))
                }

                function f(e, t, n) {
                    if (n === t) return;
                    if (!l(e, t, n)) return;
                    const r = (0, o.getViewport)(t),
                        a = (0, o.getViewport)(n);
                    a.voi.windowWidth === r.voi.windowWidth && a.voi.windowCenter === r.voi.windowCenter || (a.voi.windowWidth = r.voi.windowWidth, a.voi.windowCenter = r.voi.windowCenter, e.setViewport(n, a))
                }

                function m(e, t, n) {
                    if (n === t) return;
                    if (!l(e, t, n)) return;
                    const r = (0, o.getViewport)(t),
                        a = (0, o.getViewport)(n);
                    a.scale !== r.scale && (a.scale = r.scale, e.setViewport(n, a))
                }
                var g = n(6402),
                    p = n(8398);

                function v(e, t, n, a) {
                    if (t === n || !a) return;
                    const i = (0, r.getToolState)(n, "stack").data[0];
                    if (a.direction) i.isScroll = !0;
                    else {
                        if (i.isScroll) return delete i.isScroll;
                        isNaN(i.oldImageIdIndex) && (a.direction = 1);
                        const e = i.currentImageIdIndex - i.oldImageIdIndex;
                        Math.abs(e) > 0 && (a.direction = e > 0 ? 1 : -1), -e === i.imageIds.length && (a.direction = 1)
                    }
                    let s = i.currentImageIdIndex + a.direction;
                    if (s = (0, p.qE)(s, 0, i.imageIds.length - 1), i.currentImageIdIndex === s) return;
                    const l = r.loadHandlerManager.getStartLoadHandler(n),
                        c = r.loadHandlerManager.getEndLoadHandler(n),
                        u = r.loadHandlerManager.getErrorLoadingHandler(n),
                        d = i.imageIds[s];
                    i.oldImageIdIndex = i.currentImageIdIndex, i.currentImageIdIndex = s, null == l || l(n), (0, g.BY)(d).then((function(t) {
                        i.currentImageIdIndex === s && (e.displayImage(n, t, (0, o.getViewport)(n)), null == c || c(n, t))
                    }), (function(e) {
                        null == u || u(n, d, e)
                    }))
                }
            },
            4012: (e, t, n) => {
                "use strict";
                var o;
                n.d(t, {
                        A: () => r
                    }),
                    function(e) {
                        e.AXIAL = "axial", e.CORONAL = "coronal", e.SAGITTAL = "sagittal", e.ACQUISITION = "acquisition"
                    }(o || (o = {}));
                const r = o
            },
            4025: (e, t, n) => {
                "use strict";
                n.d(t, {
                    A: () => r
                });
                var o = n(9473);

                function r() {
                    return (0, o._K)().isMobile || (0, o._K)().isIpad || (0, o._K)().isAndroid ? "mobile" : "PC"
                }
            },
            4039: (e, t, n) => {
                "use strict";
                var o = "undefined" != typeof Symbol && Symbol,
                    r = n(1333);
                e.exports = function() {
                    return "function" == typeof o && ("function" == typeof Symbol && ("symbol" == typeof o("foo") && ("symbol" == typeof Symbol("bar") && r())))
                }
            },
            4459: e => {
                "use strict";
                e.exports = Number.isNaN || function(e) {
                    return e != e
                }
            },
            4467: (e, t, n) => {
                "use strict";
                n.d(t, {
                    A: () => r
                });
                var o = n(816);

                function r(e, t, n) {
                    return (t = (0, o.A)(t)) in e ? Object.defineProperty(e, t, {
                        value: n,
                        enumerable: !0,
                        configurable: !0,
                        writable: !0
                    }) : e[t] = n, e
                }
            },
            4508: (e, t, n) => {
                "use strict";
                n.d(t, {
                    A: () => s
                });
                var o = n(4594);
                const r = !1,
                    a = e => ((e ? new URL(e) : window.location).pathname.match(/(\/[^/]*)+\//) || ["/"])[0];
                let i;

                function s() {
                    var e;
                    const t = window.staticResourceURLPrefix || o.A.instanceOptions.publicPath || i;
                    if (t) return t;
                    const n = null === (e = document.currentScript) || void 0 === e ? void 0 : e.src;
                    let s;
                    return s = n ? a(n) : a() + (r ? "" : "./dicomviewer-cornerstone/"), i = s, s
                }
            },
            4594: (e, t, n) => {
                "use strict";
                n.d(t, {
                    A: () => p
                });
                var o = n(4025),
                    r = n(8398);
                const a = JSON.parse('{"rE":"1.7.1.250429"}');
                var i, s, l, c = n(9473),
                    u = n(2117);
                const d = (0, o.A)(),
                    h = "mobile" === d,
                    f = ((null === (s = null === (i = window.performance) || void 0 === i ? void 0 : i.memory) || void 0 === s ? void 0 : s.jsHeapSizeLimit) || 0) / 1024 / 1024 / 1024,
                    {
                        rE: m
                    } = a,
                    g = {
                        instanceOptions: {},
                        env: d,
                        isMobile: h,
                        webDicomView: {},
                        sharedArrayBuffer: void 0,
                        forceIM: !0,
                        imageTypeDefault: void 0,
                        _imageType: c.IG.getItem("imageType"),
                        get imageType() {
                            var e;
                            return null !== (e = this._imageType) && void 0 !== e ? e : this.imageTypeDefault
                        },
                        set imageType(e) {
                            this._imageType = e, c.IG.setItem("imageType", e)
                        },
                        tackSynchronizerTypeDefault: "stackIndexSynchronizer",
                        _tackSynchronizerType: c.IG.getItem("tackSynchronizerType"),
                        get tackSynchronizerType() {
                            return this._tackSynchronizerType || this.tackSynchronizerTypeDefault
                        },
                        set tackSynchronizerType(e) {
                            this._tackSynchronizerType = e, c.IG.setItem("tackSynchronizerType", e)
                        },
                        _imageCacheTypeDefault: null !== (l = c.IG.getItem("imageCacheTypeDefault")) && void 0 !== l ? l : 0,
                        get imageCacheTypeDefault() {
                            return this._imageCacheTypeDefault
                        },
                        set imageCacheTypeDefault(e) {
                            this._imageCacheTypeDefault = e, c.IG.setItem("imageCacheTypeDefault", e)
                        },
                        logoURL: n(5738),
                        cavanAroundInfo: !0,
                        minRenderCountMPR3D: 10,
                        preload: {
                            scroll: !0,
                            scrollNum: 9,
                            seriesFetchNum: 0,
                            fullLoad: !1
                        },
                        AI: {
                            resultURL: void 0,
                            parseSuccess: !1,
                            active: !1,
                            jumpFirstAI: !1,
                            getParseHandler: void 0
                        },
                        toolsBar: {
                            navigationBottomLayout: !0,
                            seriesBarVisibility: !0,
                            VRTVisibility: !0,
                            MPRVisibility: !0,
                            MPRFusionVisibility: !0,
                            MPRFusion2Visibility: !1,
                            AIVisibility: !0,
                            enhanceVisibility: !1,
                            aboutUsVisibility: !0,
                            fastImageModeVisibility: void 0,
                            fasModeVisibility: !0,
                            staModeVisibility: !0,
                            majModeVisibility: !1,
                            imageModeVisibility: !0,
                            languageVisibility: !1,
                            printVisibility: !1,
                            customMenu: {
                                main: void 0,
                                MPR: void 0,
                                VRT: void 0
                            }
                        },
                        toolsOptions: {
                            toolColor: "#FF7F0E",
                            zoomTool: {
                                minScale: .05,
                                maxScale: 100
                            }
                        },
                        DBCacheImages: {
                            dbName: "ClearDicomView",
                            version: Number(null == m ? void 0 : m.replace(/[^\d]/g, "").slice(-6)),
                            storeName: "cornerstoneStore",
                            temporaryEnable: !1,
                            enableDefault: !0,
                            _enable: c.IG.getItem("enableDBCacheImages"),
                            get enable() {
                                var e;
                                return null !== (e = this._enable) && void 0 !== e ? e : this.enableDefault
                            },
                            set enable(e) {
                                this._enable = e, c.IG.setItem("enableDBCacheImages", e)
                            }
                        },
                        aboutUs: {
                            imgURl: void 0,
                            description: () => (0, u.Tl)("aboutUs.description"),
                            originVersion: m,
                            version: null == m ? void 0 : m.replace("_", "."),
                            copyright: () => (0, u.Tl)("aboutUs.copyright"),
                            tel: () => (0, u.Tl)("aboutUs.tel")
                        },
                        toolsData: {
                            main: void 0,
                            MPR: void 0,
                            VRT: void 0
                        },
                        systemInfo: {
                            jsHeapSizeLimit: f,
                            performanceLevel: (0, r.B6)(f)
                        },
                        fusionData: {
                            PT: [],
                            CT: []
                        },
                        VRTWSURL: void 0
                    },
                    p = g
            },
            4621: (e, t, n) => {
                "use strict";
                n.d(t, {
                    Ay: () => i,
                    lD: () => r,
                    qO: () => a
                });
                var o = n(6579);

                function r(e) {
                    return o.A.get(e)
                }

                function a() {
                    return o.A.getAll()
                }
                const i = r
            },
            4633: (e, t, n) => {
                var o = n(3738).default;

                function r() {
                    "use strict"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
                    e.exports = r = function() {
                        return n
                    }, e.exports.__esModule = !0, e.exports.default = e.exports;
                    var t, n = {},
                        a = Object.prototype,
                        i = a.hasOwnProperty,
                        s = Object.defineProperty || function(e, t, n) {
                            e[t] = n.value
                        },
                        l = "function" == typeof Symbol ? Symbol : {},
                        c = l.iterator || "@@iterator",
                        u = l.asyncIterator || "@@asyncIterator",
                        d = l.toStringTag || "@@toStringTag";

                    function h(e, t, n) {
                        return Object.defineProperty(e, t, {
                            value: n,
                            enumerable: !0,
                            configurable: !0,
                            writable: !0
                        }), e[t]
                    }
                    try {
                        h({}, "")
                    } catch (t) {
                        h = function(e, t, n) {
                            return e[t] = n
                        }
                    }

                    function f(e, t, n, o) {
                        var r = t && t.prototype instanceof w ? t : w,
                            a = Object.create(r.prototype),
                            i = new L(o || []);
                        return s(a, "_invoke", {
                            value: D(e, n, i)
                        }), a
                    }

                    function m(e, t, n) {
                        try {
                            return {
                                type: "normal",
                                arg: e.call(t, n)
                            }
                        } catch (e) {
                            return {
                                type: "throw",
                                arg: e
                            }
                        }
                    }
                    n.wrap = f;
                    var g = "suspendedStart",
                        p = "suspendedYield",
                        v = "executing",
                        y = "completed",
                        b = {};

                    function w() {}

                    function x() {}

                    function T() {}
                    var I = {};
                    h(I, c, (function() {
                        return this
                    }));
                    var E = Object.getPrototypeOf,
                        S = E && E(E(O([])));
                    S && S !== a && i.call(S, c) && (I = S);
                    var A = T.prototype = w.prototype = Object.create(I);

                    function C(e) {
                        ["next", "throw", "return"].forEach((function(t) {
                            h(e, t, (function(e) {
                                return this._invoke(t, e)
                            }))
                        }))
                    }

                    function M(e, t) {
                        function n(r, a, s, l) {
                            var c = m(e[r], e, a);
                            if ("throw" !== c.type) {
                                var u = c.arg,
                                    d = u.value;
                                return d && "object" == o(d) && i.call(d, "__await") ? t.resolve(d.__await).then((function(e) {
                                    n("next", e, s, l)
                                }), (function(e) {
                                    n("throw", e, s, l)
                                })) : t.resolve(d).then((function(e) {
                                    u.value = e, s(u)
                                }), (function(e) {
                                    return n("throw", e, s, l)
                                }))
                            }
                            l(c.arg)
                        }
                        var r;
                        s(this, "_invoke", {
                            value: function(e, o) {
                                function a() {
                                    return new t((function(t, r) {
                                        n(e, o, t, r)
                                    }))
                                }
                                return r = r ? r.then(a, a) : a()
                            }
                        })
                    }

                    function D(e, n, o) {
                        var r = g;
                        return function(a, i) {
                            if (r === v) throw Error("Generator is already running");
                            if (r === y) {
                                if ("throw" === a) throw i;
                                return {
                                    value: t,
                                    done: !0
                                }
                            }
                            for (o.method = a, o.arg = i;;) {
                                var s = o.delegate;
                                if (s) {
                                    var l = P(s, o);
                                    if (l) {
                                        if (l === b) continue;
                                        return l
                                    }
                                }
                                if ("next" === o.method) o.sent = o._sent = o.arg;
                                else if ("throw" === o.method) {
                                    if (r === g) throw r = y, o.arg;
                                    o.dispatchException(o.arg)
                                } else "return" === o.method && o.abrupt("return", o.arg);
                                r = v;
                                var c = m(e, n, o);
                                if ("normal" === c.type) {
                                    if (r = o.done ? y : p, c.arg === b) continue;
                                    return {
                                        value: c.arg,
                                        done: o.done
                                    }
                                }
                                "throw" === c.type && (r = y, o.method = "throw", o.arg = c.arg)
                            }
                        }
                    }

                    function P(e, n) {
                        var o = n.method,
                            r = e.iterator[o];
                        if (r === t) return n.delegate = null, "throw" === o && e.iterator.return && (n.method = "return", n.arg = t, P(e, n), "throw" === n.method) || "return" !== o && (n.method = "throw", n.arg = new TypeError("The iterator does not provide a '" + o + "' method")), b;
                        var a = m(r, e.iterator, n.arg);
                        if ("throw" === a.type) return n.method = "throw", n.arg = a.arg, n.delegate = null, b;
                        var i = a.arg;
                        return i ? i.done ? (n[e.resultName] = i.value, n.next = e.nextLoc, "return" !== n.method && (n.method = "next", n.arg = t), n.delegate = null, b) : i : (n.method = "throw", n.arg = new TypeError("iterator result is not an object"), n.delegate = null, b)
                    }

                    function k(e) {
                        var t = {
                            tryLoc: e[0]
                        };
                        1 in e && (t.catchLoc = e[1]), 2 in e && (t.finallyLoc = e[2], t.afterLoc = e[3]), this.tryEntries.push(t)
                    }

                    function _(e) {
                        var t = e.completion || {};
                        t.type = "normal", delete t.arg, e.completion = t
                    }

                    function L(e) {
                        this.tryEntries = [{
                            tryLoc: "root"
                        }], e.forEach(k, this), this.reset(!0)
                    }

                    function O(e) {
                        if (e || "" === e) {
                            var n = e[c];
                            if (n) return n.call(e);
                            if ("function" == typeof e.next) return e;
                            if (!isNaN(e.length)) {
                                var r = -1,
                                    a = function n() {
                                        for (; ++r < e.length;)
                                            if (i.call(e, r)) return n.value = e[r], n.done = !1, n;
                                        return n.value = t, n.done = !0, n
                                    };
                                return a.next = a
                            }
                        }
                        throw new TypeError(o(e) + " is not iterable")
                    }
                    return x.prototype = T, s(A, "constructor", {
                        value: T,
                        configurable: !0
                    }), s(T, "constructor", {
                        value: x,
                        configurable: !0
                    }), x.displayName = h(T, d, "GeneratorFunction"), n.isGeneratorFunction = function(e) {
                        var t = "function" == typeof e && e.constructor;
                        return !!t && (t === x || "GeneratorFunction" === (t.displayName || t.name))
                    }, n.mark = function(e) {
                        return Object.setPrototypeOf ? Object.setPrototypeOf(e, T) : (e.__proto__ = T, h(e, d, "GeneratorFunction")), e.prototype = Object.create(A), e
                    }, n.awrap = function(e) {
                        return {
                            __await: e
                        }
                    }, C(M.prototype), h(M.prototype, u, (function() {
                        return this
                    })), n.AsyncIterator = M, n.async = function(e, t, o, r, a) {
                        void 0 === a && (a = Promise);
                        var i = new M(f(e, t, o, r), a);
                        return n.isGeneratorFunction(t) ? i : i.next().then((function(e) {
                            return e.done ? e.value : i.next()
                        }))
                    }, C(A), h(A, d, "Generator"), h(A, c, (function() {
                        return this
                    })), h(A, "toString", (function() {
                        return "[object Generator]"
                    })), n.keys = function(e) {
                        var t = Object(e),
                            n = [];
                        for (var o in t) n.push(o);
                        return n.reverse(),
                            function e() {
                                for (; n.length;) {
                                    var o = n.pop();
                                    if (o in t) return e.value = o, e.done = !1, e
                                }
                                return e.done = !0, e
                            }
                    }, n.values = O, L.prototype = {
                        constructor: L,
                        reset: function(e) {
                            if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = "next", this.arg = t, this.tryEntries.forEach(_), !e)
                                for (var n in this) "t" === n.charAt(0) && i.call(this, n) && !isNaN(+n.slice(1)) && (this[n] = t)
                        },
                        stop: function() {
                            this.done = !0;
                            var e = this.tryEntries[0].completion;
                            if ("throw" === e.type) throw e.arg;
                            return this.rval
                        },
                        dispatchException: function(e) {
                            if (this.done) throw e;
                            var n = this;

                            function o(o, r) {
                                return s.type = "throw", s.arg = e, n.next = o, r && (n.method = "next", n.arg = t), !!r
                            }
                            for (var r = this.tryEntries.length - 1; r >= 0; --r) {
                                var a = this.tryEntries[r],
                                    s = a.completion;
                                if ("root" === a.tryLoc) return o("end");
                                if (a.tryLoc <= this.prev) {
                                    var l = i.call(a, "catchLoc"),
                                        c = i.call(a, "finallyLoc");
                                    if (l && c) {
                                        if (this.prev < a.catchLoc) return o(a.catchLoc, !0);
                                        if (this.prev < a.finallyLoc) return o(a.finallyLoc)
                                    } else if (l) {
                                        if (this.prev < a.catchLoc) return o(a.catchLoc, !0)
                                    } else {
                                        if (!c) throw Error("try statement without catch or finally");
                                        if (this.prev < a.finallyLoc) return o(a.finallyLoc)
                                    }
                                }
                            }
                        },
                        abrupt: function(e, t) {
                            for (var n = this.tryEntries.length - 1; n >= 0; --n) {
                                var o = this.tryEntries[n];
                                if (o.tryLoc <= this.prev && i.call(o, "finallyLoc") && this.prev < o.finallyLoc) {
                                    var r = o;
                                    break
                                }
                            }
                            r && ("break" === e || "continue" === e) && r.tryLoc <= t && t <= r.finallyLoc && (r = null);
                            var a = r ? r.completion : {};
                            return a.type = e, a.arg = t, r ? (this.method = "next", this.next = r.finallyLoc, b) : this.complete(a)
                        },
                        complete: function(e, t) {
                            if ("throw" === e.type) throw e.arg;
                            return "break" === e.type || "continue" === e.type ? this.next = e.arg : "return" === e.type ? (this.rval = this.arg = e.arg, this.method = "return", this.next = "end") : "normal" === e.type && t && (this.next = t), b
                        },
                        finish: function(e) {
                            for (var t = this.tryEntries.length - 1; t >= 0; --t) {
                                var n = this.tryEntries[t];
                                if (n.finallyLoc === e) return this.complete(n.completion, n.afterLoc), _(n), b
                            }
                        },
                        catch: function(e) {
                            for (var t = this.tryEntries.length - 1; t >= 0; --t) {
                                var n = this.tryEntries[t];
                                if (n.tryLoc === e) {
                                    var o = n.completion;
                                    if ("throw" === o.type) {
                                        var r = o.arg;
                                        _(n)
                                    }
                                    return r
                                }
                            }
                            throw Error("illegal catch attempt")
                        },
                        delegateYield: function(e, n, o) {
                            return this.delegate = {
                                iterator: O(e),
                                resultName: n,
                                nextLoc: o
                            }, "next" === this.method && (this.arg = t), b
                        }
                    }, n
                }
                e.exports = r, e.exports.__esModule = !0, e.exports.default = e.exports
            },
            4637: (e, t, n) => {
                "use strict";
                var o;
                n.d(t, {
                        A: () => r
                    }),
                    function(e) {
                        e.RLE = "RLE", e.Volume = "Volume"
                    }(o || (o = {}));
                const r = o
            },
            4663: (e, t, n) => {
                "use strict";
                var o;
                n.d(t, {
                        A: () => r
                    }),
                    function(e) {
                        e.CONTOUR = "CONTOUR", e.SURFACE = "SURFACE"
                    }(o || (o = {}));
                const r = o
            },
            4756: (e, t, n) => {
                var o = n(4633)();
                e.exports = o;
                try {
                    regeneratorRuntime = o
                } catch (e) {
                    "object" == typeof globalThis ? globalThis.regeneratorRuntime = o : Function("r", "regeneratorRuntime = r")(o)
                }
            },
            4765: e => {
                "use strict";
                var t = String.prototype.replace,
                    n = /%20/g,
                    o = "RFC1738",
                    r = "RFC3986";
                e.exports = {
                    default: r,
                    formatters: {
                        RFC1738: function(e) {
                            return t.call(e, n, "+")
                        },
                        RFC3986: function(e) {
                            return String(e)
                        }
                    },
                    RFC1738: o,
                    RFC3986: r
                }
            },
            4803: (e, t, n) => {
                "use strict";
                var o = n(8859),
                    r = n(9675),
                    a = function(e, t, n) {
                        for (var o, r = e; null != (o = r.next); r = o)
                            if (o.key === t) return r.next = o.next, n || (o.next = e.next, e.next = o), o
                    };
                e.exports = function() {
                    var e, t = {
                        assert: function(e) {
                            if (!t.has(e)) throw new r("Side channel does not contain " + o(e))
                        },
                        delete: function(t) {
                            var n = e && e.next,
                                o = function(e, t) {
                                    if (e) return a(e, t, !0)
                                }(e, t);
                            return o && n && n === o && (e = void 0), !!o
                        },
                        get: function(t) {
                            return function(e, t) {
                                if (e) {
                                    var n = a(e, t);
                                    return n && n.value
                                }
                            }(e, t)
                        },
                        has: function(t) {
                            return function(e, t) {
                                return !!e && !!a(e, t)
                            }(e, t)
                        },
                        set: function(t, n) {
                            e || (e = {
                                    next: void 0
                                }),
                                function(e, t, n) {
                                    var o = a(e, t);
                                    o ? o.value = n : e.next = {
                                        key: t,
                                        next: e.next,
                                        value: n
                                    }
                                }(e, t, n)
                        }
                    };
                    return t
                }
            },
            4824: (e, t, n) => {
                "use strict";
                var o;
                n.d(t, {
                        A: () => r
                    }),
                    function(e) {
                        e.LINEAR = "LINEAR", e.SAMPLED_SIGMOID = "SIGMOID", e.LINEAR_EXACT = "LINEAR_EXACT"
                    }(o || (o = {}));
                const r = o
            },
            5255: (e, t, n) => {
                "use strict";
                var o;
                n.d(t, {
                        A: () => r
                    }),
                    function(e) {
                        e[e.FAR_REPLICATE = 1] = "FAR_REPLICATE", e[e.ADJACENT_REPLICATE = 3] = "ADJACENT_REPLICATE", e[e.SUBRESOLUTION = 6] = "SUBRESOLUTION", e[e.LOSSY = 7] = "LOSSY", e[e.FULL_RESOLUTION = 8] = "FULL_RESOLUTION"
                    }(o || (o = {}));
                const r = o
            },
            5345: e => {
                "use strict";
                e.exports = URIError
            },
            5373: (e, t, n) => {
                "use strict";
                var o = n(8636),
                    r = n(2642),
                    a = n(4765);
                e.exports = {
                    formats: a,
                    parse: r,
                    stringify: o
                }
            },
            5435: (e, t, n) => {
                "use strict";
                n.d(t, {
                    A: () => r
                });
                var o = n(9584);

                function r(e) {
                    try {
                        return (0, o.getEnabledElement)(e), !0
                    } catch (e) {
                        return !1
                    }
                }
            },
            5458: (e, t, n) => {
                "use strict";
                n.d(t, {
                    A: () => a
                });
                var o = n(3145);
                var r = n(7800);

                function a(e) {
                    return function(e) {
                        if (Array.isArray(e)) return (0, o.A)(e)
                    }(e) || function(e) {
                        if ("undefined" != typeof Symbol && null != e[Symbol.iterator] || null != e["@@iterator"]) return Array.from(e)
                    }(e) || (0, r.A)(e) || function() {
                        throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                    }()
                }
            },
            5738: e => {
                "use strict";
                e.exports = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJUAAAAqCAMAAACN4OndAAAAqFBMVEUAAADKysrLy8vT09PKysrKysrKysrPz8/KysrKysrMzMzLy8vLy8vKysrKysrJycnJycnKysrKysrLy8vKysrLy8vIyMjMzMzKysrMzMzLy8vMzMzLy8vLy8vKysrLy8vKysrHx8fLy8vKysrLy8vLy8vKysrJycnKysrKysrKysrLy8vKysrLy8vKysrKysrNzc3Pz8/R0dHU1NTW1tbT09PS0tLY2NiaiJAkAAAAL3RSTlMA9aMJ8eTaFuvfNxPGaYYiHfpCW/wnEHIwm0ltj3l+isMF1c2plrJGuDxPvVRfK+IvMiAAAATbSURBVFjDtdiLkpowFAbgg4iCgOIN76ugonhLUNT3f7NycmpbQrDu0P6zM0g2JB8hYBAwO41lsZrwYfTm59Ehl4ND0eFtZFWnVZ4X29XMT6O5kMuGY65r+JYqWGr1snRfPYzS5NOko1xP9pphbqdvquaclWSQzIDSWrY/zbKX66lVp7bgeyqIZ3LcDcNc57MxVI2bYFM8nL5LR1Kp49Ko96B6jpyGXXubE/i+rx9INcTPn6kCWwodp8vFgXTzPphItyQDhuFrcLKEYq+7dpz18iNVcxI28jnucMyPUmk4yY//klTrfkn2pNoDxzDa4zyJ8BY7rl6J+iqVv+eiPoU+D2KwWaGYHf0/VRp1tAB1/JBh0h1g3zRWmrNaOXOA6MapaewhcRWqoUmnXKN0hWUCdPt2IypdMYx2gd85E6oLJTmk1C6dSSzu1wbtTG/iyEbDojYChUrUNztAmV9RVYMaqpIaUDyDYcbwK8FRlDzmZaoVjW87dw96gFlQ274diDpPr0xlvFRfOdUEKLYlq1o/L6AO6sRXhqmPAdx9NI9J5R+j/eGnCme9UKXlKu+tym/Iqjk9rLa/Wkkx919ImlU8wqq3xGmRSn/iF8TnqlY/y8mWVFvvnBXviiqPiWivdjp0iQcvVb9LqiadwC/VnV2/obIO9ewRY4xllcu7XbYvqqKE7spArfJX1M0CKqrwsHqvoLpne0XVmBOiB2rV6SGeo45eUTVVqw63bM+RVcGKYx41KFHt+iJjqKhq4UabyqoeqkJZFZt1jKYrVFIqqYwLbronWTVOsz1TUkn5j6oObgZnSTXppDiESlV/JjJUqVxaNnlVVb6JG1dW+U+srVQNmEisUq05o2n6L1R8VFDhJlWpmoziqVSbROydK6vw9PhXQaXhYbZCNWbkAJWqja1gcxVVdoSqrazSTax9Uaj6ooQ7StXhRkuPoKpqwlFTUIW4MDjpRdVSlCQbpWrIheqoV1Q1vxJ8igeSKsAL+zgrVHtqqK9UeSajc62qOj/weuiyas+xgaCg8ull8NlUqmz6L29WVR3uuFiUVbDhuFtUXWg0NFCqgs3PbiqqvDFO0K4vq+aocqCg6g1o5siq3Ky7LquqmilWKKi+cGsWVbNETPb22/UVNyqqOnDDCmNZNcJtvVlQbbhQnUpUnTr1o5er2h+pTJ6VHxaS6jxA1bCgMl/LcrUKaD/pK1R0ptxyXcFjT/uNaoXPgIWkopcTbSerLjdREDbLVDSWfKNSeQMa6ITW/g0oV4nvrmttJKlaYoVzllVf9OIcQZnqRBUMlQpO1j19JQmH71Qzq9GwCipvhS/zrqwyuCgYlaogoUscA0wStsqrwPZ+x4d3Kt3OUnhegY/F8mzvEIoPy1V7qrLABQSPJJWUctW33gcXhAqhXHW608QKUFX7i2pWSZX/Erwv3qg84WCmDSvOt/F71eQvqrZS1bRyqgsZHr8NrYGs0iPqaQoOT9rlqloYhhZd7fSiVPmjL40WRjnVYRHlf5OZGlYWYyOOn2yzmNSuKVSUmfWzksUf51jjWSz9xu+SyrklScIx1wiUqo72EKikl1NNbvT1svKhmOnzkYUznv09JgEUYxlmL24YWRzdNEwXctmuHcp+pCtVr2XRugV5Ff2WtbVBkdg0XmlQu1J+ABT1EjoBoYiGAAAAAElFTkSuQmCC"
            },
            5795: (e, t, n) => {
                "use strict";
                var o = n(6549);
                if (o) try {
                    o([], "length")
                } catch (e) {
                    o = null
                }
                e.exports = o
            },
            5880: e => {
                "use strict";
                e.exports = Math.pow
            },
            5915: function(e, t, n) {
                /*! dicom-parser - 1.8.12 - 2023-02-20 | (c) 2017 Chris Hafey | https://github.com/cornerstonejs/dicomParser */
                e.exports = function(e) {
                    return n = [function(t, n) {
                        t.exports = e
                    }, function(e, t, n) {
                        "use strict";
                        n.r(t), n.d(t, "isStringVr", (function() {
                            return r
                        })), n.d(t, "isPrivateTag", (function() {
                            return a
                        })), n.d(t, "parsePN", (function() {
                            return i
                        })), n.d(t, "parseTM", (function() {
                            return s
                        })), n.d(t, "parseDA", (function() {
                            return c
                        })), n.d(t, "explicitElementToString", (function() {
                            return u
                        })), n.d(t, "explicitDataSetToJS", (function() {
                            return d
                        })), n.d(t, "createJPEGBasicOffsetTable", (function() {
                            return m
                        })), n.d(t, "parseDicomDataSetExplicit", (function() {
                            return _
                        })), n.d(t, "parseDicomDataSetImplicit", (function() {
                            return L
                        })), n.d(t, "readFixedString", (function() {
                            return y
                        })), n.d(t, "alloc", (function() {
                            return O
                        })), n.d(t, "version", (function() {
                            return R
                        })), n.d(t, "bigEndianByteArrayParser", (function() {
                            return N
                        })), n.d(t, "ByteStream", (function() {
                            return V
                        })), n.d(t, "sharedCopy", (function() {
                            return U
                        })), n.d(t, "DataSet", (function() {
                            return x
                        })), n.d(t, "findAndSetUNElementLength", (function() {
                            return v
                        })), n.d(t, "findEndOfEncapsulatedElement", (function() {
                            return p
                        })), n.d(t, "findItemDelimitationItemAndSetElementLength", (function() {
                            return T
                        })), n.d(t, "littleEndianByteArrayParser", (function() {
                            return F
                        })), n.d(t, "parseDicom", (function() {
                            return j
                        })), n.d(t, "readDicomElementExplicit", (function() {
                            return k
                        })), n.d(t, "readDicomElementImplicit", (function() {
                            return E
                        })), n.d(t, "readEncapsulatedImageFrame", (function() {
                            return Z
                        })), n.d(t, "readEncapsulatedPixelData", (function() {
                            return X
                        })), n.d(t, "readEncapsulatedPixelDataFromFragments", (function() {
                            return W
                        })), n.d(t, "readPart10Header", (function() {
                            return H
                        })), n.d(t, "readSequenceItemsExplicit", (function() {
                            return D
                        })), n.d(t, "readSequenceItemsImplicit", (function() {
                            return C
                        })), n.d(t, "readSequenceItem", (function() {
                            return S
                        })), n.d(t, "readTag", (function() {
                            return g
                        }));
                        var o = {
                                AE: !0,
                                AS: !0,
                                AT: !1,
                                CS: !0,
                                DA: !0,
                                DS: !0,
                                DT: !0,
                                FL: !1,
                                FD: !1,
                                IS: !0,
                                LO: !0,
                                LT: !0,
                                OB: !1,
                                OD: !1,
                                OF: !1,
                                OW: !1,
                                PN: !0,
                                SH: !0,
                                SL: !1,
                                SQ: !1,
                                SS: !1,
                                ST: !0,
                                TM: !0,
                                UI: !0,
                                UL: !1,
                                UN: void 0,
                                UR: !0,
                                US: !1,
                                UT: !0
                            },
                            r = function(e) {
                                return o[e]
                            },
                            a = function(e) {
                                if (e = parseInt(e[4], 16), isNaN(e)) throw "dicomParser.isPrivateTag: cannot parse last character of group";
                                return e % 2 == 1
                            },
                            i = function(e) {
                                if (void 0 !== e) return {
                                    familyName: (e = e.split("^"))[0],
                                    givenName: e[1],
                                    middleName: e[2],
                                    prefix: e[3],
                                    suffix: e[4]
                                }
                            };

                        function s(e, t) {
                            if (2 <= e.length) {
                                var n = parseInt(e.substring(0, 2), 10),
                                    o = 4 <= e.length ? parseInt(e.substring(2, 4), 10) : void 0,
                                    r = 6 <= e.length ? parseInt(e.substring(4, 6), 10) : void 0,
                                    a = (a = 8 <= e.length ? e.substring(7, 13) : void 0) ? parseInt(a, 10) * Math.pow(10, 6 - a.length) : void 0;
                                if (t && (isNaN(n) || void 0 !== o && isNaN(o) || void 0 !== r && isNaN(r) || void 0 !== a && isNaN(a) || n < 0 || 23 < n || o && (o < 0 || 59 < o) || r && (r < 0 || 59 < r) || a && (a < 0 || 999999 < a))) throw "invalid TM '".concat(e, "'");
                                return {
                                    hours: n,
                                    minutes: o,
                                    seconds: r,
                                    fractionalSeconds: a
                                }
                            }
                            if (t) throw "invalid TM '".concat(e, "'")
                        }

                        function l(e, t, n) {
                            return !isNaN(n) && 0 < t && t <= 12 && 0 < e && e <= function(e, t) {
                                switch (e) {
                                    case 2:
                                        return t % 4 == 0 && t % 100 || t % 400 == 0 ? 29 : 28;
                                    case 9:
                                    case 4:
                                    case 6:
                                    case 11:
                                        return 30;
                                    default:
                                        return 31
                                }
                            }(t, n)
                        }

                        function c(e, t) {
                            if (e && 8 === e.length) {
                                var n = parseInt(e.substring(0, 4), 10),
                                    o = parseInt(e.substring(4, 6), 10),
                                    r = parseInt(e.substring(6, 8), 10);
                                if (t && !0 !== l(r, o, n)) throw "invalid DA '".concat(e, "'");
                                return {
                                    year: n,
                                    month: o,
                                    day: r
                                }
                            }
                            if (t) throw "invalid DA '".concat(e, "'")
                        }

                        function u(e, t) {
                            if (void 0 === e || void 0 === t) throw "dicomParser.explicitElementToString: missing required parameters";
                            if (void 0 === t.vr) throw "dicomParser.explicitElementToString: cannot convert implicit element to string";
                            var n, o = t.vr,
                                a = t.tag;

                            function i(t, n) {
                                for (var o = "", r = 0; r < t; r++) 0 !== r && (o += "/"), o += n.call(e, a, r).toString();
                                return o
                            }
                            if (!0 === r(o)) n = e.string(a);
                            else {
                                if ("AT" === o) {
                                    var s = e.uint32(a);
                                    return void 0 === s ? void 0 : "x".concat((s = s < 0 ? 4294967295 + s + 1 : s).toString(16).toUpperCase())
                                }
                                "US" === o ? n = i(t.length / 2, e.uint16) : "SS" === o ? n = i(t.length / 2, e.int16) : "UL" === o ? n = i(t.length / 4, e.uint32) : "SL" === o ? n = i(t.length / 4, e.int32) : "FD" === o ? n = i(t.length / 8, e.double) : "FL" === o && (n = i(t.length / 4, e.float))
                            }
                            return n
                        }

                        function d(e, t) {
                            if (void 0 === e) throw "dicomParser.explicitDataSetToJS: missing required parameter dataSet";
                            t = t || {
                                omitPrivateAttibutes: !0,
                                maxElementLength: 128
                            };
                            var n, o = {};
                            for (n in e.elements) {
                                var r = e.elements[n];
                                if (!0 !== t.omitPrivateAttibutes || !a(n))
                                    if (r.items) {
                                        for (var i = [], s = 0; s < r.items.length; s++) i.push(d(r.items[s].dataSet, t));
                                        o[n] = i
                                    } else {
                                        var l = void 0;
                                        r.length < t.maxElementLength && (l = u(e, r)), o[n] = void 0 !== l ? l : {
                                            dataOffset: r.dataOffset,
                                            length: r.length
                                        }
                                    }
                            }
                            return o
                        }

                        function h(e, t) {
                            return 255 === e.byteArray[t] && 217 === e.byteArray[t + 1]
                        }

                        function f(e, t, n) {
                            for (var o, r, a = n; a < t.fragments.length; a++)
                                if (r = a, h(o = e, (r = t.fragments[r]).position + r.length - 2) || h(o, r.position + r.length - 3)) return a
                        }

                        function m(e, t, n) {
                            if (void 0 === e) throw "dicomParser.createJPEGBasicOffsetTable: missing required parameter dataSet";
                            if (void 0 === t) throw "dicomParser.createJPEGBasicOffsetTable: missing required parameter pixelDataElement";
                            if ("x7fe00010" !== t.tag) throw "dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010'";
                            if (!0 !== t.encapsulatedPixelData) throw "dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";
                            if (!0 !== t.hadUndefinedLength) throw "dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";
                            if (void 0 === t.basicOffsetTable) throw "dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";
                            if (void 0 === t.fragments) throw "dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";
                            if (t.fragments.length <= 0) throw "dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";
                            if (n && n.length <= 0) throw "dicomParser.createJPEGBasicOffsetTable: parameter 'fragments' must not be zero length";
                            n = n || t.fragments;
                            for (var o = [], r = 0;;) {
                                o.push(t.fragments[r].offset);
                                var a = f(e, t, r);
                                if (void 0 === a || a === t.fragments.length - 1) return o;
                                r = a + 1
                            }
                        }

                        function g(e) {
                            if (void 0 === e) throw "dicomParser.readTag: missing required parameter 'byteStream'";
                            var t = 256 * e.readUint16() * 256;
                            return e = e.readUint16(), "x".concat("00000000".concat((t + e).toString(16)).substr(-8))
                        }

                        function p(e, t, n) {
                            if (void 0 === e) throw "dicomParser.findEndOfEncapsulatedElement: missing required parameter 'byteStream'";
                            if (void 0 === t) throw "dicomParser.findEndOfEncapsulatedElement: missing required parameter 'element'";
                            if (t.encapsulatedPixelData = !0, t.basicOffsetTable = [], t.fragments = [], "xfffee000" !== g(e)) throw "dicomParser.findEndOfEncapsulatedElement: basic offset table not found";
                            for (var o = e.readUint32() / 4, r = 0; r < o; r++) {
                                var a = e.readUint32();
                                t.basicOffsetTable.push(a)
                            }
                            for (var i = e.position; e.position < e.byteArray.length;) {
                                var s = g(e),
                                    l = e.readUint32();
                                if ("xfffee0dd" === s) return e.seek(l), void(t.length = e.position - t.dataOffset);
                                if ("xfffee000" !== s) return n && n.push("unexpected tag ".concat(s, " while searching for end of pixel data element with undefined length")), l > e.byteArray.length - e.position && (l = e.byteArray.length - e.position), t.fragments.push({
                                    offset: e.position - i - 8,
                                    position: e.position,
                                    length: l
                                }), e.seek(l), void(t.length = e.position - t.dataOffset);
                                t.fragments.push({
                                    offset: e.position - i - 8,
                                    position: e.position,
                                    length: l
                                }), e.seek(l)
                            }
                            n && n.push("pixel data element ".concat(t.tag, " missing sequence delimiter tag xfffee0dd"))
                        }

                        function v(e, t) {
                            if (void 0 === e) throw "dicomParser.findAndSetUNElementLength: missing required parameter 'byteStream'";
                            for (var n = e.byteArray.length - 8; e.position <= n;)
                                if (65534 === e.readUint16() && 57565 === e.readUint16()) return 0 !== e.readUint32() && e.warnings("encountered non zero length following item delimiter at position ".concat(e.position - 4, " while reading element of undefined length with tag ").concat(t.tag)), void(t.length = e.position - t.dataOffset);
                            t.length = e.byteArray.length - t.dataOffset, e.seek(e.byteArray.length - e.position)
                        }

                        function y(e, t, n) {
                            if (n < 0) throw "dicomParser.readFixedString - length cannot be less than 0";
                            if (t + n > e.length) throw "dicomParser.readFixedString: attempt to read past end of buffer";
                            for (var o, r = "", a = 0; a < n; a++) {
                                if (0 === (o = e[t + a])) return t += n, r;
                                r += String.fromCharCode(o)
                            }
                            return r
                        }

                        function b(e, t) {
                            for (var n = 0; n < t.length; n++) {
                                var o = t[n];
                                o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o)
                            }
                        }

                        function w(e, t) {
                            return void 0 !== e.parser ? e.parser : t
                        }
                        var x = function() {
                            function e(t, n, o) {
                                ! function(e, t) {
                                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                                }(this, e), this.byteArrayParser = t, this.byteArray = n, this.elements = o
                            }
                            var t, n, o;
                            return t = e, (n = [{
                                key: "uint16",
                                value: function(e, t) {
                                    if (t = void 0 !== t ? t : 0, (e = this.elements[e]) && 0 !== e.length) return w(e, this.byteArrayParser).readUint16(this.byteArray, e.dataOffset + 2 * t)
                                }
                            }, {
                                key: "int16",
                                value: function(e, t) {
                                    if (t = void 0 !== t ? t : 0, (e = this.elements[e]) && 0 !== e.length) return w(e, this.byteArrayParser).readInt16(this.byteArray, e.dataOffset + 2 * t)
                                }
                            }, {
                                key: "uint32",
                                value: function(e, t) {
                                    if (t = void 0 !== t ? t : 0, (e = this.elements[e]) && 0 !== e.length) return w(e, this.byteArrayParser).readUint32(this.byteArray, e.dataOffset + 4 * t)
                                }
                            }, {
                                key: "int32",
                                value: function(e, t) {
                                    if (t = void 0 !== t ? t : 0, (e = this.elements[e]) && 0 !== e.length) return w(e, this.byteArrayParser).readInt32(this.byteArray, e.dataOffset + 4 * t)
                                }
                            }, {
                                key: "float",
                                value: function(e, t) {
                                    if (t = void 0 !== t ? t : 0, (e = this.elements[e]) && 0 !== e.length) return w(e, this.byteArrayParser).readFloat(this.byteArray, e.dataOffset + 4 * t)
                                }
                            }, {
                                key: "double",
                                value: function(e, t) {
                                    if (t = void 0 !== t ? t : 0, (e = this.elements[e]) && 0 !== e.length) return w(e, this.byteArrayParser).readDouble(this.byteArray, e.dataOffset + 8 * t)
                                }
                            }, {
                                key: "numStringValues",
                                value: function(e) {
                                    if ((e = this.elements[e]) && 0 < e.length) return null === (e = y(this.byteArray, e.dataOffset, e.length).match(/\\/g)) ? 1 : e.length + 1
                                }
                            }, {
                                key: "string",
                                value: function(e, t) {
                                    return (e = this.elements[e]) && e.Value ? e.Value : e && 0 < e.length ? (e = y(this.byteArray, e.dataOffset, e.length), 0 <= t ? e.split("\\")[t].trim() : e.trim()) : void 0
                                }
                            }, {
                                key: "text",
                                value: function(e, t) {
                                    if ((e = this.elements[e]) && 0 < e.length) return e = y(this.byteArray, e.dataOffset, e.length), 0 <= t ? e.split("\\")[t].replace(/ +$/, "") : e.replace(/ +$/, "")
                                }
                            }, {
                                key: "floatString",
                                value: function(e, t) {
                                    var n = this.elements[e];
                                    if (n && 0 < n.length && void 0 !== (t = this.string(e, t = void 0 !== t ? t : 0))) return parseFloat(t)
                                }
                            }, {
                                key: "intString",
                                value: function(e, t) {
                                    var n = this.elements[e];
                                    if (n && 0 < n.length && void 0 !== (t = this.string(e, t = void 0 !== t ? t : 0))) return parseInt(t)
                                }
                            }, {
                                key: "attributeTag",
                                value: function(e) {
                                    if ((n = this.elements[e]) && 4 === n.length) {
                                        var t = w(n, this.byteArrayParser).readUint16,
                                            n = (e = this.byteArray, n.dataOffset);
                                        return "x".concat("00000000".concat((256 * t(e, n) * 256 + t(e, n + 2)).toString(16)).substr(-8))
                                    }
                                }
                            }]) && b(t.prototype, n), o && b(t, o), Object.defineProperty(t, "prototype", {
                                writable: !1
                            }), e
                        }();

                        function T(e, t) {
                            if (void 0 === e) throw "dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";
                            for (var n = e.byteArray.length - 8; e.position <= n;)
                                if (65534 === e.readUint16() && 57357 === e.readUint16()) return 0 !== e.readUint32() && e.warnings("encountered non zero length following item delimiter at position ".concat(e.position - 4, " while reading element of undefined length with tag ").concat(t.tag)), void(t.length = e.position - t.dataOffset);
                            t.length = e.byteArray.length - t.dataOffset, e.seek(e.byteArray.length - e.position)
                        }
                        var I = function(e, t) {
                            return void 0 !== e.vr ? "SQ" === e.vr : t.position + 4 <= t.byteArray.length ? (e = g(t), t.seek(-4), "xfffee000" === e || "xfffee0dd" === e) : (t.warnings.push("eof encountered before finding sequence item tag or sequence delimiter tag in peeking to determine VR"), !1)
                        };

                        function E(e, t, n) {
                            if (void 0 === e) throw "dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";
                            var o;
                            return 4294967295 === (o = {
                                tag: o = g(e),
                                vr: void 0 !== n ? n(o) : void 0,
                                length: e.readUint32(),
                                dataOffset: e.position
                            }).length && (o.hadUndefinedLength = !0), o.tag === t || (!I(o, e) || a(o.tag) && !o.hadUndefinedLength ? o.hadUndefinedLength ? T(e, o) : e.seek(o.length) : (C(e, o, n), a(o.tag) && (o.items = void 0))), o
                        }

                        function S(e) {
                            if (void 0 === e) throw "dicomParser.readSequenceItem: missing required parameter 'byteStream'";
                            var t = {
                                tag: g(e),
                                length: e.readUint32(),
                                dataOffset: e.position
                            };
                            if ("xfffee000" !== t.tag) throw "dicomParser.readSequenceItem: item tag (FFFE,E000) not found at offset ".concat(e.position);
                            return t
                        }

                        function A(e, t) {
                            var n = S(e);
                            return 4294967295 === n.length ? (n.hadUndefinedLength = !0, n.dataSet = function(e, t) {
                                for (var n = {}; e.position < e.byteArray.length;) {
                                    var o = E(e, void 0, t);
                                    if ("xfffee00d" === (n[o.tag] = o).tag) return new x(e.byteArrayParser, e.byteArray, n)
                                }
                                return e.warnings.push("eof encountered before finding sequence item delimiter in sequence item of undefined length"), new x(e.byteArrayParser, e.byteArray, n)
                            }(e, t), n.length = e.position - n.dataOffset) : (n.dataSet = new x(e.byteArrayParser, e.byteArray, {}), L(n.dataSet, e, e.position + n.length, {
                                vrCallback: t
                            })), n
                        }

                        function C(e, t, n) {
                            if (void 0 === e) throw "dicomParser.readSequenceItemsImplicit: missing required parameter 'byteStream'";
                            if (void 0 === t) throw "dicomParser.readSequenceItemsImplicit: missing required parameter 'element'";
                            t.items = [], (4294967295 === t.length ? function(e, t, n) {
                                for (; e.position + 4 <= e.byteArray.length;) {
                                    var o = g(e);
                                    if (e.seek(-4), "xfffee0dd" === o) return t.length = e.position - t.dataOffset, e.seek(8);
                                    o = A(e, n), t.items.push(o)
                                }
                                e.warnings.push("eof encountered before finding sequence delimiter in sequence of undefined length"), t.length = e.byteArray.length - t.dataOffset
                            } : function(e, t, n) {
                                for (var o = t.dataOffset + t.length; e.position < o;) {
                                    var r = A(e, n);
                                    t.items.push(r)
                                }
                            })(e, t, n)
                        }

                        function M(e, t) {
                            var n = S(e);
                            return 4294967295 === n.length ? (n.hadUndefinedLength = !0, n.dataSet = function(e, t) {
                                for (var n = {}; e.position < e.byteArray.length;) {
                                    var o = k(e, t);
                                    if ("xfffee00d" === (n[o.tag] = o).tag) return new x(e.byteArrayParser, e.byteArray, n)
                                }
                                return t.push("eof encountered before finding item delimiter tag while reading sequence item of undefined length"), new x(e.byteArrayParser, e.byteArray, n)
                            }(e, t), n.length = e.position - n.dataOffset) : (n.dataSet = new x(e.byteArrayParser, e.byteArray, {}), _(n.dataSet, e, e.position + n.length)), n
                        }

                        function D(e, t, n) {
                            if (void 0 === e) throw "dicomParser.readSequenceItemsExplicit: missing required parameter 'byteStream'";
                            if (void 0 === t) throw "dicomParser.readSequenceItemsExplicit: missing required parameter 'element'";
                            t.items = [], (4294967295 === t.length ? function(e, t, n) {
                                for (; e.position + 4 <= e.byteArray.length;) {
                                    var o = g(e);
                                    if (e.seek(-4), "xfffee0dd" === o) return t.length = e.position - t.dataOffset, e.seek(8);
                                    o = M(e, n), t.items.push(o)
                                }
                                n.push("eof encountered before finding sequence delimitation tag while reading sequence of undefined length"), t.length = e.position - t.dataOffset
                            } : function(e, t, n) {
                                for (var o = t.dataOffset + t.length; e.position < o;) {
                                    var r = M(e, n);
                                    t.items.push(r)
                                }
                            })(e, t, n)
                        }
                        var P = function(e) {
                            return "OB" === e || "OD" === e || "OL" === e || "OW" === e || "SQ" === e || "OF" === e || "UC" === e || "UR" === e || "UT" === e || "UN" === e ? 4 : 2
                        };

                        function k(e, t, n) {
                            if (void 0 === e) throw "dicomParser.readDicomElementExplicit: missing required parameter 'byteStream'";
                            var o = {
                                tag: g(e),
                                vr: e.readFixedString(2)
                            };
                            return 2 === P(o.vr) ? o.length = e.readUint16() : (e.seek(2), o.length = e.readUint32()), o.dataOffset = e.position, 4294967295 === o.length && (o.hadUndefinedLength = !0), o.tag === n || ("SQ" === o.vr ? D(e, o, t) : 4294967295 === o.length ? "x7fe00010" === o.tag ? p(e, o, t) : ("UN" === o.vr ? C : T)(e, o) : e.seek(o.length)), o
                        }

                        function _(e, t, n) {
                            var o = 3 < arguments.length && void 0 !== arguments[3] ? arguments[3] : {};
                            if (n = void 0 === n ? t.byteArray.length : n, void 0 === t) throw "dicomParser.parseDicomDataSetExplicit: missing required parameter 'byteStream'";
                            if (n < t.position || n > t.byteArray.length) throw "dicomParser.parseDicomDataSetExplicit: invalid value for parameter 'maxP osition'";
                            for (var r = e.elements; t.position < n;) {
                                var a = k(t, e.warnings, o.untilTag);
                                if ((r[a.tag] = a).tag === o.untilTag) return
                            }
                            if (t.position > n) throw "dicomParser:parseDicomDataSetExplicit: buffer overrun"
                        }

                        function L(e, t, n) {
                            var o = 3 < arguments.length && void 0 !== arguments[3] ? arguments[3] : {};
                            if (n = void 0 === n ? e.byteArray.length : n, void 0 === t) throw "dicomParser.parseDicomDataSetImplicit: missing required parameter 'byteStream'";
                            if (n < t.position || n > t.byteArray.length) throw "dicomParser.parseDicomDataSetImplicit: invalid value for parameter 'maxPosition'";
                            for (var r = e.elements; t.position < n;) {
                                var a = E(t, o.untilTag, o.vrCallback);
                                if ((r[a.tag] = a).tag === o.untilTag) return
                            }
                        }

                        function O(e, t) {
                            if ("undefined" != typeof Buffer && e instanceof Buffer) return Buffer.alloc(t);
                            if (e instanceof Uint8Array) return new Uint8Array(t);
                            throw "dicomParser.alloc: unknown type for byteArray"
                        }
                        var R = "1.8.12",
                            N = {
                                readUint16: function(e, t) {
                                    if (t < 0) throw "bigEndianByteArrayParser.readUint16: position cannot be less than 0";
                                    if (t + 2 > e.length) throw "bigEndianByteArrayParser.readUint16: attempt to read past end of buffer";
                                    return (e[t] << 8) + e[t + 1]
                                },
                                readInt16: function(e, t) {
                                    if (t < 0) throw "bigEndianByteArrayParser.readInt16: position cannot be less than 0";
                                    if (t + 2 > e.length) throw "bigEndianByteArrayParser.readInt16: attempt to read past end of buffer";
                                    return 32768 & (t = (e[t] << 8) + e[t + 1]) ? t - 65535 - 1 : t
                                },
                                readUint32: function(e, t) {
                                    if (t < 0) throw "bigEndianByteArrayParser.readUint32: position cannot be less than 0";
                                    if (t + 4 > e.length) throw "bigEndianByteArrayParser.readUint32: attempt to read past end of buffer";
                                    return 256 * (256 * (256 * e[t] + e[t + 1]) + e[t + 2]) + e[t + 3]
                                },
                                readInt32: function(e, t) {
                                    if (t < 0) throw "bigEndianByteArrayParser.readInt32: position cannot be less than 0";
                                    if (t + 4 > e.length) throw "bigEndianByteArrayParser.readInt32: attempt to read past end of buffer";
                                    return (e[t] << 24) + (e[t + 1] << 16) + (e[t + 2] << 8) + e[t + 3]
                                },
                                readFloat: function(e, t) {
                                    if (t < 0) throw "bigEndianByteArrayParser.readFloat: position cannot be less than 0";
                                    if (t + 4 > e.length) throw "bigEndianByteArrayParser.readFloat: attempt to read past end of buffer";
                                    var n = new Uint8Array(4);
                                    return n[3] = e[t], n[2] = e[t + 1], n[1] = e[t + 2], n[0] = e[t + 3], new Float32Array(n.buffer)[0]
                                },
                                readDouble: function(e, t) {
                                    if (t < 0) throw "bigEndianByteArrayParser.readDouble: position cannot be less than 0";
                                    if (t + 8 > e.length) throw "bigEndianByteArrayParser.readDouble: attempt to read past end of buffer";
                                    var n = new Uint8Array(8);
                                    return n[7] = e[t], n[6] = e[t + 1], n[5] = e[t + 2], n[4] = e[t + 3], n[3] = e[t + 4], n[2] = e[t + 5], n[1] = e[t + 6], n[0] = e[t + 7], new Float64Array(n.buffer)[0]
                                }
                            };

                        function U(e, t, n) {
                            if ("undefined" != typeof Buffer && e instanceof Buffer) return e.slice(t, t + n);
                            if (e instanceof Uint8Array) return new Uint8Array(e.buffer, e.byteOffset + t, n);
                            throw "dicomParser.from: unknown type for byteArray"
                        }

                        function B(e, t) {
                            for (var n = 0; n < t.length; n++) {
                                var o = t[n];
                                o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o)
                            }
                        }
                        var V = function() {
                                function e(t, n, o) {
                                    if (function(e, t) {
                                            if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                                        }(this, e), void 0 === t) throw "dicomParser.ByteStream: missing required parameter 'byteArrayParser'";
                                    if (void 0 === n) throw "dicomParser.ByteStream: missing required parameter 'byteArray'";
                                    if (n instanceof Uint8Array == 0 && ("undefined" == typeof Buffer || n instanceof Buffer == 0)) throw "dicomParser.ByteStream: parameter byteArray is not of type Uint8Array or Buffer";
                                    if (o < 0) throw "dicomParser.ByteStream: parameter 'position' cannot be less than 0";
                                    if (o >= n.length) throw "dicomParser.ByteStream: parameter 'position' cannot be greater than or equal to 'byteArray' length";
                                    this.byteArrayParser = t, this.byteArray = n, this.position = o || 0, this.warnings = []
                                }
                                var t, n, o;
                                return t = e, (n = [{
                                    key: "seek",
                                    value: function(e) {
                                        if (this.position + e < 0) throw "dicomParser.ByteStream.prototype.seek: cannot seek to position < 0";
                                        this.position += e
                                    }
                                }, {
                                    key: "readByteStream",
                                    value: function(t) {
                                        if (this.position + t > this.byteArray.length) throw "dicomParser.ByteStream.prototype.readByteStream: readByteStream - buffer overread";
                                        var n = U(this.byteArray, this.position, t);
                                        return this.position += t, new e(this.byteArrayParser, n)
                                    }
                                }, {
                                    key: "getSize",
                                    value: function() {
                                        return this.byteArray.length
                                    }
                                }, {
                                    key: "readUint16",
                                    value: function() {
                                        var e = this.byteArrayParser.readUint16(this.byteArray, this.position);
                                        return this.position += 2, e
                                    }
                                }, {
                                    key: "readUint32",
                                    value: function() {
                                        var e = this.byteArrayParser.readUint32(this.byteArray, this.position);
                                        return this.position += 4, e
                                    }
                                }, {
                                    key: "readFixedString",
                                    value: function(e) {
                                        var t = y(this.byteArray, this.position, e);
                                        return this.position += e, t
                                    }
                                }]) && B(t.prototype, n), o && B(t, o), Object.defineProperty(t, "prototype", {
                                    writable: !1
                                }), e
                            }(),
                            F = {
                                readUint16: function(e, t) {
                                    if (t < 0) throw "littleEndianByteArrayParser.readUint16: position cannot be less than 0";
                                    if (t + 2 > e.length) throw "littleEndianByteArrayParser.readUint16: attempt to read past end of buffer";
                                    return e[t] + 256 * e[t + 1]
                                },
                                readInt16: function(e, t) {
                                    if (t < 0) throw "littleEndianByteArrayParser.readInt16: position cannot be less than 0";
                                    if (t + 2 > e.length) throw "littleEndianByteArrayParser.readInt16: attempt to read past end of buffer";
                                    return 32768 & (t = e[t] + (e[t + 1] << 8)) ? t - 65535 - 1 : t
                                },
                                readUint32: function(e, t) {
                                    if (t < 0) throw "littleEndianByteArrayParser.readUint32: position cannot be less than 0";
                                    if (t + 4 > e.length) throw "littleEndianByteArrayParser.readUint32: attempt to read past end of buffer";
                                    return e[t] + 256 * e[t + 1] + 256 * e[t + 2] * 256 + 256 * e[t + 3] * 256 * 256
                                },
                                readInt32: function(e, t) {
                                    if (t < 0) throw "littleEndianByteArrayParser.readInt32: position cannot be less than 0";
                                    if (t + 4 > e.length) throw "littleEndianByteArrayParser.readInt32: attempt to read past end of buffer";
                                    return e[t] + (e[t + 1] << 8) + (e[t + 2] << 16) + (e[t + 3] << 24)
                                },
                                readFloat: function(e, t) {
                                    if (t < 0) throw "littleEndianByteArrayParser.readFloat: position cannot be less than 0";
                                    if (t + 4 > e.length) throw "littleEndianByteArrayParser.readFloat: attempt to read past end of buffer";
                                    var n = new Uint8Array(4);
                                    return n[0] = e[t], n[1] = e[t + 1], n[2] = e[t + 2], n[3] = e[t + 3], new Float32Array(n.buffer)[0]
                                },
                                readDouble: function(e, t) {
                                    if (t < 0) throw "littleEndianByteArrayParser.readDouble: position cannot be less than 0";
                                    if (t + 8 > e.length) throw "littleEndianByteArrayParser.readDouble: attempt to read past end of buffer";
                                    var n = new Uint8Array(8);
                                    return n[0] = e[t], n[1] = e[t + 1], n[2] = e[t + 2], n[3] = e[t + 3], n[4] = e[t + 4], n[5] = e[t + 5], n[6] = e[t + 6], n[7] = e[t + 7], new Float64Array(n.buffer)[0]
                                }
                            };

                        function H(e) {
                            var t = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : {};
                            if (void 0 === e) throw "dicomParser.readPart10Header: missing required parameter 'byteArray'";
                            var n = t.TransferSyntaxUID,
                                o = new V(F, e);
                            return function() {
                                var e = function() {
                                        if (o.getSize() <= 132 && n) return !1;
                                        if (o.seek(128), "DICM" === o.readFixedString(4)) return !0;
                                        if (!(t || {}).TransferSyntaxUID) throw "dicomParser.readPart10Header: DICM prefix not found at location 132 - this is not a valid DICOM P10 file.";
                                        return o.seek(0), !1
                                    }(),
                                    r = [],
                                    a = {};
                                if (!e) return o.position = 0, {
                                    elements: {
                                        x00020010: {
                                            tag: "x00020010",
                                            vr: "UI",
                                            Value: n
                                        }
                                    },
                                    warnings: r
                                };
                                for (; o.position < o.byteArray.length;) {
                                    var i = o.position,
                                        s = k(o, r);
                                    if ("x0002ffff" < s.tag) {
                                        o.position = i;
                                        break
                                    }
                                    s.parser = F, a[s.tag] = s
                                }
                                return (e = new x(o.byteArrayParser, o.byteArray, a)).warnings = o.warnings, e.position = o.position, e
                            }()
                        }
                        var q = "1.2.840.10008.1.2.2";

                        function j(e) {
                            var t = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : {};
                            if (void 0 === e) throw new Error("dicomParser.parseDicom: missing required parameter 'byteArray'");
                            var o, r = function(t) {
                                if (void 0 === t.elements.x00020010) throw new Error("dicomParser.parseDicom: missing required meta header attribute 0002,0010");
                                return (t = t.elements.x00020010) && t.Value || y(e, t.dataOffset, t.length)
                            };

                            function a(o) {
                                var a = "1.2.840.10008.1.2" !== (i = r(o)),
                                    i = function(o, r) {
                                        var a = "[object process]" === Object.prototype.toString.call("undefined" != typeof process ? process : 0);
                                        if ("1.2.840.10008.1.2.1.99" !== o) return new V(o === q ? N : F, e, r);
                                        if (t && t.inflater) return o = t.inflater(e, r), new V(F, o, 0);
                                        if (1 == a) {
                                            var i = n(0),
                                                s = U(e, r, e.length - r);
                                            return i = i.inflateRawSync(s), s = O(e, i.length + r), e.copy(s, 0, 0, r), i.copy(s, r), new V(F, s, 0)
                                        }
                                        if ("undefined" == typeof pako) throw "dicomParser.parseDicom: no inflater available to handle deflate transfer syntax";
                                        return i = e.slice(r), s = pako.inflateRaw(i), (i = O(e, s.length + r)).set(e.slice(0, r), 0), i.set(s, r), new V(F, i, 0)
                                    }(i, o.position);
                                (o = new x(i.byteArrayParser, i.byteArray, {})).warnings = i.warnings;
                                try {
                                    (a ? _ : L)(o, i, i.byteArray.length, t)
                                } catch (i) {
                                    throw {
                                        exception: i,
                                        dataSet: o
                                    }
                                }
                                return o
                            }
                            return function(e, t) {
                                for (var n in e.elements) e.elements.hasOwnProperty(n) && (t.elements[n] = e.elements[n]);
                                return void 0 !== e.warnings && (t.warnings = e.warnings.concat(t.warnings)), t
                            }(o = H(e, t), a(o))
                        }
                        var z = function(e, t, n) {
                            for (var o = 0, r = t; r < t + n; r++) o += e[r].length;
                            return o
                        };

                        function W(e, t, n, o, r) {
                            if (r = r || t.fragments, void 0 === e) throw "dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'dataSet'";
                            if (void 0 === t) throw "dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'pixelDataElement'";
                            if (void 0 === n) throw "dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'startFragmentIndex'";
                            if (void 0 === (o = o || 1)) throw "dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'numFragments'";
                            if ("x7fe00010" !== t.tag) throw "dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010";
                            if (!0 !== t.encapsulatedPixelData) throw "dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";
                            if (!0 !== t.hadUndefinedLength) throw "dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";
                            if (void 0 === t.basicOffsetTable) throw "dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";
                            if (void 0 === t.fragments) throw "dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";
                            if (t.fragments.length <= 0) throw "dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";
                            if (n < 0) throw "dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be >= 0";
                            if (n >= t.fragments.length) throw "dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be < number of fragments";
                            if (o < 1) throw "dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'numFragments' must be > 0";
                            if (n + o > t.fragments.length) throw "dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragment' + 'numFragments' < number of fragments";
                            var a = new V(e.byteArrayParser, e.byteArray, t.dataOffset);
                            if ("xfffee000" !== (t = S(a)).tag) throw "dicomParser.readEncapsulatedPixelData: missing basic offset table xfffee000";
                            a.seek(t.length);
                            var i = a.position;
                            if (1 === o) return U(a.byteArray, i + r[n].offset + 8, r[n].length);
                            t = z(r, n, o);
                            for (var s = O(a.byteArray, t), l = 0, c = n; c < n + o; c++)
                                for (var u = i + r[c].offset + 8, d = 0; d < r[c].length; d++) s[l++] = a.byteArray[u++];
                            return s
                        }
                        var G = function(e, t) {
                                for (var n = 0; n < e.length; n++)
                                    if (e[n].offset === t) return n
                            },
                            Y = function(e, t, n, o) {
                                if (e === t.length - 1) return n.length - o;
                                for (var r = t[e + 1], a = o + 1; a < n.length; a++)
                                    if (n[a].offset === r) return a - o;
                                throw "dicomParser.calculateNumberOfFragmentsForFrame: could not find fragment with offset matching basic offset table"
                            };

                        function Z(e, t, n, o, r) {
                            if (o = o || t.basicOffsetTable, r = r || t.fragments, void 0 === e) throw "dicomParser.readEncapsulatedImageFrame: missing required parameter 'dataSet'";
                            if (void 0 === t) throw "dicomParser.readEncapsulatedImageFrame: missing required parameter 'pixelDataElement'";
                            if (void 0 === n) throw "dicomParser.readEncapsulatedImageFrame: missing required parameter 'frameIndex'";
                            if (void 0 === o) throw "dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' does not have basicOffsetTable";
                            if ("x7fe00010" !== t.tag) throw "dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010)";
                            if (!0 !== t.encapsulatedPixelData) throw "dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";
                            if (!0 !== t.hadUndefinedLength) throw "dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have undefined length";
                            if (void 0 === t.fragments) throw "dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have fragments";
                            if (0 === o.length) throw "dicomParser.readEncapsulatedImageFrame: basicOffsetTable has zero entries";
                            if (n < 0) throw "dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be >= 0";
                            if (n >= o.length) throw "dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be < basicOffsetTable.length";
                            var a = o[n];
                            if (void 0 === (a = G(r, a))) throw "dicomParser.readEncapsulatedImageFrame: unable to find fragment that matches basic offset table entry";
                            return W(e, t, a, Y(n, o, r, a), r)
                        }
                        var K = !1;

                        function X(e, t, n) {
                            if (K || (K = !0, console && console.log && console.log("WARNING: dicomParser.readEncapsulatedPixelData() has been deprecated")), void 0 === e) throw "dicomParser.readEncapsulatedPixelData: missing required parameter 'dataSet'";
                            if (void 0 === t) throw "dicomParser.readEncapsulatedPixelData: missing required parameter 'element'";
                            if (void 0 === n) throw "dicomParser.readEncapsulatedPixelData: missing required parameter 'frame'";
                            if ("x7fe00010" !== t.tag) throw "dicomParser.readEncapsulatedPixelData: parameter 'element' refers to non pixel data tag (expected tag = x7fe00010)";
                            if (!0 !== t.encapsulatedPixelData) throw "dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";
                            if (!0 !== t.hadUndefinedLength) throw "dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";
                            if (void 0 === t.basicOffsetTable) throw "dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";
                            if (void 0 === t.fragments) throw "dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";
                            if (n < 0) throw "dicomParser.readEncapsulatedPixelData: parameter 'frame' must be >= 0";
                            return 0 !== t.basicOffsetTable.length ? Z(e, t, n) : W(e, t, 0, t.fragments.length)
                        }
                        t.default = {
                            isStringVr: r,
                            isPrivateTag: a,
                            parsePN: i,
                            parseTM: s,
                            parseDA: c,
                            explicitElementToString: u,
                            explicitDataSetToJS: d,
                            createJPEGBasicOffsetTable: m,
                            parseDicomDataSetExplicit: _,
                            parseDicomDataSetImplicit: L,
                            readFixedString: y,
                            alloc: O,
                            version: R,
                            bigEndianByteArrayParser: N,
                            ByteStream: V,
                            sharedCopy: U,
                            DataSet: x,
                            findAndSetUNElementLength: v,
                            findEndOfEncapsulatedElement: p,
                            findItemDelimitationItemAndSetElementLength: T,
                            littleEndianByteArrayParser: F,
                            parseDicom: j,
                            readDicomElementExplicit: k,
                            readDicomElementImplicit: E,
                            readEncapsulatedImageFrame: Z,
                            readEncapsulatedPixelData: X,
                            readEncapsulatedPixelDataFromFragments: W,
                            readPart10Header: H,
                            readSequenceItemsExplicit: D,
                            readSequenceItemsImplicit: C,
                            readSequenceItem: S,
                            readTag: g,
                            LEI: "1.2.840.10008.1.2",
                            LEE: "1.2.840.10008.1.2.1"
                        }
                    }], o = {}, t.m = n, t.c = o, t.d = function(e, n, o) {
                        t.o(e, n) || Object.defineProperty(e, n, {
                            enumerable: !0,
                            get: o
                        })
                    }, t.r = function(e) {
                        "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {
                            value: "Module"
                        }), Object.defineProperty(e, "__esModule", {
                            value: !0
                        })
                    }, t.t = function(e, n) {
                        if (1 & n && (e = t(e)), 8 & n) return e;
                        if (4 & n && "object" == typeof e && e && e.__esModule) return e;
                        var o = Object.create(null);
                        if (t.r(o), Object.defineProperty(o, "default", {
                                enumerable: !0,
                                value: e
                            }), 2 & n && "string" != typeof e)
                            for (var r in e) t.d(o, r, function(t) {
                                return e[t]
                            }.bind(null, r));
                        return o
                    }, t.n = function(e) {
                        var n = e && e.__esModule ? function() {
                            return e.default
                        } : function() {
                            return e
                        };
                        return t.d(n, "a", n), n
                    }, t.o = function(e, t) {
                        return Object.prototype.hasOwnProperty.call(e, t)
                    }, t.p = "", t(t.s = 1);

                    function t(e) {
                        if (o[e]) return o[e].exports;
                        var r = o[e] = {
                            i: e,
                            l: !1,
                            exports: {}
                        };
                        return n[e].call(r.exports, r, r.exports, t), r.l = !0, r.exports
                    }
                    var n, o
                }(n(6559))
            },
            5947: function(e, t, n) {
                var o, r;
                /* NProgress, (c) 2013, 2014 Rico Sta. Cruz - http://ricostacruz.com/nprogress
                 * @license MIT */
                o = function() {
                    var e, t, n = {
                            version: "0.2.0"
                        },
                        o = n.settings = {
                            minimum: .08,
                            easing: "ease",
                            positionUsing: "",
                            speed: 200,
                            trickle: !0,
                            trickleRate: .02,
                            trickleSpeed: 800,
                            showSpinner: !0,
                            barSelector: '[role="bar"]',
                            spinnerSelector: '[role="spinner"]',
                            parent: "body",
                            template: '<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'
                        };

                    function r(e, t, n) {
                        return e < t ? t : e > n ? n : e
                    }

                    function a(e) {
                        return 100 * (-1 + e)
                    }

                    function i(e, t, n) {
                        var r;
                        return (r = "translate3d" === o.positionUsing ? {
                            transform: "translate3d(" + a(e) + "%,0,0)"
                        } : "translate" === o.positionUsing ? {
                            transform: "translate(" + a(e) + "%,0)"
                        } : {
                            "margin-left": a(e) + "%"
                        }).transition = "all " + t + "ms " + n, r
                    }
                    n.configure = function(e) {
                        var t, n;
                        for (t in e) void 0 !== (n = e[t]) && e.hasOwnProperty(t) && (o[t] = n);
                        return this
                    }, n.status = null, n.set = function(e) {
                        var t = n.isStarted();
                        e = r(e, o.minimum, 1), n.status = 1 === e ? null : e;
                        var a = n.render(!t),
                            c = a.querySelector(o.barSelector),
                            u = o.speed,
                            d = o.easing;
                        return a.offsetWidth, s((function(t) {
                            "" === o.positionUsing && (o.positionUsing = n.getPositioningCSS()), l(c, i(e, u, d)), 1 === e ? (l(a, {
                                transition: "none",
                                opacity: 1
                            }), a.offsetWidth, setTimeout((function() {
                                l(a, {
                                    transition: "all " + u + "ms linear",
                                    opacity: 0
                                }), setTimeout((function() {
                                    n.remove(), t()
                                }), u)
                            }), u)) : setTimeout(t, u)
                        })), this
                    }, n.isStarted = function() {
                        return "number" == typeof n.status
                    }, n.start = function() {
                        n.status || n.set(0);
                        var e = function() {
                            setTimeout((function() {
                                n.status && (n.trickle(), e())
                            }), o.trickleSpeed)
                        };
                        return o.trickle && e(), this
                    }, n.done = function(e) {
                        return e || n.status ? n.inc(.3 + .5 * Math.random()).set(1) : this
                    }, n.inc = function(e) {
                        var t = n.status;
                        return t ? ("number" != typeof e && (e = (1 - t) * r(Math.random() * t, .1, .95)), t = r(t + e, 0, .994), n.set(t)) : n.start()
                    }, n.trickle = function() {
                        return n.inc(Math.random() * o.trickleRate)
                    }, e = 0, t = 0, n.promise = function(o) {
                        return o && "resolved" !== o.state() ? (0 === t && n.start(), e++, t++, o.always((function() {
                            0 == --t ? (e = 0, n.done()) : n.set((e - t) / e)
                        })), this) : this
                    }, n.render = function(e) {
                        if (n.isRendered()) return document.getElementById("nprogress");
                        u(document.documentElement, "nprogress-busy");
                        var t = document.createElement("div");
                        t.id = "nprogress", t.innerHTML = o.template;
                        var r, i = t.querySelector(o.barSelector),
                            s = e ? "-100" : a(n.status || 0),
                            c = document.querySelector(o.parent);
                        return l(i, {
                            transition: "all 0 linear",
                            transform: "translate3d(" + s + "%,0,0)"
                        }), o.showSpinner || (r = t.querySelector(o.spinnerSelector)) && f(r), c != document.body && u(c, "nprogress-custom-parent"), c.appendChild(t), t
                    }, n.remove = function() {
                        d(document.documentElement, "nprogress-busy"), d(document.querySelector(o.parent), "nprogress-custom-parent");
                        var e = document.getElementById("nprogress");
                        e && f(e)
                    }, n.isRendered = function() {
                        return !!document.getElementById("nprogress")
                    }, n.getPositioningCSS = function() {
                        var e = document.body.style,
                            t = "WebkitTransform" in e ? "Webkit" : "MozTransform" in e ? "Moz" : "msTransform" in e ? "ms" : "OTransform" in e ? "O" : "";
                        return t + "Perspective" in e ? "translate3d" : t + "Transform" in e ? "translate" : "margin"
                    };
                    var s = function() {
                            var e = [];

                            function t() {
                                var n = e.shift();
                                n && n(t)
                            }
                            return function(n) {
                                e.push(n), 1 == e.length && t()
                            }
                        }(),
                        l = function() {
                            var e = ["Webkit", "O", "Moz", "ms"],
                                t = {};

                            function n(e) {
                                return e.replace(/^-ms-/, "ms-").replace(/-([\da-z])/gi, (function(e, t) {
                                    return t.toUpperCase()
                                }))
                            }

                            function o(t) {
                                var n = document.body.style;
                                if (t in n) return t;
                                for (var o, r = e.length, a = t.charAt(0).toUpperCase() + t.slice(1); r--;)
                                    if ((o = e[r] + a) in n) return o;
                                return t
                            }

                            function r(e) {
                                return e = n(e), t[e] || (t[e] = o(e))
                            }

                            function a(e, t, n) {
                                t = r(t), e.style[t] = n
                            }
                            return function(e, t) {
                                var n, o, r = arguments;
                                if (2 == r.length)
                                    for (n in t) void 0 !== (o = t[n]) && t.hasOwnProperty(n) && a(e, n, o);
                                else a(e, r[1], r[2])
                            }
                        }();

                    function c(e, t) {
                        return ("string" == typeof e ? e : h(e)).indexOf(" " + t + " ") >= 0
                    }

                    function u(e, t) {
                        var n = h(e),
                            o = n + t;
                        c(n, t) || (e.className = o.substring(1))
                    }

                    function d(e, t) {
                        var n, o = h(e);
                        c(e, t) && (n = o.replace(" " + t + " ", " "), e.className = n.substring(1, n.length - 1))
                    }

                    function h(e) {
                        return (" " + (e.className || "") + " ").replace(/\s+/gi, " ")
                    }

                    function f(e) {
                        e && e.parentNode && e.parentNode.removeChild(e)
                    }
                    return n
                }, void 0 === (r = "function" == typeof o ? o.call(t, n, t, e) : o) || (e.exports = r)
            },
            6030: e => {
                "use strict";
                e.exports = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAA9lBMVEVP//9M4/97h/5kqP92jP5M5/9M7P9N3P9no/9qnv9O/f9Q1v9Q0f9cuv9wlv9O2f9btv9M8f9esf9N4P9TzP9VyP/vBPxZvP9yk/5N9f9+hP6Jdf5ZwP+Bf/5opf5N+P9tmf+gWv5U2/9zkP5+gv5Q3P9Ww/9gtf9Q5P+tS/5lrf9rm/5zmP6Gef6aY/7dGf3kDvxR8f9U0P9cxP9frf9hq/9un/6FgP6lVP6+PP1U6P9jsf94kv58iv6Ncv6OcP6Sa/6oWf24P/3CNf3NK/3RI/3WH/z3APxgvf6XZ/6zSv3HLv1bzP6MfP5e1f52qv56oP6Ljf7KZtzfAAACoElEQVQ4y9WPh47dIBREwWDAz4B7736997a9b3r5/58Jm40UKX+QkS7o6gwzAvxf6lTJ+qI1277J/S/tuur8y0eURswd8PxQ5rvpcNMmf8C7M2lpvx/4h+JqeJXJzcTIobn+jZxEWTrV1rq8ku5hnn3rXHy9iedZcWkG645ixCFOawlxuLm5+XhqjurN96a5zW7nZd/0LgjgOhS+aXczpcV4/FXF/Tg12bzX01C/nXgggFtkCjEsZ9k8WzR37ejL9V1WYDfw81wffgAWRJv8kkDq415azAuZpuldrxxAQilx+iXQrQhOSodQZKAJLqQsil56vYH9wNKryvkACLd0tB1ZPtbKXGpZM256seBmiUTfg84IQAuSzWhrGPU0z430HL6GL0fm0ksXMUGTBFALOokzxNJgg2AwW4WrVXjOI0vsXDb0Bmtgccdxgni3R4ZKOYZvehRIuG5klyaKQDlJkpFbG7K4e/w0u39dfn4Ol1fd6xkSts0RAw/HqqI8OoxfzsvFebma1fL+9eXh4/jzCfm6vQPhbdIhhFz8fHp+Hj+G4bVdnl9Xjw8vz59aTvwcLGdJpyKJ4xlNs2jun5afnlYPt4vT5+MHnxIuwH1UdZxqJKI9mk7Fjo3DcGGwvZYyIw50HgHEVYWzxTFjopYMGU+nOO6qNdZ6yIMWsE1CfDrRtC4KWCxr+2MtZWwwIy16Q880wcA3ubCRltbCtI09irDtsi7zXYz3/oAhIKfIRYjhOKABm9o2KuwAYckt17VRrGlAU8JdKW0KPc65b6OcD6IgcI06xqoGaPi3RTLXp9SyTMuingchjaSmpYqA9P3GGJk69KingtQomcLoYozfK3DXGKrf6PCvdB1aPIhsgBWtUWR6+hsmjq4Y0dWi5u38BZRBTiq+AwTyAAAAAElFTkSuQmCC"
            },
            6082: (e, t, n) => {
                "use strict";
                n.d(t, {
                    R: () => u
                });
                var o = n(4467),
                    r = n(3029),
                    a = n(2901),
                    i = n(9770),
                    s = n(8628);

                function l(e, t) {
                    var n = "undefined" != typeof Symbol && e[Symbol.iterator] || e["@@iterator"];
                    if (!n) {
                        if (Array.isArray(e) || (n = function(e, t) {
                                if (e) {
                                    if ("string" == typeof e) return c(e, t);
                                    var n = {}.toString.call(e).slice(8, -1);
                                    return "Object" === n && e.constructor && (n = e.constructor.name), "Map" === n || "Set" === n ? Array.from(e) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? c(e, t) : void 0
                                }
                            }(e)) || t && e && "number" == typeof e.length) {
                            n && (e = n);
                            var o = 0,
                                r = function() {};
                            return {
                                s: r,
                                n: function() {
                                    return o >= e.length ? {
                                        done: !0
                                    } : {
                                        done: !1,
                                        value: e[o++]
                                    }
                                },
                                e: function(e) {
                                    throw e
                                },
                                f: r
                            }
                        }
                        throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                    }
                    var a, i = !0,
                        s = !1;
                    return {
                        s: function() {
                            n = n.call(e)
                        },
                        n: function() {
                            var e = n.next();
                            return i = e.done, e
                        },
                        e: function(e) {
                            s = !0, a = e
                        },
                        f: function() {
                            try {
                                i || null == n.return || n.return()
                            } finally {
                                if (s) throw a
                            }
                        }
                    }
                }

                function c(e, t) {
                    (null == t || t > e.length) && (t = e.length);
                    for (var n = 0, o = Array(t); n < t; n++) o[n] = e[n];
                    return o
                }
                var u = function() {
                    return (0, a.A)((function e(t) {
                        (0, r.A)(this, e), this.numRequests = (0, o.A)((0, o.A)((0, o.A)((0, o.A)({}, i.A.Interaction, 0), i.A.Thumbnail, 0), i.A.Prefetch, 0), i.A.Compute, 0), this.id = t || (0, s.A)(), this.requestPool = (0, o.A)((0, o.A)((0, o.A)((0, o.A)({}, i.A.Interaction, {
                            0: []
                        }), i.A.Thumbnail, {
                            0: []
                        }), i.A.Prefetch, {
                            0: []
                        }), i.A.Compute, {
                            0: []
                        }), this.grabDelay = 5, this.awake = !1, this.numRequests = (0, o.A)((0, o.A)((0, o.A)((0, o.A)({}, i.A.Interaction, 0), i.A.Thumbnail, 0), i.A.Prefetch, 0), i.A.Compute, 0), this.maxNumRequests = (0, o.A)((0, o.A)((0, o.A)((0, o.A)({}, i.A.Interaction, 6), i.A.Thumbnail, 6), i.A.Prefetch, 5), i.A.Compute, 1e3)
                    }), [{
                        key: "setMaxSimultaneousRequests",
                        value: function(e, t) {
                            this.maxNumRequests[e] = t
                        }
                    }, {
                        key: "getMaxSimultaneousRequests",
                        value: function(e) {
                            return this.maxNumRequests[e]
                        }
                    }, {
                        key: "destroy",
                        value: function() {
                            this.timeoutHandle && window.clearTimeout(this.timeoutHandle)
                        }
                    }, {
                        key: "addRequest",
                        value: function(e, t, n) {
                            var o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 0,
                                r = {
                                    requestFn: e,
                                    type: t,
                                    additionalDetails: n
                                };
                            void 0 === this.requestPool[t][o] && (this.requestPool[t][o] = []), this.requestPool[t][o].push(r), this.startGrabbing()
                        }
                    }, {
                        key: "filterRequests",
                        value: function(e) {
                            var t = this;
                            Object.keys(this.requestPool).forEach((function(n) {
                                var o = t.requestPool[n];
                                Object.keys(o).forEach((function(t) {
                                    o[t] = o[t].filter((function(t) {
                                        return e(t)
                                    }))
                                }))
                            }))
                        }
                    }, {
                        key: "clearRequestStack",
                        value: function(e) {
                            if (!this.requestPool[e]) throw new Error("No category for the type ".concat(e, " found"));
                            this.requestPool[e] = {
                                0: []
                            }
                        }
                    }, {
                        key: "sendRequests",
                        value: function(e) {
                            for (var t = this, n = this.maxNumRequests[e] - this.numRequests[e], o = 0, r = 0; r < n; r++) {
                                var a = this.getNextRequest(e);
                                if (null === a) return !1;
                                if (a) {
                                    var i;
                                    this.numRequests[e]++, this.awake = !0;
                                    var s = void 0;
                                    try {
                                        s = a.requestFn()
                                    } catch (e) {
                                        console.warn("sendRequest failed", e)
                                    }
                                    null !== (i = s) && void 0 !== i && i.finally ? s.finally((function() {
                                        t.numRequests[e]--, t.startAgain()
                                    })) : (this.numRequests[e]--, o++)
                                }
                            }
                            return o && this.startAgain(), !0
                        }
                    }, {
                        key: "getNextRequest",
                        value: function(e) {
                            var t, n = l(this.getSortedPriorityGroups(e));
                            try {
                                for (n.s(); !(t = n.n()).done;) {
                                    var o = t.value;
                                    if (this.requestPool[e][o].length) return this.requestPool[e][o].shift()
                                }
                            } catch (e) {
                                n.e(e)
                            } finally {
                                n.f()
                            }
                            return null
                        }
                    }, {
                        key: "startGrabbing",
                        value: function() {
                            var e = this.sendRequests(i.A.Interaction),
                                t = this.sendRequests(i.A.Thumbnail),
                                n = this.sendRequests(i.A.Prefetch),
                                o = this.sendRequests(i.A.Compute);
                            e || t || n || o || (this.awake = !1)
                        }
                    }, {
                        key: "startAgain",
                        value: function() {
                            var e = this;
                            this.awake && (void 0 !== this.grabDelay ? this.timeoutHandle || (this.timeoutHandle = window.setTimeout((function() {
                                e.timeoutHandle = null, e.startGrabbing()
                            }), this.grabDelay)) : this.startGrabbing())
                        }
                    }, {
                        key: "getSortedPriorityGroups",
                        value: function(e) {
                            var t = this;
                            return Object.keys(this.requestPool[e]).map(Number).filter((function(n) {
                                return t.requestPool[e][n].length
                            })).sort((function(e, t) {
                                return e - t
                            }))
                        }
                    }, {
                        key: "getRequestPool",
                        value: function() {
                            return this.requestPool
                        }
                    }])
                }()
            },
            6178: e => {
                "use strict";
                e.exports = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAACxFBMVEX2AABM/7v4jQBe/z9M/8JM/6z4nQJL/7RQ/2FR/1H3qQP4hABM/5Fh/VZ4/CzdFCPzSwL4lgH3cQD2FgBL/ONM/89M/51L/n9N/nhS/UZ9+UK7vSS05B/kqgz5sgP2NQA9vvVD0OpL/shM/6Zl16FM/25b/Gll/kmK/SqW9Cp//Smv1SXd2RLUwBDXlg/11gznGgf5vwXzewP4ogH1JAH2ZQD1WwD3QAA4tfw+yftL7dxL/NZU/JZN/4R98nSK32esSV6S0FCN+UZR/z5+3jl7+zeO+jWftTRb/yya7Suq/CapxSTPQiC1yRzC6xvEehnH4BjM0hbCkRXVsRPhJRLYcQ3ptgnfMAnsjwXxigXwYwPxMgMrT/5D3vc/wehM39uBRLdN1Zha+I571oaEeYRW/oGmGoCTL35/4HWyL2eB+mZd/WB36F/tAFxT8Vhl8Fd+6U2cfkhc50fANENa9EDPHz6F8Dyf5Dmq1zla/zZv5ja2xi7HYCuD6iij5ii9WyX0ACSw8yPOxB7OsBrP7hnoBxbchhLYzBDy3Q/j0A7fsQzjnAztCAr1zAn0vAfvbQMnPf4wcv0nHf0yDf0ylPc2buVK5M5Cws14K8dWV8RDz7tP87dg17d1WrdenrZJu61W7KZsjZN3y4Rz7n9o/Xxj8nzgA3uJhndX/3JU6nHHEnCUeG2F12h3tWGVz15w+1yPv1unfVt21Fier1idaU7zAEKX5UGsyEFx+z622j67Pj2RwjiKuTdk/zC1qzCpuCjPNyiX4iS2eSDTfRnk6hbFpBXLbxTZuQ/Zpg7kvw3gSg3mkgnqYQfpeQZI8PFRRORVW9VIedN3FsxX9cpgc8VlIbNhvbFF47BN54lxpolwuohSu4Vh2HByvXCiZm6Vn2Z5k2atcU+AnU6aqjyI4Tpm8TST1jOiiyefrx/EwxbsPAX4eAAG0MznAAADV0lEQVQ4y9WM03pjYRiF/2QnaezGbOxJGtS2bWtqT227Y9u2bdu25yZmt0/P5gpmHX3P975rgf8s8zJTo7ovJyT083/+6E6d9w+/bpy6xA3ojT+1xUdzEtsWHTunMObqCSnjQkF8Ye7zD+sl8j7fbafuXEudJVQHY4Z/Sdy/Vl67WSppAJRVEnmOu3R/YmjSTJ9ut2XG3jrevNlN4rZs8cJVsD1/YZabu5t0izHh+m0biEOm+/OHQ+Q5kmz3RUuWPJsRFme5Zy/3eFJ6JXbvEBDQzpeOavz9S+XS+9mLspZ1RH3asDSHieAJ+CdOEA4eAWPpvn0tvtO0FP5GT08P6YqCXI8XS5f76NLoQiHVMVQIkIldab6FVLqwfGd5+ZpctsKDuXr12n6a8cJNi9UqPgLo+lv3KkPvjfFlCJ/w4jUrNhW9euvVrO+vCQwyjqdRk4FoBJNxPjlyK1aBbdFhN74fBBMXD5J4sW3nWklfb2aKgXkESRXb/dFsHLdLEBFJOba9qud2nCaxM+wcLmgoNBWMXrU7qO1eUCuEq67ednbwWFVVT1QXpA0LU5NrrjWeBZW1DvGdkwrsrjfr/fJed4AFfqcHk8683He4NoRM7msMBCs3MRjCX53v1u1+vGCP325KUHV9HWztWFdWVBNpIbeCnkNWRobdlnSxrKTkwUrKxAVtWzfYnpdXVtJwJfquTg2SzmQC67T4d/L3uqeP9tQ1UDqiKEc/73g4f187f5werQWXL1mBg5EcFA417lKqw+qPTlA+cnFQfj5XSWwnGDTgW5wYZFBDZd6BXK2Cw4XqTxdx2EQEC8d2YfqIXEcBedhmizbuRSGIUC+Oo8CSDx329vbGVmBdmJ4Boht6EBFn0GtCDjg7F3cOB+OgQHV+MK+CSIppQrNUMb0kFSjYqeJBEA7tpRNGVijVWtWGgAgSujh+jBdMVnmhUMAFgUDIiGxOyBRepB+4OhBQGREjaNHF8JQcosyTyQQIJ9hwQrNJwQOTJpNpxGSaNIvwrinNBShnZ5fZBfhwgkO6QcDjJ6fMeJHZjHHFYwzHt7JkaDRAoZzgAZayyUD/Q0DSaBgYumKQGAISkxIvCG8CLDSLyDkQbsDDHxqNbrekp1mmM+5a0pEEAhLOX/KQAIVSSOoqAAAAAElFTkSuQmCC"
            },
            6188: e => {
                "use strict";
                e.exports = Math.max
            },
            6206: e => {
                "use strict";
                e.exports = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAACoFBMVEUAAABDFU9MDU88iDVgXqZAH1QeAx0KBg8/kDhra7pVVJI8JlkxKVM3IU5DPXZIJ2E6gTRRUoU9NmxHMGg2MF9AEkk9ezsTEhj59O5ob6ZYaYlJQX1OWXxIRXlUf3JNdWhAMWdKbGRIblxGelZHF1U6IFJcwFEsIUETBxdoca1gaJ1idJlaYpdaaY9Yb4ZMSoRXd31OZXZEN29LOWdUlGIzLFlGZ1ZQp0dJB0ZEjEVGnT8zFD86Cz8vDjYfESv++/nj4NpydKBdXqBVWYxRTYxxjYFYaIFPaXNReHFMYW5IUWxJQ2ZDO2Y+L2BCRF1GI1xKg1lSmFdTq1JKh1FcxU9Yy01ABz8qIDooEjUpBSju7OL039He2tHDw8aqprNna67MyaZjaaVbWZ7srJpcaJXZx5JecI5XX41vcYdSWoZhdYBSYoBehH1MT3lSbnhMO3RFQ3FPcHBITWZOfGRNZ2OTvV9FU11HXlpFcVVASFFLGVHNxE9Rkk9Ef01DdE1GEE1Z00xZuEs3F0dAgEQpKkFAlTkzBzQ4ejMhIy8zAS0PAA7S0cnGvsFubr+Qkq51c67Eu6Cyrp+YnJmtnInhs4iMsYaekIONg31PS3RLVXN1pGpPW2ZUg2Jfh15bol1YfFtMRVvEr1pSi1rG0FlXsldEM1c8QFa/1FRmtlSr1VCiylCFzk9rxU5OoEpNl0gyHUZhXy8ZDCIkOSEZIx/m5+Z4eNB6fLv1xLq1sLjYwK/vuK2op6h/hqDY1J+ux5TNt5KDgpFpZ5GdsYfBv4Xlm4KUmH2epHp3dXWRkGyhsWa2umXNuWOtmWB6Z2Cmoluex1qAglmCklhrrldHgFbaeVY4LlWptVS7oVOQyVKOpUxnzktBXUuApUU3X0E4TkCVkj8EsvciAAADTklEQVQ4y9WMU58bYRhH35nMTDixbTtpsuHa9m5ta217a9u2bdv2V+m0v/aqn6D/m+finPOA/2xkskg03M9g8LkK/rCI/A83Geg0yxyXN6dOxbEvTGH2/1H+Hga9tXBxXt3e9m/Hjf68emWtPl/0m4yMjP7iLaxAsX/eVuPR00D09ajfWLZ3C2s/YYyCwcEErD9/U86O7vLuF3sOfCLskwcOfS7vNrrxd8PxCsAUwI378uf4y8uNZR/b2n78EtoOl/WUlBQHKk1NrcAF79SqObVbVLvLeoyHDzWcOXO69MjBcEiu8O3MjTS1ABas2d/YVKGn+/zhcLDndV0w2H7kmDYXqkAL41hlJ4BZC6BAZ3WCPtOdqSkume8uCW7fvH2foNXHipLJ2HcQ9dKjngJBoa+jvWaBsvjgutvr0pULuPRsCwfFe09FgIEPVfAqc7WZmpm1i2y7r4sTE5PSPXLTLOoyaQ7djAEGXzCCVTeWNkskabK05LGX394dN0FBYyHLqI5NeJ4ZqLmD1VjuVuskqm2mTblcPG3atAsTaFSESp2KZOPWAjA3A8NMdqdzfvqrlU+3XUkcP3mJOGn2/AezM1IRhEc9Bz68JAOGd2r9oxm7xq9ZuTYpOfn8RPGlVQ+f37g/U1GFUMG4DWZyVTwuejZ5xrU9T8aJryIrJiSu3fV48ow1Jm9cRgNnk83AXIWdqry1uqFh/cQlSRfHj126fP37Ozc35qGxRVPBRJoZYKMmWtoUyVx3ClWySjx2tcQ2ZdsOq0dXIODRwCQmBmLVLcJmiyWlRmuZtGLpPXdAFyrKyDoe1uJ6NUDUsZgM/UIh6aa4HIEaJ7JhtjJLZXM6KcFj2QaWGrhkPC6Hk02haGnqFKlVQktPnbewU8qUlxZJmQqPAzRrrPbp06V9usWoL6M+FXFsnpUm7cvysux2ZPqbUAhQSCSSUKfSpNJRlMvkMuVzXbLFBYtk8oVZytKB8ABgs9kkEntI5ZjFHEOMz+ePYeAoRN+oC1EGiJj4QKFQhthsoScfQvV0A8NgYDAgYrwcTVGfcAgQOYkt7Micw0uAYZgAKI7jJ3pPdMH6Qq6CIwcdQmGRah6Hhwq6IKg3Gk2AoUisKhKBYCLoggU/Aep54rZnCVVxAAAAAElFTkSuQmCC"
            },
            6260: (e, t, n) => {
                "use strict";
                n.d(t, {
                    A: () => i,
                    T: () => a
                });
                var o = n(5915),
                    r = n.n(o);
                const a = e => e ? e.split(/\|{1,2}/).map((e => parseFloat(e))) : [],
                    i = e => {
                        const {
                            accnum: t,
                            acqdt: n,
                            acqtm: o,
                            age: i,
                            bita: s,
                            bits: l,
                            blocks: c,
                            col: u,
                            hbit: d,
                            imgnum: h,
                            imgori: f,
                            imgpos: m,
                            inst: g,
                            kv: p,
                            mod: v,
                            name: y,
                            orb: b,
                            orl: w,
                            orr: x,
                            ort: T,
                            patid: I,
                            phme: E,
                            pixrep: S,
                            pixx: A,
                            pixy: C,
                            rescin: M,
                            rescsl: D,
                            row: P,
                            rphn: k,
                            sappix: _,
                            serid: L,
                            seruid: O,
                            sex: R,
                            sliceth: N,
                            sopuid: U,
                            studt: B,
                            stuid: V,
                            stutm: F,
                            stuuid: H,
                            syntaxuid: q,
                            wc: j,
                            ww: z
                        } = e, W = a(f), G = a(m), Y = parseFloat(D) || 1, Z = parseFloat(M) || 0, K = parseFloat(S);
                        let X, J, Q, $, ee = [parseFloat(A), parseFloat(C)];
                        const te = a(String(A));
                        return te.length >= 2 && (ee = te), ee && (J = ee[0], X = ee[1]), W && (Q = [W[0], W[1], W[2]], $ = [W[3], W[4], W[5]]), {
                            accessionNumber: t,
                            acquisitionDate: r().parseDA(n || ""),
                            acquisitionTime: r().parseTM(o || ""),
                            bitsAllocated: parseFloat(s),
                            bitsStored: parseFloat(l),
                            blocks: parseFloat(c),
                            columnCosines: $,
                            columnPixelSpacing: X,
                            columns: parseFloat(u),
                            frameOfReferenceUID: void 0,
                            highBit: parseFloat(d),
                            imageBottomTag: b,
                            imageleftTag: w,
                            imageOrientationPatient: W,
                            imagePositionPatient: G,
                            imagetightTag: x,
                            imagetopTag: T,
                            instanceNumber: h,
                            institutionName: g,
                            KVP: p,
                            modality: v,
                            patientAge: i,
                            patientID: I,
                            patientName: y,
                            patientSex: R,
                            photometricInterpretation: E,
                            pixelRepresentation: K,
                            pixelSpacing: ee,
                            referringPhysicianName: k,
                            rescaleIntercept: Z,
                            rescaleSlope: Y,
                            rowCosines: Q,
                            rowPixelSpacing: J,
                            rows: parseFloat(P),
                            samplesPerPixel: parseFloat(_),
                            seriesDate: r().parseDA(B || ""),
                            seriesInstanceUID: O,
                            seriesNumber: parseFloat(L),
                            seriesTime: r().parseTM(F || ""),
                            sliceLocation: G[2],
                            sliceThickness: parseFloat(N),
                            sopInstanceUID: U,
                            studyID: V,
                            studyInstanceUID: H,
                            transferSyntaxUID: q,
                            windowCenter: [parseFloat(j)],
                            windowWidth: [parseFloat(z)],
                            origin: e
                        }
                    }
            },
            6269: (e, t, n) => {
                "use strict";
                var o;
                n.d(t, {
                        A: () => r
                    }),
                    function(e) {
                        e.STACK = "stack", e.ORTHOGRAPHIC = "orthographic", e.PERSPECTIVE = "perspective", e.VOLUME_3D = "volume3d", e.VIDEO = "video", e.WHOLE_SLIDE = "wholeSlide"
                    }(o || (o = {}));
                const r = o
            },
            6299: (e, t, n) => {
                "use strict";
                n.d(t, {
                    A: () => l
                });
                var o = n(4594),
                    r = n(346),
                    a = n.n(r),
                    i = n(2117),
                    s = n(2290);

                function l(e, t) {
                    return new Promise((n => {
                        const {
                            OK: r,
                            cancel: l
                        } = (0, i.Tl)("toast.prompt");
                        a().question(Object.assign({
                            class: o.A.isMobile ? "custom-iziToast-question-mobile" : "custom-iziToast-question",
                            close: !1,
                            drag: !1,
                            timeout: !1,
                            overlay: !0,
                            theme: "dark",
                            color: "unset",
                            message: e,
                            position: "center",
                            icon: "",
                            progressBar: !1,
                            buttons: [
                                [`<button class='confirm' >${r}</button>`, function(e, t, o, r, a) {
                                    return e.destroy(), n("ok")
                                }, !1],
                                [`<button class='cancel' >${l}</button>`, function(e, t, n, o) {
                                    e.hide({}, t, "cancel")
                                }, !1]
                            ],
                            onOpening: (e, t) => {
                                (0, s._)(t)
                            },
                            onClosing: function(e, t, o) {
                                "confirm" !== o && n(null)
                            }
                        }, t))
                    }))
                }
            },
            6402: (e, t, n) => {
                "use strict";
                n.d(t, {
                    b8: () => h,
                    O$: () => d,
                    sS: () => i,
                    BY: () => S,
                    Sl: () => A,
                    fs: () => C,
                    fO: () => D,
                    lQ: () => _,
                    G7: () => P,
                    sO: () => k
                });
                var o = n(9584),
                    r = n.n(o),
                    a = n(281);
                const i = (e, t) => {
                    try {
                        (0, o.getEnabledElement)(e)
                    } catch (n) {
                        (0, o.enable)(e, Object.assign({}, t)), a.store.state.globalToolChangeHistory.length >= 49 && console.warn("globalToolChangeHistory is too much")
                    }
                };
                var s = n(736),
                    l = function(e, t, n, o) {
                        return new(n || (n = Promise))((function(r, a) {
                            function i(e) {
                                try {
                                    l(o.next(e))
                                } catch (e) {
                                    a(e)
                                }
                            }

                            function s(e) {
                                try {
                                    l(o.throw(e))
                                } catch (e) {
                                    a(e)
                                }
                            }

                            function l(e) {
                                var t;
                                e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                                    e(t)
                                }))).then(i, s)
                            }
                            l((o = o.apply(e, t || [])).next())
                        }))
                    };
                const c = e => {
                        const {
                            element: t,
                            canvas: n
                        } = e;
                        try {
                            const r = {
                                element: t
                            };
                            (0, o.triggerEvent)(t, o.EVENTS.ELEMENT_DISABLED, r), (0, o.triggerEvent)(o.events, o.EVENTS.ELEMENT_DISABLED, r), 1 === t.querySelectorAll("canvas").length && n && t.removeChild(n), e.canvas = void 0
                        } catch (e) {
                            console.info(e)
                        }
                    },
                    u = e => {
                        if (void 0 === e) throw new Error("disable: element must not be undefined");
                        const t = (0, o.getEnabledElements)();
                        for (let n = 0; n < t.length; n++) {
                            const o = t[n];
                            if (o.element === e) {
                                const r = e.querySelectorAll("canvas");
                                r.length > 1 && r.forEach((e => setTimeout((() => u(e.parentElement))))), c(o), t.splice(n, 1)
                            }
                        }
                    },
                    d = e => l(void 0, void 0, void 0, (function*() {
                        const t = [...e ? (0, o.getEnabledElements)() : yield(0, s.A)(!1)];
                        for (const e of t) u(e.element)
                    })),
                    h = u;
                var f = n(9473);
                const m = new f.TJ;
                var g = n(3678),
                    p = n(6613),
                    v = n(9788),
                    y = n(4594),
                    b = n(8319),
                    w = n(2117),
                    x = n(346),
                    T = n.n(x),
                    I = function(e, t, n, o) {
                        return new(n || (n = Promise))((function(r, a) {
                            function i(e) {
                                try {
                                    l(o.next(e))
                                } catch (e) {
                                    a(e)
                                }
                            }

                            function s(e) {
                                try {
                                    l(o.throw(e))
                                } catch (e) {
                                    a(e)
                                }
                            }

                            function l(e) {
                                var t;
                                e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                                    e(t)
                                }))).then(i, s)
                            }
                            l((o = o.apply(e, t || [])).next())
                        }))
                    };
                r().loadAndCacheImage = (e, t = {}) => (0, o.loadAndCacheImage)(e, Object.assign(Object.assign({}, t), {
                    useRGBA: !0
                })), r().loadImage = (e, t = {}) => (0, o.loadImage)(e, Object.assign(Object.assign({}, t), {
                    useRGBA: !0
                }));
                let E = 0;
                const S = (e, t) => new Promise(((n, o) => I(void 0, void 0, void 0, (function*() {
                        try {
                            const o = yield r()[y.A.DBCacheImages.enable ? "loadImage" : "loadAndCacheImage"](e, t);
                            n(o)
                        } catch (t) {
                            const {
                                loadAndCacheImage: n,
                                indexedDBDelete: r
                            } = (0, w.Tl)("toast");
                            o(t);
                            let a = 5e3;
                            (0, v.Ay)("loadAndCacheImage", (0, f.nF)((t => {
                                const {
                                    status: o,
                                    response: r
                                } = (null == t ? void 0 : t.error) || t || {};
                                let i;
                                i = void 0 === o ? n.parsingFailed : 203 === o ? n.validationFailed : n.dataError, console.error({
                                    message: i,
                                    error: t,
                                    status: o,
                                    imageId: e,
                                    response: new TextDecoder("utf-8").decode(r)
                                }), T().error({
                                    title: i,
                                    timeout: a
                                })
                            }), a, {
                                trailing: !1
                            }), t);
                            const {
                                indexedDBKey: i
                            } = (0, p.A)(e, y.A.imageType);
                            yield b.A.open(), console.info(r, i), b.A.dispatch("delete", {}, i)
                        }
                    })))),
                    A = (e, t) => I(void 0, void 0, void 0, (function*() {
                        const {
                            cancel: n = !0,
                            forceCancelAll: o = !1,
                            countCallback: r
                        } = t || {}, a = "function" == typeof r;
                        let i = 0;
                        if (o) return m.cancel();
                        !y.A.preload.fullLoad && n && m.cancel(), yield m.init({
                            arr: e,
                            func: e => I(void 0, void 0, void 0, (function*() {
                                try {
                                    const t = yield S(e);
                                    i += 1, E += 1, a && r(t, e, i), (0, g.kX)("loadAndCacheImages", !1, 400) && (E = 0)
                                } catch (e) {
                                    console.error(e)
                                }
                            })),
                            limit: 6
                        })
                    })),
                    C = e => {
                        const t = (0, o.getEnabledElement)(e);
                        t.renderingTools.colormapId = void 0, t.renderingTools.colorLut = void 0;
                        const n = t.renderingTools.renderCanvas,
                            r = n.getContext("2d", {
                                willReadFrequently: !0
                            });
                        r.fillStyle = "white", r.fillRect(0, 0, n.width, n.height);
                        const a = r.getImageData(0, 0, n.width, n.height);
                        t.renderingTools.renderCanvasContext = r, t.renderingTools.renderCanvasData = a
                    },
                    M = e => {
                        a.store.state.globalToolChangeHistory = a.store.state.globalToolChangeHistory.filter((({
                            mode: t,
                            args: [n, o]
                        }) => n !== e))
                    },
                    D = function(e, t, n) {
                        L(), M(e), (0, a.setToolActive)(e, t, n)
                    },
                    P = function(e, t) {
                        M(e), (0, a.setToolEnabled)(e, t)
                    },
                    k = function(e, t) {
                        M(e), (0, a.setToolPassive)(e, t)
                    },
                    _ = function(e, t) {
                        M(e), (0, a.setToolDisabled)(e, t), a.store.state.globalToolChangeHistory = a.store.state.globalToolChangeHistory.filter((({
                            mode: e
                        }) => "disabled" !== e))
                    },
                    L = () => {
                        for (const {
                                name: e,
                                mode: t,
                                _options: {
                                    mouseButtonMask: n = []
                                }
                            } of a.store.state.tools) {
                            if ("active" !== t) continue;
                            const o = n.findIndex((e => 1 === e)); - 1 !== o && (1 === n.length ? k(e) : n.splice(o, 1))
                        }
                    }
            },
            6439: e => {
                /*! cornerstone-web-image-loader - 2.1.1 - 2018-12-05 | (c) 2016 Chris Hafey | https://github.com/cornerstonejs/cornerstoneWebImageLoader */
                window,
                e.exports = function(e) {
                    var t = {};

                    function n(o) {
                        if (t[o]) return t[o].exports;
                        var r = t[o] = {
                            i: o,
                            l: !1,
                            exports: {}
                        };
                        return e[o].call(r.exports, r, r.exports, n), r.l = !0, r.exports
                    }
                    return n.m = e, n.c = t, n.d = function(e, t, o) {
                        n.o(e, t) || Object.defineProperty(e, t, {
                            configurable: !1,
                            enumerable: !0,
                            get: o
                        })
                    }, n.r = function(e) {
                        Object.defineProperty(e, "__esModule", {
                            value: !0
                        })
                    }, n.n = function(e) {
                        var t = e && e.__esModule ? function() {
                            return e.default
                        } : function() {
                            return e
                        };
                        return n.d(t, "a", t), t
                    }, n.o = function(e, t) {
                        return Object.prototype.hasOwnProperty.call(e, t)
                    }, n.p = "", n(n.s = 5)
                }([function(e, t, n) {
                    "use strict";
                    Object.defineProperty(t, "__esModule", {
                        value: !0
                    }), t.external = void 0;
                    var o, r = (o = n(4)) && o.__esModule ? o : {
                            default: o
                        },
                        a = void 0,
                        i = {
                            set cornerstone(e) {
                                a = e, (0, r.default)(a)
                            },
                            get cornerstone() {
                                return a
                            }
                        };
                    t.external = i
                }, function(e, t, n) {
                    "use strict";
                    Object.defineProperty(t, "__esModule", {
                        value: !0
                    }), t.loadImage = function(e) {
                        var t = o.external.cornerstone,
                            n = new XMLHttpRequest;
                        return n.open("GET", e, !0), n.responseType = "arraybuffer", s.beforeSend(n), n.onprogress = function(n) {
                            if (n.lengthComputable) {
                                var o = n.loaded,
                                    r = n.total,
                                    a = Math.round(o / r * 100),
                                    i = {
                                        imageId: e,
                                        loaded: o,
                                        total: r,
                                        percentComplete: a
                                    };
                                t.triggerEvent(t.events, "cornerstoneimageloadprogress", i)
                            }
                        }, {
                            promise: new Promise((function(t, o) {
                                n.onload = function() {
                                    (0, r.default)(this.response).then((function(n) {
                                        var o = (0, a.default)(n, e);
                                        t(o)
                                    }), o)
                                }, n.send()
                            })),
                            cancelFn: function() {
                                n.abort()
                            }
                        }
                    }, t.configure = function(e) {
                        s = e
                    };
                    var o = n(0),
                        r = i(n(3)),
                        a = i(n(2));

                    function i(e) {
                        return e && e.__esModule ? e : {
                            default: e
                        }
                    }
                    var s = {
                        beforeSend: function() {}
                    }
                }, function(e, t, n) {
                    "use strict";
                    Object.defineProperty(t, "__esModule", {
                        value: !0
                    }), t.default = function(e, t) {
                        var n = e.naturalHeight,
                            i = e.naturalWidth;
                        return {
                            imageId: t,
                            minPixelValue: 0,
                            maxPixelValue: 255,
                            slope: 1,
                            intercept: 0,
                            windowCenter: 128,
                            windowWidth: 255,
                            render: o.external.cornerstone.renderWebImage,
                            getPixelData: function() {
                                return (n = void 0, a === t ? n = r.getContext("2d") : (r.height = e.naturalHeight, r.width = e.naturalWidth, (n = r.getContext("2d")).drawImage(e, 0, 0), a = t), n.getImageData(0, 0, e.naturalWidth, e.naturalHeight)).data;
                                var n
                            },
                            getCanvas: function() {
                                return a === t || (r.height = e.naturalHeight, r.width = e.naturalWidth, r.getContext("2d").drawImage(e, 0, 0), a = t), r
                            },
                            getImage: function() {
                                return e
                            },
                            rows: n,
                            columns: i,
                            height: n,
                            width: i,
                            color: !0,
                            rgba: !1,
                            columnPixelSpacing: void 0,
                            rowPixelSpacing: void 0,
                            invert: !1,
                            sizeInBytes: n * i * 4
                        }
                    };
                    var o = n(0),
                        r = document.createElement("canvas"),
                        a = void 0
                }, function(e, t, n) {
                    "use strict";
                    Object.defineProperty(t, "__esModule", {
                        value: !0
                    }), t.default = function(e) {
                        return new Promise((function(t, n) {
                            var o = new Image,
                                r = new Uint8Array(e),
                                a = new Blob([r]),
                                i = window.URL || window.webkitURL,
                                s = i.createObjectURL(a);
                            o.src = s, o.onload = function() {
                                t(o), i.revokeObjectURL(s)
                            }, o.onerror = function(e) {
                                i.revokeObjectURL(s), n(e)
                            }
                        }))
                    }
                }, function(e, t, n) {
                    "use strict";
                    Object.defineProperty(t, "__esModule", {
                        value: !0
                    }), t.default = function(e) {
                        e.registerImageLoader("http", o.loadImage), e.registerImageLoader("https", o.loadImage)
                    };
                    var o = n(1)
                }, function(e, t, n) {
                    "use strict";
                    Object.defineProperty(t, "__esModule", {
                        value: !0
                    }), t.external = t.configure = t.loadImage = t.createImage = t.arrayBufferToImage = void 0;
                    var o = s(n(3)),
                        r = s(n(2)),
                        a = n(1),
                        i = n(0);

                    function s(e) {
                        return e && e.__esModule ? e : {
                            default: e
                        }
                    }
                    var l = {
                        arrayBufferToImage: o.default,
                        createImage: r.default,
                        loadImage: a.loadImage,
                        configure: a.configure,
                        external: i.external
                    };
                    t.arrayBufferToImage = o.default, t.createImage = r.default, t.loadImage = a.loadImage, t.configure = a.configure, t.external = i.external, t.default = l
                }])
            },
            6446: e => {
                "use strict";
                e.exports = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAACmlBMVEUAAAAINTUMP0FvA+9mDOcGLCtNLscEIiIBCQwIMTFqCepDO7w9QbU7Rq8BEhIFJycBGBhiE+FVJNIQTU9aHdZTJ84QLkI2T6cmVoYmT4MHLy8HEBpdGdwtU5UaWWoTN00QQkwOREYONkF3APKSEck3SacyU6UtWZ4rQoO+QnQbOF8VUFwTS1YUP1MUJUULPTwJOjkLMDgOJTj//v358/V6C9yIDtORDNFNLb9FMrE/O7BDJKI8YpszRpsyQpYvTpUoYJEmZo0qVo0kZIcpO3wfUXQlQHQcS2oXVGEaQWETVFgOSkn88ezt4+tqD992DtZYHM795MqMGceXFMWCGcKhksFINL9ORLRgKLJJRLFQH6v2zag8QKc9NqYwT5s4MpdRc5SuMZEtPo46NIwqMnkeZXfaf3UrJnUkOHMpLm4YXWQWS1wRRk8ZFUV/Aezk4up4COX+8OTj1OSHBOONBtr969fNwNRpHM/hw865vch2IsPAqr/XsL6qdb5sL75ENblNN7ZqF7aGd7XotLSXlbLkrbChIbB0KK5dJK5HJK1sdKxHL6i/caWWhKSVip7Se5lIapdGSJZSMZZSYJMwSpAuN4o9LYU0JYQoXoAjXHkeQWwiNmwZMFLTV0gfDDYNFSsOChf15enXzunSueHBid7Iz9ltJNWyqtTJptSZWdRrRcxjHcvk0se8wcKos8FsGsCWqb9eMb+aYb1qW7z827nUmrZRJrTGpK2RRq2rfKlmOamxVahySKivnZ1ghZxuFZxINppRJZmmRJg/J5ivVpVqX5Q6Q5SQcZFgO5E8WY6+aoyAe4aiOYNBGYPHWYIgb34iTXiDTXQtVHFxaW2FLG2SMGwkYGrDSWolImgsDmCWRTzdZDRvNTFgLTDQUIJRAAADMklEQVQ4y9WQ07IdURRFd+/2aZ8+tu1r27HNa8S2bdu2bdvGv6STt1S+ILNqrVW1xnia4D8LxZt3d8R0rvZwzZcOM/UPT7mgkbVWtJVfyjF4iaJw7G+FskMdrKoZkDH35W3PkujIOZVJu/kPEUXqN2+xb5rbb8O6TM8usOejp1+vrF4joy17FABIkjTHHIHA3Z4ez/DPwQ+K/TMY7JnVM3O5bkdqNwmqTfTmUHtpvx5ZEyYM3/n9myL82BnMGt81o8vSVOy+DtiQljzZsHHknSWZo8YPD77o2PV18aIebqmgKlRfj29qAs5kXqh8qIDA0HEUHZPZq1vXjMmLui6tTOIQkmJsAMAdgWTeAFGAg/sMGjw5gyDGuKdNO72D1m234xTFbwZCrRMf3GRy1Fi65BiJLj3OzTx6TBOI2HO4EToXIqZAXEbIUKo5myCI8krm0IFOaen7zucW6Ib69bNHQJ4HUKZFnhwqqRn2ja1hWOeJAy90mvppi9Pg8zOFrmYzkGtJUdzezafXM/37Zy/rNLF797Ent3jL/P6y4hz7oHqw9pHII0MIpu+NK9NXPFmQNu7I/vTRw84+XP/UUGKN5LKg8S1FwYhh3Yr5jVNWXR7YeU3fvr3TTkx//GzG1UFVeJEPjH3OU4JS9/sZC+e/auyefqskf2rawNWrpyy8qQuTttdg9DAeUAJvptcsuH5vZe9J404d7Hx43soHF5e9q3EJbWXgzFYK8FRyhNGn7z/H4M/vnb53Hsf5Zs1i+2ia8agB5FfzgBSbJDXHlRBaRp8/aaZWrcE0rFrlXg4RGZTIJFnlykNRjdfGqrVE8ar1WrVSCoOOQgvjDhk0VLfXGktzUZQwRqyMniu7Zh3CWFhboWTRt1YwHNAS3BCOYzFNJdw2mygt9i62NrCSNgILrMVeDaYCqEqlwjRqbSlMwHC4trVo7dbWivJttoI+hFZC3W6AYSpMUdRsUbXTWVcny3V1MI4gMNANQ1FUhQJllIthWK4DTySccZhIQIgoiW7MtkgYBlAUU2LJLnQIOE7TNPInNIKbENhWYdwAJEyyEJwxGlc+NCKQuMIEATfRNI6blP0L9GTBDZUfhasAAAAASUVORK5CYII="
            },
            6549: e => {
                "use strict";
                e.exports = Object.getOwnPropertyDescriptor
            },
            6556: (e, t, n) => {
                "use strict";
                var o = n(453),
                    r = n(3126),
                    a = r([o("%String.prototype.indexOf%")]);
                e.exports = function(e, t) {
                    var n = o(e, !!t);
                    return "function" == typeof n && a(e, ".prototype.") > -1 ? r([n]) : n
                }
            },
            6559: () => {},
            6579: (e, t, n) => {
                "use strict";
                n.d(t, {
                    A: () => r
                });
                var o = {};
                const r = {
                    get: function(e) {
                        return o[e]
                    },
                    set: function(e) {
                        var t = e.id;
                        o[t] = e
                    },
                    delete: function(e) {
                        return delete o[e]
                    },
                    getAll: function() {
                        var e = Object.keys(o).map((function(e) {
                            return o[e]
                        }));
                        return e.sort((function(e, t) {
                            return "_" === e.id[0] && "_" !== t.id[0] ? 1 : "_" !== e.id[0] && "_" === t.id[0] ? -1 : 0
                        })), e
                    }
                }
            },
            6581: (e, t, n) => {
                "use strict";
                n.d(t, {
                    wj: () => E,
                    i5: () => _,
                    Up: () => C
                });
                var o = n(1948),
                    r = n(9584),
                    a = n(6439);
                const i = document.createElement("canvas");
                let s;
                const l = function(e, t, n = {}) {
                    const o = e.naturalHeight,
                        r = e.naturalWidth;
                    let a = !1;

                    function l(e) {
                        const t = c();
                        if (a) return t.data;
                        let n;
                        return n = (null == e ? void 0 : e.arrayBuffer) ? new Uint8Array(e.arrayBuffer, e.offset, e.length) : new Uint8Array(t.width * t.height * 3),
                            function(e, t) {
                                for (let n = 0, o = 0; n < e.data.length; n += 4, o += 3) t[o] = e.data[n], t[o + 1] = e.data[n + 1], t[o + 2] = e.data[n + 2]
                            }(t, n), n
                    }

                    function c() {
                        let n;
                        return s === t ? n = i.getContext("2d", {
                            willReadFrequently: !0
                        }) : (i.height = e.naturalHeight, i.width = e.naturalWidth, n = i.getContext("2d", {
                            willReadFrequently: !0
                        }), n.drawImage(e, 0, 0), s = t), n.getImageData(0, 0, e.naturalWidth, e.naturalHeight)
                    }
                    return void 0 !== n.useRGBA && (a = n.useRGBA), {
                        imageId: t,
                        minPixelValue: 0,
                        maxPixelValue: 255,
                        slope: 1,
                        intercept: 0,
                        windowCenter: 128,
                        windowWidth: 255,
                        getImageData: c,
                        getPixelData: l,
                        getCanvas: function() {
                            return s === t || (i.height = e.naturalHeight, i.width = e.naturalWidth, i.getContext("2d", {
                                willReadFrequently: !0
                            }).drawImage(e, 0, 0), s = t), i
                        },
                        getImage: () => e,
                        rows: o,
                        columns: r,
                        height: o,
                        width: r,
                        color: !0,
                        rgba: a,
                        columnPixelSpacing: 1,
                        rowPixelSpacing: 1,
                        invert: !1,
                        sizeInBytes: o * r * (a ? 4 : 3),
                        pixelData: (null == n ? void 0 : n.targetBuffer) ? l(n.targetBuffer) : void 0
                    }
                };

                function c(e, t) {
                    const n = e.get("modalityLutModule", t) || {},
                        o = e.get("generalSeriesModule", t) || {},
                        {
                            modality: r
                        } = o,
                        a = {
                            rescaleSlope: n.rescaleSlope,
                            rescaleIntercept: n.rescaleIntercept,
                            modality: r
                        },
                        i = e.get("scalingModule", t) || {};
                    return Object.assign(Object.assign({}, a), "PT" === r && {
                        suvbw: i.suvbw
                    })
                }
                var u = n(2881),
                    d = n(6613),
                    h = n(4594),
                    f = n(2117),
                    m = n(8319),
                    g = n(9473),
                    p = function(e, t, n, o) {
                        return new(n || (n = Promise))((function(r, a) {
                            function i(e) {
                                try {
                                    l(o.next(e))
                                } catch (e) {
                                    a(e)
                                }
                            }

                            function s(e) {
                                try {
                                    l(o.throw(e))
                                } catch (e) {
                                    a(e)
                                }
                            }

                            function l(e) {
                                var t;
                                e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                                    e(t)
                                }))).then(i, s)
                            }
                            l((o = o.apply(e, t || [])).next())
                        }))
                    };
                let v = "";

                function y(e) {
                    const t = function(e, t) {
                        let n;
                        return Number.isInteger(e) && Number.isInteger(t) && (e >= 0 ? t <= 255 ? n = Uint8Array : t <= 65535 && (n = Uint16Array) : e >= -128 && t <= 127 ? n = Int8Array : e >= -32768 && t <= 32767 && (n = Int16Array)), n || Float32Array
                    }(e.smallestPixelValue, e.largestPixelValue);
                    if (!t) throw new Error("Could not apply a typed array to the pixel data"); {
                        const n = new t(e.pixelData);
                        e.pixelData = n
                    }
                }
                const b = function(e, t, n = {}) {
                        let i = !1;
                        if (void 0 !== n.useRGBA && (i = n.useRGBA), n.preScale = {
                                enabled: !(!n.preScale || void 0 === n.preScale.enabled) && n.preScale.enabled
                            }, !t) return Promise.reject(new Error("The file does not contain image data."));
                        const s = document.createElement("canvas");
                        if (n.preScale.enabled) {
                            const t = c(r.metaData, e);
                            t && (n.preScale = Object.assign(Object.assign({}, n.preScale), {
                                scalingParameters: t
                            }))
                        }
                        const b = r.metaData.get("_grayImageModule", e),
                            w = (new Date).getTime(),
                            x = o.webWorkerManager.addTask("encryptionPngDecode", {
                                buffer: t,
                                info: Object.assign(Object.assign({}, b), {
                                    isIM: !0
                                })
                            }).promise;
                        return new Promise(((c, T) => {
                            x.then((function(x) {
                                return p(this, arguments, void 0, (function*({
                                    data: p,
                                    isPng: x,
                                    width: I,
                                    height: E,
                                    isImageData: S
                                }) {
                                    const A = (new Date).getTime(),
                                        C = (0, o.getImageFrame)(e),
                                        M = (0, o.isColorImage)(C.photometricInterpretation);
                                    let D = !1;
                                    if (b.blocks > 1) {
                                        const {
                                            lazyHandleToast: {
                                                notSupportedBlocks: t
                                            },
                                            indexedDBDelete: n
                                        } = (0, f.Tl)("toast"), {
                                            indexedDBKey: o
                                        } = (0, d.A)(e, h.A.imageType);
                                        yield m.A.open(), console.info(n, o), m.A.dispatch("delete", {}, o), (0, u.A)("multiImage", t)
                                    }
                                    if (S && p instanceof ImageData && (p = yield(0, g.Y4)(p)), x || (C.pixelData = p, C.pixelDataLength = p.length), C.decodeTimeInMS = A - w, M || x) {
                                        return void(0, a.arrayBufferToImage)(t).then((t => {
                                            c(l(t, e, n))
                                        }), T)
                                    }
                                    const P = r.metaData.get("imagePlaneModule", e) || {},
                                        k = r.metaData.get("voiLutModule", e) || {},
                                        _ = r.metaData.get("modalityLutModule", e) || {},
                                        L = r.metaData.get("sopCommonModule", e) || {};
                                    if (n.targetBuffer) {
                                        const e = {
                                                Uint8Array,
                                                Uint16Array,
                                                Int16Array,
                                                Float32Array
                                            },
                                            {
                                                arrayBuffer: t,
                                                type: o,
                                                offset: r = 0
                                            } = n.targetBuffer,
                                            {
                                                imageFrameLength: a
                                            } = C,
                                            {
                                                rescaleIntercept: i
                                            } = _,
                                            s = e[o];
                                        let l, {
                                            length: c
                                        } = n.targetBuffer;
                                        if (c = c || a - r, t) {
                                            if (c !== C.pixelDataLength) throw new Error("target array for image does not have the same length as the decoded image length.");
                                            l = new s(t, r, c)
                                        } else l = new s(C.pixelData);
                                        if (i)
                                            for (let e = 0; e < l.length; e++) l[e] = l[e] + i;
                                        C.pixelData = l, D = !0
                                    }
                                    const O = (0, o.getMinMax)(C.pixelData);
                                    C.smallestPixelValue = O.min, C.largestPixelValue = O.max, D || y(C);
                                    const {
                                        columns: R,
                                        rows: N
                                    } = C;
                                    if (I && E && (I !== R || E !== N)) {
                                        C.columns = I, C.rows = E, console.warn("Image row col is inconsistent", {
                                            columns: R,
                                            rows: N,
                                            width: I,
                                            height: E
                                        });
                                        try {
                                            const t = r.metaData.get("_allModule", e) || {},
                                                n = r.metaData.get("_resetModule", e) || {};
                                            t.origin.col = I, t.origin.row = I, n()
                                        } catch (e) {
                                            console.error(e)
                                        }
                                    }
                                    const U = {
                                        imageId: e,
                                        color: M || x,
                                        columnPixelSpacing: P.columnPixelSpacing,
                                        columns: C.columns,
                                        height: C.rows,
                                        preScale: C.preScale,
                                        intercept: _.rescaleIntercept ? _.rescaleIntercept : 0,
                                        slope: _.rescaleSlope ? _.rescaleSlope : 1,
                                        invert: "MONOCHROME1" === C.photometricInterpretation,
                                        minPixelValue: C.smallestPixelValue,
                                        maxPixelValue: C.largestPixelValue,
                                        rowPixelSpacing: P.rowPixelSpacing,
                                        rows: C.rows,
                                        sizeInBytes: C.pixelData.byteLength,
                                        width: C.columns,
                                        windowCenter: k.windowCenter ? k.windowCenter[0] : void 0,
                                        windowWidth: k.windowWidth ? k.windowWidth[0] : void 0,
                                        voiLUTFunction: k.voiLUTFunction,
                                        decodeTimeInMS: C.decodeTimeInMS,
                                        imageFrame: C,
                                        rgba: (M || x) && i,
                                        getPixelData: () => C.pixelData,
                                        getCanvas: void 0,
                                        numComps: void 0
                                    };
                                    var B;
                                    if (U.color && (U.getCanvas = function() {
                                            if (v === e) return s;
                                            s.height = U.rows, s.width = U.columns;
                                            return s.getContext("2d", {
                                                willReadFrequently: !0
                                            }).putImageData(C.imageData, 0, 0), v = e, s
                                        }), _.modalityLUTSequence && _.modalityLUTSequence.length > 0 && ("1.2.840.10008.5.1.4.1.1.12.1" !== (B = L.sopClassUID) && "1.2.840.10008.5.1.4.1.1.12.2.1" !== B) && (U.modalityLUT = _.modalityLUTSequence[0]), k.voiLUTSequence && k.voiLUTSequence.length > 0 && (U.voiLUT = k.voiLUTSequence[0]), U.color && (U.windowWidth = 255, U.windowCenter = 127), void 0 === U.windowCenter || void 0 === U.windowWidth) {
                                        const e = U.maxPixelValue * U.slope + U.intercept,
                                            t = U.minPixelValue * U.slope + U.intercept;
                                        U.windowWidth = e - t, U.windowCenter = (e + t) / 2
                                    }
                                    c(U)
                                }))
                            }), T)
                        }))
                    },
                    {
                        getOptions: w
                    } = o.internal,
                    x = (e, t, n = {}, o = {}) => {
                        const a = new XMLHttpRequest,
                            i = w(),
                            s = e => {
                                if ("function" == typeof i.errorInterceptor) {
                                    const t = new Error("request failed");
                                    t.request = e, t.response = e.response, t.status = e.status, i.errorInterceptor(t)
                                }
                            },
                            l = new Promise(((l, c) => {
                                i.open(a, e, n, o), a.responseType = "arraybuffer";
                                const u = i.beforeSend(a, t, n, o),
                                    d = Object.assign({}, n, u);
                                Object.keys(d).forEach((function(t) {
                                    null !== d[t] && ("Accept" === t && -1 !== e.indexOf("accept=") || a.setRequestHeader(t, d[t]))
                                })), o.deferred = {
                                    resolve: l,
                                    reject: c
                                }, o.url = e, o.imageId = t, a.onloadstart = function(n) {
                                    i.onloadstart && i.onloadstart(n, o);
                                    const a = {
                                        url: e,
                                        imageId: t
                                    };
                                    (0, r.triggerEvent)(r.events, "cornerstoneimageloadstart", a)
                                }, a.onloadend = function(n) {
                                    i.onloadend && i.onloadend(n, o);
                                    const a = {
                                        url: e,
                                        imageId: t
                                    };
                                    (0, r.triggerEvent)(r.events, "cornerstoneimageloadend", a)
                                }, a.onreadystatechange = function(e) {
                                    i.onreadystatechange ? i.onreadystatechange(e, o) : 4 === a.readyState && (200 === a.status ? i.beforeProcessing(a).then(l).catch((() => {
                                        s(a), c(a)
                                    })) : (s(a), c(a)))
                                }, a.onprogress = function(n) {
                                    const a = n.loaded;
                                    let s, l;
                                    n.lengthComputable && (s = n.total, l = Math.round(a / s * 100)), i.onprogress && i.onprogress(n, o);
                                    const c = {
                                        url: e,
                                        imageId: t,
                                        loaded: a,
                                        total: s,
                                        percentComplete: l
                                    };
                                    (0, r.triggerEvent)(r.events, r.EVENTS.IMAGE_LOAD_PROGRESS, c)
                                }, a.onerror = function() {
                                    s(a), c(a)
                                }, a.onabort = function() {
                                    s(a), c(a)
                                }, a.send()
                            }));
                        return l.xhr = a, l
                    },
                    {
                        parseImageId: T
                    } = o.wadouri,
                    I = (e, t = {}) => {
                        const n = T(e),
                            o = x(n.url, e),
                            r = (new Date).getTime();
                        return {
                            promise: new Promise(((n, a) => {
                                o.then((o => {
                                    try {
                                        const i = (new Date).getTime();
                                        b(e, o, t).then((t => {
                                            const o = (new Date).getTime();
                                            t.sharedCacheKey = e, t.loadTimeInMS = i - r, t.totalTimeInMS = o - r, n(t)
                                        }), a)
                                    } catch (e) {
                                        a({
                                            error: e,
                                            buffer: o
                                        })
                                    }
                                }), a)
                            })),
                            cancelFn: () => {
                                o.xhr.abort()
                            }
                        }
                    },
                    E = e => {
                        e("IM", I)
                    },
                    {
                        parseImageId: S
                    } = o.wadouri,
                    A = (e, t = {}) => {
                        const n = S(e),
                            o = x(n.url, e),
                            r = (new Date).getTime();
                        return {
                            promise: new Promise(((n, i) => {
                                o.then((o => {
                                    try {
                                        const s = (0, a.arrayBufferToImage)(o),
                                            c = (new Date).getTime();
                                        s.then((o => {
                                            const a = l(o, e, t),
                                                i = (new Date).getTime();
                                            a.sharedCacheKey = e, a.loadTimeInMS = c - r, a.totalTimeInMS = i - r, n(a)
                                        }), i)
                                    } catch (e) {
                                        i({
                                            error: e,
                                            response: o
                                        })
                                    }
                                }), i)
                            })),
                            cancelFn: () => {
                                o.xhr.abort()
                            }
                        }
                    },
                    C = e => {
                        e("web", A)
                    };
                let M = "";
                const D = function(e, t, n = {}) {
                        let a = !0;
                        if (void 0 !== n.useRGBA && (a = n.useRGBA), n.preScale = {
                                enabled: !(!n.preScale || void 0 === n.preScale.enabled) && n.preScale.enabled
                            }, !t) return Promise.reject(new Error("The file does not contain image data."));
                        const i = document.createElement("canvas");
                        if (n.preScale.enabled) {
                            const t = c(r.metaData, e);
                            t && (n.preScale = Object.assign(Object.assign({}, n.preScale), {
                                scalingParameters: t
                            }))
                        }
                        const s = r.metaData.get("_grayImageModule", e);
                        return new Promise(((n, l) => {
                            const c = (0, o.getImageFrame)(e),
                                u = (0, o.isColorImage)(c.photometricInterpretation),
                                d = function(e, t, n) {
                                    const o = e.length / (t * n);
                                    switch (o) {
                                        case 1:
                                            return !1;
                                        case 3:
                                        case 4:
                                            return !0;
                                        default:
                                            return console.warn({
                                                message: "type is error",
                                                type: o,
                                                pixelDa: e,
                                                width: t,
                                                height: n
                                            }), !1
                                    }
                                }(t, s.columns, s.rows);
                            if (d || (c.pixelData = t, c.pixelDataLength = t.length), c.decodeTimeInMS = 0, u || d) throw "PNG is Not yet supported";
                            const h = r.metaData.get("imagePlaneModule", e) || {},
                                f = r.metaData.get("voiLutModule", e) || {},
                                m = r.metaData.get("modalityLutModule", e) || {},
                                g = r.metaData.get("sopCommonModule", e) || {},
                                p = (0, o.getMinMax)(c.pixelData);
                            c.smallestPixelValue = p.min, c.largestPixelValue = p.max;
                            const {
                                columns: v,
                                rows: y
                            } = c, b = {
                                imageId: e,
                                color: u || d,
                                columnPixelSpacing: h.columnPixelSpacing,
                                columns: c.columns,
                                height: c.rows,
                                preScale: c.preScale,
                                intercept: m.rescaleIntercept ? m.rescaleIntercept : 0,
                                slope: m.rescaleSlope ? m.rescaleSlope : 1,
                                invert: "MONOCHROME1" === c.photometricInterpretation,
                                minPixelValue: c.smallestPixelValue,
                                maxPixelValue: c.largestPixelValue,
                                rowPixelSpacing: h.rowPixelSpacing,
                                rows: c.rows,
                                sizeInBytes: c.pixelData.byteLength,
                                width: c.columns,
                                windowCenter: f.windowCenter ? f.windowCenter[0] : void 0,
                                windowWidth: f.windowWidth ? f.windowWidth[0] : void 0,
                                voiLUTFunction: f.voiLUTFunction ? f.voiLUTFunction : void 0,
                                decodeTimeInMS: c.decodeTimeInMS,
                                floatPixelData: void 0,
                                imageFrame: c,
                                rgba: (u || d) && a,
                                getPixelData: () => c.pixelData,
                                getCanvas: void 0,
                                numComps: void 0
                            };
                            var w;
                            if (b.color && (b.getCanvas = function() {
                                    if (M === e) return i;
                                    i.height = b.rows, i.width = b.columns;
                                    return i.getContext("2d", {
                                        willReadFrequently: !0
                                    }).putImageData(c.imageData, 0, 0), M = e, i
                                }), m.modalityLUTSequence && m.modalityLUTSequence.length > 0 && ("1.2.840.10008.5.1.4.1.1.12.1" !== (w = g.sopClassUID) && "1.2.840.10008.5.1.4.1.1.12.2.1" !== w) && (b.modalityLUT = m.modalityLUTSequence[0]), f.voiLUTSequence && f.voiLUTSequence.length > 0 && (b.voiLUT = f.voiLUTSequence[0]), b.color && (b.windowWidth = 255, b.windowCenter = 127), void 0 === b.windowCenter || void 0 === b.windowWidth) {
                                const e = b.maxPixelValue * b.slope + b.intercept,
                                    t = b.minPixelValue * b.slope + b.intercept;
                                b.windowWidth = e - t, b.windowCenter = (e + t) / 2
                            }
                            n(b)
                        }))
                    },
                    {
                        parseImageId: P
                    } = o.wadouri,
                    k = (e, t = {}) => {
                        const n = P(e),
                            o = x(n.url, e),
                            r = (new Date).getTime();
                        return {
                            promise: new Promise(((n, a) => {
                                o.then((o => {
                                    try {
                                        const i = (new Date).getTime();
                                        D(e, o, t).then((t => {
                                            const o = (new Date).getTime();
                                            t.sharedCacheKey = e, t.loadTimeInMS = i - r, t.totalTimeInMS = o - r, n(t)
                                        }), a)
                                    } catch (e) {
                                        a({
                                            error: e,
                                            pixelDa: o
                                        })
                                    }
                                }), a)
                            })),
                            cancelFn: () => {
                                o.xhr.abort()
                            }
                        }
                    },
                    _ = e => {
                        e("pixelData", k)
                    }
            },
            6613: (e, t, n) => {
                "use strict";
                n.d(t, {
                    A: () => r
                });
                var o = n(226);

                function r(e, t) {
                    const n = e.includes("isMprDcm=1") ? o.$[2] : o.$[t + 1],
                        r = e.replace(/((http|https):\/\/[^/]*)|(wadouri:|IM:)|([&?](sign|Signature|Token|Authorization|AccessKeySecret|X-Subject-Token|X-Date|Date|Expires|t|X-Expires-At|isDcm|dicomInfo|isMprDcm|x-oss-process|imageMogr2\/format\/jpeg)[^&^?]*)/gi, "");
                    return {
                        imageTypeEN: n,
                        indexedDBKeyPeel: r,
                        indexedDBKey: -1 !== e.lastIndexOf("isPixelData") ? r : `${n}:${r}`
                    }
                }
            },
            6733: (e, t, n) => {
                "use strict";
                var o;
                n.d(t, {
                        A: () => r
                    }),
                    function(e) {
                        e.CALIBRATION = "calibrationModule", e.CINE = "cineModule", e.GENERAL_IMAGE = "generalImageModule", e.GENERAL_SERIES = "generalSeriesModule", e.GENERAL_STUDY = "generalStudyModule", e.IMAGE_PIXEL = "imagePixelModule", e.IMAGE_PLANE = "imagePlaneModule", e.IMAGE_URL = "imageUrlModule", e.MODALITY_LUT = "modalityLutModule", e.MULTIFRAME = "multiframeModule", e.NM_MULTIFRAME_GEOMETRY = "nmMultiframeGeometryModule", e.OVERLAY_PLANE = "overlayPlaneModule", e.PATIENT = "patientModule", e.PATIENT_STUDY = "patientStudyModule", e.PET_IMAGE = "petImageModule", e.PET_ISOTOPE = "petIsotopeModule", e.PET_SERIES = "petSeriesModule", e.SOP_COMMON = "sopCommonModule", e.ULTRASOUND_ENHANCED_REGION = "ultrasoundEnhancedRegionModule", e.VOI_LUT = "voiLutModule", e.WADO_WEB_CLIENT = "wadoWebClient"
                    }(o || (o = {}));
                const r = o
            },
            6743: (e, t, n) => {
                "use strict";
                var o = n(9353);
                e.exports = Function.prototype.bind || o
            },
            7119: e => {
                "use strict";
                e.exports = "undefined" != typeof Reflect && Reflect && Reflect.apply
            },
            7176: (e, t, n) => {
                "use strict";
                var o, r = n(3126),
                    a = n(5795);
                try {
                    o = [].__proto__ === Array.prototype
                } catch (e) {
                    if (!e || "object" != typeof e || !("code" in e) || "ERR_PROTO_ACCESS" !== e.code) throw e
                }
                var i = !!o && a && a(Object.prototype, "__proto__"),
                    s = Object,
                    l = s.getPrototypeOf;
                e.exports = i && "function" == typeof i.get ? r([i.get]) : "function" == typeof l && function(e) {
                    return l(null == e ? e : s(e))
                }
            },
            7185: (e, t, n) => {
                "use strict";
                n.d(t, {
                    lk: () => ae,
                    up: () => Q,
                    D0: () => ue,
                    LH: () => se,
                    G_: () => fe,
                    Ts: () => J,
                    Dh: () => le,
                    a: () => me,
                    IB: () => ce,
                    Xn: () => ie,
                    xN: () => de,
                    zw: () => ee,
                    qc: () => $
                });
                var o = n(467),
                    r = n(4467),
                    a = n(4756),
                    i = n.n(a),
                    s = n(4621),
                    l = n(2035),
                    c = n(5458),
                    u = n(3029),
                    d = n(2901);
                /**
                 * @license
                 * Copyright 2019 Google LLC
                 * SPDX-License-Identifier: Apache-2.0
                 */
                const h = Symbol("Comlink.proxy"),
                    f = Symbol("Comlink.endpoint"),
                    m = Symbol("Comlink.releaseProxy"),
                    g = Symbol("Comlink.finalizer"),
                    p = Symbol("Comlink.thrown"),
                    v = e => "object" == typeof e && null !== e || "function" == typeof e,
                    y = new Map([
                        ["proxy", {
                            canHandle: e => v(e) && e[h],
                            serialize(e) {
                                const {
                                    port1: t,
                                    port2: n
                                } = new MessageChannel;
                                return b(e, t), [n, [n]]
                            },
                            deserialize: e => (e.start(), x(e))
                        }],
                        ["throw", {
                            canHandle: e => v(e) && p in e,
                            serialize({
                                value: e
                            }) {
                                let t;
                                return t = e instanceof Error ? {
                                    isError: !0,
                                    value: {
                                        message: e.message,
                                        name: e.name,
                                        stack: e.stack
                                    }
                                } : {
                                    isError: !1,
                                    value: e
                                }, [t, []]
                            },
                            deserialize(e) {
                                if (e.isError) throw Object.assign(new Error(e.value.message), e.value);
                                throw e.value
                            }
                        }]
                    ]);

                function b(e, t = globalThis, n = ["*"]) {
                    t.addEventListener("message", (function o(r) {
                        if (!r || !r.data) return;
                        if (! function(e, t) {
                                for (const n of e) {
                                    if (t === n || "*" === n) return !0;
                                    if (n instanceof RegExp && n.test(t)) return !0
                                }
                                return !1
                            }(n, r.origin)) return void console.warn(`Invalid origin '${r.origin}' for comlink proxy`);
                        const {
                            id: a,
                            type: i,
                            path: s
                        } = Object.assign({
                            path: []
                        }, r.data), l = (r.data.argumentList || []).map(k);
                        let c;
                        try {
                            const t = s.slice(0, -1).reduce(((e, t) => e[t]), e),
                                n = s.reduce(((e, t) => e[t]), e);
                            switch (i) {
                                case "GET":
                                    c = n;
                                    break;
                                case "SET":
                                    t[s.slice(-1)[0]] = k(r.data.value), c = !0;
                                    break;
                                case "APPLY":
                                    c = n.apply(t, l);
                                    break;
                                case "CONSTRUCT":
                                    c = D(new n(...l));
                                    break;
                                case "ENDPOINT":
                                    {
                                        const {
                                            port1: t,
                                            port2: n
                                        } = new MessageChannel;b(e, n),
                                        c = function(e, t) {
                                            return M.set(e, t), e
                                        }(t, [t])
                                    }
                                    break;
                                case "RELEASE":
                                    c = void 0;
                                    break;
                                default:
                                    return
                            }
                        } catch (e) {
                            c = {
                                value: e,
                                [p]: 0
                            }
                        }
                        Promise.resolve(c).catch((e => ({
                            value: e,
                            [p]: 0
                        }))).then((n => {
                            const [r, s] = P(n);
                            t.postMessage(Object.assign(Object.assign({}, r), {
                                id: a
                            }), s), "RELEASE" === i && (t.removeEventListener("message", o), w(t), g in e && "function" == typeof e[g] && e[g]())
                        })).catch((e => {
                            const [n, o] = P({
                                value: new TypeError("Unserializable return value"),
                                [p]: 0
                            });
                            t.postMessage(Object.assign(Object.assign({}, n), {
                                id: a
                            }), o)
                        }))
                    })), t.start && t.start()
                }

                function w(e) {
                    (function(e) {
                        return "MessagePort" === e.constructor.name
                    })(e) && e.close()
                }

                function x(e, t) {
                    const n = new Map;
                    return e.addEventListener("message", (function(e) {
                        const {
                            data: t
                        } = e;
                        if (!t || !t.id) return;
                        const o = n.get(t.id);
                        if (o) try {
                            o(t)
                        } finally {
                            n.delete(t.id)
                        }
                    })), A(e, n, [], t)
                }

                function T(e) {
                    if (e) throw new Error("Proxy has been released and is not useable")
                }

                function I(e) {
                    return _(e, new Map, {
                        type: "RELEASE"
                    }).then((() => {
                        w(e)
                    }))
                }
                const E = new WeakMap,
                    S = "FinalizationRegistry" in globalThis && new FinalizationRegistry((e => {
                        const t = (E.get(e) || 0) - 1;
                        E.set(e, t), 0 === t && I(e)
                    }));

                function A(e, t, n = [], o = function() {}) {
                    let r = !1;
                    const a = new Proxy(o, {
                        get(o, i) {
                            if (T(r), i === m) return () => {
                                ! function(e) {
                                    S && S.unregister(e)
                                }(a), I(e), t.clear(), r = !0
                            };
                            if ("then" === i) {
                                if (0 === n.length) return {
                                    then: () => a
                                };
                                const o = _(e, t, {
                                    type: "GET",
                                    path: n.map((e => e.toString()))
                                }).then(k);
                                return o.then.bind(o)
                            }
                            return A(e, t, [...n, i])
                        },
                        set(o, a, i) {
                            T(r);
                            const [s, l] = P(i);
                            return _(e, t, {
                                type: "SET",
                                path: [...n, a].map((e => e.toString())),
                                value: s
                            }, l).then(k)
                        },
                        apply(o, a, i) {
                            T(r);
                            const s = n[n.length - 1];
                            if (s === f) return _(e, t, {
                                type: "ENDPOINT"
                            }).then(k);
                            if ("bind" === s) return A(e, t, n.slice(0, -1));
                            const [l, c] = C(i);
                            return _(e, t, {
                                type: "APPLY",
                                path: n.map((e => e.toString())),
                                argumentList: l
                            }, c).then(k)
                        },
                        construct(o, a) {
                            T(r);
                            const [i, s] = C(a);
                            return _(e, t, {
                                type: "CONSTRUCT",
                                path: n.map((e => e.toString())),
                                argumentList: i
                            }, s).then(k)
                        }
                    });
                    return function(e, t) {
                        const n = (E.get(t) || 0) + 1;
                        E.set(t, n), S && S.register(e, t, e)
                    }(a, e), a
                }

                function C(e) {
                    const t = e.map(P);
                    return [t.map((e => e[0])), (n = t.map((e => e[1])), Array.prototype.concat.apply([], n))];
                    var n
                }
                const M = new WeakMap;

                function D(e) {
                    return Object.assign(e, {
                        [h]: !0
                    })
                }

                function P(e) {
                    for (const [t, n] of y)
                        if (n.canHandle(e)) {
                            const [o, r] = n.serialize(e);
                            return [{
                                type: "HANDLER",
                                name: t,
                                value: o
                            }, r]
                        }
                    return [{
                        type: "RAW",
                        value: e
                    }, M.get(e) || []]
                }

                function k(e) {
                    switch (e.type) {
                        case "HANDLER":
                            return y.get(e.name).deserialize(e.value);
                        case "RAW":
                            return e.value
                    }
                }

                function _(e, t, n, o) {
                    return new Promise((r => {
                        const a = new Array(4).fill(0).map((() => Math.floor(Math.random() * Number.MAX_SAFE_INTEGER).toString(16))).join("-");
                        t.set(a, r), e.start && e.start(), e.postMessage(Object.assign({
                            id: a
                        }, n), o)
                    }))
                }
                var L = n(9770),
                    O = n(6082);
                const R = function() {
                    return (0, d.A)((function e() {
                        (0, u.A)(this, e), this.workerRegistry = {}, this.workerPoolManager = new O.R("webworker")
                    }), [{
                        key: "registerWorker",
                        value: function(e, t) {
                            var n, o = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                                r = o.maxWorkerInstances,
                                a = void 0 === r ? 1 : r,
                                i = o.overwrite,
                                s = void 0 !== i && i,
                                l = o.autoTerminateOnIdle,
                                c = void 0 === l ? {
                                    enabled: !1,
                                    idleTimeThreshold: 3e3
                                } : l;
                            if (!this.workerRegistry[e] || s) {
                                s && null !== (n = this.workerRegistry[e]) && void 0 !== n && n.idleCheckIntervalId && clearInterval(this.workerRegistry[e].idleCheckIntervalId);
                                var u = {
                                    workerFn: null,
                                    instances: [],
                                    loadCounters: [],
                                    lastActiveTime: [],
                                    nativeWorkers: [],
                                    autoTerminateOnIdle: c.enabled,
                                    idleCheckIntervalId: null,
                                    idleTimeThreshold: c.idleTimeThreshold
                                };
                                u.loadCounters = Array(a).fill(0), u.lastActiveTime = Array(a).fill(null);
                                for (var d = 0; d < a; d++) {
                                    var h = t();
                                    u.instances.push(x(h)), u.nativeWorkers.push(h), u.workerFn = t
                                }
                                this.workerRegistry[e] = u
                            } else console.warn("Worker type '".concat(e, "' is already registered..."))
                        }
                    }, {
                        key: "getNextWorkerAPI",
                        value: function(e) {
                            var t = this.workerRegistry[e];
                            if (!t) return console.error("Worker type '".concat(e, "' is not registered.")), null;
                            for (var n = t.instances.filter((function(e) {
                                    return null !== e
                                })), o = 0, r = t.loadCounters[0] || 0, a = 1; a < n.length; a++) {
                                var i = t.loadCounters[a] || 0;
                                i < r && (o = a, r = i)
                            }
                            if (null === t.instances[o]) {
                                var s = t.workerFn();
                                t.instances[o] = x(s), t.nativeWorkers[o] = s
                            }
                            return t.loadCounters[o] += 1, {
                                api: t.instances[o],
                                index: o
                            }
                        }
                    }, {
                        key: "executeTask",
                        value: function(e, t) {
                            var n = this,
                                r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
                                a = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : {},
                                s = a.requestType,
                                l = void 0 === s ? L.A.Compute : s,
                                u = a.priority,
                                d = void 0 === u ? 0 : u,
                                h = a.options,
                                f = void 0 === h ? {} : h,
                                m = a.callbacks,
                                g = void 0 === m ? [] : m;
                            return new Promise((function(a, s) {
                                var u = function() {
                                    var l = (0, o.A)(i().mark((function o() {
                                        var l, u, d, h, f, m, p;
                                        return i().wrap((function(o) {
                                            for (;;) switch (o.prev = o.next) {
                                                case 0:
                                                    if (l = n.getNextWorkerAPI(e), u = l.api, d = l.index, u) {
                                                        o.next = 6;
                                                        break
                                                    }
                                                    return h = new Error("No available worker instance for '".concat(e, "'")), console.error(h), s(h), o.abrupt("return");
                                                case 6:
                                                    return o.prev = 6, f = [], g.length && (f = g.map((function(e) {
                                                        return D(e)
                                                    }))), (m = n.workerRegistry[e]).processing = !0, o.next = 13, u[t].apply(u, [r].concat((0, c.A)(f)));
                                                case 13:
                                                    p = o.sent, m.processing = !1, m.lastActiveTime[d] = Date.now(), m.autoTerminateOnIdle && !m.idleCheckIntervalId && m.idleTimeThreshold && (m.idleCheckIntervalId = setInterval((function() {
                                                        n.terminateIdleWorkers(e, m.idleTimeThreshold)
                                                    }), m.idleTimeThreshold)), a(p), o.next = 24;
                                                    break;
                                                case 20:
                                                    o.prev = 20, o.t0 = o.catch(6), console.error("Error executing method '".concat(t, "' on worker '").concat(e, "':"), o.t0), s(o.t0);
                                                case 24:
                                                    return o.prev = 24, n.workerRegistry[e].loadCounters[d]--, o.finish(24);
                                                case 27:
                                                case "end":
                                                    return o.stop()
                                            }
                                        }), o, null, [
                                            [6, 20, 24, 27]
                                        ])
                                    })));
                                    return function() {
                                        return l.apply(this, arguments)
                                    }
                                }();
                                n.workerPoolManager.addRequest(u, l, f, d)
                            }))
                        }
                    }, {
                        key: "terminateIdleWorkers",
                        value: function(e, t) {
                            var n = this,
                                o = this.workerRegistry[e];
                            if (!o.processing) {
                                var r = Date.now();
                                o.instances.forEach((function(a, i) {
                                    var s = o.lastActiveTime[i];
                                    !(null !== s && o.loadCounters[i] > 0) && r - s > t && n.terminateWorkerInstance(e, i)
                                }))
                            }
                        }
                    }, {
                        key: "terminate",
                        value: function(e) {
                            var t = this,
                                n = this.workerRegistry[e];
                            n ? n.instances.forEach((function(n, o) {
                                t.terminateWorkerInstance(e, o)
                            })) : console.error("Worker type '".concat(e, "' is not registered."))
                        }
                    }, {
                        key: "terminateWorkerInstance",
                        value: function(e, t) {
                            var n = this.workerRegistry[e],
                                o = n.instances[t];
                            null !== o && (o[m](), n.nativeWorkers[t].terminate(), n.instances[t] = null, n.lastActiveTime[t] = null)
                        }
                    }])
                }();
                var N = n(296),
                    U = 4,
                    B = 5,
                    V = 1,
                    F = [1, 1];

                function H(e) {
                    var t = e.ext,
                        n = e.filterType,
                        o = e.texData,
                        r = e.internalFormat,
                        a = e.glDataType;
                    try {
                        var i = document.createElement("canvas");
                        i.width = U, i.height = U;
                        var s = i.getContext("webgl2");
                        if (!s) return !1;
                        var l, c = "#version 300 es\n    void main() {\n      gl_PointSize = ".concat(U.toFixed(1), ";\n      gl_Position = vec4(0, 0, 0, 1);\n    }\n  ");
                        if (t && !(l = s.getExtension(t))) return !1;
                        var u = s.createShader(s.VERTEX_SHADER);
                        if (s.shaderSource(u, c), s.compileShader(u), !s.getShaderParameter(u, s.COMPILE_STATUS)) return !1;
                        var d = s.createShader(s.FRAGMENT_SHADER);
                        if (s.shaderSource(d, "#version 300 es\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n\n    uniform sampler2D u_image;\n\n    out vec4 color;\n\n    void main() {\n        vec4 intColor = texture(u_image, gl_PointCoord.xy);\n        color = vec4(vec3(intColor.rrr), 1);\n    }\n    "), s.compileShader(d), !s.getShaderParameter(d, s.COMPILE_STATUS)) return !1;
                        var h = s.createProgram();
                        if (s.attachShader(h, u), s.attachShader(h, d), s.linkProgram(h), !s.getProgramParameter(h, s.LINK_STATUS)) return !1;
                        var f = s.createTexture();
                        s.bindTexture(s.TEXTURE_2D, f), s.texImage2D(s.TEXTURE_2D, 0, r(s, l), B, V, 0, s.RED, a(s, l), o);
                        var m = "LINEAR" === n ? s.LINEAR : s.NEAREST;
                        s.texParameteri(s.TEXTURE_2D, s.TEXTURE_MAG_FILTER, m), s.texParameteri(s.TEXTURE_2D, s.TEXTURE_MIN_FILTER, m), s.useProgram(h), s.drawArrays(s.POINTS, 0, 1);
                        var g = new Uint8Array(4);
                        s.readPixels(F[0], F[1], 1, 1, s.RGBA, s.UNSIGNED_BYTE, g);
                        var p = (0, N.A)(g, 3),
                            v = p[0],
                            y = p[1],
                            b = p[2],
                            w = s.getExtension("WEBGL_lose_context");
                        return w && w.loseContext(), v === y && y === b && 0 !== v
                    } catch (e) {
                        return !1
                    }
                }

                function q(e, t) {
                    var n = Object.keys(e);
                    if (Object.getOwnPropertySymbols) {
                        var o = Object.getOwnPropertySymbols(e);
                        t && (o = o.filter((function(t) {
                            return Object.getOwnPropertyDescriptor(e, t).enumerable
                        }))), n.push.apply(n, o)
                    }
                    return n
                }

                function j(e) {
                    for (var t = 1; t < arguments.length; t++) {
                        var n = null != arguments[t] ? arguments[t] : {};
                        t % 2 ? q(Object(n), !0).forEach((function(t) {
                            (0, r.A)(e, t, n[t])
                        })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : q(Object(n)).forEach((function(t) {
                            Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t))
                        }))
                    }
                    return e
                }
                var z = !1,
                    W = {
                        gpuTier: {
                            tier: 2
                        },
                        isMobile: !1,
                        rendering: {
                            useCPURendering: !1,
                            preferSizeOverAccuracy: !1,
                            strictZSpacingForVolumeViewport: !0
                        },
                        peerImport: function(e) {
                            return null
                        }
                    },
                    G = j(j({}, W), {}, {
                        rendering: j({}, W.rendering)
                    }),
                    Y = null,
                    Z = !1;

                function K() {
                    var e, t = (e = document.createElement("canvas")).getContext("webgl2") || e.getContext("webgl") || e.getContext("experimental-webgl");
                    return t instanceof WebGLRenderingContext || t instanceof WebGL2RenderingContext
                }

                function X() {
                    var e, t = {
                        norm16: H({
                            ext: "EXT_texture_norm16",
                            filterType: "NEAREST",
                            texData: e = new Int16Array([32767, 2e3, 3e3, 4e3, 5e3, 16784, 7e3, 8e3, 9e3, 32767]),
                            internalFormat: function(e, t) {
                                return t.R16_SNORM_EXT
                            },
                            glDataType: function(e) {
                                return e.SHORT
                            }
                        }),
                        norm16Linear: H({
                            ext: "EXT_texture_norm16",
                            filterType: "LINEAR",
                            texData: e,
                            internalFormat: function(e, t) {
                                return t.R16_SNORM_EXT
                            },
                            glDataType: function(e) {
                                return e.SHORT
                            }
                        })
                    };
                    return t.norm16 && t.norm16Linear
                }

                function J() {
                    var e, t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : G;
                    if (z) return z;
                    (Z = X(), G = (0, l.A)(W, t), /iPad|iPhone|iPod/.test(navigator.platform) || navigator.maxTouchPoints && navigator.maxTouchPoints > 2 && navigator.platform.includes("MacIntel")) && (null !== (e = t.rendering) && void 0 !== e && e.preferSizeOverAccuracy ? G.rendering.preferSizeOverAccuracy = !0 : console.log("norm16 texture not supported, you can turn on the preferSizeOverAccuracy flag to use native data type, but be aware of the inaccuracy of the rendering in high bits"));
                    return K() ? console.log("CornerstoneRender: using GPU rendering") : (console.log("CornerstoneRender: GPU not detected, using CPU rendering"), G.rendering.useCPURendering = !0), z = !0, Y || (Y = new R), z
                }

                function Q() {
                    return Z
                }

                function $(e) {
                    var t = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1];
                    G.rendering.useCPURendering = e, z = !0, t && he()
                }

                function ee(e) {
                    G.rendering.preferSizeOverAccuracy = e, z = !0, he()
                }
                var te, ne, oe, re = (te = "OES_texture_float_linear", ne = document.createElement("canvas"), !!(oe = ne.getContext("webgl2") || ne.getContext("webgl") || ne.getContext("experimental-webgl")) && null !== ("getExtension" in oe ? oe.getExtension(te) : null));

                function ae() {
                    return re
                }

                function ie() {
                    G.rendering.useCPURendering = !K(), he()
                }

                function se() {
                    return G.rendering.useCPURendering
                }

                function le() {
                    return z
                }

                function ce() {
                    z = !1
                }

                function ue() {
                    return G
                }

                function de(e) {
                    G = e, he()
                }

                function he() {
                    (0, s.qO)().forEach((function(e) {
                        e.getViewports().forEach((function(e) {
                            e.updateRenderingPipeline()
                        }))
                    }))
                }

                function fe() {
                    return Y || (Y = new R), Y
                }

                function me(e) {
                    return ge.apply(this, arguments)
                }

                function ge() {
                    return (ge = (0, o.A)(i().mark((function e(t) {
                        return i().wrap((function(e) {
                            for (;;) switch (e.prev = e.next) {
                                case 0:
                                    return e.abrupt("return", G.peerImport(t));
                                case 1:
                                case "end":
                                    return e.stop()
                            }
                        }), e)
                    })))).apply(this, arguments)
                }
            },
            7271: (e, t, n) => {
                "use strict";
                n.d(t, {
                    Ay: () => r,
                    Nx: () => o
                });
                const o = {
                    COMPOSITE_BLEND: 0,
                    MAXIMUM_INTENSITY_BLEND: 1,
                    MINIMUM_INTENSITY_BLEND: 2,
                    AVERAGE_INTENSITY_BLEND: 3,
                    ADDITIVE_INTENSITY_BLEND: 4,
                    RADON_TRANSFORM_BLEND: 5,
                    LABELMAP_EDGE_PROJECTION_BLEND: 6
                };
                var r = {
                    BlendMode: o,
                    FilterMode: {
                        OFF: 0,
                        NORMALIZED: 1,
                        RAW: 2
                    }
                }
            },
            7369: (e, t, n) => {
                "use strict";
                n.d(t, {
                    A: () => a
                });
                var o = n(736),
                    r = function(e, t, n, o) {
                        return new(n || (n = Promise))((function(r, a) {
                            function i(e) {
                                try {
                                    l(o.next(e))
                                } catch (e) {
                                    a(e)
                                }
                            }

                            function s(e) {
                                try {
                                    l(o.throw(e))
                                } catch (e) {
                                    a(e)
                                }
                            }

                            function l(e) {
                                var t;
                                e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                                    e(t)
                                }))).then(i, s)
                            }
                            l((o = o.apply(e, t || [])).next())
                        }))
                    };
                const a = function(e, t) {
                    return r(this, void 0, void 0, (function*() {
                        const n = yield(0, o.A)(t);
                        e.destroy();
                        for (const {
                                element: t
                            } of n) e.add(t);
                        return n
                    }))
                }
            },
            7426: (e, t, n) => {
                "use strict";
                var o;
                n.d(t, {
                        A: () => r
                    }),
                    function(e) {
                        e.ERROR_EVENT = "CORNERSTONE_ERROR", e.CACHE_SIZE_EXCEEDED = "CACHE_SIZE_EXCEEDED", e.IMAGE_LOAD_ERROR = "IMAGE_LOAD_ERROR", e.CAMERA_MODIFIED = "CORNERSTONE_CAMERA_MODIFIED", e.CAMERA_RESET = "CORNERSTONE_CAMERA_RESET", e.VOI_MODIFIED = "CORNERSTONE_VOI_MODIFIED", e.PRESET_MODIFIED = "CORNERSTONE_VIEWPORT_RENDERING_PRESET_MODIFIED", e.DISPLAY_AREA_MODIFIED = "CORNERSTONE_DISPLAY_AREA_MODIFIED", e.ELEMENT_DISABLED = "CORNERSTONE_ELEMENT_DISABLED", e.ELEMENT_ENABLED = "CORNERSTONE_ELEMENT_ENABLED", e.IMAGE_RENDERED = "CORNERSTONE_IMAGE_RENDERED", e.IMAGE_VOLUME_MODIFIED = "CORNERSTONE_IMAGE_VOLUME_MODIFIED", e.IMAGE_VOLUME_LOADING_COMPLETED = "CORNERSTONE_IMAGE_VOLUME_LOADING_COMPLETED", e.IMAGE_LOADED = "CORNERSTONE_IMAGE_LOADED", e.IMAGE_RETRIEVAL_STAGE = "CORNERSTONE_IMAGE_RETRIEVAL_STAGE", e.IMAGE_LOAD_FAILED = "CORNERSTONE_IMAGE_LOAD_FAILED", e.VOLUME_VIEWPORT_NEW_VOLUME = "CORNERSTONE_VOLUME_VIEWPORT_NEW_VOLUME", e.VOLUME_LOADED = "CORNERSTONE_VOLUME_LOADED", e.VOLUME_LOADED_FAILED = "CORNERSTONE_VOLUME_LOADED_FAILED", e.IMAGE_CACHE_IMAGE_ADDED = "CORNERSTONE_IMAGE_CACHE_IMAGE_ADDED", e.IMAGE_CACHE_IMAGE_REMOVED = "CORNERSTONE_IMAGE_CACHE_IMAGE_REMOVED", e.VOLUME_CACHE_VOLUME_ADDED = "CORNERSTONE_VOLUME_CACHE_VOLUME_ADDED", e.VOLUME_CACHE_VOLUME_REMOVED = "CORNERSTONE_VOLUME_CACHE_VOLUME_REMOVED", e.STACK_NEW_IMAGE = "CORNERSTONE_STACK_NEW_IMAGE", e.VOLUME_NEW_IMAGE = "CORNERSTONE_VOLUME_NEW_IMAGE", e.PRE_STACK_NEW_IMAGE = "CORNERSTONE_PRE_STACK_NEW_IMAGE", e.IMAGE_SPACING_CALIBRATED = "CORNERSTONE_IMAGE_SPACING_CALIBRATED", e.VIEWPORT_NEW_IMAGE_SET = "CORNERSTONE_VIEWPORT_NEW_IMAGE_SET", e.STACK_VIEWPORT_SCROLL = "CORNERSTONE_STACK_VIEWPORT_SCROLL", e.STACK_SCROLL_OUT_OF_BOUNDS = "STACK_SCROLL_OUT_OF_BOUNDS", e.GEOMETRY_CACHE_GEOMETRY_ADDED = "CORNERSTONE_GEOMETRY_CACHE_GEOMETRY_ADDED", e.GEOMETRY_CACHE_GEOMETRY_REMOVED = "CORNERSTONE_GEOMETRY_CACHE_GEOMETRY_REMOVED", e.VOLUME_VIEWPORT_SCROLL_OUT_OF_BOUNDS = "VOLUME_VIEWPORT_SCROLL_OUT_OF_BOUNDS", e.VOLUME_VIEWPORT_SCROLL = "VOLUME_VIEWPORT_SCROLL", e.CLIPPING_PLANES_UPDATED = "CORNERSTONE_CLIPPING_PLANES_UPDATED", e.WEB_WORKER_PROGRESS = "CORNERSTONE_WEB_WORKER_PROGRESS", e.COLORMAP_MODIFIED = "CORNERSTONE_COLORMAP_MODIFIED", e.DYNAMIC_VOLUME_DIMENSION_GROUP_CHANGED = "DYNAMIC_VOLUME_DIMENSION_GROUP_CHANGED", e.DYNAMIC_VOLUME_TIME_POINT_INDEX_CHANGED = "DYNAMIC_VOLUME_TIME_POINT_INDEX_CHANGED", e.DYNAMIC_VOLUME_DIMENSION_GROUP_LOADED = "DYNAMIC_VOLUME_DIMENSION_GROUP_LOADED", e.DYNAMIC_VOLUME_TIME_POINT_LOADED = "DYNAMIC_VOLUME_TIME_POINT_LOADED", e.GEOMETRY_LOADED = "GEOMETRY_LOADED", e.GEOMETRY_LOADED_FAILED = "GEOMETRY_LOADED_FAILED"
                    }(o || (o = {}));
                const r = o
            },
            7471: (e, t, n) => {
                "use strict";
                n.d(t, {
                    zV: () => f,
                    dZ: () => m,
                    jt: () => h
                });
                var o = n(9584),
                    r = n(1948);
                const {
                    dataSetCacheManager: a
                } = r.wadouri;
                const i = function(e) {
                    return a.get(e)
                };
                var s = n(6260);
                const l = function(e, t, n, o) {
                        var r;
                        let a = !1;
                        if (!t) return console.error("imageId is required for metaDataProvider," + e);
                        0 === e.indexOf("_") && (t = t.replace("wadouri:", "")), t.includes("web:") && (t = t.replace("web:", ""), a = !0), t.includes("cacheDB:") && (t = t.replace(/(cacheDB:)|(wadouri:)/g, "")), "cornerstone3D" === o && t.includes("wadouri:") && (t = t.replace("wadouri:", "")), t.includes("frame") && (t = t.replace(/[?&]frame=[^?&]*/, ""));
                        const l = n.get(t) || n.get("IM:" + t) || n.get("wadouri:" + t);
                        if (l) {
                            if ("_allModule" === e) return l;
                            if ("_originModule" === e) return l.origin;
                            if ("_resetModule" === e) return () => {
                                const {
                                    origin: e
                                } = l;
                                e && n.set(e.key, (0, s.A)(e))
                            };
                            if ("_referringPhysicianModule" === e) return l.referringPhysicianName || (null === (r = i(t)) || void 0 === r ? void 0 : r.string("x00080090"));
                            if ("_grayImageModule" === e) {
                                const {
                                    transferSyntaxUID: e,
                                    rows: t,
                                    columns: n,
                                    rescaleIntercept: o,
                                    rescaleSlope: r,
                                    bitsAllocated: i,
                                    photometricInterpretation: s,
                                    pixelRepresentation: c,
                                    windowCenter: u,
                                    windowWidth: d,
                                    blocks: h
                                } = l;
                                return Object.assign({
                                    windowWidth: d[0],
                                    windowCenter: u[0],
                                    rows: t,
                                    columns: n,
                                    rescaleSlope: r,
                                    rescaleIntercept: o,
                                    photometricInterpretation: s,
                                    bitsAllocated: i,
                                    pixelRepresentation: c,
                                    blocks: h,
                                    transferSyntaxUID: e
                                }, a && {
                                    windowWidth: [256],
                                    windowCenter: [128],
                                    photometricInterpretation: "RGB",
                                    bitsAllocated: 24,
                                    pixelRepresentation: 0,
                                    isWeb: a
                                })
                            }
                            if ("_imageOrientationTagModule" === e) {
                                const {
                                    imageBottomTag: e,
                                    imageleftTag: t,
                                    imagetightTag: n,
                                    imagetopTag: o
                                } = l;
                                return {
                                    imageBottomTag: e,
                                    imageleftTag: t,
                                    imagetightTag: n,
                                    imagetopTag: o
                                }
                            }
                            if ("_IDModule" === e) {
                                const {
                                    patientID: e,
                                    studyInstanceUID: t,
                                    seriesInstanceUID: n,
                                    sopInstanceUID: o,
                                    origin: {
                                        uid: r,
                                        uuid: a,
                                        queryParams: i,
                                        queryParams: {
                                            studyUID: s,
                                            seriesUID: c,
                                            hospID: u
                                        }
                                    } = {
                                        queryParams: {}
                                    }
                                } = l;
                                return {
                                    patientID: e,
                                    studyUID: s,
                                    studyInstanceUID: t,
                                    seriesUID: c,
                                    seriesInstanceUID: n,
                                    sopInstanceUID: o,
                                    hospID: u,
                                    imageUID: a || r,
                                    queryParams: i
                                }
                            }
                            if ("_baseModule" === e) {
                                const {
                                    modality: e,
                                    patientID: t,
                                    studyInstanceUID: n,
                                    seriesInstanceUID: o,
                                    seriesNumber: r,
                                    acquisitionDate: a,
                                    acquisitionTime: i,
                                    patientAge: s,
                                    sliceThickness: c,
                                    windowCenter: u,
                                    windowWidth: d
                                } = l || {}, {
                                    name: h,
                                    sex: f,
                                    queryParams: m,
                                    study: g
                                } = (null == l ? void 0 : l.origin) || {}, {
                                    orgname: p
                                } = g || {};
                                return {
                                    name: h,
                                    sex: f,
                                    modality: e,
                                    patientID: t,
                                    orgname: p,
                                    studyInstanceUID: n,
                                    seriesInstanceUID: o,
                                    seriesNumber: r,
                                    acquisitionDate: a,
                                    acquisitionTime: i,
                                    patientAge: s,
                                    sliceThickness: c,
                                    windowCenter: u,
                                    windowWidth: d,
                                    queryParams: m,
                                    study: g
                                }
                            }
                            if ("generalSeriesModule" === e) {
                                const {
                                    modality: e,
                                    seriesInstanceUID: t,
                                    seriesNumber: n,
                                    studyInstanceUID: o,
                                    seriesDate: r,
                                    seriesTime: a,
                                    acquisitionDate: i,
                                    acquisitionTime: s
                                } = l;
                                return {
                                    modality: e,
                                    seriesInstanceUID: t,
                                    seriesNumber: n,
                                    studyInstanceUID: o,
                                    seriesDate: r,
                                    seriesTime: a,
                                    acquisitionDate: i,
                                    acquisitionTime: s
                                }
                            }
                            if ("patientStudyModule" === e) {
                                const {
                                    patientAge: e
                                } = l;
                                return {
                                    patientAge: e
                                }
                            }
                            if ("imagePlaneModule" === e) {
                                const {
                                    frameOfReferenceUID: e,
                                    rows: t,
                                    columns: n,
                                    rowPixelSpacing: o,
                                    columnPixelSpacing: r,
                                    pixelSpacing: a,
                                    rowCosines: i,
                                    columnCosines: s,
                                    imageOrientationPatient: c,
                                    imagePositionPatient: u,
                                    sliceThickness: d,
                                    sliceLocation: h
                                } = l;
                                return {
                                    frameOfReferenceUID: e,
                                    rows: t,
                                    columns: n,
                                    imageOrientationPatient: c,
                                    rowCosines: i,
                                    columnCosines: s,
                                    imagePositionPatient: u,
                                    sliceThickness: d,
                                    sliceLocation: h,
                                    pixelSpacing: a,
                                    rowPixelSpacing: o,
                                    columnPixelSpacing: r
                                }
                            }
                            if ("imagePixelModule" === e) {
                                const {
                                    rows: e,
                                    columns: t,
                                    bitsAllocated: n,
                                    bitsStored: o,
                                    highBit: r,
                                    photometricInterpretation: i,
                                    pixelRepresentation: s,
                                    samplesPerPixel: c
                                } = l;
                                return Object.assign({
                                    samplesPerPixel: c,
                                    photometricInterpretation: i,
                                    rows: e,
                                    columns: t,
                                    bitsAllocated: n,
                                    bitsStored: o,
                                    highBit: r,
                                    pixelRepresentation: s
                                }, a && {
                                    pixelRepresentation: 0,
                                    bitsAllocated: 24,
                                    bitsStored: 24,
                                    highBit: 24,
                                    photometricInterpretation: "RGB",
                                    samplesPerPixel: 3
                                })
                            }
                            if ("voiLutModule" === e) {
                                if (a) return {
                                    windowWidth: [256],
                                    windowCenter: [128]
                                };
                                const {
                                    windowCenter: e,
                                    windowWidth: t
                                } = l;
                                return {
                                    windowCenter: e,
                                    windowWidth: t
                                }
                            }
                            if ("modalityLutModule" === e) {
                                const {
                                    rescaleIntercept: e,
                                    rescaleSlope: t
                                } = l;
                                return {
                                    rescaleIntercept: e,
                                    rescaleSlope: t
                                }
                            }
                            if ("sopCommonModule" === e) {
                                const {
                                    sopInstanceUID: e
                                } = l;
                                return {
                                    sopClassUID: void 0,
                                    sopInstanceUID: e
                                }
                            }
                            if ("transferSyntax" === e) {
                                const {
                                    transferSyntaxUID: e
                                } = l;
                                return {
                                    transferSyntaxUID: e
                                }
                            }
                            0
                        }
                    },
                    {
                        metaDataProvider: c
                    } = r.wadouri.metaData;
                const u = function(e, t) {
                        if ("imagePlaneModule" === e) {
                            const n = c(e, t);
                            return n ? Object.assign(Object.assign({}, n), {
                                frameOfReferenceUID: void 0
                            }) : void 0
                        }
                    },
                    d = new Map,
                    h = e => {
                        e.addProvider(((e, t) => l(e, t, d, "cornerstone3D")))
                    },
                    f = (e, t, n, o) => {
                        d.set(e, (0, s.A)(Object.assign(Object.assign({}, t), {
                            queryParams: n,
                            study: o,
                            key: e
                        })))
                    },
                    m = () => {
                        d.clear()
                    };
                o.metaData.addProvider(((e, t) => l(e, t, d)), -1), o.metaData, o.metaData.addProvider(((e, t) => u(e, t)), 999)
            },
            7510: (e, t, n) => {
                "use strict";
                n.d(t, {
                    p: () => po,
                    Y: () => vo
                });
                var o = n(730),
                    r = n.n(o),
                    a = n(9584),
                    i = n.n(a),
                    s = n(7869),
                    l = n.n(s),
                    c = n(281),
                    u = n(334);
                const d = (0, c.importInternal)("base/BaseAnnotationTool"),
                    h = (0, c.importInternal)("drawing/getNewContext"),
                    f = (0, c.importInternal)("drawing/draw"),
                    m = (0, c.importInternal)("drawing/drawRect"),
                    g = (0, c.importInternal)("drawing/drawLinkedTextBox"),
                    p = (0, c.importInternal)("util/getLogger"),
                    v = p ? p("tools:annotation:LengthTool") : console;
                const y = (0, c.importInternal)("drawing/path");

                function b(e, t, n, o, r, i = "pixel", s) {
                    "pixel" === i && (n = (0, a.pixelToCanvas)(t, n)), y(e, r, (e => {
                        e.arc(n.x, n.y, o, 0, 2 * Math.PI)
                    })), s && y(e, r, (e => {
                        e.font = `${o}px lighter`, e.fillStyle = "#ceff82";
                        const t = e.measureText(s).width >> 1;
                        e.fillText(s, n.x - t, n.y + t)
                    }))
                }
                const w = (0, c.importInternal)("base/BaseAnnotationTool"),
                    {
                        circleRoiCursor: x
                    } = (0, c.importInternal)("tools/cursors"),
                    T = (0, c.importInternal)("drawing/getNewContext"),
                    I = (0, c.importInternal)("drawing/draw"),
                    E = (0, c.importInternal)("drawing/setShadow"),
                    S = (0, c.importInternal)("util/throttle");
                class A extends w {
                    constructor(e = {}) {
                        const {
                            markerFlag: t = "L"
                        } = e;
                        super(e, {
                            name: "Ann" + t,
                            supportedInteractionTypes: ["Mouse", "Touch"],
                            svgCursor: x,
                            configuration: {
                                renderDashed: !1,
                                hideHandlesIfMoving: !0,
                                type: t
                            }
                        }), this.markerFlag = t, this.throttledUpdateCachedStats = S(this.updateCachedStats, 0)
                    }
                    createNewMeasurement(e) {
                        var t;
                        if (!(e && e.currentPoints && e.currentPoints.image)) return void console.error(`required eventData not supplied to tool ${this.name}'s createNewMeasurement`);
                        const n = (0, c.getToolState)(e.element, this.name);
                        return (null === (t = null == n ? void 0 : n.data) || void 0 === t ? void 0 : t.length) >= 1 ? void 0 : {
                            visible: !0,
                            active: !0,
                            color: void 0,
                            invalidated: !0,
                            handles: {
                                start: {
                                    x: e.currentPoints.image.x,
                                    y: e.currentPoints.image.y,
                                    highlight: !0,
                                    active: !1
                                },
                                end: {
                                    x: e.currentPoints.image.x,
                                    y: e.currentPoints.image.y,
                                    highlight: !0,
                                    active: !0
                                }
                            }
                        }
                    }
                    pointNearTool(e, t, n, o) {
                        const r = t && t.handles && t.handles.start && t.handles.end,
                            a = c.external.cornerstoneMath.point.distance;
                        if (r || console.warn(`invalid parameters supplied to tool ${this.name}'s pointNearTool`), !r || !1 === t.visible) return !1;
                        const i = "mouse" === o ? 15 : 25,
                            s = c.external.cornerstone.pixelToCanvas(e, t.handles.start),
                            l = c.external.cornerstone.pixelToCanvas(e, t.handles.end),
                            u = a(s, n),
                            d = a(s, l);
                        return u > d - i / 1.1 && u < d + i / 1.1
                    }
                    updateCachedStats(e, t, n) {
                        n.invalidated = !1
                    }
                    renderToolData(e) {
                        const t = (0, c.getToolState)(e.currentTarget, this.name);
                        if (!t) return;
                        const n = c.external.cornerstoneMath.point.distance,
                            o = e.detail,
                            {
                                image: r,
                                element: a,
                                canvasContext: i
                            } = o,
                            {
                                renderDashed: s
                            } = this.configuration,
                            l = T(i.canvas),
                            u = (0, c.getModule)("globalConfiguration").configuration.lineDash;
                        I(l, (e => {
                            for (let o = 0; o < t.data.length; o++) {
                                const i = t.data[o];
                                if (!1 === i.visible) continue;
                                const l = c.toolColors.getColorIfActive(i) || "#ff8000",
                                    d = c.external.cornerstone.pixelToCanvas(a, i.handles.start),
                                    h = c.external.cornerstone.pixelToCanvas(a, i.handles.end),
                                    f = n(d, h),
                                    m = {
                                        color: l,
                                        lineDash: void 0
                                    };
                                s && (m.lineDash = u), E(e, this.configuration), b(e, a, i.handles.start, f, m, "pixel", this.markerFlag), !0 === i.invalidated && (i.cachedStats ? this.throttledUpdateCachedStats(r, a, i) : this.updateCachedStats(r, a, i))
                            }
                        }))
                    }
                }
                const C = (0, c.importInternal)("base/BaseAnnotationTool"),
                    M = (0, c.importInternal)("drawing/getNewContext"),
                    D = (0, c.importInternal)("drawing/draw"),
                    P = (0, c.importInternal)("drawing/setShadow"),
                    k = (0, c.importInternal)("drawing/drawLine"),
                    _ = (0, c.importInternal)("drawing/drawLinkedTextBox"),
                    L = (0, c.importInternal)("drawing/drawHandles"),
                    O = (0, c.importInternal)("util/lineSegDistance"),
                    R = (0, c.importInternal)("util/getLogger"),
                    N = (0, c.importInternal)("util/throttle"),
                    U = (0, c.importInternal)("util/getPixelSpacing"),
                    B = R ? R("tools:annotation:LengthTool") : console,
                    {
                        bidirectionalCursor: V
                    } = (0, c.importInternal)("tools/cursors");
                var F = n(9897),
                    H = n(2117),
                    q = function(e, t, n, o) {
                        return new(n || (n = Promise))((function(r, a) {
                            function i(e) {
                                try {
                                    l(o.next(e))
                                } catch (e) {
                                    a(e)
                                }
                            }

                            function s(e) {
                                try {
                                    l(o.throw(e))
                                } catch (e) {
                                    a(e)
                                }
                            }

                            function l(e) {
                                var t;
                                e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                                    e(t)
                                }))).then(i, s)
                            }
                            l((o = o.apply(e, t || [])).next())
                        }))
                    };
                const j = (0, c.importInternal)("base/BaseAnnotationTool"),
                    z = (0, c.importInternal)("manipulators/moveNewHandle"),
                    W = (0, c.importInternal)("util/pointInsideBoundingBox"),
                    G = (0, c.importInternal)("util/lineSegDistance"),
                    Y = (0, c.importInternal)("util/triggerEvent"),
                    Z = (0, c.importInternal)("drawing/drawLinkedTextBox"),
                    K = (0, c.importInternal)("drawing/getNewContext"),
                    X = (0, c.importInternal)("drawing/draw"),
                    J = (0, c.importInternal)("drawing/setShadow"),
                    Q = (0, c.importInternal)("drawing/drawArrow"),
                    $ = (0, c.importInternal)("drawing/drawHandles"),
                    ee = (0, c.importInternal)("drawing/textBoxWidth"),
                    {
                        arrowAnnotateCursor: te
                    } = (0, c.importInternal)("tools/cursors");

                function ne(e) {
                    return q(this, void 0, void 0, (function*() {
                        e(yield(0, F.A)((0, H.Tl)("toast.prompt.enterComment")))
                    }))
                }

                function oe(e, t, n) {
                    return q(this, void 0, void 0, (function*() {
                        n(yield(0, F.A)((0, H.Tl)("toast.prompt.changeComment")))
                    }))
                }
                var re = function(e, t, n, o) {
                    return new(n || (n = Promise))((function(r, a) {
                        function i(e) {
                            try {
                                l(o.next(e))
                            } catch (e) {
                                a(e)
                            }
                        }

                        function s(e) {
                            try {
                                l(o.throw(e))
                            } catch (e) {
                                a(e)
                            }
                        }

                        function l(e) {
                            var t;
                            e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                                e(t)
                            }))).then(i, s)
                        }
                        l((o = o.apply(e, t || [])).next())
                    }))
                };
                const ae = (0, c.importInternal)("base/BaseAnnotationTool"),
                    ie = (0, c.importInternal)("manipulators/moveHandle"),
                    se = (0, c.importInternal)("util/pointInsideBoundingBox"),
                    le = (0, c.importInternal)("util/triggerEvent"),
                    ce = (0, c.importInternal)("util/getLogger"),
                    ue = (0, c.importInternal)("drawing/drawLinkedTextBox"),
                    de = (0, c.importInternal)("drawing/getNewContext"),
                    he = (0, c.importInternal)("drawing/draw"),
                    fe = (0, c.importInternal)("drawing/setShadow"),
                    me = (0, c.importInternal)("drawing/drawHandles"),
                    ge = (0, c.importInternal)("drawing/textBoxWidth"),
                    {
                        textMarkerCursor: pe
                    } = (0, c.importInternal)("tools/cursors"),
                    ve = ce("tools:annotation:ProbeTool");

                function ye(e) {
                    return re(this, void 0, void 0, (function*() {
                        e(yield(0, F.A)((0, H.Tl)("toast.prompt.enterText")))
                    }))
                }

                function be(e, t, n) {
                    return re(this, void 0, void 0, (function*() {
                        n(yield(0, F.A)((0, H.Tl)("toast.prompt.enterText")))
                    }))
                }
                const we = (0, c.importInternal)("base/BaseAnnotationTool"),
                    xe = (0, c.importInternal)("manipulators/moveNewHandle"),
                    Te = (0, c.importInternal)("drawing/getNewContext"),
                    Ie = (0, c.importInternal)("drawing/draw"),
                    Ee = (0, c.importInternal)("drawing/setShadow"),
                    Se = (0, c.importInternal)("drawing/drawJoinedLines"),
                    Ae = (0, c.importInternal)("drawing/drawLinkedTextBox"),
                    Ce = (0, c.importInternal)("drawing/drawHandles"),
                    Me = (0, c.importInternal)("util/triggerEvent"),
                    De = (0, c.importInternal)("util/lineSegDistance"),
                    Pe = (0, c.importInternal)("util/roundToDecimal"),
                    ke = (0, c.importInternal)("util/throttle"),
                    _e = (0, c.importInternal)("util/getPixelSpacing"),
                    Le = (0, c.importInternal)("drawing/textBoxWidth"),
                    {
                        angleCursor: Oe
                    } = (0, c.importInternal)("tools/cursors");

                function Re(e) {
                    return Math.sqrt(Math.pow(e.x, 2) + Math.pow(e.y, 2))
                }

                function Ne(e, t, n) {
                    const {
                        rowPixelSpacing: o,
                        colPixelSpacing: r
                    } = _e(e);
                    return {
                        x: (t.x - n.x) * (r || 1),
                        y: (t.y - n.y) * (o || 1)
                    }
                }
                var Ue = n(1948),
                    Be = n(8398);
                (0, c.importInternal)("base/BaseTool"), (0, c.importInternal)("util/debounce");
                const {
                    panCursor: Ve
                } = (0, c.importInternal)("tools/cursors");
                var Fe = n(346),
                    He = n.n(Fe),
                    qe = function(e, t, n, o) {
                        return new(n || (n = Promise))((function(r, a) {
                            function i(e) {
                                try {
                                    l(o.next(e))
                                } catch (e) {
                                    a(e)
                                }
                            }

                            function s(e) {
                                try {
                                    l(o.throw(e))
                                } catch (e) {
                                    a(e)
                                }
                            }

                            function l(e) {
                                var t;
                                e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                                    e(t)
                                }))).then(i, s)
                            }
                            l((o = o.apply(e, t || [])).next())
                        }))
                    };
                const je = (0, c.importInternal)("base/BaseTool"),
                    ze = (0, c.importInternal)("util/debounce");
                const We = (0, c.importInternal)("base/BaseAnnotationTool"),
                    Ge = (0, c.importInternal)("manipulators/moveNewHandle"),
                    Ye = (0, c.importInternal)("drawing/getNewContext"),
                    Ze = (0, c.importInternal)("drawing/draw"),
                    Ke = (0, c.importInternal)("drawing/setShadow"),
                    Xe = (0, c.importInternal)("drawing/drawLine"),
                    Je = (0, c.importInternal)("drawing/drawLinkedTextBox"),
                    Qe = (0, c.importInternal)("drawing/drawHandles"),
                    $e = (0, c.importInternal)("util/triggerEvent"),
                    et = (0, c.importInternal)("util/lineSegDistance"),
                    tt = (0, c.importInternal)("util/roundToDecimal"),
                    nt = (0, c.importInternal)("util/throttle"),
                    ot = (0, c.importInternal)("util/getPixelSpacing"),
                    {
                        cobbAngleCursor: rt
                    } = (0, c.importInternal)("tools/cursors");

                function at(e, t, n) {
                    let o, r, a, i;
                    const {
                        columnPixelSpacing: s = 1,
                        rowPixelSpacing: l = 1
                    } = e.image, c = {
                        x: (t.x + n.x) / 2,
                        y: (t.y + n.y) / 2
                    };
                    if (t.x === n.x && t.y === n.y) o = t.x, r = t.y, a = n.x, i = n.y;
                    else {
                        const e = function(e, t, n, o) {
                                const r = (n.x - o.x) * e,
                                    a = (n.y - o.y) * t,
                                    i = Math.sqrt(r * r + a * a);
                                return {
                                    x: r / i,
                                    y: a / i,
                                    length: i
                                }
                            }(s, l, t, n),
                            u = 10 * e.length,
                            d = u / (2 * l),
                            h = u / (2 * s);
                        o = c.x + h * e.y, r = c.y - d * e.x, a = c.x - h * e.y, i = c.y + d * e.x
                    }
                    return {
                        start: {
                            x: o,
                            y: r
                        },
                        mid: c,
                        end: {
                            x: a,
                            y: i
                        }
                    }
                }
                var it = n(6402),
                    st = n(9093),
                    lt = n(4594),
                    ct = n(9473);
                const ut = (0, c.importInternal)("base/BaseTool"),
                    dt = (0, c.importInternal)("drawing/getNewContext"),
                    ht = (0, c.importInternal)("drawing/draw"),
                    ft = (0, c.importInternal)("drawing/setShadow"),
                    mt = (0, c.importInternal)("drawing/drawTextBox"),
                    gt = (0, c.importInternal)("drawing/drawLine"),
                    pt = (0, c.importInternal)("util/imagePointToPatientPoint"),
                    vt = (0, c.importInternal)("util/projectPatientPointToImagePlane"),
                    yt = (0, c.importInternal)("util/convertToVector3"),
                    bt = (0, c.importInternal)("util/debounce"),
                    {
                        crosshairsCursor: wt
                    } = (0, c.importInternal)("tools/cursors"),
                    xt = {
                        _enabled: !1,
                        set enabled(e) {
                            this._enabled = e
                        },
                        get enabled() {
                            return this._enabled
                        },
                        state: {},
                        init(e) {
                            this.enabled = !0, this.state = e
                        }
                    };
                const Tt = (0, c.importInternal)("base/BaseAnnotationTool"),
                    It = (0, c.importInternal)("manipulators/getHandleNearImagePoint"),
                    Et = (0, c.importInternal)("drawing/getNewContext"),
                    St = (0, c.importInternal)("drawing/draw"),
                    At = (0, c.importInternal)("drawing/setShadow"),
                    Ct = (0, c.importInternal)("drawing/drawEllipse"),
                    Mt = (0, c.importInternal)("drawing/drawLinkedTextBox"),
                    Dt = (0, c.importInternal)("drawing/drawLine"),
                    Pt = (0, c.importInternal)("drawing/drawHandles"),
                    kt = (0, c.importInternal)("util/getROITextBoxCoords"),
                    _t = (0, c.importInternal)("util/numbersWithCommas"),
                    Lt = (0, c.importInternal)("util/calculateSUV"),
                    {
                        calculateEllipseStatistics: Ot,
                        pointInEllipse: Rt
                    } = (0, c.importInternal)("util/ellipseUtils"),
                    Nt = (0, c.importInternal)("util/getLogger"),
                    Ut = (0, c.importInternal)("util/throttle"),
                    Bt = (0, c.importInternal)("util/getPixelSpacing"),
                    Vt = Nt ? Nt("tools:annotation:LengthTool") : console,
                    {
                        ellipticalRoiCursor: Ft
                    } = (0, c.importInternal)("tools/cursors");

                function Ht(e, t) {
                    const {
                        top: n,
                        left: o,
                        bottom: r,
                        right: a
                    } = e, {
                        top: i,
                        left: s,
                        bottom: l,
                        right: c
                    } = t;
                    n.active ? (e.start.y += n.y - i.y, e.top.x = r.x, e.left.y = e.right.y = (e.start.y + e.end.y) / 2) : o.active ? (e.start.x += o.x - s.x, e.left.y = a.y, e.top.x = e.bottom.x = (e.start.x + e.end.x) / 2) : r.active ? (e.end.y += r.y - l.y, e.bottom.x = n.x, e.left.y = e.right.y = (e.start.y + e.end.y) / 2) : a.active && (e.end.x += a.x - c.x, e.right.y = o.y, e.top.x = e.bottom.x = (e.start.x + e.end.x) / 2)
                }

                function qt(e, t) {
                    const {
                        left: n,
                        top: o,
                        width: r,
                        height: a
                    } = Wt(e, t);
                    return [{
                        x: n + r / 2,
                        y: o
                    }, {
                        x: n,
                        y: o + a / 2
                    }, {
                        x: n + r / 2,
                        y: o + a
                    }, {
                        x: n + r,
                        y: o + a / 2
                    }]
                }

                function jt(e, t) {
                    return "CT" === e && !1 !== t ? "HU" : ""
                }

                function zt(e, t, {
                    area: n,
                    mean: o,
                    stdDev: r,
                    min: a,
                    max: i,
                    meanStdDevSUV: s
                } = {}, l, c, u = {}) {
                    const d = u.showMinMax || !1,
                        h = [],
                        f = [];
                    if (!t) {
                        const t = s && 0 !== s.mean,
                            n = jt(l, u.showHounsfieldUnits);
                        let c = `Mean: ${_t(o.toFixed(2))} ${n}`;
                        const h = `Std Dev: ${_t(r.toFixed(2))} ${n}`;
                        if (t) {
                            const t = " SUV: ",
                                n = `${t}${_t(s.mean.toFixed(2))}`,
                                o = `${t}${_t(s.stdDev.toFixed(2))}`,
                                r = Math.floor(e.measureText(`${h}     `).width);
                            for (; e.measureText(c).width < r;) c += " ";
                            f.push(`${c}${n}`), f.push(`${h}     ${o}`)
                        } else f.push(`${c}`), f.push(`${h}`);
                        if (d) {
                            let o = `Min: ${a} ${n}`;
                            const r = `Max: ${i} ${n}`,
                                s = t ? Math.floor(e.measureText(`${h}     `).width) : Math.floor(e.measureText(`${c}     `).width);
                            for (; e.measureText(o).width < s;) o += " ";
                            f.push(`${o}${r}`)
                        }
                    }
                    return h.push(function(e, t) {
                        const n = t ? ` mm${String.fromCharCode(178)}` : ` px${String.fromCharCode(178)}`;
                        return `Area: ${_t(e.toFixed(2))}${n}`
                    }(n, c)), f.forEach((e => h.push(e))), h
                }

                function Wt(e, t) {
                    return {
                        left: Math.round(Math.min(e.x, t.x)),
                        top: Math.round(Math.min(e.y, t.y)),
                        width: Math.round(Math.abs(e.x - t.x)),
                        height: Math.round(Math.abs(e.y - t.y))
                    }
                }
                const Gt = (0, c.importInternal)("base/BaseTool"),
                    Yt = (0, c.importInternal)("util/getPixelSpacing"),
                    Zt = (0, c.importInternal)("drawing/getNewContext"),
                    Kt = (0, c.importInternal)("drawing/draw"),
                    Xt = (0, c.importInternal)("drawing/setShadow"),
                    Jt = (0, c.importInternal)("drawing/drawLine"),
                    Qt = (0, c.importInternal)("drawing/drawTextBox"),
                    $t = (0, c.importInternal)("util/getLogger")("tools:ScaleOverlayTool");
                const en = (e, t, n) => {
                        let o = 0;
                        const {
                            color: r,
                            lineWidth: a
                        } = n;
                        for (; n.verticalLine.start.y + o * n.verticalMinorTick <= n.vscaleBounds.bottomRight.y;) {
                            const i = {
                                    x: n.verticalLine.start.x,
                                    y: n.verticalLine.start.y + o * n.verticalMinorTick
                                },
                                s = {
                                    x: 0,
                                    y: n.verticalLine.start.y + o * n.verticalMinorTick
                                };
                            s.x = o % 10 == 0 ? n.verticalLine.start.x - n.majorTickLength : o % 5 == 0 ? n.verticalLine.start.x - n.minorTickLength : n.verticalLine.start.x - n.minorTickLength / 2, Jt(e, t, i, s, {
                                color: r,
                                lineWidth: a
                            }, "canvas"), o++
                        }
                        const i = 10 * (o - 1) + "mm";
                        Qt(e, i, n.verticalLine.end.x - e.measureText(i).width - 10, n.verticalLine.end.y, c.toolColors.getToolColor())
                    },
                    tn = (e, t, n) => {
                        let o = 0;
                        const {
                            color: r,
                            lineWidth: a
                        } = n;
                        for (n.horizontalMinorTick !== n.verticalMinorTick && (n.horizontalMinorTick = n.verticalMinorTick); n.horizontalLine.start.x + o * n.horizontalMinorTick <= n.hscaleBounds.bottomRight.x;) {
                            const i = {
                                    x: n.horizontalLine.start.x + o * n.horizontalMinorTick,
                                    y: n.horizontalLine.start.y
                                },
                                s = {
                                    x: n.horizontalLine.start.x + o * n.horizontalMinorTick,
                                    y: 0
                                };
                            s.y = o % 10 == 0 ? n.horizontalLine.start.y - n.majorTickLength : o % 5 == 0 ? n.horizontalLine.start.y - n.minorTickLength : n.horizontalLine.start.y - n.minorTickLength / 2, Jt(e, t, i, s, {
                                color: r,
                                lineWidth: a
                            }, "canvas"), o++
                        }
                        Qt(e, 10 * (o - 1) + "mm", n.horizontalLine.end.x, n.horizontalLine.end.y - c.textStyle.getFontSize(), c.toolColors.getToolColor())
                    };
                (0, c.importInternal)("base/BaseTool"), (0, c.importInternal)("util/debounce");
                const {
                    panCursor: nn
                } = (0, c.importInternal)("tools/cursors");
                const on = (0, c.importInternal)("base/BaseAnnotationTool"),
                    rn = (0, c.importInternal)("drawing/getNewContext"),
                    an = (0, c.importInternal)("drawing/draw"),
                    sn = (0, c.importInternal)("drawing/setShadow"),
                    ln = (0, c.importInternal)("drawing/drawLinkedTextBox"),
                    cn = (0, c.importInternal)("drawing/drawLine"),
                    un = (0, c.importInternal)("drawing/drawHandles"),
                    dn = (0, c.importInternal)("util/getLogger"),
                    hn = (0, c.importInternal)("util/throttle"),
                    fn = (0, c.importInternal)("util/getPixelSpacing"),
                    mn = (0, c.importInternal)("util/lineSegDistance"),
                    gn = dn ? dn("tools:annotation:LengthTool") : console,
                    {
                        lengthCursor: pn
                    } = (0, c.importInternal)("tools/cursors");
                const {
                    state: vn,
                    modules: yn
                } = c.store, bn = yn.globalConfiguration;

                function wn(e, t) {
                    vn.svgCursorUrl && window.URL.revokeObjectURL(vn.svgCursorUrl), vn.svgCursorUrl = null, e.style.cursor = t
                }
                const xn = (0, c.importInternal)("base/BaseTool"),
                    Tn = (0, c.importInternal)("drawing/getNewContext"),
                    {
                        magnifyCursor: In
                    } = (0, c.importInternal)("tools/cursors");
                const En = (0, c.importInternal)("base/BaseAnnotationTool"),
                    Sn = (0, c.importInternal)("drawing/getNewContext"),
                    An = (0, c.importInternal)("drawing/draw"),
                    Cn = (0, c.importInternal)("drawing/setShadow"),
                    Mn = (0, c.importInternal)("drawing/drawRect"),
                    Dn = (0, c.importInternal)("drawing/drawLinkedTextBox"),
                    Pn = (0, c.importInternal)("drawing/drawHandles"),
                    kn = (0, c.importInternal)("util/getLogger"),
                    _n = (0, c.importInternal)("util/throttle"),
                    Ln = (0, c.importInternal)("util/getPixelSpacing"),
                    On = (0, c.importInternal)("util/calculateSUV"),
                    Rn = (0, c.importInternal)("util/getROITextBoxCoords"),
                    Nn = (0, c.importInternal)("util/numbersWithCommas"),
                    Un = kn ? kn("tools:annotation:LengthTool") : console,
                    {
                        rectangleRoiCursor: Bn
                    } = (0, c.importInternal)("tools/cursors");

                function Vn(e, t) {
                    return {
                        left: Math.min(e.x, t.x),
                        top: Math.min(e.y, t.y),
                        width: Math.abs(e.x - t.x),
                        height: Math.abs(e.y - t.y)
                    }
                }

                function Fn(e, t) {
                    const {
                        left: n,
                        top: o,
                        width: r,
                        height: a
                    } = Vn(e, t);
                    return [{
                        x: n + r / 2,
                        y: o
                    }, {
                        x: n,
                        y: o + a / 2
                    }, {
                        x: n + r / 2,
                        y: o + a
                    }, {
                        x: n + r,
                        y: o + a / 2
                    }]
                }

                function Hn(e, t) {
                    return "CT" === e && !1 !== t ? "HU" : ""
                }

                function qn(e, t, {
                    area: n,
                    mean: o,
                    stdDev: r,
                    min: a,
                    max: i,
                    meanStdDevSUV: s
                }, l, c, u = {}) {
                    const d = u.showMinMax || !1,
                        h = [],
                        f = [];
                    if (!t) {
                        const t = s && 0 !== s.mean,
                            n = Hn(l, u.showHounsfieldUnits);
                        let c = `Mean: ${Nn(o.toFixed(2))} ${n}`;
                        const h = `Std Dev: ${Nn(r.toFixed(2))} ${n}`;
                        if (t) {
                            const t = " SUV: ",
                                n = `${t}${Nn(s.mean.toFixed(2))}`,
                                o = `${t}${Nn(s.stdDev.toFixed(2))}`,
                                r = Math.floor(e.measureText(`${h}     `).width);
                            for (; e.measureText(c).width < r;) c += " ";
                            f.push(`${c}${n}`), f.push(`${h}     ${o}`)
                        } else f.push(`${c}`), f.push(`${h}`);
                        if (d) {
                            let o = `Min: ${a} ${n}`;
                            const r = `Max: ${i} ${n}`,
                                s = t ? Math.floor(e.measureText(`${h}     `).width) : Math.floor(e.measureText(`${c}     `).width);
                            for (; e.measureText(o).width < s;) o += " ";
                            f.push(`${o}${r}`)
                        }
                    }
                    return h.push(function(e, t) {
                        const n = t ? ` mm${String.fromCharCode(178)}` : ` px${String.fromCharCode(178)}`;
                        return `Area: ${Nn(e.toFixed(2))}${n}`
                    }(n, c)), f.forEach((e => h.push(e))), h
                }(0, c.importInternal)("base/BaseTool"), (0, c.importInternal)("drawing/getNewContext"), (0, c.importInternal)("drawing/draw"), (0, c.importInternal)("drawing/drawTextBox");
                const jn = (0, c.importInternal)("base/BaseTool");
                const zn = (0, c.importInternal)("base/BaseAnnotationTool"),
                    Wn = (0, c.importInternal)("manipulators/moveHandle"),
                    Gn = (0, c.importInternal)("drawing/getNewContext"),
                    Yn = (0, c.importInternal)("drawing/draw"),
                    Zn = (0, c.importInternal)("drawing/drawHandles"),
                    Kn = (0, c.importInternal)("drawing/drawLinkedTextBox"),
                    Xn = (0, c.importInternal)("util/triggerEvent"),
                    Jn = (0, c.importInternal)("util/getRGBPixels"),
                    Qn = (0, c.importInternal)("util/calculateSUV"),
                    $n = (0, c.importInternal)("util/getLogger"),
                    eo = (0, c.importInternal)("util/throttle"),
                    {
                        probeCursor: to
                    } = (0, c.importInternal)("tools/cursors"),
                    no = $n("tools:annotation:ProbeTool");
                const oo = (0, c.importInternal)("base/BaseTool");
                const ro = (0, c.importInternal)("base/BaseTool"),
                    ao = (0, c.importInternal)("util/angleBetweenPoints"),
                    {
                        rotateCursor: io
                    } = (0, c.importInternal)("tools/cursors");

                function so(e) {
                    var t;
                    const {
                        roundAngles: n,
                        rotateScale: o
                    } = this.configuration, {
                        element: r,
                        viewport: a,
                        startPoints: i,
                        currentPoints: s
                    } = e.detail, l = null !== (t = a.initialRotation) && void 0 !== t ? t : a.rotation, c = r.getBoundingClientRect(r), {
                        clientWidth: u,
                        clientHeight: d
                    } = r, {
                        scale: h,
                        translation: f
                    } = a, m = {
                        x: c.left + u / 2 + f.x * h,
                        y: c.top + d / 2 + f.y * h
                    }, g = ao(m, i.client, s.client);
                    g.angle *= o, n && (g.angle = Math.ceil(g.angle)), g.direction < 0 && (g.angle = -g.angle), a.rotation = l + g.angle
                }

                function lo(e) {
                    const {
                        roundAngles: t,
                        flipHorizontal: n,
                        rotateScale: o
                    } = this.configuration, {
                        viewport: r,
                        startPoints: a,
                        currentPoints: i
                    } = e.detail, s = r.initialRotation, l = a.client.x;
                    let c = (i.client.x - l) * o;
                    t && (c = Math.round(Math.abs(c)) * (c > 0 ? 1 : -1)), n && (c = -c), r.rotation = s + c
                }

                function co(e) {
                    const {
                        roundAngles: t,
                        flipVertical: n,
                        rotateScale: o
                    } = this.configuration, {
                        viewport: r,
                        startPoints: a,
                        currentPoints: i
                    } = e.detail, s = r.initialRotation, l = a.client.y;
                    let c = (i.client.y - l) * o;
                    t && (c = Math.round(Math.abs(c)) * (c > 0 ? 1 : -1)), n && (c = -c), r.rotation = s + c
                }
                var uo = n(9083);
                const {
                    toolColor: ho,
                    zoomTool: {
                        minScale: fo,
                        maxScale: mo
                    }
                } = lt.A.toolsOptions, go = {
                    configuration: {
                        invert: !1,
                        preventZoomOutsideImage: !1,
                        minScale: fo,
                        maxScale: mo
                    }
                };

                function po() {
                    c.toolColors.setToolColor(ho)
                }

                function vo(e) {
                    c.toolColors.setToolColor(e)
                }
                c.external.cornerstoneMath = l(), c.external.cornerstone = i(), c.external.Hammer = r(), (0, c.init)({
                    globalToolSyncEnabled: !0,
                    mouseEnabled: !lt.A.isMobile,
                    touchEnabled: lt.A.isMobile,
                    showSVGCursors: !0,
                    autoResizeViewports: !0
                }), (0, c.addTool)(c.WwwcTool), (0, c.addTool)(class extends ro {
                    constructor(e = {}) {
                        super(e, {
                            name: "Rotate",
                            strategies: {
                                default: so,
                                horizontal: lo,
                                vertical: co
                            },
                            defaultStrategy: "default",
                            supportedInteractionTypes: ["Mouse", "Touch"],
                            configuration: {
                                roundAngles: !1,
                                flipHorizontal: !1,
                                flipVertical: !1,
                                rotateScale: 1
                            },
                            svgCursor: io
                        })
                    }
                    touchDragCallback(e) {
                        this.dragCallback(e)
                    }
                    mouseDragCallback(e) {
                        this.dragCallback(e)
                    }
                    postTouchStartCallback(e) {
                        this.initialRotation = e.detail.viewport.rotation
                    }
                    postMouseDownCallback(e) {
                        this.initialRotation = e.detail.viewport.rotation
                    }
                    dragCallback(e) {
                        e.detail.viewport.initialRotation = this.initialRotation, this.applyActiveStrategy(e), c.external.cornerstone.setViewport(e.detail.element, e.detail.viewport)
                    }
                }), (0, c.addTool)(c.ReferenceLinesTool), (0, c.addTool)(class extends ut {
                    constructor(e = {}) {
                        super(e, {
                            name: "Crosshairs",
                            supportedInteractionTypes: ["Mouse", "Touch"],
                            svgCursor: wt
                        }), this.synchronizationContext = null, this.debounceClear = bt(this.clear, 10), this.stackEEventListener = bt((e => {
                            const t = n => {
                                e.removeEventListener(n.type, t), this.debounceClear()
                            };
                            e.addEventListener(c.EVENTS.STACK_SCROLL, t)
                        }), 100, {
                            leading: !0
                        }), this.postTouchStartCallback = this._downCallback.bind(this), this.postMouseDownCallback = this._downCallback.bind(this), this.touchDragCallback = this._chooseLocation.bind(this), this.mouseDragCallback = this._chooseLocation.bind(this), this.touchEndCallback = this.debounceClear.bind(this), this.mouseUpCallback = this.debounceClear.bind(this)
                    }
                    clear() {
                        xt.enabled = !1, this.updateImages()
                    }
                    updateImages() {
                        for (const e of this.synchronizationContext.getSourceElements())(0, a.updateImage)(e)
                    }
                    renderToolData(e) {
                        if (!xt.enabled) return;
                        const {
                            patientPoint: t
                        } = xt.state || {}, {
                            element: n,
                            canvasContext: o,
                            viewport: {
                                scale: r
                            }
                        } = e.detail, i = dt(o.canvas), s = c.toolColors.getActiveColor(), l = 30 / r, u = {
                            color: s,
                            lineWidth: 2
                        }, d = a.metaData.get("imagePlaneModule", (0, a.getEnabledElement)(n).image.imageId);
                        if (!d || (0, ct.TB)(d.imagePositionPatient) || (0, ct.TB)(d.imageOrientationPatient)) return;
                        const h = vt(yt(t), d);
                        ft(i, this.configuration), ht(i, (e => {
                            gt(e, n, {
                                x: h.x - l,
                                y: h.y
                            }, {
                                x: h.x + l,
                                y: h.y
                            }, u), gt(e, n, {
                                x: h.x,
                                y: h.y - l
                            }, {
                                x: h.x,
                                y: h.y + l
                            }, u);
                            const t = (0, a.pixelToCanvas)(n, h),
                                o = pt(h, d);
                            mt(e, [`X: ${o.x.toFixed(2)}`, `Y: ${o.y.toFixed(2)}`, `Z: ${o.z.toFixed(2)}`], t.x + 20, t.y + 10, s)
                        }))
                    }
                    activeCallback(e, {
                        synchronizationContext: t
                    }) {
                        this.synchronizationContext = t
                    }
                    _chooseLocation(e) {
                        st.lY.enabled = !1;
                        const t = e.detail,
                            {
                                element: n,
                                currentPoints: o,
                                viewport: {
                                    scale: r
                                }
                            } = t;
                        if (!(0, c.getToolState)(n, this.name)) return;
                        this.stackEEventListener(n);
                        const i = n,
                            s = a.metaData.get("imagePlaneModule", (0, a.getEnabledElement)(n).image.imageId);
                        if (!s || (0, ct.TB)(s.imagePositionPatient) || (0, ct.TB)(s.imageOrientationPatient)) return;
                        const l = o.image;
                        if (lt.A.isMobile) {
                            const {
                                handleTouchOffset: {
                                    x: e,
                                    y: t
                                }
                            } = c.store.state;
                            l.x += e / r, l.y += t / r
                        }
                        const u = pt(l, s),
                            d = this.synchronizationContext.getSourceElements();
                        xt.init({
                            sourceElement: i,
                            sourceImagePoint: l,
                            sourceImagePlane: s,
                            patientPoint: u,
                            eventData: t
                        }), d.forEach((e => {
                            if (e === i) return void(1 === d.length && this.updateImages());
                            let t = Number.MAX_VALUE,
                                n = -1;
                            const o = (0, c.getToolState)(e, "stack");
                            if (void 0 === o) return;
                            const r = o.data[0];
                            if (r.imageIds.forEach((function(e, o) {
                                    const r = a.metaData.get("imagePlaneModule", e);
                                    if (!(r && r.imagePositionPatient && r.rowCosines && r.columnCosines)) return;
                                    const i = yt(r.imagePositionPatient),
                                        s = yt(r.rowCosines),
                                        l = yt(r.columnCosines).clone().cross(s.clone()),
                                        c = Math.abs(l.clone().dot(i) - l.clone().dot(u));
                                    c < t && (t = c, n = o)
                                })), -1 !== n && void 0 !== r.imageIds[n]) {
                                const t = c.loadHandlerManager.getStartLoadHandler(e),
                                    o = c.loadHandlerManager.getEndLoadHandler(e),
                                    i = c.loadHandlerManager.getErrorLoadingHandler(e);
                                null == t || t(e);
                                const s = r.imageIds[n];
                                (0, it.BY)(s).then((t => {
                                    r.currentImageIdIndex = n, (0, a.displayImage)(e, t, (0, a.getViewport)(e)), null == o || o(e, t)
                                }), (t => {
                                    null == i || i(e, s, t)
                                })).finally((() => {
                                    (0, st.K2)(100)
                                }))
                            }
                        }))
                    }
                    _downCallback(e) {
                        const {
                            element: t
                        } = e.detail, n = e => {
                            t.removeEventListener(e.type, n), this.debounceClear()
                        };
                        this._chooseLocation(e), t.addEventListener(lt.A.isMobile ? "touchend" : "mouseup", n)
                    }
                }), (0, c.addTool)(class extends Tt {
                    constructor(e = {}) {
                        super(e, {
                            name: "EllipticalRoi",
                            supportedInteractionTypes: ["Mouse", "Touch"],
                            configuration: {
                                drawHandles: !0,
                                drawHandlesOnHover: !1,
                                hideHandlesIfMoving: !1,
                                renderDashed: !1
                            },
                            svgCursor: Ft
                        }), this.throttledUpdateCachedStats = Ut(this.updateCachedStats, 110), this.throttledHandlesMove = Ut(Ht, 0)
                    }
                    createNewMeasurement(e) {
                        const {
                            currentPoints: {
                                image: t
                            },
                            image: n
                        } = e || {
                            currentPoints: {}
                        };
                        if (t) return {
                            visible: !0,
                            active: !0,
                            color: void 0,
                            invalidated: !0,
                            handles: {
                                start: {
                                    x: e.currentPoints.image.x,
                                    y: e.currentPoints.image.y,
                                    highlight: !0,
                                    active: !1
                                },
                                end: {
                                    x: e.currentPoints.image.x,
                                    y: e.currentPoints.image.y,
                                    highlight: !0,
                                    active: !1
                                },
                                initialRotation: e.viewport.rotation,
                                textBox: {
                                    active: !1,
                                    hasMoved: !1,
                                    movesIndependently: !1,
                                    drawnIndependently: !0,
                                    allowedOutsideImage: !0,
                                    hasBoundingBox: !0
                                }
                            }
                        };
                        Vt.error(`required eventData not supplied to tool ${this.name}'s createNewMeasurement`)
                    }
                    pointNearTool(e, t, n, o) {
                        const r = t && t.handles && t.handles.start && t.handles.end;
                        if (r || Vt.warn(`invalid parameters supplied to tool ${this.name}'s pointNearTool`), !r || !1 === t.visible) return !1;
                        if (It(e, t.handles, n, 6)) return !0;
                        const a = "mouse" === o ? 15 : 25,
                            i = c.external.cornerstone.pixelToCanvas(e, t.handles.start),
                            s = c.external.cornerstone.pixelToCanvas(e, t.handles.end),
                            l = {
                                left: Math.min(i.x, s.x) + a / 2,
                                top: Math.min(i.y, s.y) + a / 2,
                                width: Math.abs(i.x - s.x) - a,
                                height: Math.abs(i.y - s.y) - a
                            },
                            u = {
                                left: Math.min(i.x, s.x) - a / 2,
                                top: Math.min(i.y, s.y) - a / 2,
                                width: Math.abs(i.x - s.x) + a,
                                height: Math.abs(i.y - s.y) + a
                            },
                            d = Rt(l, n);
                        return !(!Rt(u, n) || d)
                    }
                    updateCachedStats(e, t, n) {
                        const o = (c.external.cornerstone.metaData.get("generalSeriesModule", e.imageId) || {}).modality,
                            r = Bt(e),
                            a = function(e, t, n, o, r) {
                                const a = Wt(n.start, n.end),
                                    i = c.external.cornerstone.getPixels(t, a.left, a.top, a.width, a.height),
                                    s = Ot(i, a);
                                let l;
                                "PT" === o && (l = {
                                    mean: Lt(e, s.mean, !0) || 0,
                                    stdDev: Lt(e, s.stdDev, !0) || 0
                                });
                                const u = Math.PI * (a.width * (r.colPixelSpacing || 1) / 2) * (a.height * (r.rowPixelSpacing || 1) / 2);
                                return {
                                    area: u || 0,
                                    count: s.count || 0,
                                    mean: s.mean || 0,
                                    variance: s.variance || 0,
                                    stdDev: s.stdDev || 0,
                                    min: s.min || 0,
                                    max: s.max || 0,
                                    meanStdDevSUV: l,
                                    handles: (0, Be.A4)(n)
                                }
                            }(e, t, n.handles, o, r);
                        n.cachedStats = a, n.invalidated = !1
                    }
                    renderToolData(e) {
                        const t = (0, c.getToolState)(e.currentTarget, this.name);
                        if (!t) return;
                        const n = e.detail,
                            {
                                image: o,
                                element: r
                            } = n,
                            a = c.toolStyle.getToolWidth(),
                            i = (0, c.getModule)("globalConfiguration").configuration.lineDash,
                            {
                                handleRadius: s,
                                drawHandlesOnHover: l,
                                hideHandlesIfMoving: u,
                                renderDashed: d
                            } = this.configuration,
                            h = Et(n.canvasContext.canvas),
                            {
                                rowPixelSpacing: f,
                                colPixelSpacing: m
                            } = Bt(o),
                            g = (c.external.cornerstone.metaData.get("generalSeriesModule", o.imageId) || {}).modality,
                            p = f && m;
                        St(h, (e => {
                            for (let h = 0; h < t.data.length; h++) {
                                const f = t.data[h];
                                if (!1 === f.visible) continue;
                                const m = c.toolColors.getColorIfActive(f),
                                    v = {
                                        color: m,
                                        handleRadius: s,
                                        drawHandlesIfActive: l,
                                        hideHandlesIfMoving: u
                                    };
                                At(e, this.configuration);
                                const y = {
                                    color: m
                                };
                                if (d && (y.lineDash = i), Ct(e, r, f.handles.start, f.handles.end, y, "pixel", f.handles.initialRotation), this.configuration.drawHandles && f.active) {
                                    Pt(e, n, Object.assign(Object.assign({}, f.handles), {
                                        top: {
                                            drawnIndependently: !0
                                        },
                                        left: {
                                            drawnIndependently: !0
                                        },
                                        bottom: {
                                            drawnIndependently: !0
                                        },
                                        right: {
                                            drawnIndependently: !0
                                        }
                                    }), v);
                                    const t = {
                                        color: m,
                                        lineWidth: a,
                                        lineDash: [2, 3]
                                    };
                                    Dt(e, r, f.handles.start, f.handles.end, t)
                                }
                                if (!0 === f.invalidated && (f.cachedStats ? this.throttledUpdateCachedStats(o, r, f) : this.updateCachedStats(o, r, f)), !f.handles.textBox.hasMoved) {
                                    const e = kt(n.viewport, f.handles);
                                    Object.assign(f.handles.textBox, e)
                                }
                                const b = e => qt(e.start, e.end),
                                    w = zt(e, o.color, f.cachedStats, g, p, this.configuration);
                                f.unit = jt(g, this.configuration.showHounsfieldUnits), Mt(e, r, f.handles.textBox, w, f.handles, b, m, a, 10, !0)
                            }
                        }))
                    }
                }, {
                    configuration: {
                        showMinMax: !0
                    }
                }), (0, c.addTool)(c.StackScrollTool), (0, c.addTool)(c.FreehandRoiTool, {
                    configuration: {
                        showMinMax: !0
                    }
                }), (0, c.addTool)(c.CircleRoiTool, {
                    configuration: {
                        showMinMax: !0
                    }
                }), (0, c.addTool)(class extends xn {
                    constructor(e = {}) {
                        super(e, {
                            name: "Magnify",
                            supportedInteractionTypes: ["Mouse", "Touch"],
                            configuration: {
                                magnifySize: 300,
                                magnificationLevel: 2
                            },
                            svgCursor: In
                        }), this.zoomCanvas = void 0, this.zoomElement = void 0, this.activeCallback = this._createMagnificationCanvas.bind(this), this.enabledCallback = this._createMagnificationCanvas.bind(this), this.disabledCallback = this._destroyMagnificationCanvas.bind(this), this.postTouchStartCallback = this._addMagnifyingGlass.bind(this), this.touchDragCallback = this._updateMagnifyingGlass.bind(this), this.touchEndCallback = this._removeMagnifyingGlass.bind(this), this.touchDragEndCallback = this._removeMagnifyingGlass.bind(this), this.postMouseDownCallback = this._addMagnifyingGlass.bind(this), this.mouseDragCallback = this._updateMagnifyingGlass.bind(this), this.mouseUpCallback = this._removeMagnifyingGlass.bind(this), this.mouseClickCallback = this._removeMagnifyingGlass.bind(this), this.newImageCallback = this._drawMagnificationTool.bind(this)
                    }
                    _addMagnifyingGlass(e) {
                        var t;
                        (this._removeZoomElement(), e.detail.element.querySelector(".active")) || (this._drawZoomedElement(e), window.requestAnimationFrame((() => this._drawMagnificationTool(e))), t = e.detail.element, bn.configuration.showSVGCursors && wn(t, "none"), e.preventDefault(), e.stopPropagation())
                    }
                    _updateMagnifyingGlass(e) {
                        e.detail.element.querySelector(".active") || (this._drawMagnificationTool(e), e.preventDefault(), e.stopPropagation())
                    }
                    _removeMagnifyingGlass(e) {
                        const t = e.detail.element;
                        ! function(e, t) {
                            if (!bn.configuration.showSVGCursors) return;
                            const n = t.getIconWithPointerSVG(),
                                o = t.mousePoint,
                                r = window.URL.createObjectURL(n);
                            e.style.cursor = `url('${r}') ${o}, auto`, vn.svgCursorUrl = r
                        }(this.element, this.svgCursor), t.querySelector(".magnifyTool").style.display = "none", this._removeZoomElement()
                    }
                    _drawMagnificationTool(e) {
                        const t = e.detail.element,
                            n = t.querySelector(".magnifyTool");
                        if (void 0 === this.zoomCanvas) return;
                        const o = t.querySelector("canvas:not(.magnifyTool)"),
                            r = Tn(n),
                            a = c.external.cornerstone.pixelToCanvas(e.detail.element, e.detail.currentPoints.image),
                            i = Math.min(this.configuration.magnifySize, o.width, o.height),
                            s = this.configuration.magnificationLevel;
                        n.width = i, n.height = i, a.x = Math.max(a.x, .5 * i / s), a.x = Math.min(a.x, o.width - .5 * i / s), a.y = Math.max(a.y, .5 * i / s), a.y = Math.min(a.y, o.height - .5 * i / s);
                        const l = {
                            x: a.x * s - .5 * i,
                            y: a.y * s - .5 * i
                        };
                        l.x = Math.max(l.x, 0), l.y = Math.max(l.y, 0), r.drawImage(this.zoomCanvas, l.x, l.y, i, i, 0, 0, i, i);
                        const u = e.detail.isTouchEvent ? 120 : 0,
                            d = {
                                top: Math.max(a.y - .5 * i - u, 0),
                                left: Math.max(a.x - .5 * i, 0)
                            },
                            h = n.getBoundingClientRect();
                        d.top = Math.min(d.top, o.height - h.height), d.left = Math.min(d.left, o.width - h.width), n.style.top = `${d.top}px`, n.style.left = `${d.left}px`, n.style.display = "block"
                    }
                    _drawZoomedElement(e) {
                        const t = e.detail.element;
                        let n = e.detail.enabledElement;
                        void 0 === n && (n = c.external.cornerstone.getEnabledElement(t));
                        const o = this.configuration.magnificationLevel,
                            r = n.canvas,
                            a = n.image;
                        this.zoomElement || (this.zoomElement = document.createElement("div"), this.zoomElement.width = r.width * o, this.zoomElement.height = r.height * o, c.external.cornerstone.enable(this.zoomElement, n.options));
                        const i = c.external.cornerstone.getEnabledElement(this.zoomElement),
                            s = c.external.cornerstone.getViewport(n.element);
                        this.zoomCanvas = i.canvas, this.zoomCanvas.width = r.width * o, this.zoomCanvas.height = r.height * o, i.viewport = Object.assign({}, s), s.scale *= o, c.external.cornerstone.displayImage(this.zoomElement, a), c.external.cornerstone.setViewport(this.zoomElement, s)
                    }
                    _removeZoomElement() {
                        void 0 !== this.zoomElement && (c.external.cornerstone.disable(this.zoomElement), this.zoomElement = void 0, this.zoomCanvas = void 0)
                    }
                    _createMagnificationCanvas(e) {
                        if (null === e.querySelector(".magnifyTool")) {
                            const t = document.createElement("canvas");
                            (0, Be.wf)(t, !0, "magnifyTool"), t.width = this.configuration.magnifySize, t.height = this.configuration.magnifySize, t.style.position = "absolute", t.style.display = "none", e.appendChild(t)
                        }
                    }
                    _destroyMagnificationCanvas(e) {
                        const t = e.querySelector(".magnifyTool");
                        t && e.removeChild(t)
                    }
                }), (0, c.addTool)(c.EraserTool), (0, c.addTool)(c.PanTool), (0, c.addTool)(class extends j {
                    constructor(e = {}) {
                        super(e, {
                            name: "ArrowAnnotate",
                            supportedInteractionTypes: ["Mouse", "Touch"],
                            configuration: {
                                getTextCallback: ne,
                                changeTextCallback: oe,
                                drawHandles: !0,
                                drawHandlesOnHover: !1,
                                hideHandlesIfMoving: !1,
                                arrowFirst: !0,
                                renderDashed: !1,
                                allowEmptyLabel: !1
                            },
                            svgCursor: te
                        }), this.preventNewMeasurement = !1
                    }
                    createNewMeasurement(e) {
                        return {
                            visible: !0,
                            active: !0,
                            color: void 0,
                            handles: {
                                start: {
                                    x: e.detail.currentPoints.image.x,
                                    y: e.detail.currentPoints.image.y,
                                    highlight: !0,
                                    active: !1
                                },
                                end: {
                                    x: e.detail.currentPoints.image.x,
                                    y: e.detail.currentPoints.image.y,
                                    highlight: !0,
                                    active: !1
                                },
                                textBox: {
                                    active: !1,
                                    hasMoved: !1,
                                    movesIndependently: !1,
                                    drawnIndependently: !0,
                                    allowedOutsideImage: !0,
                                    hasBoundingBox: !0
                                }
                            }
                        }
                    }
                    pointNearTool(e, t, n, o) {
                        if (!1 === t.visible) return !1;
                        const r = "mouse" === o ? 15 : 25;
                        return G(e, t.handles.start, t.handles.end, n) < r
                    }
                    updateCachedStats() {}
                    renderToolData(e) {
                        const {
                            element: t,
                            enabledElement: n
                        } = e.detail, {
                            handleRadius: o,
                            drawHandlesOnHover: r,
                            hideHandlesIfMoving: a,
                            renderDashed: i
                        } = this.configuration, s = (0, c.getToolState)(t, this.name);
                        if (!s) return;
                        const l = e.detail.canvasContext.canvas,
                            u = K(l),
                            d = c.toolStyle.getToolWidth();
                        let h;
                        i && (h = (0, c.getModule)("globalConfiguration").configuration.lineDash);
                        for (let i = 0; i < s.data.length; i++) {
                            const l = s.data[i];
                            !1 !== l.visible && X(u, (i => {
                                J(i, this.configuration);
                                const s = c.toolColors.getColorIfActive(l),
                                    u = c.external.cornerstone.pixelToCanvas(t, l.handles.start),
                                    g = c.external.cornerstone.pixelToCanvas(t, l.handles.end);
                                this.configuration.arrowFirst ? Q(i, g, u, s, d, h) : Q(i, u, g, s, d, h);
                                const p = {
                                    color: s,
                                    handleRadius: o,
                                    drawHandlesIfActive: r,
                                    hideHandlesIfMoving: a
                                };
                                this.configuration.drawHandles && l.active && $(i, e.detail, l.handles, p);
                                const v = f(l);
                                if (v && "" !== v) {
                                    const e = ee(i, v, 5),
                                        o = c.textStyle.getFontSize() + 10;
                                    let r = Math.max(e, o) / 2 + 5;
                                    if (g.x < u.x && (r = -r), !l.handles.textBox.hasMoved) {
                                        let t;
                                        t = this.configuration.arrowFirst ? {
                                            x: g.x - e / 2 + r,
                                            y: g.y - o / 2
                                        } : {
                                            x: u.x - e / 2 - r,
                                            y: u.y - o / 2
                                        };
                                        const a = c.external.cornerstone.internal.getTransform(n);
                                        a.invert();
                                        const i = a.transformPoint(t.x, t.y);
                                        l.handles.textBox.x = i.x, l.handles.textBox.y = i.y
                                    }
                                    Z(i, t, l.handles.textBox, v, l.handles, m, s, d, 0, !1)
                                }
                            }))
                        }

                        function f(e) {
                            return e.text
                        }

                        function m(e) {
                            const t = {
                                x: (e.start.x + e.end.x) / 2,
                                y: (e.start.y + e.end.y) / 2
                            };
                            return [e.start, t, e.end]
                        }
                    }
                    addNewMeasurement(e, t) {
                        const n = e.detail.element,
                            o = this.createNewMeasurement(e),
                            {
                                allowEmptyLabel: r
                            } = this.configuration;
                        (0, c.addToolState)(n, this.name, o), c.external.cornerstone.updateImage(n), z(e.detail, this.name, o, o.handles.end, this.options, t, (t => {
                            t ? void 0 === o.text && this.configuration.getTextCallback((e => {
                                if (e || r) {
                                    o.text = e, o.active = !1;
                                    const t = {
                                        toolName: this.name,
                                        toolType: this.name,
                                        element: n,
                                        measurementData: o
                                    };
                                    c.external.cornerstone.updateImage(n), Y(n, c.EVENTS.MEASUREMENT_COMPLETED, t)
                                } else(0, c.removeToolState)(n, this.name, o)
                            }), e.detail) : (0, c.removeToolState)(n, this.name, o), c.external.cornerstone.updateImage(n)
                        }))
                    }
                    doubleClickCallback(e) {
                        return this._updateTextForNearbyAnnotation(e, "mouse")
                    }
                    touchPressCallback(e) {
                        return this._updateTextForNearbyAnnotation(e, "touch")
                    }
                    _updateTextForNearbyAnnotation(e, t) {
                        const n = e.detail.element,
                            o = e.detail.currentPoints.canvas,
                            r = (0, c.getToolState)(n, this.name);
                        if (!r) return !1;
                        for (let a = 0; a < r.data.length; a++) {
                            const i = r.data[a];
                            if (this.pointNearTool(n, i, o, t) || W(i.handles.textBox, o)) return i.active = !0, c.external.cornerstone.updateImage(n), this.configuration.changeTextCallback(i, e.detail, this._doneChangingTextCallback.bind(this, n, i)), e.stopImmediatePropagation(), e.preventDefault(), e.stopPropagation(), !0
                        }
                    }
                    _doneChangingTextCallback(e, t, n, o) {
                        !0 === o ? (0, c.removeToolState)(e, this.name, t) : t.text = n, t.active = !1, c.external.cornerstone.updateImage(e), Y(e, c.EVENTS.MEASUREMENT_MODIFIED, {
                            toolName: this.name,
                            toolType: this.name,
                            element: e,
                            measurementData: t
                        })
                    }
                }, {}), (0, c.addTool)(class extends En {
                    constructor(e = {}) {
                        super(e, {
                            name: "RectangleRoi",
                            supportedInteractionTypes: ["Mouse", "Touch"],
                            configuration: {
                                drawHandles: !0,
                                drawHandlesOnHover: !1,
                                hideHandlesIfMoving: !1,
                                renderDashed: !1
                            },
                            svgCursor: Bn
                        }), this.throttledUpdateCachedStats = _n(this.updateCachedStats, 110)
                    }
                    createNewMeasurement(e) {
                        if (e && e.currentPoints && e.currentPoints.image) return {
                            visible: !0,
                            active: !0,
                            color: void 0,
                            invalidated: !0,
                            handles: {
                                start: {
                                    x: e.currentPoints.image.x,
                                    y: e.currentPoints.image.y,
                                    highlight: !0,
                                    active: !1
                                },
                                end: {
                                    x: e.currentPoints.image.x,
                                    y: e.currentPoints.image.y,
                                    highlight: !0,
                                    active: !0
                                },
                                initialRotation: e.viewport.rotation,
                                textBox: {
                                    active: !1,
                                    hasMoved: !1,
                                    movesIndependently: !1,
                                    drawnIndependently: !0,
                                    allowedOutsideImage: !0,
                                    hasBoundingBox: !0
                                }
                            }
                        };
                        Un.error(`required eventData not supplied to tool ${this.name}'s createNewMeasurement`)
                    }
                    pointNearTool(e, t, n, o) {
                        const r = t && t.handles && t.handles.start && t.handles.end;
                        if (r || Un.warn(`invalid parameters supplied to tool ${this.name}'s pointNearTool`), !r || !1 === t.visible) return !1;
                        const a = "mouse" === o ? 15 : 25,
                            i = c.external.cornerstone.pixelToCanvas(e, t.handles.start),
                            s = c.external.cornerstone.pixelToCanvas(e, t.handles.end),
                            l = {
                                left: Math.min(i.x, s.x),
                                top: Math.min(i.y, s.y),
                                width: Math.abs(i.x - s.x),
                                height: Math.abs(i.y - s.y)
                            };
                        return c.external.cornerstoneMath.rect.distanceToPoint(l, n) < a
                    }
                    updateCachedStats(e, t, n) {
                        const o = (c.external.cornerstone.metaData.get("generalSeriesModule", e.imageId) || {}).modality,
                            r = Ln(e),
                            a = function(e, t, n, o, r) {
                                const a = Vn(n.start, n.end),
                                    i = c.external.cornerstone.getPixels(t, a.left, a.top, a.width, a.height),
                                    s = function(e, t) {
                                        let n = 0,
                                            o = 0,
                                            r = 0,
                                            a = 0,
                                            i = e ? e[0] : null,
                                            s = e ? e[0] : null;
                                        for (let l = t.top; l < t.top + t.height; l++)
                                            for (let l = t.left; l < t.left + t.width; l++) n += e[a], o += e[a] * e[a], i = Math.min(i, e[a]), s = Math.max(s, e[a]), r++, a++;
                                        if (0 === r) return {
                                            count: r,
                                            mean: 0,
                                            variance: 0,
                                            stdDev: 0,
                                            min: 0,
                                            max: 0
                                        };
                                        const l = n / r,
                                            c = o / r - l * l;
                                        return {
                                            count: r,
                                            mean: l,
                                            variance: c,
                                            stdDev: Math.sqrt(c),
                                            min: i,
                                            max: s
                                        }
                                    }(i, a);
                                let l;
                                "PT" === o && (l = {
                                    mean: On(e, s.mean, !0) || 0,
                                    stdDev: On(e, s.stdDev, !0) || 0
                                });
                                const u = a.width * (r.colPixelSpacing || 1) * (a.height * (r.rowPixelSpacing || 1)),
                                    d = 2 * a.width * (r.colPixelSpacing || 1) + 2 * a.height * (r.rowPixelSpacing || 1);
                                return {
                                    area: u || 0,
                                    perimeter: d,
                                    count: s.count || 0,
                                    mean: s.mean || 0,
                                    variance: s.variance || 0,
                                    stdDev: s.stdDev || 0,
                                    min: s.min || 0,
                                    max: s.max || 0,
                                    meanStdDevSUV: l
                                }
                            }(e, t, n.handles, o, r);
                        n.cachedStats = a, n.invalidated = !1
                    }
                    renderToolData(e) {
                        const t = (0, c.getToolState)(e.currentTarget, this.name);
                        if (!t) return;
                        const n = e.detail,
                            {
                                image: o,
                                element: r
                            } = n,
                            a = c.toolStyle.getToolWidth(),
                            i = (0, c.getModule)("globalConfiguration").configuration.lineDash,
                            {
                                handleRadius: s,
                                drawHandlesOnHover: l,
                                hideHandlesIfMoving: u,
                                renderDashed: d
                            } = this.configuration,
                            h = Sn(n.canvasContext.canvas),
                            {
                                rowPixelSpacing: f,
                                colPixelSpacing: m
                            } = Ln(o),
                            g = (c.external.cornerstone.metaData.get("generalSeriesModule", o.imageId) || {}).modality,
                            p = f && m;
                        An(h, (e => {
                            for (let h = 0; h < t.data.length; h++) {
                                const f = t.data[h];
                                if (!1 === f.visible) continue;
                                const m = c.toolColors.getColorIfActive(f),
                                    v = {
                                        color: m,
                                        handleRadius: s,
                                        drawHandlesIfActive: l,
                                        hideHandlesIfMoving: u
                                    };
                                Cn(e, this.configuration);
                                const y = {
                                    color: m
                                };
                                if (d && (y.lineDash = i), Mn(e, r, f.handles.start, f.handles.end, y, "pixel", f.handles.initialRotation), this.configuration.drawHandles && f.active && Pn(e, n, f.handles, v), !0 === f.invalidated && (f.cachedStats ? this.throttledUpdateCachedStats(o, r, f) : this.updateCachedStats(o, r, f)), !f.handles.textBox.hasMoved) {
                                    const e = Rn(n.viewport, f.handles);
                                    Object.assign(f.handles.textBox, e)
                                }
                                const b = e => Fn(e.start, e.end),
                                    w = qn(e, o.color, f.cachedStats, g, p, this.configuration);
                                f.unit = Hn(g, this.configuration.showHounsfieldUnits), Dn(e, r, f.handles.textBox, w, f.handles, b, m, a, 10, !0)
                            }
                        }))
                    }
                }, {
                    configuration: {
                        showMinMax: !0
                    }
                }), (0, c.addTool)(class extends on {
                    constructor(e = {}) {
                        super(e, {
                            name: "Length",
                            supportedInteractionTypes: ["Mouse", "Touch"],
                            svgCursor: pn,
                            configuration: {
                                drawHandles: !0,
                                drawHandlesOnHover: !1,
                                hideHandlesIfMoving: !1,
                                renderDashed: !1,
                                digits: 2
                            }
                        }), this.throttledUpdateCachedStats = hn(this.updateCachedStats, 110)
                    }
                    createNewMeasurement(e) {
                        var t;
                        const n = null === (t = null == e ? void 0 : e.currentPoints) || void 0 === t ? void 0 : t.image;
                        if (!n) return void gn.error(`required eventData not supplied to tool ${this.name}'s createNewMeasurement`);
                        const {
                            x: o,
                            y: r
                        } = n;
                        return {
                            visible: !0,
                            active: !0,
                            color: void 0,
                            invalidated: !0,
                            handles: {
                                start: {
                                    x: o,
                                    y: r,
                                    highlight: !0,
                                    active: !1
                                },
                                end: {
                                    x: o,
                                    y: r,
                                    highlight: !0,
                                    active: !0
                                },
                                textBox: {
                                    active: !1,
                                    hasMoved: !1,
                                    movesIndependently: !1,
                                    drawnIndependently: !0,
                                    allowedOutsideImage: !0,
                                    hasBoundingBox: !0
                                }
                            }
                        }
                    }
                    pointNearTool(e, t, n, o) {
                        if (!(t && t.handles && t.handles.start && t.handles.end)) return gn.warn(`invalid parameters supplied to tool ${this.name}'s pointNearTool`), !1;
                        if (!1 === t.visible) return !1;
                        const r = "mouse" === o ? 15 : 25;
                        return mn(e, t.handles.start, t.handles.end, n) < r
                    }
                    updateCachedStats(e, t, n) {
                        const {
                            rowPixelSpacing: o,
                            colPixelSpacing: r
                        } = fn(e), a = (n.handles.end.x - n.handles.start.x) * (r || 1), i = (n.handles.end.y - n.handles.start.y) * (o || 1), s = Math.sqrt(a * a + i * i);
                        n.length = s, n.invalidated = !1
                    }
                    renderToolData(e) {
                        const t = e.detail,
                            {
                                handleRadius: n,
                                drawHandlesOnHover: o,
                                hideHandlesIfMoving: r,
                                renderDashed: a,
                                digits: i
                            } = this.configuration,
                            s = (0, c.getToolState)(e.currentTarget, this.name);
                        if (!s) return;
                        const l = rn(t.canvasContext.canvas),
                            {
                                image: u,
                                element: d
                            } = t,
                            {
                                rowPixelSpacing: h,
                                colPixelSpacing: f
                            } = fn(u),
                            m = c.toolStyle.getToolWidth(),
                            g = (0, c.getModule)("globalConfiguration").configuration.lineDash;
                        for (let e = 0; e < s.data.length; e++) {
                            const i = s.data[e];
                            !1 !== i.visible && an(l, (e => {
                                sn(e, this.configuration);
                                const s = c.toolColors.getColorIfActive(i),
                                    l = {
                                        color: s
                                    };
                                a && (l.lineDash = g), cn(e, d, i.handles.start, i.handles.end, l);
                                const y = {
                                    color: s,
                                    handleRadius: n,
                                    drawHandlesIfActive: o,
                                    hideHandlesIfMoving: r
                                };
                                if (this.configuration.drawHandles && i.active && un(e, t, i.handles, y), !i.handles.textBox.hasMoved) {
                                    const e = {
                                        x: Math.max(i.handles.start.x, i.handles.end.x)
                                    };
                                    e.x === i.handles.start.x ? e.y = i.handles.start.y : e.y = i.handles.end.y, i.handles.textBox.x = e.x, i.handles.textBox.y = e.y
                                }!0 === i.invalidated && (i.length ? this.throttledUpdateCachedStats(u, d, i) : this.updateCachedStats(u, d, i));
                                const b = p(i, h, f);
                                ln(e, d, i.handles.textBox, b, i.handles, v, s, m, 10, !0)
                            }))
                        }

                        function p(e, t, n) {
                            const o = function(e) {
                                const t = Number(e);
                                return isNaN(t) ? void 0 : t
                            }(e.length);
                            if (!o) return "";
                            let r = "mm";
                            return t && n || (r = "pixels"), e.unit = r, `${o.toFixed(i)} ${r}`
                        }

                        function v(e) {
                            const t = {
                                x: (e.start.x + e.end.x) / 2,
                                y: (e.start.y + e.end.y) / 2
                            };
                            return [e.start, t, e.end]
                        }
                    }
                }, {}), (0, c.addTool)(class extends we {
                    constructor(e = {}) {
                        super(e, {
                            name: "Angle",
                            supportedInteractionTypes: ["Mouse", "Touch"],
                            svgCursor: Oe,
                            configuration: {
                                drawHandles: !0,
                                drawHandlesOnHover: !1,
                                hideHandlesIfMoving: !1,
                                renderDashed: !1
                            }
                        }), this.preventNewMeasurement = !1, this.throttledUpdateCachedStats = ke(this.updateCachedStats, 110)
                    }
                    createNewMeasurement(e) {
                        return {
                            visible: !0,
                            active: !0,
                            color: void 0,
                            invalidated: !0,
                            handles: {
                                start: {
                                    x: e.currentPoints.image.x,
                                    y: e.currentPoints.image.y,
                                    highlight: !0,
                                    active: !1
                                },
                                middle: {
                                    x: e.currentPoints.image.x,
                                    y: e.currentPoints.image.y,
                                    highlight: !0,
                                    active: !0
                                },
                                end: {
                                    x: e.currentPoints.image.x,
                                    y: e.currentPoints.image.y,
                                    highlight: !0,
                                    active: !1
                                },
                                textBox: {
                                    active: !1,
                                    hasMoved: !1,
                                    movesIndependently: !1,
                                    drawnIndependently: !0,
                                    allowedOutsideImage: !0,
                                    hasBoundingBox: !0
                                }
                            }
                        }
                    }
                    pointNearTool(e, t, n, o) {
                        if (!1 === t.visible) return !1;
                        const r = "mouse" === o ? 15 : 25;
                        return De(e, t.handles.start, t.handles.middle, n) < r || De(e, t.handles.middle, t.handles.end, n) < r
                    }
                    updateCachedStats(e, t, n) {
                        if (!n.handles.middle) return;
                        const o = Ne(e, n.handles.middle, n.handles.start),
                            r = Ne(e, n.handles.end, n.handles.middle),
                            a = Ne(e, n.handles.end, n.handles.start),
                            i = Re(o),
                            s = Re(r),
                            l = Re(a);
                        let c = Math.acos((Math.pow(i, 2) + Math.pow(s, 2) - Math.pow(l, 2)) / (2 * i * s));
                        c *= 180 / Math.PI, n.rAngle = Pe(c, 2), n.invalidated = !1
                    }
                    renderToolData(e) {
                        const t = e.detail,
                            n = t.enabledElement,
                            {
                                handleRadius: o,
                                drawHandlesOnHover: r,
                                hideHandlesIfMoving: a,
                                renderDashed: i
                            } = this.configuration,
                            s = (0, c.getToolState)(e.currentTarget, this.name),
                            l = (0, c.getModule)("globalConfiguration").configuration.lineDash;
                        if (!s) return;
                        const u = Te(t.canvasContext.canvas),
                            {
                                image: d,
                                element: h
                            } = t,
                            {
                                rowPixelSpacing: f,
                                colPixelSpacing: m
                            } = _e(d),
                            g = c.toolStyle.getToolWidth();
                        for (let e = 0; e < s.data.length; e++) {
                            const y = s.data[e];
                            !1 !== y.visible && Ie(u, (e => {
                                Ee(e, this.configuration);
                                const s = c.toolColors.getColorIfActive(y),
                                    u = c.external.cornerstone.pixelToCanvas(t.element, y.handles.start),
                                    b = c.external.cornerstone.pixelToCanvas(t.element, y.handles.middle),
                                    w = {
                                        color: s
                                    };
                                i && (w.lineDash = l), Se(e, t.element, y.handles.start, [y.handles.middle, y.handles.end], w);
                                const x = {
                                    color: s,
                                    handleRadius: o,
                                    drawHandlesIfActive: r,
                                    hideHandlesIfMoving: a
                                };
                                if (this.configuration.drawHandles && y.active && Ce(e, t, y.handles, x), !0 === y.invalidated && (y.rAngle ? this.throttledUpdateCachedStats(d, h, y) : this.updateCachedStats(d, h, y)), y.rAngle) {
                                    const o = p(y, f, m),
                                        r = 15;
                                    let a;
                                    if (!y.handles.textBox.hasMoved) {
                                        a = {
                                            x: b.x,
                                            y: b.y
                                        };
                                        const t = Le(e, o, 5);
                                        b.x < u.x ? a.x -= r + t + 10 : a.x += r;
                                        const i = c.external.cornerstone.internal.getTransform(n);
                                        i.invert();
                                        const s = i.transformPoint(a.x, a.y);
                                        y.handles.textBox.x = s.x, y.handles.textBox.y = s.y
                                    }
                                    Ae(e, t.element, y.handles.textBox, o, y.handles, v, s, g, 0, !0)
                                }
                            }))
                        }

                        function p(e, t, n) {
                            const o = t && n ? "" : " (isotropic)";
                            return e.rAngle.toString() + String.fromCharCode(parseInt("00B0", 16)) + o
                        }

                        function v(e) {
                            return [e.start, e.middle, e.end]
                        }
                    }
                    addNewMeasurement(e, t) {
                        if (this.preventNewMeasurement) return;
                        this.preventNewMeasurement = !0, e.preventDefault(), e.stopPropagation();
                        const n = e.detail,
                            o = this.createNewMeasurement(n),
                            r = e.detail.element;
                        (0, c.addToolState)(r, this.name, o), c.external.cornerstone.updateImage(r), xe(n, this.name, o, o.handles.middle, this.options, t, (e => {
                            if (o.active = !1, !e) return (0, c.removeToolState)(r, this.name, o), void(this.preventNewMeasurement = !1);
                            o.handles.end.active = !0, c.external.cornerstone.updateImage(r), xe(n, this.name, o, o.handles.end, this.options, t, (e => {
                                e ? (o.active = !1, c.external.cornerstone.updateImage(r)) : (0, c.removeToolState)(r, this.name, o), this.preventNewMeasurement = !1, c.external.cornerstone.updateImage(r);
                                const t = {
                                    toolName: this.name,
                                    toolType: this.name,
                                    element: r,
                                    measurementData: o
                                };
                                Me(r, c.EVENTS.MEASUREMENT_COMPLETED, t)
                            }))
                        }))
                    }
                }, {}), (0, c.addTool)(class extends oo {
                    constructor(e = {}) {
                        super(e, {
                            name: "Pointer",
                            supportedInteractionTypes: ["Mouse", "Touch"]
                        })
                    }
                }), (0, c.addTool)(class extends We {
                    constructor(e = {}) {
                        super(e, {
                            name: "CobbAngle",
                            supportedInteractionTypes: ["Mouse", "Touch"],
                            svgCursor: rt,
                            configuration: {
                                drawHandles: !0,
                                drawHandlesOnHover: !1,
                                hideHandlesIfMoving: !1,
                                renderDashed: !1
                            }
                        }), this.hasIncomplete = !1, this.throttledUpdateCachedStats = nt(this.updateCachedStats, 110)
                    }
                    createNewMeasurement(e) {
                        return this.hasIncomplete = !0, {
                            visible: !0,
                            active: !0,
                            color: void 0,
                            invalidated: !0,
                            complete: !1,
                            value: "",
                            handles: {
                                start: {
                                    x: e.currentPoints.image.x,
                                    y: e.currentPoints.image.y,
                                    highlight: !0,
                                    active: !1
                                },
                                end: {
                                    x: e.currentPoints.image.x,
                                    y: e.currentPoints.image.y,
                                    highlight: !0,
                                    active: !0
                                },
                                start2: {
                                    x: e.currentPoints.image.x,
                                    y: e.currentPoints.image.y,
                                    highlight: !0,
                                    active: !1,
                                    drawnIndependently: !0
                                },
                                end2: {
                                    x: e.currentPoints.image.x + 1,
                                    y: e.currentPoints.image.y,
                                    highlight: !0,
                                    active: !1,
                                    drawnIndependently: !0
                                },
                                textBox: {
                                    active: !1,
                                    hasMoved: !1,
                                    movesIndependently: !1,
                                    drawnIndependently: !0,
                                    allowedOutsideImage: !0,
                                    hasBoundingBox: !0
                                }
                            }
                        }
                    }
                    pointNearTool(e, t, n, o) {
                        if (!1 === t.visible) return !1;
                        const r = "mouse" === o ? 15 : 25,
                            a = et(e, t.handles.start, t.handles.end, n) < r,
                            i = et(e, t.handles.start2, t.handles.end2, n) < r;
                        return a || i
                    }
                    updateCachedStats(e, t, n) {
                        const {
                            rowPixelSpacing: o,
                            colPixelSpacing: r
                        } = ot(e), a = (n.handles.start.x - n.handles.end.x) * (r || 1), i = (n.handles.start.y - n.handles.end.y) * (o || 1), s = (n.handles.start2.x - n.handles.end2.x) * (r || 1), l = (n.handles.start2.y - n.handles.end2.y) * (o || 1);
                        let c = Math.acos((a * s + i * l) / (Math.sqrt(a * a + i * i) * Math.sqrt(s * s + l * l)));
                        c *= 180 / Math.PI, n.rAngle = tt(c, 2), n.lAngle2 = tt(360 - c, 2), n.invalidated = !1
                    }
                    renderToolData(e) {
                        const t = e.detail,
                            {
                                handleRadius: n,
                                drawHandlesOnHover: o,
                                hideHandlesIfMoving: r,
                                renderDashed: a
                            } = this.configuration,
                            i = (0, c.getToolState)(e.currentTarget, this.name);
                        if (!i) return;
                        const s = Ye(t.canvasContext.canvas),
                            l = c.toolStyle.getToolWidth(),
                            u = (0, c.getModule)("globalConfiguration").configuration.lineDash,
                            d = c.textStyle.getFont(),
                            {
                                element: h
                            } = e.detail,
                            f = c.external.cornerstone.getEnabledElement(h).image,
                            {
                                rowPixelSpacing: m,
                                colPixelSpacing: g
                            } = ot(f);
                        for (let e = 0; e < i.data.length; e++) {
                            const f = i.data[e],
                                {
                                    start: v,
                                    end: y,
                                    start2: b,
                                    end2: w
                                } = f.handles;
                            !1 !== f.visible && (f.value || (f.value = this.textBoxText(f, m, g)), Ze(s, (e => {
                                Ke(e, this.configuration);
                                const i = c.toolColors.getColorIfActive(f),
                                    s = {
                                        color: i
                                    };
                                a && (s.lineDash = u), Xe(e, t.element, v, y, s);
                                const m = {
                                    color: i,
                                    lineWidth: l,
                                    lineDash: [2, 3]
                                };
                                if (f.active || !f.complete) {
                                    const {
                                        start: n,
                                        end: o
                                    } = at(t, v, y);
                                    Xe(e, h, n, o, m)
                                }
                                if (f.complete && (Xe(e, t.element, b, w, s), f.active)) {
                                    const {
                                        start: n,
                                        end: o
                                    } = at(t, b, w);
                                    Xe(e, h, n, o, m)
                                }
                                const g = {
                                    color: i,
                                    handleRadius: n,
                                    drawHandlesIfActive: o,
                                    hideHandlesIfMoving: r
                                };
                                this.configuration.drawHandles && f.active && Qe(e, t, f.handles, g), e.fillStyle = i;
                                const x = f.value;
                                if (!f.handles.textBox.hasMoved) {
                                    const t = {
                                        x: (v.x + y.x) / 2,
                                        y: (v.y + y.y) / 2 + 10
                                    };
                                    e.font = d, f.handles.textBox.x = t.x, f.handles.textBox.y = t.y
                                }
                                f.complete && Je(e, t.element, f.handles.textBox, x, f.handles, p, i, l, 0, !0)
                            })))
                        }

                        function p(e) {
                            return [e.start, e.start2, e.end, e.end2]
                        }
                    }
                    getIncomplete(e) {
                        const t = (0, c.getToolState)(e, this.name);
                        if (t && Array.isArray(t.data)) return t.data.find((({
                            complete: e
                        }) => !1 === e))
                    }
                    addNewMeasurement(e, t) {
                        e.preventDefault(), e.stopPropagation();
                        const n = e.detail;
                        let o, r, a = e => {
                            if (!e) return void(0, c.removeToolState)(i, this.name, o);
                            const t = c.EVENTS.MEASUREMENT_COMPLETED,
                                n = {
                                    toolName: this.name,
                                    toolType: this.name,
                                    element: i,
                                    measurementData: o
                                };
                            $e(i, t, n)
                        };
                        const i = e.detail.element,
                            s = this.getIncomplete(i);
                        s ? (o = s, o.complete = !0, o.handles.start2 = {
                            x: n.currentPoints.image.x,
                            y: n.currentPoints.image.y,
                            drawnIndependently: !1,
                            highlight: !0,
                            active: !1
                        }, o.handles.end2 = {
                            x: n.currentPoints.image.x,
                            y: n.currentPoints.image.y,
                            drawnIndependently: !1,
                            highlight: !0,
                            active: !0
                        }, r = o.handles.end2, this.hasIncomplete = !1, a = e => {
                            if (!e) return void(0, c.removeToolState)(i, this.name, o);
                            const t = c.EVENTS.MEASUREMENT_COMPLETED,
                                n = {
                                    toolName: this.name,
                                    toolType: this.name,
                                    element: i,
                                    measurementData: o
                                };
                            $e(i, t, n)
                        }) : (o = this.createNewMeasurement(n), (0, c.addToolState)(i, this.name, o), r = o.handles.end), c.external.cornerstone.updateImage(i), Ge(n, this.name, o, r, this.options, t, a)
                    }
                    onMeasureModified(e) {
                        const {
                            element: t
                        } = e.detail, n = c.external.cornerstone.getEnabledElement(t).image, {
                            rowPixelSpacing: o,
                            colPixelSpacing: r
                        } = ot(n);
                        if (e.detail.toolName !== this.name) return;
                        const a = e.detail.measurementData;
                        !0 === a.invalidated && (a.rAngle ? this.throttledUpdateCachedStats(n, t, a) : this.updateCachedStats(n, t, a)), a.value = this.textBoxText(a, o, r)
                    }
                    textBoxText({
                        rAngle: e,
                        lAngle2: t
                    }, n, o) {
                        if (void 0 === e) return "";
                        if (Number.isNaN(e)) return "";
                        const r = n && o ? "" : " (isotropic)";
                        return `${e}${r} (${t}${r})`
                    }
                    activeCallback(e) {
                        this.onMeasureModified = this.onMeasureModified.bind(this), e.addEventListener(c.EVENTS.MEASUREMENT_MODIFIED, this.onMeasureModified)
                    }
                    passiveCallback(e) {
                        this.onMeasureModified = this.onMeasureModified.bind(this), e.addEventListener(c.EVENTS.MEASUREMENT_MODIFIED, this.onMeasureModified)
                    }
                    enabledCallback(e) {
                        e.removeEventListener(c.EVENTS.MEASUREMENT_MODIFIED, this.onMeasureModified)
                    }
                    disabledCallback(e) {
                        e.removeEventListener(c.EVENTS.MEASUREMENT_MODIFIED, this.onMeasureModified)
                    }
                }), (0, c.addTool)(class extends ae {
                    constructor(e = {}) {
                        super(e, {
                            name: "Annotate",
                            supportedInteractionTypes: ["Mouse", "Touch"],
                            configuration: {
                                getTextCallback: ye,
                                changeTextCallback: be,
                                drawHandles: !0,
                                drawHandlesOnHover: !1,
                                hideHandlesIfMoving: !1,
                                allowEmptyLabel: !1
                            },
                            svgCursor: pe
                        }), this.preventNewMeasurement = !1
                    }
                    createNewMeasurement(e) {
                        return {
                            visible: !0,
                            active: !0,
                            color: void 0,
                            handles: {
                                end: {
                                    x: e.detail.currentPoints.image.x,
                                    y: e.detail.currentPoints.image.y,
                                    highlight: !0,
                                    active: !0
                                },
                                textBox: {
                                    active: !1,
                                    hasMoved: !1,
                                    movesIndependently: !1,
                                    drawnIndependently: !0,
                                    allowedOutsideImage: !0,
                                    hasBoundingBox: !0
                                }
                            }
                        }
                    }
                    pointNearTool(e, t, n, o) {
                        const r = t && t.handles && t.handles.end;
                        if (r || ve.warn(`invalid parameters supplied to tool ${this.name}'s pointNearTool`), !r || !1 === t.visible) return !1;
                        const a = c.external.cornerstone.pixelToCanvas(e, t.handles.end),
                            i = "mouse" === o ? 15 : 25;
                        return c.external.cornerstoneMath.point.distance(a, n) < i
                    }
                    updateCachedStats() {}
                    renderToolData(e) {
                        const {
                            element: t,
                            enabledElement: n
                        } = e.detail, {
                            handleRadius: o,
                            drawHandlesOnHover: r,
                            hideHandlesIfMoving: a
                        } = this.configuration, i = (0, c.getToolState)(t, this.name);
                        if (!i) return;
                        const s = e.detail.canvasContext.canvas,
                            l = de(s),
                            u = c.toolStyle.getToolWidth();
                        for (let s = 0; s < i.data.length; s++) {
                            const f = i.data[s];
                            !1 !== f.visible && he(l, (i => {
                                fe(i, this.configuration);
                                const s = c.toolColors.getColorIfActive(f),
                                    l = c.external.cornerstone.pixelToCanvas(t, f.handles.end),
                                    m = {
                                        color: s,
                                        handleRadius: o,
                                        drawHandlesIfActive: r,
                                        hideHandlesIfMoving: a
                                    };
                                this.configuration.drawHandles && me(i, e.detail, f.handles, m);
                                const g = d(f);
                                if (g && "" !== g) {
                                    const e = ge(i, g, 5),
                                        o = c.textStyle.getFontSize() + 10;
                                    let r = Math.max(e, o) / 2 + 5;
                                    if (!f.handles.textBox.hasMoved) {
                                        let t = {
                                            x: l.x - e / 2 + r,
                                            y: l.y - o / 2
                                        };
                                        const a = c.external.cornerstone.internal.getTransform(n);
                                        a.invert();
                                        const i = a.transformPoint(t.x, t.y);
                                        f.handles.textBox.x = i.x, f.handles.textBox.y = i.y
                                    }
                                    ue(i, t, f.handles.textBox, g, f.handles, h, s, u, 0, !1)
                                }
                            }))
                        }

                        function d(e) {
                            return e.text
                        }

                        function h(e) {
                            return [e.end]
                        }
                    }
                    addNewMeasurement(e, t) {
                        const n = e.detail.element,
                            o = this.createNewMeasurement(e),
                            {
                                allowEmptyLabel: r
                            } = this.configuration;
                        (0, c.addToolState)(n, this.name, o), c.external.cornerstone.updateImage(n), ie(e.detail, this.name, o, o.handles.end, this.options, t, (t => {
                            t ? void 0 === o.text && this.configuration.getTextCallback((e => {
                                if (e || r) {
                                    o.text = e, o.active = !1;
                                    const t = {
                                        toolName: this.name,
                                        toolType: this.name,
                                        element: n,
                                        measurementData: o
                                    };
                                    c.external.cornerstone.updateImage(n), le(n, c.EVENTS.MEASUREMENT_COMPLETED, t)
                                } else(0, c.removeToolState)(n, this.name, o)
                            }), e.detail) : (0, c.removeToolState)(n, this.name, o), c.external.cornerstone.updateImage(n)
                        }))
                    }
                    doubleClickCallback(e) {
                        return this._updateTextForNearbyAnnotation(e, "mouse")
                    }
                    touchPressCallback(e) {
                        return this._updateTextForNearbyAnnotation(e, "touch")
                    }
                    _updateTextForNearbyAnnotation(e, t) {
                        const n = e.detail.element,
                            o = e.detail.currentPoints.canvas,
                            r = (0, c.getToolState)(n, this.name);
                        if (!r) return !1;
                        for (let a = 0; a < r.data.length; a++) {
                            const i = r.data[a];
                            if (this.pointNearTool(n, i, o, t) || se(i.handles.textBox, o)) return i.active = !0, c.external.cornerstone.updateImage(n), this.configuration.changeTextCallback(i, e.detail, this._doneChangingTextCallback.bind(this, n, i)), e.stopImmediatePropagation(), e.preventDefault(), e.stopPropagation(), !0
                        }
                    }
                    _doneChangingTextCallback(e, t, n, o) {
                        !0 === o ? (0, c.removeToolState)(e, this.name, t) : t.text = n, t.active = !1, c.external.cornerstone.updateImage(e), le(e, c.EVENTS.MEASUREMENT_MODIFIED, {
                            toolName: this.name,
                            toolType: this.name,
                            element: e,
                            measurementData: t
                        })
                    }
                }), (0, c.addTool)(class extends Gt {
                    constructor(e = {}) {
                        super(e, {
                            name: "ScaleOverlay",
                            configuration: {
                                minorTickLength: 14,
                                majorTickLength: 24
                            },
                            mixins: ["enabledOrDisabledBinaryTool"]
                        })
                    }
                    enabledCallback(e) {
                        this.forceImageUpdate(e)
                    }
                    disabledCallback(e) {
                        this.forceImageUpdate(e)
                    }
                    forceImageUpdate(e) {
                        c.external.cornerstone.getEnabledElement(e).image && c.external.cornerstone.updateImage(e)
                    }
                    renderToolData(e) {
                        const t = e.detail,
                            n = Zt(t.canvasContext.canvas),
                            {
                                image: o,
                                viewport: r,
                                element: a
                            } = t,
                            {
                                rowPixelSpacing: i,
                                colPixelSpacing: s
                            } = Yt(o);
                        if (!i || !s) return void $t.warn(`unable to define rowPixelSpacing or colPixelSpacing from data on ${this.name}'s renderToolData`);
                        const l = n.canvas.width,
                            u = n.canvas.height;
                        if (l < 200 || u < 200) return;
                        const d = 10 / i * r.scale,
                            h = 10 / s * r.scale,
                            f = {
                                topLeft: {
                                    x: 60,
                                    y: u - 26
                                },
                                bottomRight: {
                                    x: l - 150,
                                    y: u - 26
                                }
                            },
                            m = {
                                topLeft: {
                                    x: l - 34,
                                    y: 74
                                },
                                bottomRight: {
                                    x: l - 30,
                                    y: u - 114
                                }
                            };
                        if (!(l && u && f && m)) return;
                        const g = c.toolColors.getToolColor(),
                            p = c.toolStyle.getToolWidth(),
                            v = Object.assign({}, {
                                hscaleBounds: f,
                                vscaleBounds: m,
                                verticalMinorTick: d,
                                horizontalMinorTick: h,
                                verticalLine: {
                                    start: {
                                        x: m.bottomRight.x,
                                        y: m.topLeft.y
                                    },
                                    end: {
                                        x: m.bottomRight.x,
                                        y: m.bottomRight.y
                                    }
                                },
                                horizontalLine: {
                                    start: {
                                        x: f.topLeft.x,
                                        y: f.bottomRight.y
                                    },
                                    end: {
                                        x: f.bottomRight.x,
                                        y: f.bottomRight.y
                                    }
                                },
                                color: g,
                                lineWidth: p
                            }, this.configuration);
                        Kt(n, (e => {
                            Xt(e, v), Jt(e, a, v.verticalLine.start, v.verticalLine.end, {
                                color: v.color,
                                lineWidth: v.lineWidth
                            }, "canvas"), en(e, a, v), Jt(e, a, v.horizontalLine.start, v.horizontalLine.end, {
                                color: v.color,
                                lineWidth: v.lineWidth
                            }, "canvas"), tn(e, a, v)
                        }))
                    }
                }), (0, c.addTool)(class extends A {
                    constructor() {
                        super({
                            markerFlag: "L"
                        })
                    }
                }), (0, c.addTool)(class extends A {
                    constructor() {
                        super({
                            markerFlag: "R"
                        })
                    }
                }), (0, c.addTool)(class extends C {
                    constructor(e = {}) {
                        super(e, {
                            name: "Heartratio",
                            supportedInteractionTypes: ["Mouse", "Touch"],
                            svgCursor: V,
                            configuration: {
                                drawHandles: !0,
                                drawHandlesOnHover: !1,
                                hideHandlesIfMoving: !1,
                                renderDashed: !1
                            }
                        }), this.throttledUpdateCachedStats = N(this.updateCachedStats, 110)
                    }
                    createNewMeasurement(e) {
                        const {
                            currentPoints: {
                                image: t
                            },
                            image: n
                        } = e || {
                            currentPoints: {}
                        };
                        if (!t) return void B.error(`required eventData not supplied to tool ${this.name}'s createNewMeasurement`);
                        const {
                            x: o,
                            y: r
                        } = t, {
                            columns: a,
                            rows: i
                        } = n || {};
                        return {
                            visible: !0,
                            active: !0,
                            color: void 0,
                            invalidated: !0,
                            handles: {
                                start: {
                                    x: o,
                                    y: r,
                                    highlight: !0,
                                    active: !1
                                },
                                end: {
                                    x: o,
                                    y: r,
                                    highlight: !0,
                                    active: !0
                                },
                                start2: {
                                    x: .6 * o,
                                    y: Math.min(1.35 * r, .9 * i),
                                    highlight: !0,
                                    active: !1
                                },
                                end2: {
                                    x: Math.min(1.75 * o, a),
                                    y: Math.min(1.35 * r, .9 * i),
                                    highlight: !0,
                                    active: !0
                                },
                                start3: {
                                    x: 0,
                                    y: 0,
                                    drawnIndependently: !0,
                                    highlight: !1,
                                    active: !1
                                },
                                end3: {
                                    x: 0,
                                    y: 0,
                                    drawnIndependently: !0,
                                    highlight: !1,
                                    active: !1
                                },
                                textBox: {
                                    active: !1,
                                    hasMoved: !1,
                                    movesIndependently: !1,
                                    drawnIndependently: !0,
                                    allowedOutsideImage: !0,
                                    hasBoundingBox: !0
                                }
                            }
                        }
                    }
                    pointNearTool(e, t, n, o) {
                        if (!((null == t ? void 0 : t.handles.start) && (null == t ? void 0 : t.handles.end))) return B.warn(`invalid parameters supplied to tool ${this.name}'s pointNearTool`), !1;
                        if (!1 === t.visible) return !1;
                        const r = "mouse" === o ? 15 : 25;
                        return O(e, t.handles.start, t.handles.end, n) < r || O(e, t.handles.start2, t.handles.end2, n) < r || O(e, t.handles.start3, t.handles.end3, n) < r
                    }
                    updateCachedStats(e, t, n) {
                        const {
                            rowPixelSpacing: o,
                            colPixelSpacing: r
                        } = U(e), {
                            start: a,
                            end: i,
                            start2: s,
                            end2: l
                        } = n.handles, c = Math.abs(i.x - a.x) * (r || 1), u = Math.abs(l.x - s.x) * (o || 1), d = c > u ? u / c : c / u;
                        n.ratio = d, n.handles.start3.x = (a.x + i.x) / 2, n.handles.start3.y = (a.y + i.y) / 2, n.handles.end3.x = (s.x + l.x) / 2, n.handles.end3.y = (s.y + l.y) / 2, n.invalidated = !1
                    }
                    renderToolData(e) {
                        const t = e.detail,
                            {
                                handleRadius: n,
                                drawHandlesOnHover: o,
                                hideHandlesIfMoving: r,
                                renderDashed: a
                            } = this.configuration,
                            i = (0, c.getToolState)(e.currentTarget, this.name);
                        if (!i) return;
                        const s = M(t.canvasContext.canvas),
                            {
                                image: l,
                                element: u
                            } = t,
                            d = c.toolStyle.getToolWidth(),
                            h = (0, c.getModule)("globalConfiguration").configuration.lineDash;
                        for (let e = 0; e < i.data.length; e++) {
                            const m = i.data[e],
                                {
                                    handles: {
                                        start: g,
                                        end: p,
                                        start2: v,
                                        end2: y,
                                        start3: b,
                                        end3: w
                                    }
                                } = m;
                            !1 !== m.visible && D(s, (e => {
                                P(e, this.configuration);
                                const i = c.toolColors.getColorIfActive(m),
                                    s = {
                                        color: i,
                                        lineDash: void 0
                                    };
                                a && (s.lineDash = h), k(e, u, g, p, s), k(e, u, v, y, s), k(e, u, b, w, Object.assign(Object.assign({}, s), {
                                    lineDash: h
                                }));
                                const x = {
                                    color: i,
                                    handleRadius: n,
                                    drawHandlesIfActive: o,
                                    hideHandlesIfMoving: r
                                };
                                if (this.configuration.drawHandles && m.active && L(e, t, m.handles, x), !m.handles.textBox.hasMoved) {
                                    const e = {
                                        x: (b.x + w.x) / 2,
                                        y: (b.y + w.y) / 2
                                    };
                                    m.handles.textBox.x = e.x, m.handles.textBox.y = e.y
                                }!0 === m.invalidated && (m.ratio ? this.throttledUpdateCachedStats(l, u, m) : this.updateCachedStats(l, u, m)), _(e, u, m.handles.textBox, `Ratio:${m.ratio.toFixed(3)}`, m.handles, f, i, d, 5, !0)
                            }))
                        }

                        function f(e) {
                            const {
                                start: t,
                                end: n,
                                start2: o,
                                end2: r,
                                start3: a,
                                end3: i
                            } = e;
                            return [{
                                x: (a.x + i.x) / 2,
                                y: (a.y + i.y) / 2
                            }, t, n, o, r]
                        }
                    }
                }), (0, c.addTool)(class extends zn {
                    constructor(e = {}) {
                        super(e, {
                            name: "ProbeCT",
                            supportedInteractionTypes: ["Mouse", "Touch"],
                            svgCursor: to,
                            configuration: {
                                drawHandles: !0,
                                renderDashed: !1
                            }
                        }), this.throttledUpdateCachedStats = eo(this.updateCachedStats, 110)
                    }
                    createNewMeasurement(e) {
                        if (!(e && e.currentPoints && e.currentPoints.image)) return void no.error(`required eventData not supplied to tool ${this.name}'s createNewMeasurement`);
                        const {
                            x: t,
                            y: n
                        } = e.currentPoints.image;
                        return {
                            visible: !0,
                            active: !0,
                            color: void 0,
                            invalidated: !0,
                            handles: {
                                end: {
                                    x: t,
                                    y: n,
                                    highlight: !0,
                                    active: !0
                                },
                                textBox: {
                                    active: !1,
                                    hasMoved: !1,
                                    movesIndependently: !1,
                                    drawnIndependently: !0,
                                    allowedOutsideImage: !0,
                                    hasBoundingBox: !0
                                }
                            }
                        }
                    }
                    pointNearTool(e, t, n, o) {
                        const r = t && t.handles && t.handles.end;
                        if (r || no.warn(`invalid parameters supplied to tool ${this.name}'s pointNearTool`), !r || !1 === t.visible) return !1;
                        const a = "mouse" === o ? 15 : 25,
                            i = c.external.cornerstone.pixelToCanvas(e, t.handles.end);
                        return c.external.cornerstoneMath.point.distance(i, n) < a
                    }
                    updateCachedStats(e, t, n) {
                        const o = Math.round(n.handles.end.x),
                            r = Math.round(n.handles.end.y),
                            a = {};
                        o >= 0 && r >= 0 && o < e.columns && r < e.rows && (a.x = o, a.y = r, e.color ? a.storedPixels = Jn(t, o, r, 1, 1) : (a.storedPixels = c.external.cornerstone.getStoredPixels(t, o, r, 1, 1), a.sp = a.storedPixels[0], a.mo = a.sp * e.slope + e.intercept, a.suv = Qn(e, a.sp))), n.cachedStats = a, n.invalidated = !1
                    }
                    renderToolData(e) {
                        const t = e.detail,
                            {
                                handleRadius: n,
                                renderDashed: o
                            } = this.configuration,
                            r = (0, c.getToolState)(e.currentTarget, this.name);
                        if (!r) return;
                        const a = Gn(t.canvasContext.canvas),
                            {
                                image: i,
                                element: s
                            } = t,
                            l = (0, c.getModule)("globalConfiguration").configuration.lineDash;
                        for (let e = 0; e < r.data.length; e++) {
                            const u = r.data[e];
                            !1 !== u.visible && Yn(a, (e => {
                                const r = c.toolColors.getColorIfActive(u);
                                if (this.configuration.drawHandles) {
                                    const a = {
                                        handleRadius: n,
                                        color: r
                                    };
                                    o && (a.lineDash = l), Zn(e, t, u.handles, a)
                                }!0 === u.invalidated && (u.cachedStats ? this.throttledUpdateCachedStats(i, s, u) : this.updateCachedStats(i, s, u));
                                let a, d = [];
                                const {
                                    x: h,
                                    y: f,
                                    storedPixels: m,
                                    sp: g,
                                    mo: p,
                                    suv: v
                                } = u.cachedStats;
                                if (h >= 0 && f >= 0 && h < i.columns && f < i.rows) {
                                    if (a = `X: ${h}, Y: ${f}`, i.color ? d.push(`R: ${m[0]} G: ${m[1]} B: ${m[2]}`) : (d.push(`SP: ${g} HU`), d.push(`MO: ${parseFloat(p.toFixed(3))} HU`), v && d.push(` SUV: ${parseFloat(v.toFixed(3))} HU`)), !u.handles.textBox.hasMoved) {
                                        const e = {
                                            x: u.handles.end.x,
                                            y: u.handles.end.y
                                        };
                                        u.handles.textBox.x = e.x, u.handles.textBox.y = e.y
                                    }
                                    const t = c.toolStyle.getToolWidth();
                                    Kn(e, s, u.handles.textBox, [a, ...d], u.handles, (() => [{
                                        x: u.handles.end.x,
                                        y: u.handles.end.y
                                    }]), r, t, 10, !0)
                                }
                            }))
                        }
                    }
                    addNewMeasurement(e, t) {
                        e.preventDefault(), e.stopPropagation();
                        const n = e.detail,
                            o = n.element,
                            r = this.createNewMeasurement(n);
                        r && ((0, c.addToolState)(o, this.name, r), c.external.cornerstone.updateImage(o), Wn(n, this.name, r, r.handles.end, this.options, t, (e => {
                            if (e) {
                                const e = c.EVENTS.MEASUREMENT_COMPLETED,
                                    t = {
                                        toolName: this.name,
                                        toolType: this.name,
                                        element: o,
                                        measurementData: r
                                    };
                                Xn(o, e, t)
                            } else(0, c.removeToolState)(o, this.name, r)
                        })))
                    }
                }), (0, c.addTool)(class extends je {
                    constructor(e = {}) {
                        super(e, {
                            name: "BlurAndSharpen",
                            mixins: ["enabledOrDisabledBinaryTool"]
                        }), this.updateCavansLazy = ze(this.updateCavans, 300, {})
                    }
                    updateCavans(e) {
                        return qe(this, void 0, void 0, (function*() {
                            const t = e.detail,
                                {
                                    element: n,
                                    viewport: o,
                                    canvasContext: r
                                } = t,
                                {
                                    blur: i,
                                    sharpen: s
                                } = o;
                            if (t && (i || s)) {
                                if (!this.isCleanCanvas()) return vo("transparent"), void(0, a.updateImage)(n);
                                try {
                                    const e = r.canvas.width,
                                        o = r.canvas.height,
                                        l = r.getImageData(0, 0, e, o),
                                        c = i ? yield Ue.webWorkerManager.addTask("opencvDecode", {
                                            imageData: l,
                                            info: {
                                                kernelType: "blur",
                                                sigma: i
                                            }
                                        }).promise: l, u = s ? yield Ue.webWorkerManager.addTask("opencvDecode", {
                                            imageData: c,
                                            info: {
                                                kernelType: "sharpen",
                                                sigma: s
                                            }
                                        }).promise: c;
                                    r.putImageData(u, 0, 0), this.mode = "disabled", po(), (0, a.triggerEvent)(n, a.EVENTS.IMAGE_RENDERED, t), yield(0, Be.uk)(), this.mode = "enabled"
                                } catch (e) {
                                    console.error(e), void 0 === e && He().error({
                                        title: (0, H.Tl)("toast.unModule")
                                    })
                                }
                            }
                        }))
                    }
                    enabledCallback(e) {
                        this.forceImageUpdate(e)
                    }
                    disabledCallback(e) {
                        this.forceImageUpdate(e)
                    }
                    forceImageUpdate(e) {
                        c.external.cornerstone.getEnabledElement(e).image && c.external.cornerstone.updateImage(e)
                    }
                    isCleanCanvas() {
                        return "transparent" === c.toolColors.getToolColor()
                    }
                    renderToolData(e) {
                        if (this.isCleanCanvas()) return this.updateCavans(e);
                        this.updateCavansLazy(e)
                    }
                }), (0, c.addTool)(class extends d {
                    constructor(e = {}) {
                        super(e, {
                            name: "AI",
                            supportedInteractionTypes: ["Mouse", "Touch"],
                            configuration: {
                                drawHandles: !0,
                                drawHandlesOnHover: !1,
                                hideHandlesIfMoving: !1,
                                renderDashed: !1
                            }
                        })
                    }
                    activeCallback(e) {
                        this.forceImageUpdate(e)
                    }
                    passiveCallback(e) {
                        this.forceImageUpdate(e)
                    }
                    enabledCallback(e) {
                        this.forceImageUpdate(e)
                    }
                    disabledCallback(e) {
                        this.forceImageUpdate(e)
                    }
                    forceImageUpdate(e) {
                        c.external.cornerstone.getEnabledElement(e).image && c.external.cornerstone.updateImage(e)
                    }
                    createNewMeasurement() {}
                    updateCachedStats() {}
                    pointNearTool(e, t, n, o) {
                        const r = t && t.handles && t.handles.start && t.handles.end;
                        if (r || v.warn(`invalid parameters supplied to tool ${this.name}'s pointNearTool`), !r || !1 === t.visible) return !1;
                        const a = "mouse" === o ? 15 : 25,
                            i = c.external.cornerstone.pixelToCanvas(e, t.handles.start),
                            s = c.external.cornerstone.pixelToCanvas(e, t.handles.end),
                            l = {
                                left: Math.min(i.x, s.x),
                                top: Math.min(i.y, s.y),
                                width: Math.abs(i.x - s.x),
                                height: Math.abs(i.y - s.y)
                            },
                            u = c.external.cornerstoneMath.rect.distanceToPoint(l, n);
                        return t.handles.disable = u < a, t.handles.disable
                    }
                    renderToolData(e) {
                        let t = (0, c.getToolState)(e.currentTarget, this.name);
                        const {
                            seriesUID: n,
                            currentImageIdIndex: o
                        } = e.currentTarget.dataset;
                        if (!t) {
                            const r = u.RF.get(`${n}?index=${o}`);
                            if (!r) return;
                            t = {
                                data: r
                            }, r.forEach(((n, o) => {
                                o >= 1 && c.external.cornerstoneMath.point.distance(n.handles.textBox, t.data[o - 1].handles.textBox) < 100 && (n.textBoxPointsCompute = !0), (0, c.addToolState)(e.currentTarget, this.name, n)
                            }))
                        }
                        const r = e.detail,
                            {
                                image: a,
                                element: i
                            } = r,
                            s = c.toolStyle.getToolWidth(),
                            l = (0, c.getModule)("globalConfiguration").configuration.lineDash,
                            {
                                handleRadius: d,
                                drawHandlesOnHover: p,
                                hideHandlesIfMoving: v,
                                renderDashed: y
                            } = this.configuration,
                            b = h(r.canvasContext.canvas);
                        f(b, (e => {
                            for (let n = 0; n < t.data.length; n++) {
                                const o = t.data[n],
                                    r = c.toolColors.getColorIfActive(o),
                                    u = {
                                        color: r,
                                        handleRadius: d,
                                        drawHandlesIfActive: p,
                                        hideHandlesIfMoving: v
                                    };
                                y && ({
                                    color: r
                                }.lineDash = l), m(e, i, o.handles.start, o.handles.end, u, "pixel");
                                const h = e => [e.start, e.end];
                                if (o.textBoxPointsCompute) {
                                    const [e, t] = [200, 150], r = a.height - t, i = a.width - e;
                                    let s = {
                                        x: 0,
                                        y: 0
                                    };
                                    switch (n) {
                                        case 2:
                                            s = {
                                                x: i,
                                                y: 0
                                            };
                                            break;
                                        case 3:
                                            s = {
                                                x: 0,
                                                y: r
                                            };
                                            break;
                                        case 4:
                                            s = {
                                                x: i,
                                                y: r
                                            }
                                    }
                                    o.handles.textBox = Object.assign(Object.assign({}, o.handles.textBox), s), o.textBoxPointsCompute = !1
                                }
                                g(e, i, o.handles.textBox, o.textBoxContent, o.handles, h, r, s, 20, !1)
                            }
                        }))
                    }
                }), (0, c.addTool)(c.OrientationMarkersTool), (0, c.addTool)(c.ZoomTool, go), (0, c.addTool)(class extends jn {
                    constructor(e = {}) {
                        super(e, {
                            name: "PersistentSate",
                            configuration: {},
                            mixins: ["enabledOrDisabledBinaryTool"]
                        }), this.state = "disabled"
                    }
                    enabledCallback() {
                        this.state = "enabled"
                    }
                    disabledCallback() {
                        this.state = "disabled"
                    }
                }), lt.A.isMobile ? ((0, c.addTool)(c.ZoomTouchPinchTool, go), (0, c.addTool)(c.PanMultiTouchTool)) : (0, c.addTool)(c.StackScrollMouseWheelTool), (0, uo.q)(!0), c.toolColors.setToolColor(ho), c.store.state.clickProximity = 20, c.store.state.touchProximity = 30, c.store.state.handleRadius = 8, (0, it.G7)("ScaleOverlay"), (0, it.G7)("OrientationMarkers"), (0, it.G7)("BlurAndSharpen"), lt.A.isMobile ? ((0, it.fO)("ZoomTouchPinch", {}), (0, it.fO)("PanMultiTouch", {})) : ((0, it.fO)("StackScrollMouseWheel", {}), (0, it.fO)("Wwwc", {
                    mouseButtonMask: 2
                }), (0, it.fO)("Pan", {
                    mouseButtonMask: 4
                }))
            },
            7522: (e, t, n) => {
                "use strict";
                n.d(t, {
                    A: () => d,
                    N: () => u
                });
                var o = n(4594),
                    r = n(346),
                    a = n.n(r),
                    i = n(2290),
                    s = n(8398),
                    l = function(e, t, n, o) {
                        return new(n || (n = Promise))((function(r, a) {
                            function i(e) {
                                try {
                                    l(o.next(e))
                                } catch (e) {
                                    a(e)
                                }
                            }

                            function s(e) {
                                try {
                                    l(o.throw(e))
                                } catch (e) {
                                    a(e)
                                }
                            }

                            function l(e) {
                                var t;
                                e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                                    e(t)
                                }))).then(i, s)
                            }
                            l((o = o.apply(e, t || [])).next())
                        }))
                    };
                class c {
                    constructor(e) {
                        this.iziToast = a(), this.options = Object.assign({
                            message: void 0,
                            position: "center",
                            class: o.A.isMobile ? "custom-iziToast-mobile" : "custom-iziToast",
                            close: !1,
                            theme: "dark",
                            overlay: !0,
                            image: n(1972),
                            timeout: !1,
                            progressBar: !1,
                            onOpening: (e, t) => {
                                (0, i._)(t)
                            }
                        }, e), this.loading = !1
                    }
                    show(e) {
                        this.loading || (this.loading = !0, a().show(Object.assign(Object.assign({}, this.options), e)))
                    }
                    progress(e) {
                        return l(this, void 0, void 0, (function*() {
                            return yield(0, s.uk)(), a().progress(Object.assign({}, e), this.$toast())
                        }))
                    }
                    hidden() {
                        this.loading && (this.loading = !1, a().hide({}, `.${this.options.class}`))
                    }
                    updateMessage(e) {
                        this.messageEl = this.messageEl || this.$toast().querySelector(".iziToast-message"), this.messageEl.innerHTML = e
                    }
                    customProgress(e) {
                        this.progressBar = this.progressBar || this.$toast().querySelector(".iziToast-progressbar div"), this.progressBar.style.width = 100 * e + "%"
                    }
                    $toast() {
                        return document.querySelector("." + this.options.class)
                    }
                }
                const u = new c,
                    d = c
            },
            7720: (e, t, n) => {
                "use strict";
                var o = n(4765),
                    r = Object.prototype.hasOwnProperty,
                    a = Array.isArray,
                    i = function() {
                        for (var e = [], t = 0; t < 256; ++t) e.push("%" + ((t < 16 ? "0" : "") + t.toString(16)).toUpperCase());
                        return e
                    }(),
                    s = function(e, t) {
                        for (var n = t && t.plainObjects ? {
                                __proto__: null
                            } : {}, o = 0; o < e.length; ++o) void 0 !== e[o] && (n[o] = e[o]);
                        return n
                    },
                    l = 1024;
                e.exports = {
                    arrayToObject: s,
                    assign: function(e, t) {
                        return Object.keys(t).reduce((function(e, n) {
                            return e[n] = t[n], e
                        }), e)
                    },
                    combine: function(e, t) {
                        return [].concat(e, t)
                    },
                    compact: function(e) {
                        for (var t = [{
                                obj: {
                                    o: e
                                },
                                prop: "o"
                            }], n = [], o = 0; o < t.length; ++o)
                            for (var r = t[o], i = r.obj[r.prop], s = Object.keys(i), l = 0; l < s.length; ++l) {
                                var c = s[l],
                                    u = i[c];
                                "object" == typeof u && null !== u && -1 === n.indexOf(u) && (t.push({
                                    obj: i,
                                    prop: c
                                }), n.push(u))
                            }
                        return function(e) {
                            for (; e.length > 1;) {
                                var t = e.pop(),
                                    n = t.obj[t.prop];
                                if (a(n)) {
                                    for (var o = [], r = 0; r < n.length; ++r) void 0 !== n[r] && o.push(n[r]);
                                    t.obj[t.prop] = o
                                }
                            }
                        }(t), e
                    },
                    decode: function(e, t, n) {
                        var o = e.replace(/\+/g, " ");
                        if ("iso-8859-1" === n) return o.replace(/%[0-9a-f]{2}/gi, unescape);
                        try {
                            return decodeURIComponent(o)
                        } catch (e) {
                            return o
                        }
                    },
                    encode: function(e, t, n, r, a) {
                        if (0 === e.length) return e;
                        var s = e;
                        if ("symbol" == typeof e ? s = Symbol.prototype.toString.call(e) : "string" != typeof e && (s = String(e)), "iso-8859-1" === n) return escape(s).replace(/%u[0-9a-f]{4}/gi, (function(e) {
                            return "%26%23" + parseInt(e.slice(2), 16) + "%3B"
                        }));
                        for (var c = "", u = 0; u < s.length; u += l) {
                            for (var d = s.length >= l ? s.slice(u, u + l) : s, h = [], f = 0; f < d.length; ++f) {
                                var m = d.charCodeAt(f);
                                45 === m || 46 === m || 95 === m || 126 === m || m >= 48 && m <= 57 || m >= 65 && m <= 90 || m >= 97 && m <= 122 || a === o.RFC1738 && (40 === m || 41 === m) ? h[h.length] = d.charAt(f) : m < 128 ? h[h.length] = i[m] : m < 2048 ? h[h.length] = i[192 | m >> 6] + i[128 | 63 & m] : m < 55296 || m >= 57344 ? h[h.length] = i[224 | m >> 12] + i[128 | m >> 6 & 63] + i[128 | 63 & m] : (f += 1, m = 65536 + ((1023 & m) << 10 | 1023 & d.charCodeAt(f)), h[h.length] = i[240 | m >> 18] + i[128 | m >> 12 & 63] + i[128 | m >> 6 & 63] + i[128 | 63 & m])
                            }
                            c += h.join("")
                        }
                        return c
                    },
                    isBuffer: function(e) {
                        return !(!e || "object" != typeof e) && !!(e.constructor && e.constructor.isBuffer && e.constructor.isBuffer(e))
                    },
                    isRegExp: function(e) {
                        return "[object RegExp]" === Object.prototype.toString.call(e)
                    },
                    maybeMap: function(e, t) {
                        if (a(e)) {
                            for (var n = [], o = 0; o < e.length; o += 1) n.push(t(e[o]));
                            return n
                        }
                        return t(e)
                    },
                    merge: function e(t, n, o) {
                        if (!n) return t;
                        if ("object" != typeof n && "function" != typeof n) {
                            if (a(t)) t.push(n);
                            else {
                                if (!t || "object" != typeof t) return [t, n];
                                (o && (o.plainObjects || o.allowPrototypes) || !r.call(Object.prototype, n)) && (t[n] = !0)
                            }
                            return t
                        }
                        if (!t || "object" != typeof t) return [t].concat(n);
                        var i = t;
                        return a(t) && !a(n) && (i = s(t, o)), a(t) && a(n) ? (n.forEach((function(n, a) {
                            if (r.call(t, a)) {
                                var i = t[a];
                                i && "object" == typeof i && n && "object" == typeof n ? t[a] = e(i, n, o) : t.push(n)
                            } else t[a] = n
                        })), t) : Object.keys(n).reduce((function(t, a) {
                            var i = n[a];
                            return r.call(t, a) ? t[a] = e(t[a], i, o) : t[a] = i, t
                        }), i)
                    }
                }
            },
            7800: (e, t, n) => {
                "use strict";
                n.d(t, {
                    A: () => r
                });
                var o = n(3145);

                function r(e, t) {
                    if (e) {
                        if ("string" == typeof e) return (0, o.A)(e, t);
                        var n = {}.toString.call(e).slice(8, -1);
                        return "Object" === n && e.constructor && (n = e.constructor.name), "Map" === n || "Set" === n ? Array.from(e) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? (0, o.A)(e, t) : void 0
                    }
                }
            },
            7869: e => {
                /*! cornerstone-math - 0.1.10 - 2022-06-09 | (c) 2017 Chris Hafey | https://github.com/cornerstonejs/cornerstoneMath */
                window,
                e.exports = function(e) {
                    var t = {};

                    function n(o) {
                        if (t[o]) return t[o].exports;
                        var r = t[o] = {
                            i: o,
                            l: !1,
                            exports: {}
                        };
                        return e[o].call(r.exports, r, r.exports, n), r.l = !0, r.exports
                    }
                    return n.m = e, n.c = t, n.d = function(e, t, o) {
                        n.o(e, t) || Object.defineProperty(e, t, {
                            enumerable: !0,
                            get: o
                        })
                    }, n.r = function(e) {
                        "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {
                            value: "Module"
                        }), Object.defineProperty(e, "__esModule", {
                            value: !0
                        })
                    }, n.t = function(e, t) {
                        if (1 & t && (e = n(e)), 8 & t) return e;
                        if (4 & t && "object" == typeof e && e && e.__esModule) return e;
                        var o = Object.create(null);
                        if (n.r(o), Object.defineProperty(o, "default", {
                                enumerable: !0,
                                value: e
                            }), 2 & t && "string" != typeof e)
                            for (var r in e) n.d(o, r, function(t) {
                                return e[t]
                            }.bind(null, r));
                        return o
                    }, n.n = function(e) {
                        var t = e && e.__esModule ? function() {
                            return e.default
                        } : function() {
                            return e
                        };
                        return n.d(t, "a", t), t
                    }, n.o = function(e, t) {
                        return Object.prototype.hasOwnProperty.call(e, t)
                    }, n.p = "", n(n.s = 4)
                }([function(e, t, n) {
                    "use strict";
                    Object.defineProperty(t, "__esModule", {
                        value: !0
                    });
                    var o = function() {
                            function e(e, t) {
                                for (var n = 0; n < t.length; n++) {
                                    var o = t[n];
                                    o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o)
                                }
                            }
                            return function(t, n, o) {
                                return n && e(t.prototype, n), o && e(t, o), t
                            }
                        }(),
                        r = function(e) {
                            return e && e.__esModule ? e : {
                                default: e
                            }
                        }(n(2)),
                        a = n(1),
                        i = function() {
                            function e(t, n, o) {
                                ! function(e, t) {
                                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                                }(this, e), this.x = t || 0, this.y = n || 0, this.z = o || 0
                            }
                            return o(e, [{
                                key: "set",
                                value: function(e, t, n) {
                                    return this.x = e, this.y = t, this.z = n, this
                                }
                            }, {
                                key: "setX",
                                value: function(e) {
                                    return this.x = e, this
                                }
                            }, {
                                key: "setY",
                                value: function(e) {
                                    return this.y = e, this
                                }
                            }, {
                                key: "setZ",
                                value: function(e) {
                                    return this.z = e, this
                                }
                            }, {
                                key: "setComponent",
                                value: function(e, t) {
                                    switch (e) {
                                        case 0:
                                            this.x = t;
                                            break;
                                        case 1:
                                            this.y = t;
                                            break;
                                        case 2:
                                            this.z = t;
                                            break;
                                        default:
                                            throw new Error("index is out of range: " + e)
                                    }
                                }
                            }, {
                                key: "getComponent",
                                value: function(e) {
                                    switch (e) {
                                        case 0:
                                            return this.x;
                                        case 1:
                                            return this.y;
                                        case 2:
                                            return this.z;
                                        default:
                                            throw new Error("index is out of range: " + e)
                                    }
                                }
                            }, {
                                key: "copy",
                                value: function(e) {
                                    return this.x = e.x, this.y = e.y, this.z = e.z, this
                                }
                            }, {
                                key: "add",
                                value: function(e, t) {
                                    return void 0 !== t ? (console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."), this.addVectors(e, t)) : (this.x += e.x, this.y += e.y, this.z += e.z, this)
                                }
                            }, {
                                key: "addScalar",
                                value: function(e) {
                                    return this.x += e, this.y += e, this.z += e, this
                                }
                            }, {
                                key: "addVectors",
                                value: function(e, t) {
                                    return this.x = e.x + t.x, this.y = e.y + t.y, this.z = e.z + t.z, this
                                }
                            }, {
                                key: "sub",
                                value: function(e, t) {
                                    return void 0 !== t ? (console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."), this.subVectors(e, t)) : (this.x -= e.x, this.y -= e.y, this.z -= e.z, this)
                                }
                            }, {
                                key: "subVectors",
                                value: function(e, t) {
                                    return this.x = e.x - t.x, this.y = e.y - t.y, this.z = e.z - t.z, this
                                }
                            }, {
                                key: "multiply",
                                value: function(e, t) {
                                    return void 0 !== t ? (console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."), this.multiplyVectors(e, t)) : (this.x *= e.x, this.y *= e.y, this.z *= e.z, this)
                                }
                            }, {
                                key: "multiplyScalar",
                                value: function(e) {
                                    return this.x *= e, this.y *= e, this.z *= e, this
                                }
                            }, {
                                key: "multiplyVectors",
                                value: function(e, t) {
                                    return this.x = e.x * t.x, this.y = e.y * t.y, this.z = e.z * t.z, this
                                }
                            }, {
                                key: "applyMatrix3",
                                value: function(e) {
                                    var t = this.x,
                                        n = this.y,
                                        o = this.z,
                                        r = e.elements;
                                    return this.x = r[0] * t + r[3] * n + r[6] * o, this.y = r[1] * t + r[4] * n + r[7] * o, this.z = r[2] * t + r[5] * n + r[8] * o, this
                                }
                            }, {
                                key: "applyMatrix4",
                                value: function(e) {
                                    var t = this.x,
                                        n = this.y,
                                        o = this.z,
                                        r = e.elements;
                                    return this.x = r[0] * t + r[4] * n + r[8] * o + r[12], this.y = r[1] * t + r[5] * n + r[9] * o + r[13], this.z = r[2] * t + r[6] * n + r[10] * o + r[14], this
                                }
                            }, {
                                key: "applyProjection",
                                value: function(e) {
                                    var t = this.x,
                                        n = this.y,
                                        o = this.z,
                                        r = e.elements,
                                        a = 1 / (r[3] * t + r[7] * n + r[11] * o + r[15]);
                                    return this.x = (r[0] * t + r[4] * n + r[8] * o + r[12]) * a, this.y = (r[1] * t + r[5] * n + r[9] * o + r[13]) * a, this.z = (r[2] * t + r[6] * n + r[10] * o + r[14]) * a, this
                                }
                            }, {
                                key: "applyQuaternion",
                                value: function(e) {
                                    var t = this.x,
                                        n = this.y,
                                        o = this.z,
                                        r = e.x,
                                        a = e.y,
                                        i = e.z,
                                        s = e.w,
                                        l = s * t + a * o - i * n,
                                        c = s * n + i * t - r * o,
                                        u = s * o + r * n - a * t,
                                        d = -r * t - a * n - i * o;
                                    return this.x = l * s + d * -r + c * -i - u * -a, this.y = c * s + d * -a + u * -r - l * -i, this.z = u * s + d * -i + l * -a - c * -r, this
                                }
                            }, {
                                key: "transformDirection",
                                value: function(e) {
                                    var t = this.x,
                                        n = this.y,
                                        o = this.z,
                                        r = e.elements;
                                    return this.x = r[0] * t + r[4] * n + r[8] * o, this.y = r[1] * t + r[5] * n + r[9] * o, this.z = r[2] * t + r[6] * n + r[10] * o, this.normalize(), this
                                }
                            }, {
                                key: "divide",
                                value: function(e) {
                                    return this.x /= e.x, this.y /= e.y, this.z /= e.z, this
                                }
                            }, {
                                key: "divideScalar",
                                value: function(e) {
                                    if (0 !== e) {
                                        var t = 1 / e;
                                        this.x *= t, this.y *= t, this.z *= t
                                    } else this.x = 0, this.y = 0, this.z = 0;
                                    return this
                                }
                            }, {
                                key: "min",
                                value: function(e) {
                                    return this.x > e.x && (this.x = e.x), this.y > e.y && (this.y = e.y), this.z > e.z && (this.z = e.z), this
                                }
                            }, {
                                key: "max",
                                value: function(e) {
                                    return this.x < e.x && (this.x = e.x), this.y < e.y && (this.y = e.y), this.z < e.z && (this.z = e.z), this
                                }
                            }, {
                                key: "clamp",
                                value: function(e, t) {
                                    return this.x < e.x ? this.x = e.x : this.x > t.x && (this.x = t.x), this.y < e.y ? this.y = e.y : this.y > t.y && (this.y = t.y), this.z < e.z ? this.z = e.z : this.z > t.z && (this.z = t.z), this
                                }
                            }, {
                                key: "floor",
                                value: function() {
                                    return this.x = Math.floor(this.x), this.y = Math.floor(this.y), this.z = Math.floor(this.z), this
                                }
                            }, {
                                key: "ceil",
                                value: function() {
                                    return this.x = Math.ceil(this.x), this.y = Math.ceil(this.y), this.z = Math.ceil(this.z), this
                                }
                            }, {
                                key: "round",
                                value: function() {
                                    return this.x = Math.round(this.x), this.y = Math.round(this.y), this.z = Math.round(this.z), this
                                }
                            }, {
                                key: "roundToZero",
                                value: function() {
                                    return this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x), this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y), this.z = this.z < 0 ? Math.ceil(this.z) : Math.floor(this.z), this
                                }
                            }, {
                                key: "negate",
                                value: function() {
                                    return this.multiplyScalar(-1)
                                }
                            }, {
                                key: "dot",
                                value: function(e) {
                                    return this.x * e.x + this.y * e.y + this.z * e.z
                                }
                            }, {
                                key: "lengthSq",
                                value: function() {
                                    return this.x * this.x + this.y * this.y + this.z * this.z
                                }
                            }, {
                                key: "length",
                                value: function() {
                                    return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z)
                                }
                            }, {
                                key: "lengthManhattan",
                                value: function() {
                                    return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z)
                                }
                            }, {
                                key: "normalize",
                                value: function() {
                                    return this.divideScalar(this.length())
                                }
                            }, {
                                key: "setLength",
                                value: function(e) {
                                    var t = this.length();
                                    return 0 !== t && e !== t && this.multiplyScalar(e / t), this
                                }
                            }, {
                                key: "lerp",
                                value: function(e, t) {
                                    return this.x += (e.x - this.x) * t, this.y += (e.y - this.y) * t, this.z += (e.z - this.z) * t, this
                                }
                            }, {
                                key: "cross",
                                value: function(e, t) {
                                    if (void 0 !== t) return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."), this.crossVectors(e, t);
                                    var n = this.x,
                                        o = this.y,
                                        r = this.z;
                                    return this.x = o * e.z - r * e.y, this.y = r * e.x - n * e.z, this.z = n * e.y - o * e.x, this
                                }
                            }, {
                                key: "crossVectors",
                                value: function(e, t) {
                                    var n = e.x,
                                        o = e.y,
                                        r = e.z,
                                        a = t.x,
                                        i = t.y,
                                        s = t.z;
                                    return this.x = o * s - r * i, this.y = r * a - n * s, this.z = n * i - o * a, this
                                }
                            }, {
                                key: "angleTo",
                                value: function(e) {
                                    var t = this.dot(e) / (this.length() * e.length());
                                    return Math.acos((0, a.clamp)(t, -1, 1))
                                }
                            }, {
                                key: "distanceTo",
                                value: function(e) {
                                    return Math.sqrt(this.distanceToSquared(e))
                                }
                            }, {
                                key: "distanceToSquared",
                                value: function(e) {
                                    var t = this.x - e.x,
                                        n = this.y - e.y,
                                        o = this.z - e.z;
                                    return t * t + n * n + o * o
                                }
                            }, {
                                key: "setFromMatrixPosition",
                                value: function(e) {
                                    return this.x = e.elements[12], this.y = e.elements[13], this.z = e.elements[14], this
                                }
                            }, {
                                key: "setFromMatrixScale",
                                value: function(e) {
                                    var t = this.set(e.elements[0], e.elements[1], e.elements[2]).length(),
                                        n = this.set(e.elements[4], e.elements[5], e.elements[6]).length(),
                                        o = this.set(e.elements[8], e.elements[9], e.elements[10]).length();
                                    return this.x = t, this.y = n, this.z = o, this
                                }
                            }, {
                                key: "setFromMatrixColumn",
                                value: function(e, t) {
                                    var n = 4 * e,
                                        o = t.elements;
                                    return this.x = o[n], this.y = o[n + 1], this.z = o[n + 2], this
                                }
                            }, {
                                key: "equals",
                                value: function(e) {
                                    return e.x === this.x && e.y === this.y && e.z === this.z
                                }
                            }, {
                                key: "fromArray",
                                value: function(e) {
                                    return this.x = e[0], this.y = e[1], this.z = e[2], this
                                }
                            }, {
                                key: "toArray",
                                value: function() {
                                    return [this.x, this.y, this.z]
                                }
                            }, {
                                key: "clone",
                                value: function() {
                                    return new e(this.x, this.y, this.z)
                                }
                            }]), e
                        }();
                    i.prototype.projectOnVector = function() {
                        var e = void 0,
                            t = void 0;
                        return function(n) {
                            return void 0 === e && (e = new i), e.copy(n).normalize(), t = this.dot(e), this.copy(e).multiplyScalar(t)
                        }
                    }(), i.prototype.projectOnPlane = function() {
                        var e = void 0;
                        return function(t) {
                            return void 0 === e && (e = new i), e.copy(this).projectOnVector(t), this.sub(e)
                        }
                    }(), i.prototype.reflect = function() {
                        var e = void 0;
                        return function(t) {
                            return void 0 === e && (e = new i), this.sub(e.copy(t).multiplyScalar(2 * this.dot(t)))
                        }
                    }(), i.prototype.clampScalar = function() {
                        var e = void 0,
                            t = void 0;
                        return function(n, o) {
                            return void 0 === e && (e = new i, t = new i), e.set(n, n, n), t.set(o, o, o), this.clamp(e, t)
                        }
                    }(), i.prototype.applyAxisAngle = function() {
                        var e = void 0;
                        return function(t, n) {
                            return void 0 === e && (e = new r.default), this.applyQuaternion(e.setFromAxisAngle(t.normalize(), n)), this
                        }
                    }(), t.default = i
                }, function(e, t, n) {
                    "use strict";
                    Object.defineProperty(t, "__esModule", {
                        value: !0
                    });
                    var o = 1e-4;
                    t.clamp = function(e, t, n) {
                        return e < t ? t : e > n ? n : e
                    }, t.degToRad = function(e) {
                        return e * (Math.PI / 180)
                    }, t.approximatelyEquals = function(e, t, n) {
                        var r = n || o;
                        return Math.abs(e - t) <= r * Math.max(1, Math.abs(e), Math.abs(t))
                    }, t.radToDeg = function(e) {
                        return e * (180 / Math.PI)
                    }, t.sign = function(e) {
                        return "number" == typeof e ? e ? e < 0 ? -1 : 1 : e == e ? 0 : NaN : NaN
                    }
                }, function(e, t, n) {
                    "use strict";
                    Object.defineProperty(t, "__esModule", {
                        value: !0
                    });
                    var o = function() {
                            function e(e, t) {
                                for (var n = 0; n < t.length; n++) {
                                    var o = t[n];
                                    o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o)
                                }
                            }
                            return function(t, n, o) {
                                return n && e(t.prototype, n), o && e(t, o), t
                            }
                        }(),
                        r = function() {
                            function e(t, n, o, r) {
                                ! function(e, t) {
                                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                                }(this, e), this.x = t || 0, this.y = n || 0, this.z = o || 0, this.w = void 0 !== r ? r : 1
                            }
                            return o(e, [{
                                key: "setFromAxisAngle",
                                value: function(e, t) {
                                    var n = t / 2,
                                        o = Math.sin(n);
                                    return this.x = e.x * o, this.y = e.y * o, this.z = e.z * o, this.w = Math.cos(n), this
                                }
                            }, {
                                key: "multiplyQuaternions",
                                value: function(e, t) {
                                    var n = e.x,
                                        o = e.y,
                                        r = e.z,
                                        a = e.w,
                                        i = t.x,
                                        s = t.y,
                                        l = t.z,
                                        c = t.w;
                                    return this.x = n * c + a * i + o * l - r * s, this.y = o * c + a * s + r * i - n * l, this.z = r * c + a * l + n * s - o * i, this.w = a * c - n * i - o * s - r * l, this
                                }
                            }, {
                                key: "setFromRotationMatrix",
                                value: function(e) {
                                    var t = e.elements,
                                        n = t[0],
                                        o = t[4],
                                        r = t[8],
                                        a = t[1],
                                        i = t[5],
                                        s = t[9],
                                        l = t[2],
                                        c = t[6],
                                        u = t[10],
                                        d = n + i + u,
                                        h = void 0;
                                    return d > 0 ? (h = .5 / Math.sqrt(d + 1), this.w = .25 / h, this.x = (c - s) * h, this.y = (r - l) * h, this.z = (a - o) * h) : n > i && n > u ? (h = 2 * Math.sqrt(1 + n - i - u), this.w = (c - s) / h, this.x = .25 * h, this.y = (o + a) / h, this.z = (r + l) / h) : i > u ? (h = 2 * Math.sqrt(1 + i - n - u), this.w = (r - l) / h, this.x = (o + a) / h, this.y = .25 * h, this.z = (s + c) / h) : (h = 2 * Math.sqrt(1 + u - n - i), this.w = (a - o) / h, this.x = (r + l) / h, this.y = (s + c) / h, this.z = .25 * h), this
                                }
                            }]), e
                        }();
                    t.default = r
                }, function(e, t, n) {
                    "use strict";
                    Object.defineProperty(t, "__esModule", {
                        value: !0
                    });
                    var o = n(1);

                    function r(e) {
                        return e * e
                    }

                    function a(e, t) {
                        return r(e.x - t.x) + r(e.y - t.y)
                    }
                    var i = {
                        distanceToPoint: function(e, t) {
                            return Math.sqrt(function(e, t) {
                                var n = a(e.start, e.end);
                                if (0 === n) return a(t, e.start);
                                var o = ((t.x - e.start.x) * (e.end.x - e.start.x) + (t.y - e.start.y) * (e.end.y - e.start.y)) / n;
                                return a(t, o < 0 ? e.start : o > 1 ? e.end : {
                                    x: e.start.x + o * (e.end.x - e.start.x),
                                    y: e.start.y + o * (e.end.y - e.start.y)
                                })
                            }(e, t))
                        },
                        intersectLine: function(e, t) {
                            var n, r, a, i, s, l, c, u, d, h, f, m = {},
                                g = e.start.x,
                                p = e.start.y,
                                v = e.end.x,
                                y = e.end.y,
                                b = t.start.x,
                                w = t.start.y,
                                x = t.end.x,
                                T = t.end.y,
                                I = void 0;
                            if (h = (n = y - p) * x + (a = g - v) * T + (s = v * p - g * y), (0 === (d = n * b + a * w + s) || 0 === h || (0, o.sign)(d) !== (0, o.sign)(h)) && (u = (r = T - w) * v + (i = b - x) * y + (l = x * w - b * T), 0 === (c = r * g + i * p + l) || 0 === u || (0, o.sign)(c) !== (0, o.sign)(u))) {
                                f = n * i - r * a, I = a * l - i * s;
                                var E = parseFloat(I / f);
                                I = r * s - n * l;
                                var S = parseFloat(I / f);
                                return m.x = E, m.y = S, m
                            }
                        }
                    };
                    t.default = i
                }, function(e, t, n) {
                    "use strict";
                    Object.defineProperty(t, "__esModule", {
                        value: !0
                    }), t.Vector3 = t.rect = t.quaternion = t.point = t.Plane = t.Matrix4 = t.sign = t.radToDeg = t.degToRad = t.clamp = t.lineSegment = t.Line3 = void 0;
                    var o = h(n(5)),
                        r = h(n(3)),
                        a = n(1),
                        i = h(n(6)),
                        s = h(n(7)),
                        l = h(n(8)),
                        c = h(n(2)),
                        u = h(n(9)),
                        d = h(n(0));

                    function h(e) {
                        return e && e.__esModule ? e : {
                            default: e
                        }
                    }
                    var f = {
                        Line3: o.default,
                        lineSegment: r.default,
                        clamp: a.clamp,
                        degToRad: a.degToRad,
                        radToDeg: a.radToDeg,
                        sign: a.sign,
                        Matrix4: i.default,
                        Plane: s.default,
                        point: l.default,
                        quaternion: c.default,
                        rect: u.default,
                        Vector3: d.default
                    };
                    t.Line3 = o.default, t.lineSegment = r.default, t.clamp = a.clamp, t.degToRad = a.degToRad, t.radToDeg = a.radToDeg, t.sign = a.sign, t.Matrix4 = i.default, t.Plane = s.default, t.point = l.default, t.quaternion = c.default, t.rect = u.default, t.Vector3 = d.default, t.default = f
                }, function(e, t, n) {
                    "use strict";
                    Object.defineProperty(t, "__esModule", {
                        value: !0
                    });
                    var o = function() {
                            function e(e, t) {
                                for (var n = 0; n < t.length; n++) {
                                    var o = t[n];
                                    o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o)
                                }
                            }
                            return function(t, n, o) {
                                return n && e(t.prototype, n), o && e(t, o), t
                            }
                        }(),
                        r = function(e) {
                            return e && e.__esModule ? e : {
                                default: e
                            }
                        }(n(0)),
                        a = n(1),
                        i = function() {
                            function e(t, n) {
                                ! function(e, t) {
                                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                                }(this, e), this.start = void 0 !== t ? t : new r.default, this.end = void 0 !== n ? n : new r.default
                            }
                            return o(e, [{
                                key: "set",
                                value: function(e, t) {
                                    return this.start.copy(e), this.end.copy(t), this
                                }
                            }, {
                                key: "copy",
                                value: function(e) {
                                    return this.start.copy(e.start), this.end.copy(e.end), this
                                }
                            }, {
                                key: "center",
                                value: function(e) {
                                    return (e || new r.default).addVectors(this.start, this.end).multiplyScalar(.5)
                                }
                            }, {
                                key: "delta",
                                value: function(e) {
                                    return (e || new r.default).subVectors(this.end, this.start)
                                }
                            }, {
                                key: "distanceSq",
                                value: function() {
                                    return this.start.distanceToSquared(this.end)
                                }
                            }, {
                                key: "distance",
                                value: function() {
                                    return this.start.distanceTo(this.end)
                                }
                            }, {
                                key: "at",
                                value: function(e, t) {
                                    var n = t || new r.default;
                                    return this.delta(n).multiplyScalar(e).add(this.start)
                                }
                            }, {
                                key: "closestPointToPointParameter",
                                value: function(e, t) {
                                    var n = new r.default,
                                        o = new r.default;
                                    n.subVectors(e, this.start), o.subVectors(this.end, this.start);
                                    var i = o.dot(o),
                                        s = o.dot(n) / i;
                                    return t && (s = (0, a.clamp)(s, 0, 1)), s
                                }
                            }, {
                                key: "closestPointToPoint",
                                value: function(e, t, n) {
                                    var o = this.closestPointToPointParameter(e, t),
                                        a = n || new r.default;
                                    return this.delta(a).multiplyScalar(o).add(this.start)
                                }
                            }, {
                                key: "applyMatrix4",
                                value: function(e) {
                                    return this.start.applyMatrix4(e), this.end.applyMatrix4(e), this
                                }
                            }, {
                                key: "equals",
                                value: function(e) {
                                    return e.start.equals(this.start) && e.end.equals(this.end)
                                }
                            }, {
                                key: "clone",
                                value: function() {
                                    return (new e).copy(this)
                                }
                            }, {
                                key: "intersectLine",
                                value: function(e) {
                                    var t = this.end.clone().sub(this.start),
                                        n = e.end.clone().sub(e.start),
                                        o = e.start.clone().sub(this.start),
                                        r = t.clone().cross(n),
                                        i = o.clone().cross(n),
                                        s = o.dot(r) / (o.lengthSq() * r.lengthSq());
                                    if ((0, a.approximatelyEquals)(s, 0)) {
                                        var l = i.dot(r) / r.lengthSq();
                                        if (!(l > 1 || isNaN(l))) {
                                            var c = this.start.clone().add(t.clone().multiplyScalar(l));
                                            return c.clone().sub(e.start).lengthSq() + c.clone().sub(e.end).lengthSq() <= e.distanceSq() ? c : void 0
                                        }
                                    }
                                }
                            }]), e
                        }();
                    t.default = i
                }, function(e, t, n) {
                    "use strict";
                    Object.defineProperty(t, "__esModule", {
                        value: !0
                    });
                    var o = function() {
                            function e(e, t) {
                                for (var n = 0; n < t.length; n++) {
                                    var o = t[n];
                                    o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o)
                                }
                            }
                            return function(t, n, o) {
                                return n && e(t.prototype, n), o && e(t, o), t
                            }
                        }(),
                        r = function(e) {
                            return e && e.__esModule ? e : {
                                default: e
                            }
                        }(n(0)),
                        a = function() {
                            function e(t, n, o, r, a, i, s, l, c, u, d, h, f, m, g, p) {
                                ! function(e, t) {
                                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                                }(this, e), this.elements = new Float32Array(16);
                                var v = this.elements;
                                v[0] = void 0 !== t ? t : 1, v[4] = n || 0, v[8] = o || 0, v[12] = r || 0, v[1] = a || 0, v[5] = void 0 !== i ? i : 1, v[9] = s || 0, v[13] = l || 0, v[2] = c || 0, v[6] = u || 0, v[10] = void 0 !== d ? d : 1, v[14] = h || 0, v[3] = f || 0, v[7] = m || 0, v[11] = g || 0, v[15] = void 0 !== p ? p : 1
                            }
                            return o(e, [{
                                key: "makeRotationFromQuaternion",
                                value: function(e) {
                                    var t = this.elements,
                                        n = e.x,
                                        o = e.y,
                                        r = e.z,
                                        a = e.w,
                                        i = n + n,
                                        s = o + o,
                                        l = r + r,
                                        c = n * i,
                                        u = n * s,
                                        d = n * l,
                                        h = o * s,
                                        f = o * l,
                                        m = r * l,
                                        g = a * i,
                                        p = a * s,
                                        v = a * l;
                                    return t[0] = 1 - (h + m), t[4] = u - v, t[8] = d + p, t[1] = u + v, t[5] = 1 - (c + m), t[9] = f - g, t[2] = d - p, t[6] = f + g, t[10] = 1 - (c + h), t[3] = 0, t[7] = 0, t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0, t[15] = 1, this
                                }
                            }, {
                                key: "multiplyMatrices",
                                value: function(e, t) {
                                    var n = e.elements,
                                        o = t.elements,
                                        r = this.elements,
                                        a = n[0],
                                        i = n[4],
                                        s = n[8],
                                        l = n[12],
                                        c = n[1],
                                        u = n[5],
                                        d = n[9],
                                        h = n[13],
                                        f = n[2],
                                        m = n[6],
                                        g = n[10],
                                        p = n[14],
                                        v = n[3],
                                        y = n[7],
                                        b = n[11],
                                        w = n[15],
                                        x = o[0],
                                        T = o[4],
                                        I = o[8],
                                        E = o[12],
                                        S = o[1],
                                        A = o[5],
                                        C = o[9],
                                        M = o[13],
                                        D = o[2],
                                        P = o[6],
                                        k = o[10],
                                        _ = o[14],
                                        L = o[3],
                                        O = o[7],
                                        R = o[11],
                                        N = o[15];
                                    return r[0] = a * x + i * S + s * D + l * L, r[4] = a * T + i * A + s * P + l * O, r[8] = a * I + i * C + s * k + l * R, r[12] = a * E + i * M + s * _ + l * N, r[1] = c * x + u * S + d * D + h * L, r[5] = c * T + u * A + d * P + h * O, r[9] = c * I + u * C + d * k + h * R, r[13] = c * E + u * M + d * _ + h * N, r[2] = f * x + m * S + g * D + p * L, r[6] = f * T + m * A + g * P + p * O, r[10] = f * I + m * C + g * k + p * R, r[14] = f * E + m * M + g * _ + p * N, r[3] = v * x + y * S + b * D + w * L, r[7] = v * T + y * A + b * P + w * O, r[11] = v * I + y * C + b * k + w * R, r[15] = v * E + y * M + b * _ + w * N, this
                                }
                            }, {
                                key: "multiply",
                                value: function(e, t) {
                                    return void 0 !== t ? (console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."), this.multiplyMatrices(e, t)) : this.multiplyMatrices(this, e)
                                }
                            }, {
                                key: "getInverse",
                                value: function(e, t) {
                                    var n = this.elements,
                                        o = e.elements,
                                        r = o[0],
                                        a = o[4],
                                        i = o[8],
                                        s = o[12],
                                        l = o[1],
                                        c = o[5],
                                        u = o[9],
                                        d = o[13],
                                        h = o[2],
                                        f = o[6],
                                        m = o[10],
                                        g = o[14],
                                        p = o[3],
                                        v = o[7],
                                        y = o[11],
                                        b = o[15];
                                    n[0] = u * g * v - d * m * v + d * f * y - c * g * y - u * f * b + c * m * b, n[4] = s * m * v - i * g * v - s * f * y + a * g * y + i * f * b - a * m * b, n[8] = i * d * v - s * u * v + s * c * y - a * d * y - i * c * b + a * u * b, n[12] = s * u * f - i * d * f - s * c * m + a * d * m + i * c * g - a * u * g, n[1] = d * m * p - u * g * p - d * h * y + l * g * y + u * h * b - l * m * b, n[5] = i * g * p - s * m * p + s * h * y - r * g * y - i * h * b + r * m * b, n[9] = s * u * p - i * d * p - s * l * y + r * d * y + i * l * b - r * u * b, n[13] = i * d * h - s * u * h + s * l * m - r * d * m - i * l * g + r * u * g, n[2] = c * g * p - d * f * p + d * h * v - l * g * v - c * h * b + l * f * b, n[6] = s * f * p - a * g * p - s * h * v + r * g * v + a * h * b - r * f * b, n[10] = a * d * p - s * c * p + s * l * v - r * d * v - a * l * b + r * c * b, n[14] = s * c * h - a * d * h - s * l * f + r * d * f + a * l * g - r * c * g, n[3] = u * f * p - c * m * p - u * h * v + l * m * v + c * h * y - l * f * y, n[7] = a * m * p - i * f * p + i * h * v - r * m * v - a * h * y + r * f * y, n[11] = i * c * p - a * u * p - i * l * v + r * u * v + a * l * y - r * c * y, n[15] = a * u * h - i * c * h + i * l * f - r * u * f - a * l * m + r * c * m;
                                    var w = r * n[0] + l * n[4] + h * n[8] + p * n[12];
                                    if (0 === w) {
                                        var x = "Matrix4.getInverse(): can't invert matrix, determinant is 0";
                                        if (t) throw new Error(x);
                                        return console.warn(x), this.identity(), this
                                    }
                                    return this.multiplyScalar(1 / w), this
                                }
                            }, {
                                key: "applyToVector3Array",
                                value: function() {
                                    var e = new r.default;
                                    return function(t, n, o) {
                                        void 0 === n && (n = 0), void 0 === o && (o = t.length);
                                        for (var r = 0, a = n; r < o; r += 3, a += 3) e.x = t[a], e.y = t[a + 1], e.z = t[a + 2], e.applyMatrix4(this), t[a] = e.x, t[a + 1] = e.y, t[a + 2] = e.z;
                                        return t
                                    }
                                }
                            }, {
                                key: "makeTranslation",
                                value: function(e, t, n) {
                                    return this.set(1, 0, 0, e, 0, 1, 0, t, 0, 0, 1, n, 0, 0, 0, 1), this
                                }
                            }, {
                                key: "multiplyScalar",
                                value: function(e) {
                                    var t = this.elements;
                                    return t[0] *= e, t[4] *= e, t[8] *= e, t[12] *= e, t[1] *= e, t[5] *= e, t[9] *= e, t[13] *= e, t[2] *= e, t[6] *= e, t[10] *= e, t[14] *= e, t[3] *= e, t[7] *= e, t[11] *= e, t[15] *= e, this
                                }
                            }, {
                                key: "set",
                                value: function(e, t, n, o, r, a, i, s, l, c, u, d, h, f, m, g) {
                                    var p = this.elements;
                                    return p[0] = e, p[4] = t, p[8] = n, p[12] = o, p[1] = r, p[5] = a, p[9] = i, p[13] = s, p[2] = l, p[6] = c, p[10] = u, p[14] = d, p[3] = h, p[7] = f, p[11] = m, p[15] = g, this
                                }
                            }, {
                                key: "makeScale",
                                value: function(e, t, n) {
                                    return this.set(e, 0, 0, 0, 0, t, 0, 0, 0, 0, n, 0, 0, 0, 0, 1), this
                                }
                            }]), e
                        }();
                    t.default = a
                }, function(e, t, n) {
                    "use strict";
                    Object.defineProperty(t, "__esModule", {
                        value: !0
                    });
                    var o = function() {
                            function e(e, t) {
                                for (var n = 0; n < t.length; n++) {
                                    var o = t[n];
                                    o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o)
                                }
                            }
                            return function(t, n, o) {
                                return n && e(t.prototype, n), o && e(t, o), t
                            }
                        }(),
                        r = function(e) {
                            return e && e.__esModule ? e : {
                                default: e
                            }
                        }(n(0)),
                        a = function() {
                            function e(t, n) {
                                ! function(e, t) {
                                    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
                                }(this, e), this.normal = void 0 !== t ? t : new r.default(1, 0, 0), this.constant = void 0 !== n ? n : 0
                            }
                            return o(e, [{
                                key: "set",
                                value: function(e, t) {
                                    return this.normal.copy(e), this.constant = t, this
                                }
                            }, {
                                key: "setComponents",
                                value: function(e, t, n, o) {
                                    return this.normal.set(e, t, n), this.constant = o, this
                                }
                            }, {
                                key: "setFromNormalAndCoplanarPoint",
                                value: function(e, t) {
                                    return this.normal.copy(e), this.constant = -t.dot(this.normal), this
                                }
                            }, {
                                key: "copy",
                                value: function(e) {
                                    return this.normal.copy(e.normal), this.constant = e.constant, this
                                }
                            }, {
                                key: "normalize",
                                value: function() {
                                    var e = 1 / this.normal.length();
                                    return this.normal.multiplyScalar(e), this.constant *= e, this
                                }
                            }, {
                                key: "negate",
                                value: function() {
                                    return this.constant *= -1, this.normal.negate(), this
                                }
                            }, {
                                key: "distanceToPoint",
                                value: function(e) {
                                    return this.normal.dot(e) + this.constant
                                }
                            }, {
                                key: "distanceToSphere",
                                value: function(e) {
                                    return this.distanceToPoint(e.center) - e.radius
                                }
                            }, {
                                key: "projectPoint",
                                value: function(e, t) {
                                    return this.orthoPoint(e, t).sub(e).negate()
                                }
                            }, {
                                key: "orthoPoint",
                                value: function(e, t) {
                                    var n = this.distanceToPoint(e);
                                    return (t || new r.default).copy(this.normal).multiplyScalar(n)
                                }
                            }, {
                                key: "isIntersectionLine",
                                value: function(e) {
                                    var t = this.distanceToPoint(e.start),
                                        n = this.distanceToPoint(e.end);
                                    return t < 0 && n > 0 || n < 0 && t > 0
                                }
                            }, {
                                key: "intersectPlane",
                                value: function(e) {
                                    var t = this.normal.clone().cross(e.normal),
                                        n = {
                                            origin: new r.default,
                                            direction: t
                                        };
                                    if (this.normal.clone().cross(e.normal).length < 1e-10) return n.direction = new r.default, n;
                                    var o = this.constant,
                                        a = e.constant,
                                        i = this.normal.clone().dot(e.normal),
                                        s = -(o - a * i) / (1 - i * i),
                                        l = -(a - o * i) / (1 - i * i);
                                    return n.origin = this.normal.clone().multiplyScalar(s).add(e.normal.clone().multiplyScalar(l)), n
                                }
                            }, {
                                key: "coplanarPoint",
                                value: function(e) {
                                    return (e || new r.default).copy(this.normal).multiplyScalar(-this.constant)
                                }
                            }, {
                                key: "translate",
                                value: function(e) {
                                    return this.constant = this.constant - e.dot(this.normal), this
                                }
                            }, {
                                key: "equals",
                                value: function(e) {
                                    return e.normal.equals(this.normal) && e.constant === this.constant
                                }
                            }, {
                                key: "clone",
                                value: function() {
                                    return (new e).copy(this)
                                }
                            }]), e
                        }();
                    a.prototype.setFromCoplanarPoints = function() {
                        var e = new r.default,
                            t = new r.default;
                        return function(n, o, r) {
                            var a = e.subVectors(r, o).cross(t.subVectors(n, o)).normalize();
                            return this.setFromNormalAndCoplanarPoint(a, n), this
                        }
                    }(), a.prototype.intersectLine = function() {
                        var e = new r.default;
                        return function(t, n) {
                            var o = n || new r.default,
                                a = t.delta(e),
                                i = this.normal.dot(a);
                            if (0 === i) return 0 === this.distanceToPoint(t.start) ? o.copy(t.start) : void 0;
                            var s = -(t.start.dot(this.normal) + this.constant) / i;
                            return s < 0 || s > 1 ? void 0 : o.copy(a).multiplyScalar(s).add(t.start)
                        }
                    }(), t.default = a
                }, function(e, t, n) {
                    "use strict";

                    function o(e, t) {
                        return {
                            x: e.x - t.x,
                            y: e.y - t.y
                        }
                    }

                    function r(e, t) {
                        return Math.sqrt(a(e, t))
                    }

                    function a(e, t) {
                        var n = o(e, t);
                        return n.x * n.x + n.y * n.y
                    }
                    Object.defineProperty(t, "__esModule", {
                        value: !0
                    });
                    var i = {
                        subtract: o,
                        copy: function(e) {
                            return {
                                x: e.x,
                                y: e.y
                            }
                        },
                        pageToPoint: function(e) {
                            return {
                                x: e.pageX,
                                y: e.pageY
                            }
                        },
                        distance: r,
                        distanceSquared: a,
                        insideRect: function(e, t) {
                            return !(e.x < t.left || e.x > t.left + t.width || e.y < t.top || e.y > t.top + t.height)
                        },
                        findClosestPoint: function(e, t) {
                            var n = [],
                                o = void 0;
                            return e.forEach((function(e, a) {
                                var i = r(e, t);
                                n.push(i), o = 0 === a ? i : Math.min(i, o)
                            })), e[n.indexOf(o)]
                        }
                    };
                    t.default = i
                }, function(e, t, n) {
                    "use strict";
                    Object.defineProperty(t, "__esModule", {
                        value: !0
                    });
                    var o = function(e) {
                        return e && e.__esModule ? e : {
                            default: e
                        }
                    }(n(3));

                    function r(e) {
                        return {
                            topLeft: {
                                x: e.left,
                                y: e.top
                            },
                            bottomRight: {
                                x: e.left + e.width,
                                y: e.top + e.height
                            }
                        }
                    }
                    var a = {
                        distanceToPoint: function(e, t) {
                            var n = 655535;
                            return function(e) {
                                return [{
                                    start: {
                                        x: e.left,
                                        y: e.top
                                    },
                                    end: {
                                        x: e.left + e.width,
                                        y: e.top
                                    }
                                }, {
                                    start: {
                                        x: e.left + e.width,
                                        y: e.top
                                    },
                                    end: {
                                        x: e.left + e.width,
                                        y: e.top + e.height
                                    }
                                }, {
                                    start: {
                                        x: e.left + e.width,
                                        y: e.top + e.height
                                    },
                                    end: {
                                        x: e.left,
                                        y: e.top + e.height
                                    }
                                }, {
                                    start: {
                                        x: e.left,
                                        y: e.top + e.height
                                    },
                                    end: {
                                        x: e.left,
                                        y: e.top
                                    }
                                }]
                            }(e).forEach((function(e) {
                                var r = o.default.distanceToPoint(e, t);
                                r < n && (n = r)
                            })), n
                        },
                        getIntersectionRect: function(e, t) {
                            var n = {
                                topLeft: {},
                                bottomRight: {}
                            };
                            if (function(e, t) {
                                    var n = void 0,
                                        o = void 0,
                                        a = r(e),
                                        i = r(t);
                                    return n = e.width >= 0 ? t.width >= 0 ? !(a.bottomRight.x <= i.topLeft.x || i.bottomRight.x <= a.topLeft.x) : !(a.bottomRight.x <= i.bottomRight.x || i.topLeft.x <= a.topLeft.x) : t.width >= 0 ? !(a.topLeft.x <= i.topLeft.x || i.bottomRight.x <= a.bottomRight.x) : !(a.topLeft.x <= i.bottomRight.x || i.topLeft.x <= a.bottomRight.x), o = e.height >= 0 ? t.height >= 0 ? !(a.bottomRight.y <= i.topLeft.y || i.bottomRight.y <= a.topLeft.y) : !(a.bottomRight.y <= i.bottomRight.y || i.topLeft.y <= a.topLeft.y) : t.height >= 0 ? !(a.topLeft.y <= i.topLeft.y || i.bottomRight.y <= a.bottomRight.y) : !(a.topLeft.y <= i.bottomRight.y || i.top <= a.bottomRight.y), n && o
                                }(e, t)) {
                                var o = r(e),
                                    a = r(t);
                                return e.width >= 0 ? t.width >= 0 ? (n.topLeft.x = Math.max(o.topLeft.x, a.topLeft.x), n.bottomRight.x = Math.min(o.bottomRight.x, a.bottomRight.x)) : (n.topLeft.x = Math.max(o.topLeft.x, a.bottomRight.x), n.bottomRight.x = Math.min(o.bottomRight.x, a.topLeft.x)) : t.width >= 0 ? (n.topLeft.x = Math.min(o.topLeft.x, a.bottomRight.x), n.bottomRight.x = Math.max(o.bottomRight.x, a.topLeft.x)) : (n.topLeft.x = Math.min(o.topLeft.x, a.topLeft.x), n.bottomRight.x = Math.max(o.bottomRight.x, a.bottomRight.x)), e.height >= 0 ? t.height >= 0 ? (n.topLeft.y = Math.max(o.topLeft.y, a.topLeft.y), n.bottomRight.y = Math.min(o.bottomRight.y, a.bottomRight.y)) : (n.topLeft.y = Math.max(o.topLeft.y, a.bottomRight.y), n.bottomRight.y = Math.min(o.bottomRight.y, a.topLeft.y)) : t.height >= 0 ? (n.topLeft.y = Math.min(o.topLeft.y, a.bottomRight.y), n.bottomRight.y = Math.max(o.bottomRight.y, a.topLeft.y)) : (n.topLeft.y = Math.min(o.topLeft.y, a.topLeft.y), n.bottomRight.y = Math.max(o.bottomRight.y, a.bottomRight.y)), n
                            }
                        }
                    };
                    t.default = a
                }])
            },
            7990: e => {
                "use strict";
                e.exports = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAe1BMVEUYAP4YEPMYGe8idcUeXdAcU9UYBPkbRdsYI+sfZM0YKucaOeAgacocTNcYCvYYH+wke8IdWNImiLwZM+QiccchbcgaPd4aQdwlf8Awpa4yr6o2vaMojblI+Ycun7E7zptG9Iork7csmrM+2JdA4JNC5ZFE7Y1K/4U4xJ9hpzG+AAACLUlEQVQ4y9WSR7LcMAwFGQAxZ+UwOfj+JzTm12xsn8C9UYlsvYIAsP+MrosiaZ20bS3x7p97IcRYlLMOYESjrP5T6TQJzcI8KF+9RXBcx2/wx+xcUoMPUKtlfK6+1jkkxxkRydBJTbDX/bYsko5wOe37XiFpQaVYzier1VD3Wm/rOpMA66nOOUsUKXDmuEM9KVVMnettuSbR+mvNfWjWOa5GJjhaFzgXdsh5rrOnT6+5OB6FiJ0ojOtJhBKjQEDsZ+9nSu81F9QLKm9kUVOG48n2soxG1tN6ysOodSkqCYphPPFouQMwZnQgt+N93HMJIgQEJagH4pMUVe+huObM6/J8HZsb04SBBBeZttQJ5xERKCUfx+VybAqnECZVNI6shK4TwdDd/ms1p/fjfL88/SANKhU0AtsyCXaC9bE9btvjZYxZ3o/tup4XbFwhO2rX8Rj5cL7f11+XS69gez9/bfSWbGwje5qOdZxWAU7L7bScn+v5te3X5TyPVnA7sWUkgQk1YjFGYVmPyw0AZQbwjeuRoe1oou7zm8p4QDgvnmocipcZhdBM6cibQCkHbOAp5GqM9wAg5xyE1sxZTcMkwUxaAeIkVYABWugHtA6QGVNCQZDeiQagFGblSm9sCkGhl5JJoh+8UbST1tqm0NEitBbA+D7PmYQffAlWpPRZ+0QqFzRZmeVPwpeiaWu+cEJPMPR9/xUGUJra+YUCfh7WTYr1VIHBSdMRETv+F78BzJImqyQDEWEAAAAASUVORK5CYII="
            },
            8002: e => {
                "use strict";
                e.exports = Math.min
            },
            8011: e => {
                "use strict";
                e.exports = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAV1BMVEX2AgD2EAD4eAD3QgD4bgD2HgD3TgD3ZQD3VgD2FgD2NwD3XAD2JwD2LgD99hf6owP6mQT4iAD5hAD7uwv6rQb5jwH81w/85hT83xL8zw/7xgv+/hv97BZTj7ayAAAB6klEQVQ4y9VRCY4cIRAD6qSAvnvn/P87456NEq3yglh9CGwZl0n/GXLOVbqI9DEk53/4Wms4RY/moY26/JRkqbmO3gqTrSbaIv9Q5BBi07atPdWy2rYWkvijECHyc12XeS5Y6jyf67m5yGXSc8Z5xOu6rctxXIJ2zOtWCmsVzWnkoUJwsG3blvkUGXxuYEePyBSpZu1BmLBzKWUrhu9ZfGCn5lQd8SmrY0ptqlzMCsCCkeqVMZAQHvEx8LCyLcdSOETcCRboC+MiaLRmFtHKPr2mrwJSVfG9Cvz0gRJQ4Ij2nm7vaY8QUtRZUYV08MMUa7iU6cJOCp7IRSO5okc1cOdzt+V1f35NN2M2CEgQfy8JLtSO+35f9vvbzObXfT+Px4xZSdO0wQHgx9fX8ZwmJt9ft+eOlfQ8It0MITFM9WVelvlxOx7vHbfyLIFb6JTmSEClUG+N1I9pWpprKd54ZImk/TIINncya9oesyEjOyrVnCWRpDyqlut6HAnpNKB5Q+OURVJ0ESIIjISaOjGpsw9i1h4owcxV3dlGHd4uKQVWgq5JcUyCE06EdUVmgDR6xBjaEAVkYi74IyP1WuUDSHOND/3tAB5wufYrWLwAEjGQwF58wzSY9y8ShH0QJQbMQz6b36X+fr71vwDwJBeEP0nA0AAAAABJRU5ErkJggg=="
            },
            8068: e => {
                "use strict";
                e.exports = SyntaxError
            },
            8319: (e, t, n) => {
                "use strict";
                n.d(t, {
                    A: () => d
                });
                var o = n(9473),
                    r = n(4594),
                    a = function(e, t, n, o) {
                        return new(n || (n = Promise))((function(r, a) {
                            function i(e) {
                                try {
                                    l(o.next(e))
                                } catch (e) {
                                    a(e)
                                }
                            }

                            function s(e) {
                                try {
                                    l(o.throw(e))
                                } catch (e) {
                                    a(e)
                                }
                            }

                            function l(e) {
                                var t;
                                e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                                    e(t)
                                }))).then(i, s)
                            }
                            l((o = o.apply(e, t || [])).next())
                        }))
                    };
                const {
                    dbName: i,
                    storeName: s,
                    version: l
                } = r.A.DBCacheImages, c = new o.mc(i, s, l), u = new o.a6((e => {
                    let t = [];
                    const n = (e, t) => {
                        for (const n of e.slice(0, t)) c.dispatch("delete", {}, n)
                    };
                    c.dispatch("count", {
                        mode: "readonly"
                    }).then((o => {
                        if (o > 5e3) {
                            const r = Math.ceil(o * String.prototype.slice.call(o, 0, 1) * .1);
                            c.dispatch("getAllKeys", {
                                mode: "readonly"
                            }, IDBKeyRange.upperBound(`${e}_0`)).then((o => {
                                t = o, o.length >= r ? n(t, r) : c.dispatch("getAllKeys", {
                                    mode: "readonly"
                                }, IDBKeyRange.lowerBound(`${e}_z`)).then((e => {
                                    t = [...t, ...e], n(t, r)
                                }))
                            }))
                        }
                        o > 15e3 && (console.info("Too many data stores, indexedDB is cleaning up"), c.dispatch("clear"))
                    }))
                }));
                a(void 0, void 0, void 0, (function*() {
                    const e = indexedDB || webkitIndexedDB || mozIndexedDB || msIndexedDB;
                    try {
                        const t = yield null == e ? void 0 : e.databases();
                        for (const {
                                name: n,
                                version: o
                            } of t)
                            if (n === i && o !== l) {
                                e.deleteDatabase(n), console.info("indexedDB is upgraded to version " + l), r.A.imageType = null, r.A.DBCacheImages.enable = null, r.A.tackSynchronizerType = null, console.info("User configuration reset");
                                break
                            }
                    } catch (e) {
                        console.error(e)
                    } finally {
                        a(void 0, void 0, void 0, (function*() {
                            yield c.open(), console.info("indexedDB is opened"), u.run("com")
                        }))
                    }
                }));
                const d = c
            },
            8398: (__unused_webpack_module, __webpack_exports__, __webpack_require__) => {
                "use strict";
                __webpack_require__.d(__webpack_exports__, {
                    A4: () => deepCopy,
                    AL: () => isPixelDataURL,
                    B6: () => performanceLevel,
                    CQ: () => downloadFileURL,
                    EG: () => subarrayToArrayBuffer,
                    M1: () => toggleElsClassName,
                    Nn: () => mergeArrayBuffers,
                    ON: () => removeTrailingEmpty,
                    RZ: () => extractByPercentage,
                    Rt: () => scrollIntoView,
                    Ti: () => renderRadioGroup,
                    Wp: () => setAttributes,
                    Zr: () => capitalizeFirstLetter,
                    aR: () => peelIDAlias,
                    b0: () => renderDivGroup,
                    bE: () => removeChildElement,
                    gV: () => replaceLastDelimiter,
                    i$: () => dateFormat,
                    iP: () => isStaticBlockSupported,
                    jc: () => booleanToNumber,
                    jk: () => isWebGLExtensionSupported,
                    kA: () => mousewheelScroll,
                    m_: () => isOffscreenCanvasSupported,
                    qE: () => clamp,
                    sD: () => randerLabelGroup,
                    sJ: () => renderSelectGroup,
                    uk: () => wait,
                    uo: () => extractDecimalNumber,
                    wf: () => toggleClassName
                });
                var simple2k13__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(9473),
                    __awaiter = function(e, t, n, o) {
                        return new(n || (n = Promise))((function(r, a) {
                            function i(e) {
                                try {
                                    l(o.next(e))
                                } catch (e) {
                                    a(e)
                                }
                            }

                            function s(e) {
                                try {
                                    l(o.throw(e))
                                } catch (e) {
                                    a(e)
                                }
                            }

                            function l(e) {
                                var t;
                                e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                                    e(t)
                                }))).then(i, s)
                            }
                            l((o = o.apply(e, t || [])).next())
                        }))
                    };

                function isPixelDataURL(e) {
                    return e.includes("pixelData:")
                }

                function setAttributes(e, t) {
                    Object.entries(t).forEach((([t, n]) => {
                        !0 === n ? e.setAttribute(t, "1") : !1 === n ? e.removeAttribute(t) : e.setAttribute(t, n.toString())
                    }))
                }

                function subarrayToArrayBuffer(e, t, n) {
                    return e.slice(t, n).buffer
                }

                function mergeArrayBuffers(e) {
                    const t = e.reduce(((e, t) => e + t.byteLength), 0),
                        n = new Uint8Array(t);
                    let o = 0;
                    for (const t of e) n.set(new Uint8Array(t), o), o += t.byteLength;
                    return n.buffer
                }

                function booleanToNumber(e) {
                    return e ? 1 : 0
                }

                function extractDecimalNumber(e) {
                    const t = e.match(/[\d.]+/);
                    return t ? parseFloat(t[0]) : null
                }

                function mousewheelScroll(e, t = "x") {
                    e.addEventListener("wheel", (n => {
                        e["x" === t ? "scrollLeft" : "scrollTop"] += 150 * (n.deltaY > 0 ? 1 : -1)
                    }))
                }

                function deepCopy(e) {
                    return (null === structuredClone || void 0 === structuredClone ? void 0 : structuredClone(e)) || JSON.parse(JSON.stringify(e))
                }

                function clamp(e, t, n) {
                    return Math.min(Math.max(e, t), n)
                }

                function toggleClassName(e, t, n = "active") {
                    if (e) return e.classList.toggle(n, t);
                    console.warn("target is required for toggleClassName")
                }

                function toggleElsClassName(e, t, n = "active") {
                    e.forEach(((e, o, r) => {
                        toggleClassName(e, t(e, o, r), n)
                    }))
                }

                function scrollIntoView(e) {
                    return __awaiter(this, arguments, void 0, (function*(e, t = 0, n = {
                        behavior: "smooth",
                        inline: "center",
                        block: "center"
                    }) {
                        yield wait(t), null == e || e.scrollIntoView(n)
                    }))
                }

                function capitalizeFirstLetter(e) {
                    return e.charAt(0).toUpperCase() + e.slice(1)
                }

                function replaceLastDelimiter(e, t, n = "-") {
                    const o = e.split(n);
                    return o[o.length - 1] = t, o.join(n)
                }

                function randerLabelGroup(e) {
                    const {
                        content: t,
                        className: n = "",
                        label: o = "",
                        description: r = ""
                    } = e, a = (0, simple2k13__WEBPACK_IMPORTED_MODULE_0__.n)({
                        tagName: "label",
                        className: n
                    });
                    return a.append(o, t, r), a
                }

                function renderRadioGroup(e, t, n, o, r = "") {
                    let a = (0, simple2k13__WEBPACK_IMPORTED_MODULE_0__.n)({
                        className: r
                    });
                    return e.forEach((e => {
                        const r = (0, simple2k13__WEBPACK_IMPORTED_MODULE_0__.n)({
                                tagName: "input",
                                type: "radio",
                                name: n,
                                value: e.type,
                                checked: e.type === t
                            }),
                            i = randerLabelGroup({
                                content: r,
                                description: e.name
                            });
                        r.addEventListener("change", (t => {
                            t.target.checked && o(e)
                        })), a.appendChild(i)
                    })), a
                }

                function renderSelectGroup(e, t, n) {
                    const o = (0, simple2k13__WEBPACK_IMPORTED_MODULE_0__.n)({
                        tagName: "select"
                    });
                    let r = "";
                    return e.forEach((function({
                        value: e,
                        label: n
                    }) {
                        r += `<option value="${e}" ${e===t?"selected":""} >${null!=n?n:e} </option>`
                    })), o.innerHTML = r, o.addEventListener("change", (e => {
                        const t = e.target;
                        null == n || n(t.value)
                    })), o
                }

                function renderDivGroup(e, ...t) {
                    const n = (0, simple2k13__WEBPACK_IMPORTED_MODULE_0__.n)({
                        className: e
                    });
                    return n.append(...t), n
                }

                function dataURLToArrayBuffer(e) {
                    const t = e.split(",")[1],
                        n = atob(t),
                        o = n.length,
                        r = new ArrayBuffer(o),
                        a = new Uint8Array(r);
                    for (let e = 0; e < o; e++) a[e] = n.charCodeAt(e);
                    return r
                }

                function ImageDataToArraybuffer(e, t) {
                    return __awaiter(this, void 0, void 0, (function*() {
                        try {
                            const n = e.getContext("2d");
                            return e.height = t.height, e.width = t.width, null == n || n.putImageData(t, 0, 0), Promise.resolve(dataURLToArrayBuffer(e.toDataURL()))
                        } catch (e) {
                            return Promise.reject(e)
                        }
                    }))
                }

                function isWebGLExtensionSupported(e) {
                    const t = document.createElement("canvas"),
                        n = t.getContext("webgl2") || t.getContext("webgl") || t.getContext("experimental-webgl");
                    if (!n) return !1;
                    return null !== ("getExtension" in n ? n.getExtension(e) : null)
                }

                function isStaticBlockSupported() {
                    try {
                        return eval("class Test { static {} }"), !0
                    } catch (e) {
                        return !1
                    }
                }

                function isOffscreenCanvasSupported() {
                    try {
                        return new OffscreenCanvas(0, 0), !0
                    } catch (e) {
                        return !1
                    }
                }

                function performanceLevel(e) {
                    return e >= 3.8 ? 2 : e >= 2 ? 1.5 : e ? 1 : .6
                }

                function peelIDAlias(e) {
                    return e.split("?")[0]
                }

                function extractByPercentage(e, t) {
                    if (t <= 0 || t > 100) throw new Error("Percentage must be between 0 and 100.");
                    const n = e.length,
                        o = Math.floor(n * (t / 100)),
                        r = [];
                    for (let t = 0; t < o; t++) {
                        const a = Math.floor(t * (n / o));
                        r.push(e[a])
                    }
                    return r
                }

                function removeChildElement(e, t = 1) {
                    t -= 1;
                    for (let n of [...Array.from((null == e ? void 0 : e.childNodes) || [])]) t && (null == n ? void 0 : n.childNodes) && removeChildElement(n, t), null == n || n.remove(), n = null
                }

                function downloadFileURL(e, t) {
                    const n = document.createElement("a");
                    n.style.display = "none", n.setAttribute("target", "_blank"), t && n.setAttribute("download", t), n.href = e, document.body.appendChild(n), n.click(), document.body.removeChild(n)
                }

                function dateFormat(e, t) {
                    const n = new Date(e.replace(/-/g, "/")),
                        o = {
                            "M+": n.getMonth() + 1,
                            "d+": n.getDate(),
                            "h+": n.getHours(),
                            "m+": n.getMinutes(),
                            "s+": n.getSeconds(),
                            "q+": Math.floor((n.getMonth() + 3) / 3),
                            S: n.getMilliseconds()
                        };
                    /(y+)/.test(t) && (t = t.replace(RegExp.$1, (n.getFullYear() + "").substr(4 - RegExp.$1.length)));
                    for (let e in o)
                        if (new RegExp("(" + e + ")").test(t)) {
                            const n = o[e].toString();
                            t = t.replace(RegExp.$1, 1 == RegExp.$1.length ? n : ("00" + n).substr(("" + n).length))
                        }
                    return t
                }

                function stopBubble(e) {
                    e && e.stopPropagation ? e.stopPropagation() : window.event && (window.event.cancelBubble = !0)
                }

                function wait(e = 0) {
                    return new Promise((t => setTimeout(t, e)))
                }

                function removeTrailingEmpty(e) {
                    for (; e.length > 0 && null == e[e.length - 1];) e.pop()
                }
            },
            8628: (e, t, n) => {
                "use strict";

                function o() {
                    return "function" == typeof crypto.randomUUID ? crypto.randomUUID() : ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, (function(e) {
                        return (e ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> e / 4).toString(16)
                    }))
                }
                n.d(t, {
                    A: () => o
                })
            },
            8636: (e, t, n) => {
                "use strict";
                var o = n(920),
                    r = n(7720),
                    a = n(4765),
                    i = Object.prototype.hasOwnProperty,
                    s = {
                        brackets: function(e) {
                            return e + "[]"
                        },
                        comma: "comma",
                        indices: function(e, t) {
                            return e + "[" + t + "]"
                        },
                        repeat: function(e) {
                            return e
                        }
                    },
                    l = Array.isArray,
                    c = Array.prototype.push,
                    u = function(e, t) {
                        c.apply(e, l(t) ? t : [t])
                    },
                    d = Date.prototype.toISOString,
                    h = a.default,
                    f = {
                        addQueryPrefix: !1,
                        allowDots: !1,
                        allowEmptyArrays: !1,
                        arrayFormat: "indices",
                        charset: "utf-8",
                        charsetSentinel: !1,
                        commaRoundTrip: !1,
                        delimiter: "&",
                        encode: !0,
                        encodeDotInKeys: !1,
                        encoder: r.encode,
                        encodeValuesOnly: !1,
                        filter: void 0,
                        format: h,
                        formatter: a.formatters[h],
                        indices: !1,
                        serializeDate: function(e) {
                            return d.call(e)
                        },
                        skipNulls: !1,
                        strictNullHandling: !1
                    },
                    m = {},
                    g = function e(t, n, a, i, s, c, d, h, g, p, v, y, b, w, x, T, I, E) {
                        for (var S, A = t, C = E, M = 0, D = !1; void 0 !== (C = C.get(m)) && !D;) {
                            var P = C.get(t);
                            if (M += 1, void 0 !== P) {
                                if (P === M) throw new RangeError("Cyclic object value");
                                D = !0
                            }
                            void 0 === C.get(m) && (M = 0)
                        }
                        if ("function" == typeof p ? A = p(n, A) : A instanceof Date ? A = b(A) : "comma" === a && l(A) && (A = r.maybeMap(A, (function(e) {
                                return e instanceof Date ? b(e) : e
                            }))), null === A) {
                            if (c) return g && !T ? g(n, f.encoder, I, "key", w) : n;
                            A = ""
                        }
                        if ("string" == typeof(S = A) || "number" == typeof S || "boolean" == typeof S || "symbol" == typeof S || "bigint" == typeof S || r.isBuffer(A)) return g ? [x(T ? n : g(n, f.encoder, I, "key", w)) + "=" + x(g(A, f.encoder, I, "value", w))] : [x(n) + "=" + x(String(A))];
                        var k, _ = [];
                        if (void 0 === A) return _;
                        if ("comma" === a && l(A)) T && g && (A = r.maybeMap(A, g)), k = [{
                            value: A.length > 0 ? A.join(",") || null : void 0
                        }];
                        else if (l(p)) k = p;
                        else {
                            var L = Object.keys(A);
                            k = v ? L.sort(v) : L
                        }
                        var O = h ? String(n).replace(/\./g, "%2E") : String(n),
                            R = i && l(A) && 1 === A.length ? O + "[]" : O;
                        if (s && l(A) && 0 === A.length) return R + "[]";
                        for (var N = 0; N < k.length; ++N) {
                            var U = k[N],
                                B = "object" == typeof U && U && void 0 !== U.value ? U.value : A[U];
                            if (!d || null !== B) {
                                var V = y && h ? String(U).replace(/\./g, "%2E") : String(U),
                                    F = l(A) ? "function" == typeof a ? a(R, V) : R : R + (y ? "." + V : "[" + V + "]");
                                E.set(t, M);
                                var H = o();
                                H.set(m, E), u(_, e(B, F, a, i, s, c, d, h, "comma" === a && T && l(A) ? null : g, p, v, y, b, w, x, T, I, H))
                            }
                        }
                        return _
                    };
                e.exports = function(e, t) {
                    var n, r = e,
                        c = function(e) {
                            if (!e) return f;
                            if (void 0 !== e.allowEmptyArrays && "boolean" != typeof e.allowEmptyArrays) throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");
                            if (void 0 !== e.encodeDotInKeys && "boolean" != typeof e.encodeDotInKeys) throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");
                            if (null !== e.encoder && void 0 !== e.encoder && "function" != typeof e.encoder) throw new TypeError("Encoder has to be a function.");
                            var t = e.charset || f.charset;
                            if (void 0 !== e.charset && "utf-8" !== e.charset && "iso-8859-1" !== e.charset) throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");
                            var n = a.default;
                            if (void 0 !== e.format) {
                                if (!i.call(a.formatters, e.format)) throw new TypeError("Unknown format option provided.");
                                n = e.format
                            }
                            var o, r = a.formatters[n],
                                c = f.filter;
                            if (("function" == typeof e.filter || l(e.filter)) && (c = e.filter), o = e.arrayFormat in s ? e.arrayFormat : "indices" in e ? e.indices ? "indices" : "repeat" : f.arrayFormat, "commaRoundTrip" in e && "boolean" != typeof e.commaRoundTrip) throw new TypeError("`commaRoundTrip` must be a boolean, or absent");
                            var u = void 0 === e.allowDots ? !0 === e.encodeDotInKeys || f.allowDots : !!e.allowDots;
                            return {
                                addQueryPrefix: "boolean" == typeof e.addQueryPrefix ? e.addQueryPrefix : f.addQueryPrefix,
                                allowDots: u,
                                allowEmptyArrays: "boolean" == typeof e.allowEmptyArrays ? !!e.allowEmptyArrays : f.allowEmptyArrays,
                                arrayFormat: o,
                                charset: t,
                                charsetSentinel: "boolean" == typeof e.charsetSentinel ? e.charsetSentinel : f.charsetSentinel,
                                commaRoundTrip: !!e.commaRoundTrip,
                                delimiter: void 0 === e.delimiter ? f.delimiter : e.delimiter,
                                encode: "boolean" == typeof e.encode ? e.encode : f.encode,
                                encodeDotInKeys: "boolean" == typeof e.encodeDotInKeys ? e.encodeDotInKeys : f.encodeDotInKeys,
                                encoder: "function" == typeof e.encoder ? e.encoder : f.encoder,
                                encodeValuesOnly: "boolean" == typeof e.encodeValuesOnly ? e.encodeValuesOnly : f.encodeValuesOnly,
                                filter: c,
                                format: n,
                                formatter: r,
                                serializeDate: "function" == typeof e.serializeDate ? e.serializeDate : f.serializeDate,
                                skipNulls: "boolean" == typeof e.skipNulls ? e.skipNulls : f.skipNulls,
                                sort: "function" == typeof e.sort ? e.sort : null,
                                strictNullHandling: "boolean" == typeof e.strictNullHandling ? e.strictNullHandling : f.strictNullHandling
                            }
                        }(t);
                    "function" == typeof c.filter ? r = (0, c.filter)("", r) : l(c.filter) && (n = c.filter);
                    var d = [];
                    if ("object" != typeof r || null === r) return "";
                    var h = s[c.arrayFormat],
                        m = "comma" === h && c.commaRoundTrip;
                    n || (n = Object.keys(r)), c.sort && n.sort(c.sort);
                    for (var p = o(), v = 0; v < n.length; ++v) {
                        var y = n[v],
                            b = r[y];
                        c.skipNulls && null === b || u(d, g(b, y, h, m, c.allowEmptyArrays, c.strictNullHandling, c.skipNulls, c.encodeDotInKeys, c.encode ? c.encoder : null, c.filter, c.sort, c.allowDots, c.serializeDate, c.format, c.formatter, c.encodeValuesOnly, c.charset, p))
                    }
                    var w = d.join(c.delimiter),
                        x = !0 === c.addQueryPrefix ? "?" : "";
                    return c.charsetSentinel && ("iso-8859-1" === c.charset ? x += "utf8=%26%2310003%3B&" : x += "utf8=%E2%9C%93&"), w.length > 0 ? x + w : ""
                }
            },
            8648: e => {
                "use strict";
                e.exports = "undefined" != typeof Reflect && Reflect.getPrototypeOf || null
            },
            8712: (e, t, n) => {
                "use strict";
                n.d(t, {
                    Ay: () => a,
                    Fb: () => r
                });
                const o = [{
                        type: "CT-Air"
                    }, {
                        type: "CT-MIP"
                    }, {
                        type: "CT-Soft-Tissue",
                        name: "CT-"
                    }, {
                        type: "CT-Fat",
                        name: "CT-"
                    }, {
                        type: "CT-Lung",
                        name: "CT-"
                    }, {
                        type: "CT-Muscle",
                        name: "CT-"
                    }, {
                        type: "CT-Bone",
                        name: "CT-"
                    }, {
                        type: "CT-Bones",
                        name: "CT-"
                    }, {
                        type: "CT-Cropped-Volume-Bone",
                        name: "CT-"
                    }, {
                        type: "CT-Cardiac",
                        name: "CT-"
                    }, {
                        type: "CT-Cardiac2",
                        name: "CT-2"
                    }, {
                        type: "CT-Cardiac3",
                        name: "CT-3"
                    }, {
                        type: "CT-Chest-Contrast-Enhanced",
                        name: "CT-"
                    }, {
                        type: "CT-Liver-Vasculature",
                        name: "CT-"
                    }, {
                        type: "CT-Chest-Vessels",
                        name: "CT-"
                    }, {
                        type: "CT-Coronary-Arteries",
                        name: "CT-"
                    }, {
                        type: "CT-Coronary-Arteries-2",
                        name: "CT-2"
                    }, {
                        type: "CT-Coronary-Arteries-3",
                        name: "CT-3"
                    }, {
                        type: "CT-Pulmonary-Arteries",
                        name: "CT-"
                    }, {
                        type: "CT-AAA"
                    }, {
                        type: "CT-AAA2"
                    }, {
                        type: "MR-Default"
                    }, {
                        type: "MR-MIP"
                    }, {
                        type: "MR-Angio",
                        name: "MR-"
                    }, {
                        type: "MR-T2-Brain",
                        name: "MR-T2-"
                    }, {
                        type: "DTI-FA-Brain",
                        name: "DTI-FA-"
                    }],
                    r = e => o.filter((t => t.type.includes(e))),
                    a = o
            },
            8774: e => {
                "use strict";
                e.exports = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAb1BMVEUigWcvjmdrsmhkr2hfrGhTpWg7lmc0kmdDm2d8u2lKn2gqiWeAvmksi2c4k2dZqGhxtWgmhmeNxWl1uGh5umhPomiFwWio02mZy2iy2Gj3/Gni8WnR6Gmhz2jy+Wnr9mnZ7GnI42nC4Gm83Wn+/2rMqbF9AAACIUlEQVQ4y9VRC67cIAwEG4MhBEiA/Pa/2/ufsc4+qVLVE3QUJbZnYsNY/WeYpkEna+VhTsP0D6+dC0jBBsCQgTj9LZmSc44tLpXKDDZD0Hb4Mj+9ppByLYTzbJVe5rLMS7Zh+AqGYUqpn9y8rWuUEq43SRZM1o2DsloTW6pSmbd9X0QA6zovMXrjUnaKdTC2EyGI4rZuyXHb5tgycwgjdeW04ZBH7bjGKKNLjHGLGLSUhsGhGlPXGSU0YExdCkRBszpxGsUaUqOVHkHy2jCAn2/7LdZuLRpKWg9a/NGD1QEEIaB/H7+OZzTkcjZIbpq+gmmgWhADB3gcj8fxDiFRziIQK5IVnks2BgTLcb/fjzeZnnMnTKYrzNOk88ltr72svy6v6/1SqgdDRNag+og1znbYn+/L7X15AJyqz7ZfV8MjGXXM02n36K/X5/66H63j59fj9Xk+d5nOQV1gUtMoY1BsvK3Xy359fGQrr6WzG7mrtSsld6FwnrJnsx/3DY3xHrHIyrsyfI4I5zUJChq4rqWUVlE8N1on1e0wsJM/qmEsALQBFFGjX2LWyarAyXYyMUK3JL17o4wVOdeamdEoACMmYSvsGIHILMSmgXVZ4uK98t63WgqQ09oKyATLgTkjQJXFKt+8oAESO0FKyWmBC+Bj9N8OP0HDNEpd2PMlsAS1taaE8q1VIDuMovgDSZzlTqq2WkHman3Sw6kaBZL+fH4Dv4kk7qhIC7sAAAAASUVORK5CYII="
            },
            8859: (e, t, n) => {
                var o = "function" == typeof Map && Map.prototype,
                    r = Object.getOwnPropertyDescriptor && o ? Object.getOwnPropertyDescriptor(Map.prototype, "size") : null,
                    a = o && r && "function" == typeof r.get ? r.get : null,
                    i = o && Map.prototype.forEach,
                    s = "function" == typeof Set && Set.prototype,
                    l = Object.getOwnPropertyDescriptor && s ? Object.getOwnPropertyDescriptor(Set.prototype, "size") : null,
                    c = s && l && "function" == typeof l.get ? l.get : null,
                    u = s && Set.prototype.forEach,
                    d = "function" == typeof WeakMap && WeakMap.prototype ? WeakMap.prototype.has : null,
                    h = "function" == typeof WeakSet && WeakSet.prototype ? WeakSet.prototype.has : null,
                    f = "function" == typeof WeakRef && WeakRef.prototype ? WeakRef.prototype.deref : null,
                    m = Boolean.prototype.valueOf,
                    g = Object.prototype.toString,
                    p = Function.prototype.toString,
                    v = String.prototype.match,
                    y = String.prototype.slice,
                    b = String.prototype.replace,
                    w = String.prototype.toUpperCase,
                    x = String.prototype.toLowerCase,
                    T = RegExp.prototype.test,
                    I = Array.prototype.concat,
                    E = Array.prototype.join,
                    S = Array.prototype.slice,
                    A = Math.floor,
                    C = "function" == typeof BigInt ? BigInt.prototype.valueOf : null,
                    M = Object.getOwnPropertySymbols,
                    D = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? Symbol.prototype.toString : null,
                    P = "function" == typeof Symbol && "object" == typeof Symbol.iterator,
                    k = "function" == typeof Symbol && Symbol.toStringTag && (typeof Symbol.toStringTag === P || "symbol") ? Symbol.toStringTag : null,
                    _ = Object.prototype.propertyIsEnumerable,
                    L = ("function" == typeof Reflect ? Reflect.getPrototypeOf : Object.getPrototypeOf) || ([].__proto__ === Array.prototype ? function(e) {
                        return e.__proto__
                    } : null);

                function O(e, t) {
                    if (e === 1 / 0 || e === -1 / 0 || e != e || e && e > -1e3 && e < 1e3 || T.call(/e/, t)) return t;
                    var n = /[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;
                    if ("number" == typeof e) {
                        var o = e < 0 ? -A(-e) : A(e);
                        if (o !== e) {
                            var r = String(o),
                                a = y.call(t, r.length + 1);
                            return b.call(r, n, "$&_") + "." + b.call(b.call(a, /([0-9]{3})/g, "$&_"), /_$/, "")
                        }
                    }
                    return b.call(t, n, "$&_")
                }
                var R = n(2634),
                    N = R.custom,
                    U = W(N) ? N : null,
                    B = {
                        __proto__: null,
                        double: '"',
                        single: "'"
                    },
                    V = {
                        __proto__: null,
                        double: /(["\\])/g,
                        single: /(['\\])/g
                    };

                function F(e, t, n) {
                    var o = n.quoteStyle || t,
                        r = B[o];
                    return r + e + r
                }

                function H(e) {
                    return b.call(String(e), /"/g, "&quot;")
                }

                function q(e) {
                    return !k || !("object" == typeof e && (k in e || void 0 !== e[k]))
                }

                function j(e) {
                    return "[object Array]" === Z(e) && q(e)
                }

                function z(e) {
                    return "[object RegExp]" === Z(e) && q(e)
                }

                function W(e) {
                    if (P) return e && "object" == typeof e && e instanceof Symbol;
                    if ("symbol" == typeof e) return !0;
                    if (!e || "object" != typeof e || !D) return !1;
                    try {
                        return D.call(e), !0
                    } catch (e) {}
                    return !1
                }
                e.exports = function e(t, o, r, s) {
                    var l = o || {};
                    if (Y(l, "quoteStyle") && !Y(B, l.quoteStyle)) throw new TypeError('option "quoteStyle" must be "single" or "double"');
                    if (Y(l, "maxStringLength") && ("number" == typeof l.maxStringLength ? l.maxStringLength < 0 && l.maxStringLength !== 1 / 0 : null !== l.maxStringLength)) throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');
                    var g = !Y(l, "customInspect") || l.customInspect;
                    if ("boolean" != typeof g && "symbol" !== g) throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");
                    if (Y(l, "indent") && null !== l.indent && "\t" !== l.indent && !(parseInt(l.indent, 10) === l.indent && l.indent > 0)) throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');
                    if (Y(l, "numericSeparator") && "boolean" != typeof l.numericSeparator) throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');
                    var w = l.numericSeparator;
                    if (void 0 === t) return "undefined";
                    if (null === t) return "null";
                    if ("boolean" == typeof t) return t ? "true" : "false";
                    if ("string" == typeof t) return X(t, l);
                    if ("number" == typeof t) {
                        if (0 === t) return 1 / 0 / t > 0 ? "0" : "-0";
                        var T = String(t);
                        return w ? O(t, T) : T
                    }
                    if ("bigint" == typeof t) {
                        var A = String(t) + "n";
                        return w ? O(t, A) : A
                    }
                    var M = void 0 === l.depth ? 5 : l.depth;
                    if (void 0 === r && (r = 0), r >= M && M > 0 && "object" == typeof t) return j(t) ? "[Array]" : "[Object]";
                    var N = function(e, t) {
                        var n;
                        if ("\t" === e.indent) n = "\t";
                        else {
                            if (!("number" == typeof e.indent && e.indent > 0)) return null;
                            n = E.call(Array(e.indent + 1), " ")
                        }
                        return {
                            base: n,
                            prev: E.call(Array(t + 1), n)
                        }
                    }(l, r);
                    if (void 0 === s) s = [];
                    else if (K(s, t) >= 0) return "[Circular]";

                    function V(t, n, o) {
                        if (n && (s = S.call(s)).push(n), o) {
                            var a = {
                                depth: l.depth
                            };
                            return Y(l, "quoteStyle") && (a.quoteStyle = l.quoteStyle), e(t, a, r + 1, s)
                        }
                        return e(t, l, r + 1, s)
                    }
                    if ("function" == typeof t && !z(t)) {
                        var G = function(e) {
                                if (e.name) return e.name;
                                var t = v.call(p.call(e), /^function\s*([\w$]+)/);
                                if (t) return t[1];
                                return null
                            }(t),
                            J = ne(t, V);
                        return "[Function" + (G ? ": " + G : " (anonymous)") + "]" + (J.length > 0 ? " { " + E.call(J, ", ") + " }" : "")
                    }
                    if (W(t)) {
                        var oe = P ? b.call(String(t), /^(Symbol\(.*\))_[^)]*$/, "$1") : D.call(t);
                        return "object" != typeof t || P ? oe : Q(oe)
                    }
                    if (function(e) {
                            if (!e || "object" != typeof e) return !1;
                            if ("undefined" != typeof HTMLElement && e instanceof HTMLElement) return !0;
                            return "string" == typeof e.nodeName && "function" == typeof e.getAttribute
                        }(t)) {
                        for (var re = "<" + x.call(String(t.nodeName)), ae = t.attributes || [], ie = 0; ie < ae.length; ie++) re += " " + ae[ie].name + "=" + F(H(ae[ie].value), "double", l);
                        return re += ">", t.childNodes && t.childNodes.length && (re += "..."), re += "</" + x.call(String(t.nodeName)) + ">"
                    }
                    if (j(t)) {
                        if (0 === t.length) return "[]";
                        var se = ne(t, V);
                        return N && ! function(e) {
                            for (var t = 0; t < e.length; t++)
                                if (K(e[t], "\n") >= 0) return !1;
                            return !0
                        }(se) ? "[" + te(se, N) + "]" : "[ " + E.call(se, ", ") + " ]"
                    }
                    if (function(e) {
                            return "[object Error]" === Z(e) && q(e)
                        }(t)) {
                        var le = ne(t, V);
                        return "cause" in Error.prototype || !("cause" in t) || _.call(t, "cause") ? 0 === le.length ? "[" + String(t) + "]" : "{ [" + String(t) + "] " + E.call(le, ", ") + " }" : "{ [" + String(t) + "] " + E.call(I.call("[cause]: " + V(t.cause), le), ", ") + " }"
                    }
                    if ("object" == typeof t && g) {
                        if (U && "function" == typeof t[U] && R) return R(t, {
                            depth: M - r
                        });
                        if ("symbol" !== g && "function" == typeof t.inspect) return t.inspect()
                    }
                    if (function(e) {
                            if (!a || !e || "object" != typeof e) return !1;
                            try {
                                a.call(e);
                                try {
                                    c.call(e)
                                } catch (e) {
                                    return !0
                                }
                                return e instanceof Map
                            } catch (e) {}
                            return !1
                        }(t)) {
                        var ce = [];
                        return i && i.call(t, (function(e, n) {
                            ce.push(V(n, t, !0) + " => " + V(e, t))
                        })), ee("Map", a.call(t), ce, N)
                    }
                    if (function(e) {
                            if (!c || !e || "object" != typeof e) return !1;
                            try {
                                c.call(e);
                                try {
                                    a.call(e)
                                } catch (e) {
                                    return !0
                                }
                                return e instanceof Set
                            } catch (e) {}
                            return !1
                        }(t)) {
                        var ue = [];
                        return u && u.call(t, (function(e) {
                            ue.push(V(e, t))
                        })), ee("Set", c.call(t), ue, N)
                    }
                    if (function(e) {
                            if (!d || !e || "object" != typeof e) return !1;
                            try {
                                d.call(e, d);
                                try {
                                    h.call(e, h)
                                } catch (e) {
                                    return !0
                                }
                                return e instanceof WeakMap
                            } catch (e) {}
                            return !1
                        }(t)) return $("WeakMap");
                    if (function(e) {
                            if (!h || !e || "object" != typeof e) return !1;
                            try {
                                h.call(e, h);
                                try {
                                    d.call(e, d)
                                } catch (e) {
                                    return !0
                                }
                                return e instanceof WeakSet
                            } catch (e) {}
                            return !1
                        }(t)) return $("WeakSet");
                    if (function(e) {
                            if (!f || !e || "object" != typeof e) return !1;
                            try {
                                return f.call(e), !0
                            } catch (e) {}
                            return !1
                        }(t)) return $("WeakRef");
                    if (function(e) {
                            return "[object Number]" === Z(e) && q(e)
                        }(t)) return Q(V(Number(t)));
                    if (function(e) {
                            if (!e || "object" != typeof e || !C) return !1;
                            try {
                                return C.call(e), !0
                            } catch (e) {}
                            return !1
                        }(t)) return Q(V(C.call(t)));
                    if (function(e) {
                            return "[object Boolean]" === Z(e) && q(e)
                        }(t)) return Q(m.call(t));
                    if (function(e) {
                            return "[object String]" === Z(e) && q(e)
                        }(t)) return Q(V(String(t)));
                    if ("undefined" != typeof window && t === window) return "{ [object Window] }";
                    if ("undefined" != typeof globalThis && t === globalThis || void 0 !== n.g && t === n.g) return "{ [object globalThis] }";
                    if (! function(e) {
                            return "[object Date]" === Z(e) && q(e)
                        }(t) && !z(t)) {
                        var de = ne(t, V),
                            he = L ? L(t) === Object.prototype : t instanceof Object || t.constructor === Object,
                            fe = t instanceof Object ? "" : "null prototype",
                            me = !he && k && Object(t) === t && k in t ? y.call(Z(t), 8, -1) : fe ? "Object" : "",
                            ge = (he || "function" != typeof t.constructor ? "" : t.constructor.name ? t.constructor.name + " " : "") + (me || fe ? "[" + E.call(I.call([], me || [], fe || []), ": ") + "] " : "");
                        return 0 === de.length ? ge + "{}" : N ? ge + "{" + te(de, N) + "}" : ge + "{ " + E.call(de, ", ") + " }"
                    }
                    return String(t)
                };
                var G = Object.prototype.hasOwnProperty || function(e) {
                    return e in this
                };

                function Y(e, t) {
                    return G.call(e, t)
                }

                function Z(e) {
                    return g.call(e)
                }

                function K(e, t) {
                    if (e.indexOf) return e.indexOf(t);
                    for (var n = 0, o = e.length; n < o; n++)
                        if (e[n] === t) return n;
                    return -1
                }

                function X(e, t) {
                    if (e.length > t.maxStringLength) {
                        var n = e.length - t.maxStringLength,
                            o = "... " + n + " more character" + (n > 1 ? "s" : "");
                        return X(y.call(e, 0, t.maxStringLength), t) + o
                    }
                    var r = V[t.quoteStyle || "single"];
                    return r.lastIndex = 0, F(b.call(b.call(e, r, "\\$1"), /[\x00-\x1f]/g, J), "single", t)
                }

                function J(e) {
                    var t = e.charCodeAt(0),
                        n = {
                            8: "b",
                            9: "t",
                            10: "n",
                            12: "f",
                            13: "r"
                        }[t];
                    return n ? "\\" + n : "\\x" + (t < 16 ? "0" : "") + w.call(t.toString(16))
                }

                function Q(e) {
                    return "Object(" + e + ")"
                }

                function $(e) {
                    return e + " { ? }"
                }

                function ee(e, t, n, o) {
                    return e + " (" + t + ") {" + (o ? te(n, o) : E.call(n, ", ")) + "}"
                }

                function te(e, t) {
                    if (0 === e.length) return "";
                    var n = "\n" + t.prev + t.base;
                    return n + E.call(e, "," + n) + "\n" + t.prev
                }

                function ne(e, t) {
                    var n = j(e),
                        o = [];
                    if (n) {
                        o.length = e.length;
                        for (var r = 0; r < e.length; r++) o[r] = Y(e, r) ? t(e[r], e) : ""
                    }
                    var a, i = "function" == typeof M ? M(e) : [];
                    if (P) {
                        a = {};
                        for (var s = 0; s < i.length; s++) a["$" + i[s]] = i[s]
                    }
                    for (var l in e) Y(e, l) && (n && String(Number(l)) === l && l < e.length || P && a["$" + l] instanceof Symbol || (T.call(/[^\w$]/, l) ? o.push(t(l, e) + ": " + t(e[l], e)) : o.push(l + ": " + t(e[l], e))));
                    if ("function" == typeof M)
                        for (var c = 0; c < i.length; c++) _.call(e, i[c]) && o.push("[" + t(i[c]) + "]: " + t(e[i[c]], e));
                    return o
                }
            },
            8962: e => {
                "use strict";
                e.exports = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABv1BMVEUAAAA9AACkAAAyAABCAADgAAAsAAAjAADIAACXAABOAAARAADjAACwAACrAACJAABgAAA2AAAXAAByAADnAQDMAAB+AABUAAAvAAAeAABsAAAIAAD1BABGAQDrAAC7AABJAAA5AAAoAABoAQG1AgCfAQCNAAB6AABaAADXAADUAACQAADvAQC4AACFAAC+BADbAADQAADBAACtAACTAAD1DgDwCwDdAACoAABdAAD//v3+8OWbBQHDAQCEAACCAAD98u/96dr53dX948rikXzYDgT2PAD0LQB1AAD+8uvy2NPzx8DzyLT8z6b2tKTUqaPrrqLxn4r6q4TLeXLccWPGX0n0cUjgYkbPXUD4gz3lSjzLSjO/NS6ZKybwTyTPIhmnGxG7JQyvEwh6CAfDKwaoDQbKDgH2VwD2QQD1HQDhCwDdBwDy0sn82rrit7H1x6D6t5fbmpD6sI7xqY7LkYjrl4bzg3e8fXf1lHPLhm7qalbMZlT5glOIVUfWUUTuYT/zeDi4UzigPTi2PDTtXy+gLif3WB7iMhqVHhTrOA6eEQ25EAxyDgvTFQjrFwd+JQX3YgK1PgH3RgDoLgCGLABPErVgAAAC7ElEQVQ4y9WS1a4bQQxAZ2ZnmZmShWQpfAMNlJmZmZmZmZk/uNuqb/2C+sGSdY5tyTL4z4LnNQdzVcwVioJd/h+uQmwNW3qRJ6K1MMyK6l/F/9uOIcT1Ymgw3d54YLOJrnLuH6Lx/m+uRxnTa0ntcRXQJ+ctMipkFnnu737adXkcLelO51Xmrfl+9lhpfzm7uizaIuZi2gUF5SyZcV1mXKlU1pz5+q0Ufp5ZXakIxgRByMbAc7yUW9KVUaddGqt/4Fg5fW4cNNi6slan5BxgAs3yEU1ApR8Ewfg8QwoXzgmSrtIQuhqWAFW1VFbSaIhClDYDhgna5y/0bQfXqzXf5y1A25hCulNVGqSULyI/77+//0jfsrmhJOOY0AigRgRdEHoYMr21erLq9rr5SzcclEaQZZEoQ40HMKI03s0aZkfU6/qh5cs2XVq3pZ5XF6ds0op1F0S2q2memSIUJkn4YsGyFSsWbDmBuixrZWKEcoBYjVfZQdg78ubW7uN35m/YtnnB+lfMsaMLF8steyqCpyd9H9rWqSdX923ctfLK8qO9Dzvmb1x54OW2PUihWilY8Iz3aZrWHt3Yfv31vhVLn3ffX5u/6eHuzdvvwcJVcrD+EA/8Gq8Rbx8cfrd359aLNy8vX3lg7+G7Bz8qkC4Wgx0nfKD5hJwjlIQym+5cuuyxKKWrPg07fY+yLbBwxgNa0xtmeZlFTIJObd3DmH2yL5pCgGI1AjJH03W4UBCayBNNZiDvOs6Y5VE6RjsYxREHdIXjlsiSYQwW260OkqzTLTZpisqo0UwVT0SAGUxZaSrOmR6siz05Q6syT5pj7Co7ypApCMAgSXKuaTIyVKE9s5UsXTvz8nqd7QyYRtBuA3IikAJJmsORgnH581EVw1glsMWQRiD8mWAYv6dMJI5SYwyhqkLoqATBdcPm3NwECMKfHWGLo2s1ynEIgigpRVAUgQvPkkFj0mgumlpcTFElpN2aQ9R+q4RTJsqhfgHJO3I6nMyA7AAAAABJRU5ErkJggg=="
            },
            8968: e => {
                "use strict";
                e.exports = Math.floor
            },
            9083: (e, t, n) => {
                "use strict";
                n.d(t, {
                    q: () => m
                });
                var o = n(9584),
                    r = n(281),
                    a = n(9473);
                const i = (0, r.importInternal)("base/BaseAnnotationTool"),
                    s = new a.PC;

                function l() {
                    return function() {
                        const e = [];
                        for (const [t, {
                                tool: n
                            }] of Object.entries(r.store.state.globalTools)) new n instanceof i && e.push(n);
                        return e
                    }().map((e => (new e).name))
                }
                var c = n(8398),
                    u = n(736),
                    d = n(4594),
                    h = function(e, t, n, o) {
                        return new(n || (n = Promise))((function(r, a) {
                            function i(e) {
                                try {
                                    l(o.next(e))
                                } catch (e) {
                                    a(e)
                                }
                            }

                            function s(e) {
                                try {
                                    l(o.throw(e))
                                } catch (e) {
                                    a(e)
                                }
                            }

                            function l(e) {
                                var t;
                                e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                                    e(t)
                                }))).then(i, s)
                            }
                            l((o = o.apply(e, t || [])).next())
                        }))
                    };
                let f = !0;

                function m(e) {
                    return h(this, void 0, void 0, (function*() {
                        var t;
                        f = e;
                        const {
                            layoutView: n
                        } = d.A.webDicomView;
                        if (n) {
                            f ? (yield(0, c.uk)(), (0, c.wf)(n.querySelectorForTool(".visibilityLabels"), !1)) : null === (t = n.querySelectorForTool(".disableAllTool")) || void 0 === t || t.click();
                            for (let {
                                    element: e
                                } of yield(0, u.A)(!0))(0, o.updateImage)(e)
                        }
                    }))
                }
                r.globalImageIdSpecificToolStateManager._get = r.globalImageIdSpecificToolStateManager.get, r.globalImageIdSpecificToolStateManager.get = function(e, t) {
                    if (!f && s.get(l).includes(t)) return;
                    const {
                        imageId: n
                    } = (0, o.getImage)(e), {
                        imageUID: a
                    } = o.metaData.get("_IDModule", n);
                    return r.globalImageIdSpecificToolStateManager.getImageIdToolState(a, t)
                }, r.globalImageIdSpecificToolStateManager._add = r.globalImageIdSpecificToolStateManager.add, r.globalImageIdSpecificToolStateManager.add = function(e, t, n) {
                    f || m(!0);
                    const {
                        imageId: a
                    } = (0, o.getImage)(e), {
                        imageUID: i,
                        seriesUID: s,
                        studyUID: l
                    } = o.metaData.get("_IDModule", a);
                    r.globalImageIdSpecificToolStateManager.addImageIdToolState(i, t, n), r.globalImageIdSpecificToolStateManager.setImageIdToolState(i, "baseInfo", {
                        imageUID: i,
                        seriesUID: s,
                        studyUID: l
                    })
                }, r.globalImageIdSpecificToolStateManager._set = r.globalImageIdSpecificToolStateManager.set, r.globalImageIdSpecificToolStateManager.set = function(e, t, n) {
                    const {
                        imageId: a
                    } = (0, o.getImage)(e), {
                        imageUID: i,
                        seriesUID: s,
                        studyUID: l
                    } = o.metaData.get("_IDModule", a);
                    r.globalImageIdSpecificToolStateManager.setImageIdToolState(i, t, n), r.globalImageIdSpecificToolStateManager.setImageIdToolState(i, "baseInfo", {
                        imageUID: i,
                        seriesUID: s,
                        studyUID: l
                    })
                }, r.globalImageIdSpecificToolStateManager._clear = r.globalImageIdSpecificToolStateManager.clear, r.globalImageIdSpecificToolStateManager.clear = function(e) {
                    const {
                        imageId: t
                    } = (0, o.getImage)(e), {
                        imageUID: n
                    } = o.metaData.get("_IDModule", t);
                    return r.globalImageIdSpecificToolStateManager.clearImageIdToolState(n)
                }
            },
            9093: (e, t, n) => {
                "use strict";
                n.d(t, {
                    $V: () => m,
                    IU: () => g,
                    K2: () => f,
                    dt: () => h,
                    lY: () => d,
                    zr: () => p
                });
                var o = n(9584),
                    r = n(281),
                    a = n(3893),
                    i = n(4594),
                    s = n(7369),
                    l = n(9473);
                const c = {
                    stackPositionSynchronizer: r.stackImagePositionSynchronizer,
                    stackIndexSynchronizer: r.stackImageIndexSynchronizer,
                    stackScrollSynchronizer: a.cY
                };

                function u() {
                    return new r.Synchronizer(`${o.EVENTS.NEW_IMAGE} ${r.EVENTS.STACK_SCROLL}`, c[i.A.tackSynchronizerType])
                }
                let d = u();
                const h = (0, l.sg)((function() {
                    return (0, s.A)(d, !0)
                }), 500);

                function f(e) {
                    d.enabled = !1, d.timer && clearTimeout(d.timer), d.timer = setTimeout((() => {
                        d.enabled = !0
                    }), e)
                }

                function m(e) {
                    const t = c[e];
                    if (!t) throw "synchronizer is not available";
                    i.A.tackSynchronizerType = e, d.setHandler(t)
                }

                function g() {
                    d.destroy()
                }

                function p() {
                    g(), d = u()
                }
            },
            9141: e => {
                "use strict";
                e.exports = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAACVVBMVEU/S7/W3OfU2uhVa9pfeORngeleduKctvvK1u5cc+BZcN/G1fPa2+C0yfpyjO3R2uu5zPVjfOarxPxOYdJLXM6wx/qguvqetvd/mvPD0fF4kvGKnutIVsaWsvytw/m8z/eku/eTrPaasfS+zvO6yfBvi+5sh+xpf+PY1dzi1tJEUsWzDSemwP2Ur/e1yfayxfWtvvGouvGEnvF/l+2otupwiepqhOqksuluhuhjeuJSZtfm1s1JWcuyID25HTC2y/qMqPnB0vWCnfV6lvKXrPDG0+90j++ywO17lO2NouzFz+qsuerO1+l9lOlqguZlfuaFleJZbttiddlMXtBRX8ro1MjuwKmuAR+vw/WLpvWgtfKSqfKIofLN2O6Qpe6Dmuu4w+p5kOqVpud0ieSyu+Ntg+PQ0eKxt9+ys97Nyt1ofNxfdNzIxttqfdvf2dhVaNXYz9RqedTk1M1TXsWymsPrxrXBlam3W3e6RV3NVVe1ESiowPeGove+yeydr+qKnOXU1eKRn+HEx+C+wuCboNvCwdpvgdrU0NnFudPk2NGhl89hbc3i0czqz8HKrrebhbTNnqnxvaS+iKGye5/Kjpq5fZrxspfZl5PPhozaioLbf3TBXm+mO2XGSFG+OEi5MUbGPUK/JzKcq+jKz+SfquKpq95/idOYkNDczc64q86/ts2eisRsbsLAqb/Wtrrfvri2k7bhubGugabhrqTbpqGMWpbnp5SxbJHxqo2/dIutYYeiVoTHcH2nUHviiHixTnDNaW6/VWnFWWLFUFytN1uzME3DMjdGkMgXAAADLElEQVQ4y9WQ05IkYRBG/6rqUpfbtm3MdPfYxs6szbG1tm3bto3n2pq929gn2C8vMjLPiciIBP9ZDLnO/cO7VjUna+Otw52Gf3i7O2Vl1PMq6pbWBNeb1bW7/lYMq1Lu5ljtSs/OHfdGdi5LL9VnV3T+IfIO3yzfnLnRt33+Gu/IAzB66MC2A8VDm5KtowD4AFKE5PpdlZVr5hTPGT969JBoH+7qEgdvjXtF+yACKkhseROLbxsp3rt3/NSbiVnhVFfxgMezuqGnP50FG7DWBBusvNaw3TvgHe96PLz/Vt9BL91oicX1eunyrSCFJZrq0ogEbbpO07R3qH63Z8tBT40+24aigx09KwGZXJBNr5QjaJSPRFcPaLU07dm9bgXmXpKR5gyKrQDRuXojejITJ+Aaq3bLnSNnjuypX1CdDDM2dwsmbweCU4Is69U7zGX2xQv5dR/83f6fY2F1TzQgC9maFQqAOkm5omhTI2UumRcrvZ0vXPnlvxAPZmyyAD8/W9cJWF1Rh3xJvUymNDscG8dmClevzlxYbDIGAkY8vMq0HESicgWmKjNv3PPo/Jm177svf53y5/fV312bsOGqamUJOPvQ52vWGdecvvjp0snzl/I3HUtfd1+enDj97URE06aSgZlnOZ/47tGX36enX50r+O/j6c/dV86dvTg92V87WG4E+X0KkEMU8vYdx188PXZyKv/xR2HyybHnX8Zam1qQuBG8qzOADl+vzSqb67Djgchbf2EixMhWr2N4Qi9dZgVRjQIg8s0cUcLgZVSJsmHqRBVFwARDQHQDKrAAZxFE405AMGHawFBUGX58LUVRfIiHaHp+i7MalGpYXRCfC0H2YLXKLFMa+9QWfhFTbmkk1mvmhUxAa1dalEqGq4qhS0J2XGUaUpcyjVpdxqLCTVUwBCAIgjmConBUQHUVFeXqRKlm4eJYuYW3V3HiGQDDkFgwFVZpXC6Xk3U6XWiLIEkt0MKQGBiIWGwwzIWTUkFIoaggoKhEDFvpIDiOAyKdvcGrWUQqJTFM8icYJiUlqG6h1QYWcYsI7VwrK0hJcY8UiVIbgrSJTfRJjPwNFme7zxtIt3oAAAAASUVORK5CYII="
            },
            9176: (e, t, n) => {
                "use strict";
                n.d(t, {
                    Ph: () => mn,
                    _n: () => ln,
                    SO: () => cn,
                    Z3: () => sn,
                    nu: () => hn,
                    MY: () => un,
                    QP: () => gn,
                    NZ: () => fn,
                    a9: () => dn
                });
                var o = {};

                function r(e, t) {
                    return function() {
                        return e.apply(t, arguments)
                    }
                }
                n.r(o), n.d(o, {
                    hasBrowserEnv: () => ue,
                    hasStandardBrowserEnv: () => he,
                    hasStandardBrowserWebWorkerEnv: () => fe,
                    navigator: () => de,
                    origin: () => me
                });
                const {
                    toString: a
                } = Object.prototype, {
                    getPrototypeOf: i
                } = Object, s = (l = Object.create(null), e => {
                    const t = a.call(e);
                    return l[t] || (l[t] = t.slice(8, -1).toLowerCase())
                });
                var l;
                const c = e => (e = e.toLowerCase(), t => s(t) === e),
                    u = e => t => typeof t === e,
                    {
                        isArray: d
                    } = Array,
                    h = u("undefined");
                const f = c("ArrayBuffer");
                const m = u("string"),
                    g = u("function"),
                    p = u("number"),
                    v = e => null !== e && "object" == typeof e,
                    y = e => {
                        if ("object" !== s(e)) return !1;
                        const t = i(e);
                        return !(null !== t && t !== Object.prototype && null !== Object.getPrototypeOf(t) || Symbol.toStringTag in e || Symbol.iterator in e)
                    },
                    b = c("Date"),
                    w = c("File"),
                    x = c("Blob"),
                    T = c("FileList"),
                    I = c("URLSearchParams"),
                    [E, S, A, C] = ["ReadableStream", "Request", "Response", "Headers"].map(c);

                function M(e, t, {
                    allOwnKeys: n = !1
                } = {}) {
                    if (null == e) return;
                    let o, r;
                    if ("object" != typeof e && (e = [e]), d(e))
                        for (o = 0, r = e.length; o < r; o++) t.call(null, e[o], o, e);
                    else {
                        const r = n ? Object.getOwnPropertyNames(e) : Object.keys(e),
                            a = r.length;
                        let i;
                        for (o = 0; o < a; o++) i = r[o], t.call(null, e[i], i, e)
                    }
                }

                function D(e, t) {
                    t = t.toLowerCase();
                    const n = Object.keys(e);
                    let o, r = n.length;
                    for (; r-- > 0;)
                        if (o = n[r], t === o.toLowerCase()) return o;
                    return null
                }
                const P = "undefined" != typeof globalThis ? globalThis : "undefined" != typeof self ? self : "undefined" != typeof window ? window : global,
                    k = e => !h(e) && e !== P;
                const _ = (L = "undefined" != typeof Uint8Array && i(Uint8Array), e => L && e instanceof L);
                var L;
                const O = c("HTMLFormElement"),
                    R = (({
                        hasOwnProperty: e
                    }) => (t, n) => e.call(t, n))(Object.prototype),
                    N = c("RegExp"),
                    U = (e, t) => {
                        const n = Object.getOwnPropertyDescriptors(e),
                            o = {};
                        M(n, ((n, r) => {
                            let a;
                            !1 !== (a = t(n, r, e)) && (o[r] = a || n)
                        })), Object.defineProperties(e, o)
                    };
                const B = c("AsyncFunction"),
                    V = (F = "function" == typeof setImmediate, H = g(P.postMessage), F ? setImmediate : H ? (q = `axios@${Math.random()}`, j = [], P.addEventListener("message", (({
                        source: e,
                        data: t
                    }) => {
                        e === P && t === q && j.length && j.shift()()
                    }), !1), e => {
                        j.push(e), P.postMessage(q, "*")
                    }) : e => setTimeout(e));
                var F, H, q, j;
                const z = "undefined" != typeof queueMicrotask ? queueMicrotask.bind(P) : "undefined" != typeof process && process.nextTick || V,
                    W = {
                        isArray: d,
                        isArrayBuffer: f,
                        isBuffer: function(e) {
                            return null !== e && !h(e) && null !== e.constructor && !h(e.constructor) && g(e.constructor.isBuffer) && e.constructor.isBuffer(e)
                        },
                        isFormData: e => {
                            let t;
                            return e && ("function" == typeof FormData && e instanceof FormData || g(e.append) && ("formdata" === (t = s(e)) || "object" === t && g(e.toString) && "[object FormData]" === e.toString()))
                        },
                        isArrayBufferView: function(e) {
                            let t;
                            return t = "undefined" != typeof ArrayBuffer && ArrayBuffer.isView ? ArrayBuffer.isView(e) : e && e.buffer && f(e.buffer), t
                        },
                        isString: m,
                        isNumber: p,
                        isBoolean: e => !0 === e || !1 === e,
                        isObject: v,
                        isPlainObject: y,
                        isReadableStream: E,
                        isRequest: S,
                        isResponse: A,
                        isHeaders: C,
                        isUndefined: h,
                        isDate: b,
                        isFile: w,
                        isBlob: x,
                        isRegExp: N,
                        isFunction: g,
                        isStream: e => v(e) && g(e.pipe),
                        isURLSearchParams: I,
                        isTypedArray: _,
                        isFileList: T,
                        forEach: M,
                        merge: function e() {
                            const {
                                caseless: t
                            } = k(this) && this || {}, n = {}, o = (o, r) => {
                                const a = t && D(n, r) || r;
                                y(n[a]) && y(o) ? n[a] = e(n[a], o) : y(o) ? n[a] = e({}, o) : d(o) ? n[a] = o.slice() : n[a] = o
                            };
                            for (let e = 0, t = arguments.length; e < t; e++) arguments[e] && M(arguments[e], o);
                            return n
                        },
                        extend: (e, t, n, {
                            allOwnKeys: o
                        } = {}) => (M(t, ((t, o) => {
                            n && g(t) ? e[o] = r(t, n) : e[o] = t
                        }), {
                            allOwnKeys: o
                        }), e),
                        trim: e => e.trim ? e.trim() : e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, ""),
                        stripBOM: e => (65279 === e.charCodeAt(0) && (e = e.slice(1)), e),
                        inherits: (e, t, n, o) => {
                            e.prototype = Object.create(t.prototype, o), e.prototype.constructor = e, Object.defineProperty(e, "super", {
                                value: t.prototype
                            }), n && Object.assign(e.prototype, n)
                        },
                        toFlatObject: (e, t, n, o) => {
                            let r, a, s;
                            const l = {};
                            if (t = t || {}, null == e) return t;
                            do {
                                for (r = Object.getOwnPropertyNames(e), a = r.length; a-- > 0;) s = r[a], o && !o(s, e, t) || l[s] || (t[s] = e[s], l[s] = !0);
                                e = !1 !== n && i(e)
                            } while (e && (!n || n(e, t)) && e !== Object.prototype);
                            return t
                        },
                        kindOf: s,
                        kindOfTest: c,
                        endsWith: (e, t, n) => {
                            e = String(e), (void 0 === n || n > e.length) && (n = e.length), n -= t.length;
                            const o = e.indexOf(t, n);
                            return -1 !== o && o === n
                        },
                        toArray: e => {
                            if (!e) return null;
                            if (d(e)) return e;
                            let t = e.length;
                            if (!p(t)) return null;
                            const n = new Array(t);
                            for (; t-- > 0;) n[t] = e[t];
                            return n
                        },
                        forEachEntry: (e, t) => {
                            const n = (e && e[Symbol.iterator]).call(e);
                            let o;
                            for (;
                                (o = n.next()) && !o.done;) {
                                const n = o.value;
                                t.call(e, n[0], n[1])
                            }
                        },
                        matchAll: (e, t) => {
                            let n;
                            const o = [];
                            for (; null !== (n = e.exec(t));) o.push(n);
                            return o
                        },
                        isHTMLForm: O,
                        hasOwnProperty: R,
                        hasOwnProp: R,
                        reduceDescriptors: U,
                        freezeMethods: e => {
                            U(e, ((t, n) => {
                                if (g(e) && -1 !== ["arguments", "caller", "callee"].indexOf(n)) return !1;
                                const o = e[n];
                                g(o) && (t.enumerable = !1, "writable" in t ? t.writable = !1 : t.set || (t.set = () => {
                                    throw Error("Can not rewrite read-only method '" + n + "'")
                                }))
                            }))
                        },
                        toObjectSet: (e, t) => {
                            const n = {},
                                o = e => {
                                    e.forEach((e => {
                                        n[e] = !0
                                    }))
                                };
                            return d(e) ? o(e) : o(String(e).split(t)), n
                        },
                        toCamelCase: e => e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g, (function(e, t, n) {
                            return t.toUpperCase() + n
                        })),
                        noop: () => {},
                        toFiniteNumber: (e, t) => null != e && Number.isFinite(e = +e) ? e : t,
                        findKey: D,
                        global: P,
                        isContextDefined: k,
                        isSpecCompliantForm: function(e) {
                            return !!(e && g(e.append) && "FormData" === e[Symbol.toStringTag] && e[Symbol.iterator])
                        },
                        toJSONObject: e => {
                            const t = new Array(10),
                                n = (e, o) => {
                                    if (v(e)) {
                                        if (t.indexOf(e) >= 0) return;
                                        if (!("toJSON" in e)) {
                                            t[o] = e;
                                            const r = d(e) ? [] : {};
                                            return M(e, ((e, t) => {
                                                const a = n(e, o + 1);
                                                !h(a) && (r[t] = a)
                                            })), t[o] = void 0, r
                                        }
                                    }
                                    return e
                                };
                            return n(e, 0)
                        },
                        isAsyncFn: B,
                        isThenable: e => e && (v(e) || g(e)) && g(e.then) && g(e.catch),
                        setImmediate: V,
                        asap: z
                    };

                function G(e, t, n, o, r) {
                    Error.call(this), Error.captureStackTrace ? Error.captureStackTrace(this, this.constructor) : this.stack = (new Error).stack, this.message = e, this.name = "AxiosError", t && (this.code = t), n && (this.config = n), o && (this.request = o), r && (this.response = r, this.status = r.status ? r.status : null)
                }
                W.inherits(G, Error, {
                    toJSON: function() {
                        return {
                            message: this.message,
                            name: this.name,
                            description: this.description,
                            number: this.number,
                            fileName: this.fileName,
                            lineNumber: this.lineNumber,
                            columnNumber: this.columnNumber,
                            stack: this.stack,
                            config: W.toJSONObject(this.config),
                            code: this.code,
                            status: this.status
                        }
                    }
                });
                const Y = G.prototype,
                    Z = {};
                ["ERR_BAD_OPTION_VALUE", "ERR_BAD_OPTION", "ECONNABORTED", "ETIMEDOUT", "ERR_NETWORK", "ERR_FR_TOO_MANY_REDIRECTS", "ERR_DEPRECATED", "ERR_BAD_RESPONSE", "ERR_BAD_REQUEST", "ERR_CANCELED", "ERR_NOT_SUPPORT", "ERR_INVALID_URL"].forEach((e => {
                    Z[e] = {
                        value: e
                    }
                })), Object.defineProperties(G, Z), Object.defineProperty(Y, "isAxiosError", {
                    value: !0
                }), G.from = (e, t, n, o, r, a) => {
                    const i = Object.create(Y);
                    return W.toFlatObject(e, i, (function(e) {
                        return e !== Error.prototype
                    }), (e => "isAxiosError" !== e)), G.call(i, e.message, t, n, o, r), i.cause = e, i.name = e.name, a && Object.assign(i, a), i
                };
                const K = G;

                function X(e) {
                    return W.isPlainObject(e) || W.isArray(e)
                }

                function J(e) {
                    return W.endsWith(e, "[]") ? e.slice(0, -2) : e
                }

                function Q(e, t, n) {
                    return e ? e.concat(t).map((function(e, t) {
                        return e = J(e), !n && t ? "[" + e + "]" : e
                    })).join(n ? "." : "") : t
                }
                const $ = W.toFlatObject(W, {}, null, (function(e) {
                    return /^is[A-Z]/.test(e)
                }));
                const ee = function(e, t, n) {
                    if (!W.isObject(e)) throw new TypeError("target must be an object");
                    t = t || new FormData, n = W.toFlatObject(n, {
                        metaTokens: !0,
                        dots: !1,
                        indexes: !1
                    }, !1, (function(e, t) {
                        return !W.isUndefined(t[e])
                    }));
                    const o = n.metaTokens,
                        r = n.visitor || c,
                        a = n.dots,
                        i = n.indexes,
                        s = (n.Blob || "undefined" != typeof Blob && Blob) && W.isSpecCompliantForm(t);
                    if (!W.isFunction(r)) throw new TypeError("visitor must be a function");

                    function l(e) {
                        if (null === e) return "";
                        if (W.isDate(e)) return e.toISOString();
                        if (!s && W.isBlob(e)) throw new K("Blob is not supported. Use a Buffer instead.");
                        return W.isArrayBuffer(e) || W.isTypedArray(e) ? s && "function" == typeof Blob ? new Blob([e]) : Buffer.from(e) : e
                    }

                    function c(e, n, r) {
                        let s = e;
                        if (e && !r && "object" == typeof e)
                            if (W.endsWith(n, "{}")) n = o ? n : n.slice(0, -2), e = JSON.stringify(e);
                            else if (W.isArray(e) && function(e) {
                                return W.isArray(e) && !e.some(X)
                            }(e) || (W.isFileList(e) || W.endsWith(n, "[]")) && (s = W.toArray(e))) return n = J(n), s.forEach((function(e, o) {
                            !W.isUndefined(e) && null !== e && t.append(!0 === i ? Q([n], o, a) : null === i ? n : n + "[]", l(e))
                        })), !1;
                        return !!X(e) || (t.append(Q(r, n, a), l(e)), !1)
                    }
                    const u = [],
                        d = Object.assign($, {
                            defaultVisitor: c,
                            convertValue: l,
                            isVisitable: X
                        });
                    if (!W.isObject(e)) throw new TypeError("data must be an object");
                    return function e(n, o) {
                        if (!W.isUndefined(n)) {
                            if (-1 !== u.indexOf(n)) throw Error("Circular reference detected in " + o.join("."));
                            u.push(n), W.forEach(n, (function(n, a) {
                                !0 === (!(W.isUndefined(n) || null === n) && r.call(t, n, W.isString(a) ? a.trim() : a, o, d)) && e(n, o ? o.concat(a) : [a])
                            })), u.pop()
                        }
                    }(e), t
                };

                function te(e) {
                    const t = {
                        "!": "%21",
                        "'": "%27",
                        "(": "%28",
                        ")": "%29",
                        "~": "%7E",
                        "%20": "+",
                        "%00": "\0"
                    };
                    return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g, (function(e) {
                        return t[e]
                    }))
                }

                function ne(e, t) {
                    this._pairs = [], e && ee(e, this, t)
                }
                const oe = ne.prototype;
                oe.append = function(e, t) {
                    this._pairs.push([e, t])
                }, oe.toString = function(e) {
                    const t = e ? function(t) {
                        return e.call(this, t, te)
                    } : te;
                    return this._pairs.map((function(e) {
                        return t(e[0]) + "=" + t(e[1])
                    }), "").join("&")
                };
                const re = ne;

                function ae(e) {
                    return encodeURIComponent(e).replace(/%3A/gi, ":").replace(/%24/g, "$").replace(/%2C/gi, ",").replace(/%20/g, "+").replace(/%5B/gi, "[").replace(/%5D/gi, "]")
                }

                function ie(e, t, n) {
                    if (!t) return e;
                    const o = n && n.encode || ae;
                    W.isFunction(n) && (n = {
                        serialize: n
                    });
                    const r = n && n.serialize;
                    let a;
                    if (a = r ? r(t, n) : W.isURLSearchParams(t) ? t.toString() : new re(t, n).toString(o), a) {
                        const t = e.indexOf("#"); - 1 !== t && (e = e.slice(0, t)), e += (-1 === e.indexOf("?") ? "?" : "&") + a
                    }
                    return e
                }
                const se = class {
                        constructor() {
                            this.handlers = []
                        }
                        use(e, t, n) {
                            return this.handlers.push({
                                fulfilled: e,
                                rejected: t,
                                synchronous: !!n && n.synchronous,
                                runWhen: n ? n.runWhen : null
                            }), this.handlers.length - 1
                        }
                        eject(e) {
                            this.handlers[e] && (this.handlers[e] = null)
                        }
                        clear() {
                            this.handlers && (this.handlers = [])
                        }
                        forEach(e) {
                            W.forEach(this.handlers, (function(t) {
                                null !== t && e(t)
                            }))
                        }
                    },
                    le = {
                        silentJSONParsing: !0,
                        forcedJSONParsing: !0,
                        clarifyTimeoutError: !1
                    },
                    ce = {
                        isBrowser: !0,
                        classes: {
                            URLSearchParams: "undefined" != typeof URLSearchParams ? URLSearchParams : re,
                            FormData: "undefined" != typeof FormData ? FormData : null,
                            Blob: "undefined" != typeof Blob ? Blob : null
                        },
                        protocols: ["http", "https", "file", "blob", "url", "data"]
                    },
                    ue = "undefined" != typeof window && "undefined" != typeof document,
                    de = "object" == typeof navigator && navigator || void 0,
                    he = ue && (!de || ["ReactNative", "NativeScript", "NS"].indexOf(de.product) < 0),
                    fe = "undefined" != typeof WorkerGlobalScope && self instanceof WorkerGlobalScope && "function" == typeof self.importScripts,
                    me = ue && window.location.href || "http://localhost",
                    ge = { ...o,
                        ...ce
                    };
                const pe = function(e) {
                    function t(e, n, o, r) {
                        let a = e[r++];
                        if ("__proto__" === a) return !0;
                        const i = Number.isFinite(+a),
                            s = r >= e.length;
                        if (a = !a && W.isArray(o) ? o.length : a, s) return W.hasOwnProp(o, a) ? o[a] = [o[a], n] : o[a] = n, !i;
                        o[a] && W.isObject(o[a]) || (o[a] = []);
                        return t(e, n, o[a], r) && W.isArray(o[a]) && (o[a] = function(e) {
                            const t = {},
                                n = Object.keys(e);
                            let o;
                            const r = n.length;
                            let a;
                            for (o = 0; o < r; o++) a = n[o], t[a] = e[a];
                            return t
                        }(o[a])), !i
                    }
                    if (W.isFormData(e) && W.isFunction(e.entries)) {
                        const n = {};
                        return W.forEachEntry(e, ((e, o) => {
                            t(function(e) {
                                return W.matchAll(/\w+|\[(\w*)]/g, e).map((e => "[]" === e[0] ? "" : e[1] || e[0]))
                            }(e), o, n, 0)
                        })), n
                    }
                    return null
                };
                const ve = {
                    transitional: le,
                    adapter: ["xhr", "http", "fetch"],
                    transformRequest: [function(e, t) {
                        const n = t.getContentType() || "",
                            o = n.indexOf("application/json") > -1,
                            r = W.isObject(e);
                        r && W.isHTMLForm(e) && (e = new FormData(e));
                        if (W.isFormData(e)) return o ? JSON.stringify(pe(e)) : e;
                        if (W.isArrayBuffer(e) || W.isBuffer(e) || W.isStream(e) || W.isFile(e) || W.isBlob(e) || W.isReadableStream(e)) return e;
                        if (W.isArrayBufferView(e)) return e.buffer;
                        if (W.isURLSearchParams(e)) return t.setContentType("application/x-www-form-urlencoded;charset=utf-8", !1), e.toString();
                        let a;
                        if (r) {
                            if (n.indexOf("application/x-www-form-urlencoded") > -1) return function(e, t) {
                                return ee(e, new ge.classes.URLSearchParams, Object.assign({
                                    visitor: function(e, t, n, o) {
                                        return ge.isNode && W.isBuffer(e) ? (this.append(t, e.toString("base64")), !1) : o.defaultVisitor.apply(this, arguments)
                                    }
                                }, t))
                            }(e, this.formSerializer).toString();
                            if ((a = W.isFileList(e)) || n.indexOf("multipart/form-data") > -1) {
                                const t = this.env && this.env.FormData;
                                return ee(a ? {
                                    "files[]": e
                                } : e, t && new t, this.formSerializer)
                            }
                        }
                        return r || o ? (t.setContentType("application/json", !1), function(e, t, n) {
                            if (W.isString(e)) try {
                                return (t || JSON.parse)(e), W.trim(e)
                            } catch (e) {
                                if ("SyntaxError" !== e.name) throw e
                            }
                            return (n || JSON.stringify)(e)
                        }(e)) : e
                    }],
                    transformResponse: [function(e) {
                        const t = this.transitional || ve.transitional,
                            n = t && t.forcedJSONParsing,
                            o = "json" === this.responseType;
                        if (W.isResponse(e) || W.isReadableStream(e)) return e;
                        if (e && W.isString(e) && (n && !this.responseType || o)) {
                            const n = !(t && t.silentJSONParsing) && o;
                            try {
                                return JSON.parse(e)
                            } catch (e) {
                                if (n) {
                                    if ("SyntaxError" === e.name) throw K.from(e, K.ERR_BAD_RESPONSE, this, null, this.response);
                                    throw e
                                }
                            }
                        }
                        return e
                    }],
                    timeout: 0,
                    xsrfCookieName: "XSRF-TOKEN",
                    xsrfHeaderName: "X-XSRF-TOKEN",
                    maxContentLength: -1,
                    maxBodyLength: -1,
                    env: {
                        FormData: ge.classes.FormData,
                        Blob: ge.classes.Blob
                    },
                    validateStatus: function(e) {
                        return e >= 200 && e < 300
                    },
                    headers: {
                        common: {
                            Accept: "application/json, text/plain, */*",
                            "Content-Type": void 0
                        }
                    }
                };
                W.forEach(["delete", "get", "head", "post", "put", "patch"], (e => {
                    ve.headers[e] = {}
                }));
                const ye = ve,
                    be = W.toObjectSet(["age", "authorization", "content-length", "content-type", "etag", "expires", "from", "host", "if-modified-since", "if-unmodified-since", "last-modified", "location", "max-forwards", "proxy-authorization", "referer", "retry-after", "user-agent"]),
                    we = Symbol("internals");

                function xe(e) {
                    return e && String(e).trim().toLowerCase()
                }

                function Te(e) {
                    return !1 === e || null == e ? e : W.isArray(e) ? e.map(Te) : String(e)
                }

                function Ie(e, t, n, o, r) {
                    return W.isFunction(o) ? o.call(this, t, n) : (r && (t = n), W.isString(t) ? W.isString(o) ? -1 !== t.indexOf(o) : W.isRegExp(o) ? o.test(t) : void 0 : void 0)
                }
                class Ee {
                    constructor(e) {
                        e && this.set(e)
                    }
                    set(e, t, n) {
                        const o = this;

                        function r(e, t, n) {
                            const r = xe(t);
                            if (!r) throw new Error("header name must be a non-empty string");
                            const a = W.findKey(o, r);
                            (!a || void 0 === o[a] || !0 === n || void 0 === n && !1 !== o[a]) && (o[a || t] = Te(e))
                        }
                        const a = (e, t) => W.forEach(e, ((e, n) => r(e, n, t)));
                        if (W.isPlainObject(e) || e instanceof this.constructor) a(e, t);
                        else if (W.isString(e) && (e = e.trim()) && !/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim())) a((e => {
                            const t = {};
                            let n, o, r;
                            return e && e.split("\n").forEach((function(e) {
                                r = e.indexOf(":"), n = e.substring(0, r).trim().toLowerCase(), o = e.substring(r + 1).trim(), !n || t[n] && be[n] || ("set-cookie" === n ? t[n] ? t[n].push(o) : t[n] = [o] : t[n] = t[n] ? t[n] + ", " + o : o)
                            })), t
                        })(e), t);
                        else if (W.isHeaders(e))
                            for (const [t, o] of e.entries()) r(o, t, n);
                        else null != e && r(t, e, n);
                        return this
                    }
                    get(e, t) {
                        if (e = xe(e)) {
                            const n = W.findKey(this, e);
                            if (n) {
                                const e = this[n];
                                if (!t) return e;
                                if (!0 === t) return function(e) {
                                    const t = Object.create(null),
                                        n = /([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;
                                    let o;
                                    for (; o = n.exec(e);) t[o[1]] = o[2];
                                    return t
                                }(e);
                                if (W.isFunction(t)) return t.call(this, e, n);
                                if (W.isRegExp(t)) return t.exec(e);
                                throw new TypeError("parser must be boolean|regexp|function")
                            }
                        }
                    }
                    has(e, t) {
                        if (e = xe(e)) {
                            const n = W.findKey(this, e);
                            return !(!n || void 0 === this[n] || t && !Ie(0, this[n], n, t))
                        }
                        return !1
                    }
                    delete(e, t) {
                        const n = this;
                        let o = !1;

                        function r(e) {
                            if (e = xe(e)) {
                                const r = W.findKey(n, e);
                                !r || t && !Ie(0, n[r], r, t) || (delete n[r], o = !0)
                            }
                        }
                        return W.isArray(e) ? e.forEach(r) : r(e), o
                    }
                    clear(e) {
                        const t = Object.keys(this);
                        let n = t.length,
                            o = !1;
                        for (; n--;) {
                            const r = t[n];
                            e && !Ie(0, this[r], r, e, !0) || (delete this[r], o = !0)
                        }
                        return o
                    }
                    normalize(e) {
                        const t = this,
                            n = {};
                        return W.forEach(this, ((o, r) => {
                            const a = W.findKey(n, r);
                            if (a) return t[a] = Te(o), void delete t[r];
                            const i = e ? function(e) {
                                return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g, ((e, t, n) => t.toUpperCase() + n))
                            }(r) : String(r).trim();
                            i !== r && delete t[r], t[i] = Te(o), n[i] = !0
                        })), this
                    }
                    concat(...e) {
                        return this.constructor.concat(this, ...e)
                    }
                    toJSON(e) {
                        const t = Object.create(null);
                        return W.forEach(this, ((n, o) => {
                            null != n && !1 !== n && (t[o] = e && W.isArray(n) ? n.join(", ") : n)
                        })), t
                    }[Symbol.iterator]() {
                        return Object.entries(this.toJSON())[Symbol.iterator]()
                    }
                    toString() {
                        return Object.entries(this.toJSON()).map((([e, t]) => e + ": " + t)).join("\n")
                    }
                    get[Symbol.toStringTag]() {
                        return "AxiosHeaders"
                    }
                    static from(e) {
                        return e instanceof this ? e : new this(e)
                    }
                    static concat(e, ...t) {
                        const n = new this(e);
                        return t.forEach((e => n.set(e))), n
                    }
                    static accessor(e) {
                        const t = (this[we] = this[we] = {
                                accessors: {}
                            }).accessors,
                            n = this.prototype;

                        function o(e) {
                            const o = xe(e);
                            t[o] || (! function(e, t) {
                                const n = W.toCamelCase(" " + t);
                                ["get", "set", "has"].forEach((o => {
                                    Object.defineProperty(e, o + n, {
                                        value: function(e, n, r) {
                                            return this[o].call(this, t, e, n, r)
                                        },
                                        configurable: !0
                                    })
                                }))
                            }(n, e), t[o] = !0)
                        }
                        return W.isArray(e) ? e.forEach(o) : o(e), this
                    }
                }
                Ee.accessor(["Content-Type", "Content-Length", "Accept", "Accept-Encoding", "User-Agent", "Authorization"]), W.reduceDescriptors(Ee.prototype, (({
                    value: e
                }, t) => {
                    let n = t[0].toUpperCase() + t.slice(1);
                    return {
                        get: () => e,
                        set(e) {
                            this[n] = e
                        }
                    }
                })), W.freezeMethods(Ee);
                const Se = Ee;

                function Ae(e, t) {
                    const n = this || ye,
                        o = t || n,
                        r = Se.from(o.headers);
                    let a = o.data;
                    return W.forEach(e, (function(e) {
                        a = e.call(n, a, r.normalize(), t ? t.status : void 0)
                    })), r.normalize(), a
                }

                function Ce(e) {
                    return !(!e || !e.__CANCEL__)
                }

                function Me(e, t, n) {
                    K.call(this, null == e ? "canceled" : e, K.ERR_CANCELED, t, n), this.name = "CanceledError"
                }
                W.inherits(Me, K, {
                    __CANCEL__: !0
                });
                const De = Me;

                function Pe(e, t, n) {
                    const o = n.config.validateStatus;
                    n.status && o && !o(n.status) ? t(new K("Request failed with status code " + n.status, [K.ERR_BAD_REQUEST, K.ERR_BAD_RESPONSE][Math.floor(n.status / 100) - 4], n.config, n.request, n)) : e(n)
                }
                const ke = function(e, t) {
                    e = e || 10;
                    const n = new Array(e),
                        o = new Array(e);
                    let r, a = 0,
                        i = 0;
                    return t = void 0 !== t ? t : 1e3,
                        function(s) {
                            const l = Date.now(),
                                c = o[i];
                            r || (r = l), n[a] = s, o[a] = l;
                            let u = i,
                                d = 0;
                            for (; u !== a;) d += n[u++], u %= e;
                            if (a = (a + 1) % e, a === i && (i = (i + 1) % e), l - r < t) return;
                            const h = c && l - c;
                            return h ? Math.round(1e3 * d / h) : void 0
                        }
                };
                const _e = function(e, t) {
                        let n, o, r = 0,
                            a = 1e3 / t;
                        const i = (t, a = Date.now()) => {
                            r = a, n = null, o && (clearTimeout(o), o = null), e.apply(null, t)
                        };
                        return [(...e) => {
                            const t = Date.now(),
                                s = t - r;
                            s >= a ? i(e, t) : (n = e, o || (o = setTimeout((() => {
                                o = null, i(n)
                            }), a - s)))
                        }, () => n && i(n)]
                    },
                    Le = (e, t, n = 3) => {
                        let o = 0;
                        const r = ke(50, 250);
                        return _e((n => {
                            const a = n.loaded,
                                i = n.lengthComputable ? n.total : void 0,
                                s = a - o,
                                l = r(s);
                            o = a;
                            e({
                                loaded: a,
                                total: i,
                                progress: i ? a / i : void 0,
                                bytes: s,
                                rate: l || void 0,
                                estimated: l && i && a <= i ? (i - a) / l : void 0,
                                event: n,
                                lengthComputable: null != i,
                                [t ? "download" : "upload"]: !0
                            })
                        }), n)
                    },
                    Oe = (e, t) => {
                        const n = null != e;
                        return [o => t[0]({
                            lengthComputable: n,
                            total: e,
                            loaded: o
                        }), t[1]]
                    },
                    Re = e => (...t) => W.asap((() => e(...t))),
                    Ne = ge.hasStandardBrowserEnv ? ((e, t) => n => (n = new URL(n, ge.origin), e.protocol === n.protocol && e.host === n.host && (t || e.port === n.port)))(new URL(ge.origin), ge.navigator && /(msie|trident)/i.test(ge.navigator.userAgent)) : () => !0,
                    Ue = ge.hasStandardBrowserEnv ? {
                        write(e, t, n, o, r, a) {
                            const i = [e + "=" + encodeURIComponent(t)];
                            W.isNumber(n) && i.push("expires=" + new Date(n).toGMTString()), W.isString(o) && i.push("path=" + o), W.isString(r) && i.push("domain=" + r), !0 === a && i.push("secure"), document.cookie = i.join("; ")
                        },
                        read(e) {
                            const t = document.cookie.match(new RegExp("(^|;\\s*)(" + e + ")=([^;]*)"));
                            return t ? decodeURIComponent(t[3]) : null
                        },
                        remove(e) {
                            this.write(e, "", Date.now() - 864e5)
                        }
                    } : {
                        write() {},
                        read: () => null,
                        remove() {}
                    };

                function Be(e, t, n) {
                    let o = !/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);
                    return e && o || 0 == n ? function(e, t) {
                        return t ? e.replace(/\/?\/$/, "") + "/" + t.replace(/^\/+/, "") : e
                    }(e, t) : t
                }
                const Ve = e => e instanceof Se ? { ...e
                } : e;

                function Fe(e, t) {
                    t = t || {};
                    const n = {};

                    function o(e, t, n, o) {
                        return W.isPlainObject(e) && W.isPlainObject(t) ? W.merge.call({
                            caseless: o
                        }, e, t) : W.isPlainObject(t) ? W.merge({}, t) : W.isArray(t) ? t.slice() : t
                    }

                    function r(e, t, n, r) {
                        return W.isUndefined(t) ? W.isUndefined(e) ? void 0 : o(void 0, e, 0, r) : o(e, t, 0, r)
                    }

                    function a(e, t) {
                        if (!W.isUndefined(t)) return o(void 0, t)
                    }

                    function i(e, t) {
                        return W.isUndefined(t) ? W.isUndefined(e) ? void 0 : o(void 0, e) : o(void 0, t)
                    }

                    function s(n, r, a) {
                        return a in t ? o(n, r) : a in e ? o(void 0, n) : void 0
                    }
                    const l = {
                        url: a,
                        method: a,
                        data: a,
                        baseURL: i,
                        transformRequest: i,
                        transformResponse: i,
                        paramsSerializer: i,
                        timeout: i,
                        timeoutMessage: i,
                        withCredentials: i,
                        withXSRFToken: i,
                        adapter: i,
                        responseType: i,
                        xsrfCookieName: i,
                        xsrfHeaderName: i,
                        onUploadProgress: i,
                        onDownloadProgress: i,
                        decompress: i,
                        maxContentLength: i,
                        maxBodyLength: i,
                        beforeRedirect: i,
                        transport: i,
                        httpAgent: i,
                        httpsAgent: i,
                        cancelToken: i,
                        socketPath: i,
                        responseEncoding: i,
                        validateStatus: s,
                        headers: (e, t, n) => r(Ve(e), Ve(t), 0, !0)
                    };
                    return W.forEach(Object.keys(Object.assign({}, e, t)), (function(o) {
                        const a = l[o] || r,
                            i = a(e[o], t[o], o);
                        W.isUndefined(i) && a !== s || (n[o] = i)
                    })), n
                }
                const He = e => {
                        const t = Fe({}, e);
                        let n, {
                            data: o,
                            withXSRFToken: r,
                            xsrfHeaderName: a,
                            xsrfCookieName: i,
                            headers: s,
                            auth: l
                        } = t;
                        if (t.headers = s = Se.from(s), t.url = ie(Be(t.baseURL, t.url), e.params, e.paramsSerializer), l && s.set("Authorization", "Basic " + btoa((l.username || "") + ":" + (l.password ? unescape(encodeURIComponent(l.password)) : ""))), W.isFormData(o))
                            if (ge.hasStandardBrowserEnv || ge.hasStandardBrowserWebWorkerEnv) s.setContentType(void 0);
                            else if (!1 !== (n = s.getContentType())) {
                            const [e, ...t] = n ? n.split(";").map((e => e.trim())).filter(Boolean) : [];
                            s.setContentType([e || "multipart/form-data", ...t].join("; "))
                        }
                        if (ge.hasStandardBrowserEnv && (r && W.isFunction(r) && (r = r(t)), r || !1 !== r && Ne(t.url))) {
                            const e = a && i && Ue.read(i);
                            e && s.set(a, e)
                        }
                        return t
                    },
                    qe = "undefined" != typeof XMLHttpRequest && function(e) {
                        return new Promise((function(t, n) {
                            const o = He(e);
                            let r = o.data;
                            const a = Se.from(o.headers).normalize();
                            let i, s, l, c, u, {
                                responseType: d,
                                onUploadProgress: h,
                                onDownloadProgress: f
                            } = o;

                            function m() {
                                c && c(), u && u(), o.cancelToken && o.cancelToken.unsubscribe(i), o.signal && o.signal.removeEventListener("abort", i)
                            }
                            let g = new XMLHttpRequest;

                            function p() {
                                if (!g) return;
                                const o = Se.from("getAllResponseHeaders" in g && g.getAllResponseHeaders());
                                Pe((function(e) {
                                    t(e), m()
                                }), (function(e) {
                                    n(e), m()
                                }), {
                                    data: d && "text" !== d && "json" !== d ? g.response : g.responseText,
                                    status: g.status,
                                    statusText: g.statusText,
                                    headers: o,
                                    config: e,
                                    request: g
                                }), g = null
                            }
                            g.open(o.method.toUpperCase(), o.url, !0), g.timeout = o.timeout, "onloadend" in g ? g.onloadend = p : g.onreadystatechange = function() {
                                g && 4 === g.readyState && (0 !== g.status || g.responseURL && 0 === g.responseURL.indexOf("file:")) && setTimeout(p)
                            }, g.onabort = function() {
                                g && (n(new K("Request aborted", K.ECONNABORTED, e, g)), g = null)
                            }, g.onerror = function() {
                                n(new K("Network Error", K.ERR_NETWORK, e, g)), g = null
                            }, g.ontimeout = function() {
                                let t = o.timeout ? "timeout of " + o.timeout + "ms exceeded" : "timeout exceeded";
                                const r = o.transitional || le;
                                o.timeoutErrorMessage && (t = o.timeoutErrorMessage), n(new K(t, r.clarifyTimeoutError ? K.ETIMEDOUT : K.ECONNABORTED, e, g)), g = null
                            }, void 0 === r && a.setContentType(null), "setRequestHeader" in g && W.forEach(a.toJSON(), (function(e, t) {
                                g.setRequestHeader(t, e)
                            })), W.isUndefined(o.withCredentials) || (g.withCredentials = !!o.withCredentials), d && "json" !== d && (g.responseType = o.responseType), f && ([l, u] = Le(f, !0), g.addEventListener("progress", l)), h && g.upload && ([s, c] = Le(h), g.upload.addEventListener("progress", s), g.upload.addEventListener("loadend", c)), (o.cancelToken || o.signal) && (i = t => {
                                g && (n(!t || t.type ? new De(null, e, g) : t), g.abort(), g = null)
                            }, o.cancelToken && o.cancelToken.subscribe(i), o.signal && (o.signal.aborted ? i() : o.signal.addEventListener("abort", i)));
                            const v = function(e) {
                                const t = /^([-+\w]{1,25})(:?\/\/|:)/.exec(e);
                                return t && t[1] || ""
                            }(o.url);
                            v && -1 === ge.protocols.indexOf(v) ? n(new K("Unsupported protocol " + v + ":", K.ERR_BAD_REQUEST, e)) : g.send(r || null)
                        }))
                    },
                    je = (e, t) => {
                        const {
                            length: n
                        } = e = e ? e.filter(Boolean) : [];
                        if (t || n) {
                            let n, o = new AbortController;
                            const r = function(e) {
                                if (!n) {
                                    n = !0, i();
                                    const t = e instanceof Error ? e : this.reason;
                                    o.abort(t instanceof K ? t : new De(t instanceof Error ? t.message : t))
                                }
                            };
                            let a = t && setTimeout((() => {
                                a = null, r(new K(`timeout ${t} of ms exceeded`, K.ETIMEDOUT))
                            }), t);
                            const i = () => {
                                e && (a && clearTimeout(a), a = null, e.forEach((e => {
                                    e.unsubscribe ? e.unsubscribe(r) : e.removeEventListener("abort", r)
                                })), e = null)
                            };
                            e.forEach((e => e.addEventListener("abort", r)));
                            const {
                                signal: s
                            } = o;
                            return s.unsubscribe = () => W.asap(i), s
                        }
                    },
                    ze = function*(e, t) {
                        let n = e.byteLength;
                        if (!t || n < t) return void(yield e);
                        let o, r = 0;
                        for (; r < n;) o = r + t, yield e.slice(r, o), r = o
                    },
                    We = async function*(e) {
                        if (e[Symbol.asyncIterator]) return void(yield* e);
                        const t = e.getReader();
                        try {
                            for (;;) {
                                const {
                                    done: e,
                                    value: n
                                } = await t.read();
                                if (e) break;
                                yield n
                            }
                        } finally {
                            await t.cancel()
                        }
                    },
                    Ge = (e, t, n, o) => {
                        const r = async function*(e, t) {
                            for await (const n of We(e)) yield* ze(n, t)
                        }(e, t);
                        let a, i = 0,
                            s = e => {
                                a || (a = !0, o && o(e))
                            };
                        return new ReadableStream({
                            async pull(e) {
                                try {
                                    const {
                                        done: t,
                                        value: o
                                    } = await r.next();
                                    if (t) return s(), void e.close();
                                    let a = o.byteLength;
                                    if (n) {
                                        let e = i += a;
                                        n(e)
                                    }
                                    e.enqueue(new Uint8Array(o))
                                } catch (e) {
                                    throw s(e), e
                                }
                            },
                            cancel: e => (s(e), r.return())
                        }, {
                            highWaterMark: 2
                        })
                    },
                    Ye = "function" == typeof fetch && "function" == typeof Request && "function" == typeof Response,
                    Ze = Ye && "function" == typeof ReadableStream,
                    Ke = Ye && ("function" == typeof TextEncoder ? (Xe = new TextEncoder, e => Xe.encode(e)) : async e => new Uint8Array(await new Response(e).arrayBuffer()));
                var Xe;
                const Je = (e, ...t) => {
                        try {
                            return !!e(...t)
                        } catch (e) {
                            return !1
                        }
                    },
                    Qe = Ze && Je((() => {
                        let e = !1;
                        const t = new Request(ge.origin, {
                            body: new ReadableStream,
                            method: "POST",
                            get duplex() {
                                return e = !0, "half"
                            }
                        }).headers.has("Content-Type");
                        return e && !t
                    })),
                    $e = Ze && Je((() => W.isReadableStream(new Response("").body))),
                    et = {
                        stream: $e && (e => e.body)
                    };
                var tt;
                Ye && (tt = new Response, ["text", "arrayBuffer", "blob", "formData", "stream"].forEach((e => {
                    !et[e] && (et[e] = W.isFunction(tt[e]) ? t => t[e]() : (t, n) => {
                        throw new K(`Response type '${e}' is not supported`, K.ERR_NOT_SUPPORT, n)
                    })
                })));
                const nt = async (e, t) => {
                        const n = W.toFiniteNumber(e.getContentLength());
                        return null == n ? (async e => {
                            if (null == e) return 0;
                            if (W.isBlob(e)) return e.size;
                            if (W.isSpecCompliantForm(e)) {
                                const t = new Request(ge.origin, {
                                    method: "POST",
                                    body: e
                                });
                                return (await t.arrayBuffer()).byteLength
                            }
                            return W.isArrayBufferView(e) || W.isArrayBuffer(e) ? e.byteLength : (W.isURLSearchParams(e) && (e += ""), W.isString(e) ? (await Ke(e)).byteLength : void 0)
                        })(t) : n
                    },
                    ot = {
                        http: null,
                        xhr: qe,
                        fetch: Ye && (async e => {
                            let {
                                url: t,
                                method: n,
                                data: o,
                                signal: r,
                                cancelToken: a,
                                timeout: i,
                                onDownloadProgress: s,
                                onUploadProgress: l,
                                responseType: c,
                                headers: u,
                                withCredentials: d = "same-origin",
                                fetchOptions: h
                            } = He(e);
                            c = c ? (c + "").toLowerCase() : "text";
                            let f, m = je([r, a && a.toAbortSignal()], i);
                            const g = m && m.unsubscribe && (() => {
                                m.unsubscribe()
                            });
                            let p;
                            try {
                                if (l && Qe && "get" !== n && "head" !== n && 0 !== (p = await nt(u, o))) {
                                    let e, n = new Request(t, {
                                        method: "POST",
                                        body: o,
                                        duplex: "half"
                                    });
                                    if (W.isFormData(o) && (e = n.headers.get("content-type")) && u.setContentType(e), n.body) {
                                        const [e, t] = Oe(p, Le(Re(l)));
                                        o = Ge(n.body, 65536, e, t)
                                    }
                                }
                                W.isString(d) || (d = d ? "include" : "omit");
                                const r = "credentials" in Request.prototype;
                                f = new Request(t, { ...h,
                                    signal: m,
                                    method: n.toUpperCase(),
                                    headers: u.normalize().toJSON(),
                                    body: o,
                                    duplex: "half",
                                    credentials: r ? d : void 0
                                });
                                let a = await fetch(f);
                                const i = $e && ("stream" === c || "response" === c);
                                if ($e && (s || i && g)) {
                                    const e = {};
                                    ["status", "statusText", "headers"].forEach((t => {
                                        e[t] = a[t]
                                    }));
                                    const t = W.toFiniteNumber(a.headers.get("content-length")),
                                        [n, o] = s && Oe(t, Le(Re(s), !0)) || [];
                                    a = new Response(Ge(a.body, 65536, n, (() => {
                                        o && o(), g && g()
                                    })), e)
                                }
                                c = c || "text";
                                let v = await et[W.findKey(et, c) || "text"](a, e);
                                return !i && g && g(), await new Promise(((t, n) => {
                                    Pe(t, n, {
                                        data: v,
                                        headers: Se.from(a.headers),
                                        status: a.status,
                                        statusText: a.statusText,
                                        config: e,
                                        request: f
                                    })
                                }))
                            } catch (t) {
                                if (g && g(), t && "TypeError" === t.name && /fetch/i.test(t.message)) throw Object.assign(new K("Network Error", K.ERR_NETWORK, e, f), {
                                    cause: t.cause || t
                                });
                                throw K.from(t, t && t.code, e, f)
                            }
                        })
                    };
                W.forEach(ot, ((e, t) => {
                    if (e) {
                        try {
                            Object.defineProperty(e, "name", {
                                value: t
                            })
                        } catch (e) {}
                        Object.defineProperty(e, "adapterName", {
                            value: t
                        })
                    }
                }));
                const rt = e => `- ${e}`,
                    at = e => W.isFunction(e) || null === e || !1 === e,
                    it = e => {
                        e = W.isArray(e) ? e : [e];
                        const {
                            length: t
                        } = e;
                        let n, o;
                        const r = {};
                        for (let a = 0; a < t; a++) {
                            let t;
                            if (n = e[a], o = n, !at(n) && (o = ot[(t = String(n)).toLowerCase()], void 0 === o)) throw new K(`Unknown adapter '${t}'`);
                            if (o) break;
                            r[t || "#" + a] = o
                        }
                        if (!o) {
                            const e = Object.entries(r).map((([e, t]) => `adapter ${e} ` + (!1 === t ? "is not supported by the environment" : "is not available in the build")));
                            let n = t ? e.length > 1 ? "since :\n" + e.map(rt).join("\n") : " " + rt(e[0]) : "as no adapter specified";
                            throw new K("There is no suitable adapter to dispatch the request " + n, "ERR_NOT_SUPPORT")
                        }
                        return o
                    };

                function st(e) {
                    if (e.cancelToken && e.cancelToken.throwIfRequested(), e.signal && e.signal.aborted) throw new De(null, e)
                }

                function lt(e) {
                    st(e), e.headers = Se.from(e.headers), e.data = Ae.call(e, e.transformRequest), -1 !== ["post", "put", "patch"].indexOf(e.method) && e.headers.setContentType("application/x-www-form-urlencoded", !1);
                    return it(e.adapter || ye.adapter)(e).then((function(t) {
                        return st(e), t.data = Ae.call(e, e.transformResponse, t), t.headers = Se.from(t.headers), t
                    }), (function(t) {
                        return Ce(t) || (st(e), t && t.response && (t.response.data = Ae.call(e, e.transformResponse, t.response), t.response.headers = Se.from(t.response.headers))), Promise.reject(t)
                    }))
                }
                const ct = "1.8.1",
                    ut = {};
                ["object", "boolean", "number", "function", "string", "symbol"].forEach(((e, t) => {
                    ut[e] = function(n) {
                        return typeof n === e || "a" + (t < 1 ? "n " : " ") + e
                    }
                }));
                const dt = {};
                ut.transitional = function(e, t, n) {
                    function o(e, t) {
                        return "[Axios v1.8.1] Transitional option '" + e + "'" + t + (n ? ". " + n : "")
                    }
                    return (n, r, a) => {
                        if (!1 === e) throw new K(o(r, " has been removed" + (t ? " in " + t : "")), K.ERR_DEPRECATED);
                        return t && !dt[r] && (dt[r] = !0, console.warn(o(r, " has been deprecated since v" + t + " and will be removed in the near future"))), !e || e(n, r, a)
                    }
                }, ut.spelling = function(e) {
                    return (t, n) => (console.warn(`${n} is likely a misspelling of ${e}`), !0)
                };
                const ht = {
                        assertOptions: function(e, t, n) {
                            if ("object" != typeof e) throw new K("options must be an object", K.ERR_BAD_OPTION_VALUE);
                            const o = Object.keys(e);
                            let r = o.length;
                            for (; r-- > 0;) {
                                const a = o[r],
                                    i = t[a];
                                if (i) {
                                    const t = e[a],
                                        n = void 0 === t || i(t, a, e);
                                    if (!0 !== n) throw new K("option " + a + " must be " + n, K.ERR_BAD_OPTION_VALUE)
                                } else if (!0 !== n) throw new K("Unknown option " + a, K.ERR_BAD_OPTION)
                            }
                        },
                        validators: ut
                    },
                    ft = ht.validators;
                class mt {
                    constructor(e) {
                        this.defaults = e, this.interceptors = {
                            request: new se,
                            response: new se
                        }
                    }
                    async request(e, t) {
                        try {
                            return await this._request(e, t)
                        } catch (e) {
                            if (e instanceof Error) {
                                let t = {};
                                Error.captureStackTrace ? Error.captureStackTrace(t) : t = new Error;
                                const n = t.stack ? t.stack.replace(/^.+\n/, "") : "";
                                try {
                                    e.stack ? n && !String(e.stack).endsWith(n.replace(/^.+\n.+\n/, "")) && (e.stack += "\n" + n) : e.stack = n
                                } catch (e) {}
                            }
                            throw e
                        }
                    }
                    _request(e, t) {
                        "string" == typeof e ? (t = t || {}).url = e : t = e || {}, t = Fe(this.defaults, t);
                        const {
                            transitional: n,
                            paramsSerializer: o,
                            headers: r
                        } = t;
                        void 0 !== n && ht.assertOptions(n, {
                            silentJSONParsing: ft.transitional(ft.boolean),
                            forcedJSONParsing: ft.transitional(ft.boolean),
                            clarifyTimeoutError: ft.transitional(ft.boolean)
                        }, !1), null != o && (W.isFunction(o) ? t.paramsSerializer = {
                            serialize: o
                        } : ht.assertOptions(o, {
                            encode: ft.function,
                            serialize: ft.function
                        }, !0)), void 0 !== t.allowAbsoluteUrls || (void 0 !== this.defaults.allowAbsoluteUrls ? t.allowAbsoluteUrls = this.defaults.allowAbsoluteUrls : t.allowAbsoluteUrls = !0), ht.assertOptions(t, {
                            baseUrl: ft.spelling("baseURL"),
                            withXsrfToken: ft.spelling("withXSRFToken")
                        }, !0), t.method = (t.method || this.defaults.method || "get").toLowerCase();
                        let a = r && W.merge(r.common, r[t.method]);
                        r && W.forEach(["delete", "get", "head", "post", "put", "patch", "common"], (e => {
                            delete r[e]
                        })), t.headers = Se.concat(a, r);
                        const i = [];
                        let s = !0;
                        this.interceptors.request.forEach((function(e) {
                            "function" == typeof e.runWhen && !1 === e.runWhen(t) || (s = s && e.synchronous, i.unshift(e.fulfilled, e.rejected))
                        }));
                        const l = [];
                        let c;
                        this.interceptors.response.forEach((function(e) {
                            l.push(e.fulfilled, e.rejected)
                        }));
                        let u, d = 0;
                        if (!s) {
                            const e = [lt.bind(this), void 0];
                            for (e.unshift.apply(e, i), e.push.apply(e, l), u = e.length, c = Promise.resolve(t); d < u;) c = c.then(e[d++], e[d++]);
                            return c
                        }
                        u = i.length;
                        let h = t;
                        for (d = 0; d < u;) {
                            const e = i[d++],
                                t = i[d++];
                            try {
                                h = e(h)
                            } catch (e) {
                                t.call(this, e);
                                break
                            }
                        }
                        try {
                            c = lt.call(this, h)
                        } catch (e) {
                            return Promise.reject(e)
                        }
                        for (d = 0, u = l.length; d < u;) c = c.then(l[d++], l[d++]);
                        return c
                    }
                    getUri(e) {
                        return ie(Be((e = Fe(this.defaults, e)).baseURL, e.url, e.allowAbsoluteUrls), e.params, e.paramsSerializer)
                    }
                }
                W.forEach(["delete", "get", "head", "options"], (function(e) {
                    mt.prototype[e] = function(t, n) {
                        return this.request(Fe(n || {}, {
                            method: e,
                            url: t,
                            data: (n || {}).data
                        }))
                    }
                })), W.forEach(["post", "put", "patch"], (function(e) {
                    function t(t) {
                        return function(n, o, r) {
                            return this.request(Fe(r || {}, {
                                method: e,
                                headers: t ? {
                                    "Content-Type": "multipart/form-data"
                                } : {},
                                url: n,
                                data: o
                            }))
                        }
                    }
                    mt.prototype[e] = t(), mt.prototype[e + "Form"] = t(!0)
                }));
                const gt = mt;
                class pt {
                    constructor(e) {
                        if ("function" != typeof e) throw new TypeError("executor must be a function.");
                        let t;
                        this.promise = new Promise((function(e) {
                            t = e
                        }));
                        const n = this;
                        this.promise.then((e => {
                            if (!n._listeners) return;
                            let t = n._listeners.length;
                            for (; t-- > 0;) n._listeners[t](e);
                            n._listeners = null
                        })), this.promise.then = e => {
                            let t;
                            const o = new Promise((e => {
                                n.subscribe(e), t = e
                            })).then(e);
                            return o.cancel = function() {
                                n.unsubscribe(t)
                            }, o
                        }, e((function(e, o, r) {
                            n.reason || (n.reason = new De(e, o, r), t(n.reason))
                        }))
                    }
                    throwIfRequested() {
                        if (this.reason) throw this.reason
                    }
                    subscribe(e) {
                        this.reason ? e(this.reason) : this._listeners ? this._listeners.push(e) : this._listeners = [e]
                    }
                    unsubscribe(e) {
                        if (!this._listeners) return;
                        const t = this._listeners.indexOf(e); - 1 !== t && this._listeners.splice(t, 1)
                    }
                    toAbortSignal() {
                        const e = new AbortController,
                            t = t => {
                                e.abort(t)
                            };
                        return this.subscribe(t), e.signal.unsubscribe = () => this.unsubscribe(t), e.signal
                    }
                    static source() {
                        let e;
                        return {
                            token: new pt((function(t) {
                                e = t
                            })),
                            cancel: e
                        }
                    }
                }
                const vt = pt;
                const yt = {
                    Continue: 100,
                    SwitchingProtocols: 101,
                    Processing: 102,
                    EarlyHints: 103,
                    Ok: 200,
                    Created: 201,
                    Accepted: 202,
                    NonAuthoritativeInformation: 203,
                    NoContent: 204,
                    ResetContent: 205,
                    PartialContent: 206,
                    MultiStatus: 207,
                    AlreadyReported: 208,
                    ImUsed: 226,
                    MultipleChoices: 300,
                    MovedPermanently: 301,
                    Found: 302,
                    SeeOther: 303,
                    NotModified: 304,
                    UseProxy: 305,
                    Unused: 306,
                    TemporaryRedirect: 307,
                    PermanentRedirect: 308,
                    BadRequest: 400,
                    Unauthorized: 401,
                    PaymentRequired: 402,
                    Forbidden: 403,
                    NotFound: 404,
                    MethodNotAllowed: 405,
                    NotAcceptable: 406,
                    ProxyAuthenticationRequired: 407,
                    RequestTimeout: 408,
                    Conflict: 409,
                    Gone: 410,
                    LengthRequired: 411,
                    PreconditionFailed: 412,
                    PayloadTooLarge: 413,
                    UriTooLong: 414,
                    UnsupportedMediaType: 415,
                    RangeNotSatisfiable: 416,
                    ExpectationFailed: 417,
                    ImATeapot: 418,
                    MisdirectedRequest: 421,
                    UnprocessableEntity: 422,
                    Locked: 423,
                    FailedDependency: 424,
                    TooEarly: 425,
                    UpgradeRequired: 426,
                    PreconditionRequired: 428,
                    TooManyRequests: 429,
                    RequestHeaderFieldsTooLarge: 431,
                    UnavailableForLegalReasons: 451,
                    InternalServerError: 500,
                    NotImplemented: 501,
                    BadGateway: 502,
                    ServiceUnavailable: 503,
                    GatewayTimeout: 504,
                    HttpVersionNotSupported: 505,
                    VariantAlsoNegotiates: 506,
                    InsufficientStorage: 507,
                    LoopDetected: 508,
                    NotExtended: 510,
                    NetworkAuthenticationRequired: 511
                };
                Object.entries(yt).forEach((([e, t]) => {
                    yt[t] = e
                }));
                const bt = yt;
                const wt = function e(t) {
                    const n = new gt(t),
                        o = r(gt.prototype.request, n);
                    return W.extend(o, gt.prototype, n, {
                        allOwnKeys: !0
                    }), W.extend(o, n, null, {
                        allOwnKeys: !0
                    }), o.create = function(n) {
                        return e(Fe(t, n))
                    }, o
                }(ye);
                wt.Axios = gt, wt.CanceledError = De, wt.CancelToken = vt, wt.isCancel = Ce, wt.VERSION = ct, wt.toFormData = ee, wt.AxiosError = K, wt.Cancel = wt.CanceledError, wt.all = function(e) {
                    return Promise.all(e)
                }, wt.spread = function(e) {
                    return function(t) {
                        return e.apply(null, t)
                    }
                }, wt.isAxiosError = function(e) {
                    return W.isObject(e) && !0 === e.isAxiosError
                }, wt.mergeConfig = Fe, wt.AxiosHeaders = Se, wt.formToJSON = e => pe(W.isHTMLForm(e) ? new FormData(e) : e), wt.getAdapter = it, wt.HttpStatusCode = bt, wt.default = wt;
                const xt = wt,
                    {
                        Axios: Tt,
                        AxiosError: It,
                        CanceledError: Et,
                        isCancel: St,
                        CancelToken: At,
                        VERSION: Ct,
                        all: Mt,
                        Cancel: Dt,
                        isAxiosError: Pt,
                        spread: kt,
                        toFormData: _t,
                        AxiosHeaders: Lt,
                        HttpStatusCode: Ot,
                        formToJSON: Rt,
                        getAdapter: Nt,
                        mergeConfig: Ut
                    } = xt;
                var Bt = n(4594),
                    Vt = n(5947),
                    Ft = n(2881),
                    Ht = n(2117);
                const qt = e => {
                        const {
                            unknown: t
                        } = (0, Ht.Tl)("response"), {
                            message: n = t
                        } = e;
                        (0, Ft.A)(n, n)
                    },
                    jt = xt.create({
                        baseURL: "",
                        timeout: 6e4
                    });
                let zt = 0;
                jt.interceptors.request.use((e => {
                    0 === zt && (0, Vt.start)(), zt++;
                    const t = (0, Ht.Z0)();
                    return t && e.headers && (e.headers["Accept-Language"] = t), e
                }), (e => Promise.reject(e))), jt.interceptors.response.use((e => {
                    var t, n, o;
                    try {
                        zt--, zt <= 0 && (0, Vt.done)();
                        const {
                            data: r,
                            config: {
                                headers: a,
                                params: i,
                                data: s
                            }
                        } = e, l = null !== (o = null !== (t = null == a ? void 0 : a.disableToast) && void 0 !== t ? t : s instanceof FormData ? s.get("disableToast") : null === (n = JSON.parse(s || "null")) || void 0 === n ? void 0 : n.disableToast) && void 0 !== o ? o : null == i ? void 0 : i.disableToast, {
                            statusCode: c,
                            msg: u,
                            message: d,
                            success: h,
                            data: f,
                            result: m
                        } = r || {};
                        return !h && void 0 !== h || 200 != c && void 0 !== c || null == (f || m) ? (1 != l && qt({
                            message: u || d
                        }), Promise.reject(e)) : e
                    } catch (e) {
                        return Promise.reject(e)
                    }
                }), (e => {
                    var t, n, o;
                    zt--, zt <= 0 && (0, Vt.done)();
                    const {
                        statusCode: r,
                        fail: a
                    } = (0, Ht.Tl)("response"), {
                        response: {
                            status: i,
                            config: s
                        } = {
                            config: {}
                        },
                        config: l,
                        message: c
                    } = e, {
                        headers: u,
                        params: d,
                        data: h
                    } = l || s;
                    if (null !== (o = null !== (t = null == u ? void 0 : u.disableToast) && void 0 !== t ? t : h instanceof FormData ? h.get("disableToast") : null === (n = JSON.parse(h || "null")) || void 0 === n ? void 0 : n.disableToast) && void 0 !== o ? o : null == d ? void 0 : d.disableToast) return Promise.reject(e);
                    switch (i) {
                        case 401:
                            qt({
                                message: r[401]
                            });
                            break;
                        case 403:
                            qt({
                                message: r[403]
                            });
                            break;
                        case 404:
                            console.error(r[404]);
                            break;
                        default:
                            qt({
                                message: i ? c : a,
                                duration: 5e3
                            })
                    }
                    return Promise.reject(e)
                }));
                const Wt = jt,
                    Gt = "GetStudyInfo",
                    Yt = "GetSeriesMeta",
                    Zt = "GetPath3d",
                    Kt = "GetStudyMark",
                    Xt = "AddStudyMark",
                    Jt = "GetStudyKeyImage",
                    Qt = "AddStudyKeyImage",
                    $t = "UploadPrintImage";
                var en = n(8398),
                    tn = n(9473),
                    nn = function(e, t, n, o) {
                        return new(n || (n = Promise))((function(r, a) {
                            function i(e) {
                                try {
                                    l(o.next(e))
                                } catch (e) {
                                    a(e)
                                }
                            }

                            function s(e) {
                                try {
                                    l(o.throw(e))
                                } catch (e) {
                                    a(e)
                                }
                            }

                            function l(e) {
                                var t;
                                e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                                    e(t)
                                }))).then(i, s)
                            }
                            l((o = o.apply(e, t || [])).next())
                        }))
                    },
                    on = function(e, t) {
                        var n = {};
                        for (var o in e) Object.prototype.hasOwnProperty.call(e, o) && t.indexOf(o) < 0 && (n[o] = e[o]);
                        if (null != e && "function" == typeof Object.getOwnPropertySymbols) {
                            var r = 0;
                            for (o = Object.getOwnPropertySymbols(e); r < o.length; r++) t.indexOf(o[r]) < 0 && Object.prototype.propertyIsEnumerable.call(e, o[r]) && (n[o[r]] = e[o[r]])
                        }
                        return n
                    };
                const rn = xt.CancelToken.source(),
                    an = (e = Bt.A.instanceOptions.token) => ({
                        Authorization: e ? "bearer " + e : void 0
                    });

                function sn(e, t, n, o) {
                    return nn(this, void 0, void 0, (function*() {
                        const {
                            imageType: r,
                            instanceOptions: {
                                clientType: a,
                                isDesensitize: i,
                                isInternal: s,
                                isKeyImage: l
                            }
                        } = Bt.A;
                        return (yield Wt.get(`${e}/${Gt}`, {
                            params: Object.assign({
                                hospID: n,
                                hospid: n,
                                hospId: n,
                                hospitalid: n,
                                imageType: r,
                                isDcm: r,
                                studyUID: t,
                                studyuid: t,
                                clientType: a,
                                hasDesensitize: (0, en.jc)(i),
                                isInternal: (0, en.jc)(s),
                                isKeyImage: (0, en.jc)(l)
                            }, o),
                            headers: Object.assign({}, an()),
                            timeout: 3e5
                        })).data
                    }))
                }

                function ln(e, t, n, o, r) {
                    return nn(this, void 0, void 0, (function*() {
                        try {
                            n = (0, en.aR)(n);
                            const {
                                imageType: a,
                                instanceOptions: {
                                    clientType: i,
                                    isDesensitize: s,
                                    isInternal: l,
                                    isKeyImage: c
                                }
                            } = Bt.A;
                            return (yield Wt.get(`${e}/${Yt}`, {
                                params: Object.assign({
                                    hospID: o,
                                    hospid: o,
                                    hospId: o,
                                    hospitalid: o,
                                    imageType: a,
                                    isDcm: a,
                                    seriesUID: n,
                                    uuid: n,
                                    studyUID: t,
                                    studyuid: t,
                                    clientType: i,
                                    hasDesensitize: (0, en.jc)(s),
                                    isInternal: (0, en.jc)(l),
                                    isKeyImage: (0, en.jc)(c)
                                }, r),
                                headers: Object.assign({}, an()),
                                cancelToken: rn.token
                            })).data
                        } catch (e) {
                            throw {
                                message: (0, Ht.Tl)("response.metaDataError") + n,
                                error: e
                            }
                        }
                    }))
                }

                function cn(e) {
                    return nn(this, void 0, void 0, (function*() {
                        const t = e => {
                            if ("Object" != (0, tn.Bc)(e.data)) throw (0, Ht.Tl)("response.VRTPathDataError")
                        };
                        try {
                            const n = yield Wt.get(`${e}/${Zt}`, {
                                data: {
                                    disableToast: !0
                                },
                                headers: Object.assign({}, an())
                            });
                            return t(n), n.data
                        } catch (e) {
                            throw t(e), e
                        }
                    }))
                }

                function un(e, t, n) {
                    return nn(this, void 0, void 0, (function*() {
                        const {
                            hospID: o,
                            departCode: r
                        } = n;
                        return (yield Wt.get(`${e}/${Kt}`, {
                            params: {
                                deptCode: r,
                                orgCode: o,
                                queryNo: t
                            },
                            data: {
                                disableToast: !0
                            },
                            headers: Object.assign({}, an())
                        })).data
                    }))
                }

                function dn(e, t, n) {
                    return nn(this, void 0, void 0, (function*() {
                        const {
                            departCode: o,
                            hospID: r,
                            markJson: a
                        } = n;
                        return (yield Wt.post(`${e}/${Xt}`, {
                            deptCode: o,
                            markJson: a,
                            orgCode: r,
                            queryNo: t
                        }, {
                            headers: Object.assign({}, an())
                        })).data
                    }))
                }

                function hn(e, t, n) {
                    return nn(this, void 0, void 0, (function*() {
                        const {
                            hospID: o,
                            departCode: r
                        } = n;
                        return (yield Wt.get(`${e}/${Jt}`, {
                            params: {
                                deptCode: r,
                                orgCode: o,
                                queryNo: t
                            },
                            data: {
                                disableToast: !0
                            },
                            headers: Object.assign({}, an())
                        })).data
                    }))
                }

                function fn(e, t, n) {
                    return nn(this, void 0, void 0, (function*() {
                        const {
                            departCode: o,
                            hospID: r,
                            markKeyJson: a
                        } = n;
                        return (yield Wt.post(`${e}/${Qt}`, {
                            deptCode: o,
                            markKeyJson: a,
                            orgCode: r,
                            queryNo: t
                        }, {
                            headers: Object.assign({}, an())
                        })).data
                    }))
                }

                function mn(e, t) {
                    return nn(this, void 0, void 0, (function*() {
                        var n;
                        const o = yield Wt.get(`${e}`, {
                            params: {
                                studyUID: t
                            }
                        }), {
                            data: r
                        } = JSON.parse(null === (n = o.data) || void 0 === n ? void 0 : n.result) || {};
                        switch (r) {
                            case void 0:
                            case "ALGOERROR":
                                throw {
                                    studyUID: t,
                                    mesage: (0, Ht.Tl)("response.AIDataError"),
                                    data: r,
                                    res: o
                                };
                            default:
                                if ("Array" === (0, tn.Bc)(r)) return r;
                                throw {
                                    studyUID: t,
                                    mesage: (0, Ht.Tl)("response.unknown"),
                                    data: r,
                                    res: o
                                }
                        }
                    }))
                }

                function gn(e, t, n) {
                    return nn(this, void 0, void 0, (function*() {
                        const {
                            imagesData: o
                        } = t, r = on(t, ["imagesData"]), a = _t(r);
                        for (const e of t.imagesData) a.append("imagesData", e);
                        return (yield Wt.post(`${e}/${$t}`, a, {
                            headers: Object.assign({}, an()),
                            onUploadProgress: n
                        })).data
                    }))
                }
            },
            9290: e => {
                "use strict";
                e.exports = RangeError
            },
            9353: e => {
                "use strict";
                var t = Object.prototype.toString,
                    n = Math.max,
                    o = function(e, t) {
                        for (var n = [], o = 0; o < e.length; o += 1) n[o] = e[o];
                        for (var r = 0; r < t.length; r += 1) n[r + e.length] = t[r];
                        return n
                    };
                e.exports = function(e) {
                    var r = this;
                    if ("function" != typeof r || "[object Function]" !== t.apply(r)) throw new TypeError("Function.prototype.bind called on incompatible " + r);
                    for (var a, i = function(e, t) {
                            for (var n = [], o = t || 0, r = 0; o < e.length; o += 1, r += 1) n[r] = e[o];
                            return n
                        }(arguments, 1), s = n(0, r.length - i.length), l = [], c = 0; c < s; c++) l[c] = "$" + c;
                    if (a = Function("binder", "return function (" + function(e, t) {
                            for (var n = "", o = 0; o < e.length; o += 1) n += e[o], o + 1 < e.length && (n += t);
                            return n
                        }(l, ",") + "){ return binder.apply(this,arguments); }")((function() {
                            if (this instanceof a) {
                                var t = r.apply(this, o(i, arguments));
                                return Object(t) === t ? t : this
                            }
                            return r.apply(e, o(i, arguments))
                        })), r.prototype) {
                        var u = function() {};
                        u.prototype = r.prototype, a.prototype = new u, u.prototype = null
                    }
                    return a
                }
            },
            9383: e => {
                "use strict";
                e.exports = Error
            },
            9426: (e, t, n) => {
                "use strict";
                n.d(t, {
                    A: () => o
                });
                const o = class {
                    constructor(e) {
                        this.states = [], this.originStates = [], this.addSeriesArr(e)
                    }
                    addSeriesArr(e) {
                        for (const t of e) {
                            const {
                                studyUID: e,
                                seriesUID: n
                            } = t;
                            this.states.push({
                                studyUID: e,
                                seriesUID: n,
                                series: t,
                                scrollIndex: 0,
                                synchronizerStatus: !1
                            })
                        }
                    }
                    getStates() {
                        return this.states
                    }
                    getStatesLength() {
                        return this.states.length
                    }
                    getSeries(e = "states") {
                        return ("states" === e ? this.states : this.originStates).map((({
                            series: e
                        }) => e))
                    }
                    getSeriesActiveIndex(e) {
                        let t;
                        for (let n = 0; n < this.states.length; n++) {
                            if (this.states[n].seriesUID === e) {
                                t = n;
                                break
                            }
                        }
                        return t
                    }
                    removeSerie(e) {
                        this.states[e] = {
                            studyUID: void 0,
                            seriesUID: void 0,
                            scrollIndex: void 0,
                            synchronizerStatus: void 0,
                            series: void 0
                        }
                    }
                    syncState(e = "states") {
                        this[e] = "states" === e ? [...this.originStates] : [...this.states]
                    }
                    getOriginState() {
                        return this.originStates
                    }
                    setState(e, t) {
                        this.states[e] = Object.assign(Object.assign({}, this.states[e]), t)
                    }
                    setSynchronizerStatus(e, t) {
                        this.states[e] = Object.assign(Object.assign({}, this.states[e]), {
                            synchronizerStatus: t
                        })
                    }
                    getSynchronizerStatus(e) {
                        const {
                            synchronizerStatus: t
                        } = this.states[e];
                        return t
                    }
                    setScrollIndex(e, t) {
                        this.states[e] = Object.assign(Object.assign({}, this.states[e]), {
                            scrollIndex: t
                        })
                    }
                }
            },
            9473: (e, t, n) => {
                "use strict";
                n.d(t, {
                    PC: () => r,
                    Y4: () => y,
                    mc: () => i,
                    a6: () => a,
                    TJ: () => o,
                    aA: () => p,
                    n: () => d,
                    Bc: () => g,
                    sg: () => c,
                    _K: () => m,
                    nJ: () => f,
                    TB: () => h,
                    u$: () => s,
                    IG: () => l,
                    nF: () => u
                });
                const o = class {
                    taskId;
                    arr;
                    func;
                    limit;
                    count;
                    pendingTask;
                    finishSResolve;
                    constructor() {
                        this.taskId = 0, this.count = 0, this.arr = [], this.limit = 0, this.pendingTask = [], this.func = () => ({}), this.finishSResolve = () => ({})
                    }
                    init(e) {
                        const {
                            arr: t = [],
                            func: n,
                            limit: o = 6
                        } = e || {};
                        return t.length && n ? (this.arr.length && this.pendingTask.push({
                            arr: [...this.arr],
                            func: this.func,
                            limit: this.limit
                        }), this.count = 0, this.arr = [...t], this.limit = Math.min(o, t.length), this.func = n, this.loop(this.taskId), new Promise((e => {
                            this.finishSResolve = e
                        }))) : Promise.reject("arr and func is required")
                    }
                    async loop(e) {
                        if (e === this.taskId)
                            if (0 !== this.arr.length) this.count += 1, this.count < this.limit && this.loop(this.taskId), await this.func(this.arr.shift()), e === this.taskId && (this.count >= this.limit && this.loop(this.taskId), this.count -= 1);
                            else if (this.count <= 0) {
                            this.finishSResolve("finish");
                            const {
                                arr: e,
                                func: t,
                                limit: n
                            } = this.pendingTask.shift() || {};
                            e ? .length && t && (this.taskId += 1, this.init({
                                arr: e,
                                func: t,
                                limit: n
                            }))
                        } else setTimeout((() => this.loop(this.taskId)), 100)
                    }
                    cancel() {
                        return this.taskId += 1, this.arr.length = 0, this.pendingTask.length = 0, Promise.resolve("cancel")
                    }
                };
                const r = class {
                    store;
                    constructor() {
                        this.store = new Map
                    }
                    get(e, ...t) {
                        const n = JSON.stringify(t);
                        if (!this.store.has(e)) {
                            const o = e(...t),
                                r = new Map;
                            return r.set(n, o), this.store.set(e, r), o
                        }
                        const o = this.store.get(e);
                        if (!o ? .has(n)) {
                            const r = e(...t);
                            return o ? .set(n, r), r
                        }
                        return o.get(n)
                    }
                };
                const a = class {
                    func;
                    result;
                    constructor(e) {
                        this.func = e, this.result
                    }
                    run(...e) {
                        return void 0 !== this.result || (this.result = this.func(...e)), this.result
                    }
                };
                const i = class {
                    db;
                    dbName;
                    storeName;
                    version;
                    constructor(e, t, n = 1) {
                        this.db = void 0, this.dbName = e, this.storeName = t, this.version = n
                    }
                    open() {
                        return new Promise(((e, t) => {
                            const n = indexedDB || webkitIndexedDB || mozIndexedDB || msIndexedDB;
                            if (!n) {
                                const e = new Error("IndexedDB is not supported");
                                return console.warn(e), t(e)
                            }
                            const o = n.open(this.dbName, this.version);
                            o.onsuccess = t => {
                                this.db = t.target ? .result, e(t)
                            }, o.onerror = function(e) {
                                t(e), console.log("...")
                            }, o.onupgradeneeded = e => {
                                const t = this.storeName,
                                    n = e.target ? .result;
                                n.objectStoreNames.contains(t) || n.createObjectStore(t)
                            }
                        }))
                    }
                    dispatch(e, t = {}, ...n) {
                        const {
                            mode: o = "readwrite",
                            more: r = !1
                        } = t;
                        return new Promise(((a, i) => {
                            try {
                                const t = this.getObjectStore(o),
                                    s = t[e];
                                if (!(e in t)) return i(`${e} is undefined, reference resources:https://developer.mozilla.org/zh-CN/docs/Web/API/IDBObjectStore`);
                                if ("function" == typeof s) {
                                    const o = t[e](...n);
                                    o.onsuccess = e => {
                                        const n = e.target ? .result;
                                        a(r ? {
                                            res: o,
                                            event: e,
                                            result: n,
                                            objectStore: t,
                                            bd: this.db
                                        } : n)
                                    }, o.onerror = i
                                } else a(s)
                            } catch (o) {
                                i({
                                    message: o,
                                    arguments: {
                                        func: e,
                                        options: t,
                                        args: n
                                    }
                                })
                            }
                        }))
                    }
                    getObjectStore(e = "readwrite") {
                        if (!this.db) throw new Error("No database connection available , please use IndexedDB=>open to connect");
                        return this.db.transaction([this.storeName], e).objectStore(this.storeName)
                    }
                };
                const s = function(e) {
                    return e instanceof Error ? {
                        message: e.message,
                        stack: e.stack,
                        name: e.name
                    } : {
                        message: String(e),
                        stack: "Unknown error",
                        name: "Unknown"
                    }
                };
                const l = {
                    getItem: function(e, t = localStorage) {
                        const n = t.getItem(e);
                        return n ? JSON.parse(n) : null
                    },
                    setItem: function(e, t, n = localStorage) {
                        n.setItem(e, JSON.stringify(t))
                    },
                    removeItem: function(e, t = localStorage) {
                        t.removeItem(e)
                    }
                };
                const c = function(e, t, n) {
                    let o, r, a, i, s, l, c = 0,
                        u = !1,
                        d = !1,
                        h = !0;
                    const f = !t && 0 !== t && "function" == typeof window.requestAnimationFrame;
                    if ("function" != typeof e) throw new TypeError("Expected a function");

                    function m(t) {
                        const n = o,
                            i = r;
                        return o = r = void 0, c = t, a = e.apply(i, n), a
                    }

                    function p(e, t = 0) {
                        return f ? window.requestAnimationFrame(e) : setTimeout(e, t)
                    }

                    function v(e) {
                        const n = e - (l || 0);
                        return void 0 === l || n >= (t || 0) || n < 0 || d && e - c >= (i || 0)
                    }

                    function y() {
                        const e = Date.now();
                        if (v(e)) return b(e);
                        s = p(y, function(e) {
                            const n = e - c,
                                o = (t || 0) - (e - (l || 0));
                            return d ? Math.min(o, (i || 0) - n) : o
                        }(e))
                    }

                    function b(e) {
                        return s = void 0, h && o ? m(e) : (o = r = void 0, a)
                    }

                    function w(...e) {
                        const n = Date.now(),
                            i = v(n);
                        if (o = e, r = this, l = n, i) {
                            if (void 0 === s) return function(e) {
                                return c = e, s = p(y, t), u ? m(e) : a
                            }(l);
                            if (d) return s = p(y, t), m(l)
                        }
                        return void 0 === s && (s = p(y, t)), a
                    }
                    return t = Number(t) || 0, n && "Object" === g(n) && (u = Boolean(n.leading), d = "maxWait" in n, i = d ? Math.max(Number(n.maxWait) || 0, t) : i, h = "trailing" in n ? Boolean(n.trailing) : h), w.cancel = function() {
                        void 0 !== s && function(e) {
                            if (f) return window.cancelAnimationFrame(e);
                            clearTimeout(e)
                        }(s), c = 0, o = l = r = s = void 0
                    }, w.flush = function() {
                        return void 0 === s ? a : b(Date.now())
                    }, w.pending = function() {
                        return void 0 !== s
                    }, w
                };
                const u = function(e, t = 0, n) {
                        let o = !0,
                            r = !0;
                        if ("function" != typeof e) throw new TypeError("Expected a function");
                        return n && "Object" === g(n) && (o = "leading" in n ? Boolean(n.leading) : o, r = "trailing" in n ? Boolean(n.trailing) : r), c(e, t, {
                            leading: o,
                            trailing: r,
                            maxWait: t
                        })
                    },
                    d = e => {
                        const {
                            tagName: t = "div",
                            ...n
                        } = e || {}, o = document.createElement(t);
                        for (const [e, t] of Object.entries(n)) o[e] = t;
                        return o
                    },
                    h = e => [void 0, '""', '" "', "null", "[]", "{}"].includes(JSON.stringify(e)),
                    f = e => {
                        const t = document.createElement("canvas");
                        return t.width = e.width, t.height = e.height, e.toDataURL() == t.toDataURL()
                    },
                    m = (e, t) => {
                        const {
                            userAgent: n,
                            platform: o
                        } = navigator;
                        return e = e || n, {
                            isWin: (t = t || o).includes("Win"),
                            isMac: t.includes("Mac"),
                            isLinux: !!t.match(/Linux|X11/i),
                            isIpad: !!e.match(/iPad/i),
                            isMobile: !!e.match(/mobile|phone/i),
                            isAndroid: !!e.match(/android/i),
                            isIphone: !!e.match(/iphone/i),
                            isWM: !!e.match(/windows mobile/i),
                            isWeChat: !!e.match(/MicroMessenger/i)
                        }
                    },
                    g = (e, t) => {
                        const n = typeof e,
                            {
                                lowercase: o = !1
                            } = t || {};
                        if ("object" === n) {
                            const t = Object.prototype.toString.call(e).slice(8, -1);
                            return o ? t.toLowerCase() : t
                        }
                        return n
                    },
                    p = (e, t, n = {}) => {
                        const {
                            interceptors: o,
                            crossOrigin: r = "Anonymous",
                            zoom: a = 1,
                            debug: i = !1
                        } = n;
                        return new Promise(((n, s) => {
                            try {
                                const l = e ? .getContext("2d"),
                                    c = e.width,
                                    u = e.height;
                                let d = 1;
                                const h = new Image;
                                h.crossOrigin = r, h.src = t, h.onload = () => {
                                    let e = h.width,
                                        t = h.height;
                                    d = c / u > e / t ? u / t : c / e, e = e * d * a, t = t * d * a, i && console.log({
                                        cW: c,
                                        cH: u,
                                        scale: d,
                                        zoom: a,
                                        originIW: h.width,
                                        originIH: h.height,
                                        iW: e,
                                        iH: t
                                    });
                                    const [r, f, m, p] = [(c - e) / 2, (u - t) / 2, e, t];
                                    if ("function" != typeof o) l ? .drawImage(h, r, f, m, p), n("success");
                                    else {
                                        const e = o();
                                        if ("Promise" !== g(e)) throw s(new Error("interceptors must be Promise"));
                                        e.then((e => {
                                            e ? (l ? .drawImage(h, r, f, m, p), n("success")) : s("cancel")
                                        }), (() => {
                                            s("cancel")
                                        }))
                                    }
                                }, h.onerror = e => {
                                    s(e)
                                }
                            } catch (e) {
                                s(e)
                            }
                        }))
                    },
                    v = (e, t = "image/png") => {
                        const n = document.createElement("canvas"),
                            o = n.getContext("2d");
                        return n.height = e.height, n.width = e.width, o ? .putImageData(e, 0, 0), n.toDataURL(t)
                    },
                    y = async (e, t) => {
                        try {
                            const n = v(e, t),
                                o = await fetch(n);
                            return Promise.resolve(o.arrayBuffer())
                        } catch (e) {
                            return Promise.reject(e)
                        }
                    },
                    {
                        rE: b
                    } = {
                        rE: "1.2.2"
                    }
            },
            9538: e => {
                "use strict";
                e.exports = ReferenceError
            },
            9553: (e, t, n) => {
                "use strict";
                n.d(t, {
                    sf: () => s,
                    er: () => c
                });
                const o = class {};
                const r = class extends o {
                    constructor(e) {
                        super(), this.id = e.id, this.num = e.num, this.imageIcon = e.imageIcon, this.isLoadImage = e.isLoadImage
                    }
                    setInfo(e) {
                        if (this.name = e.name.replace(/\^/g, ""), this.sex = e.sex, this.age = e.age, this.birth = e.birth, this.patid = e.patid, this.mod = e.mod, this.accnum = e.accnum, this.stuid = e.stuid, this.stuuid = e.stuuid, this.studes = e.studes, this.serid = e.serid, this.seruid = e.seruid, this.serdes = e.serdes, this.imgnum = e.imgnum, this.sopuid = e.sopuid, this.uid = e.uid, this.blocks = parseInt(e.blocks), this.studt = e.studt, this.stutm = e.stutm, "string" == typeof e.stutm && e.stutm.indexOf(":") < 0 || "string" == typeof e.stutm && e.studt.indexOf("-") < 0)
                            for (let t = 0; t < 2; t++) {
                                const n = e.stutm.substr(2 * t, 2),
                                    o = e.studt.substr(2 * t + 4, 2);
                                0 == t && (this.stutm = n, this.studt = e.studt.substr(0, 4)), this.stutm += ":" + n, this.studt += "-" + o
                            } else this.stutm = e.stutm, this.studt = e.studt;
                        if (this.acqdt = e.acqdt, this.acqtm = e.acqtm, this.acqtm && (this.acqtm = parseFloat(e.acqtm).toFixed(3)), this.wc = parseFloat(e.wc), this.ww = parseFloat(e.ww), this.ma = e.ma, this.kv = e.kv, this.sliceth = e.sliceth, this.manu = e.manu, this.inst = e.inst, this.row = parseInt(e.row), this.col = parseInt(e.col), "string" == typeof e.pixx && "string" == typeof e.pixx) {
                            if (-1 != e.pixx.indexOf(" ")) {
                                const t = e.pixx.split(" ");
                                2 == t.length && (this.pixx = parseFloat(t[0]), this.pixy = parseFloat(t[1]))
                            }
                            this.pixx = parseFloat(e.pixx), this.pixy = parseFloat(e.pixy)
                        }
                        this.bita = parseInt(e.bita), this.bits = e.bits, this.hbit = e.hbit, this.rescin = parseInt(e.rescin), this.rescsl = parseFloat(e.rescsl), ("" === e.rescin || null === e.rescin || isNaN(this.rescin)) && (this.rescin = 0), ("" === e.rescsl || null === e.rescsl || isNaN(this.rescsl) || this.rescsl < 1) && (this.rescsl = 1), this.pixrep = parseInt(e.pixrep), this.sappix = parseInt(e.sappix), this.phme = e.phme, this.orl = e.orl, this.ort = e.ort, this.orr = e.orr, this.orb = e.orb, this.strScount = e.scount
                    }
                    setData(e) {
                        void 0 !== e && (this.pixelBuffer = e, this.isLoadImage = !0, this.getMaxMinGary())
                    }
                    getMaxMinGary() {
                        let e, t = 1e6,
                            n = -1e6;
                        for (let o = 0; o < this.pixelBuffer.length; o++) e = this.pixelBuffer[o], e > t && (t = e), e < n && (n = e);
                        this.minGary = n, this.maxGary = t
                    }
                };
                var a = n(5373),
                    i = n(4594);
                const s = class {
                    constructor({
                        describ: e,
                        icon: t,
                        imgs: n,
                        num: o,
                        uid: r,
                        uuid: a,
                        flatSeries: i,
                        studyUID: s
                    }) {
                        this.flatSeries = !1, this.seriesIndex = NaN, this.describ = e, this.imgs = n, this.num = o, this.uid = r, this.uuid = a, this.seriesUID = a || r, this.studyUID = s, this.icon = t, this.flatSeries = i, this.multiframe = {
                            numFrames: void 0,
                            frameRate: void 0
                        }, this.dicomInfos = [], this.loadIds = [], this.metaArrOriginal = []
                    }
                    initSeries() {
                        this.imgs.forEach((e => {
                            const t = new r({
                                id: e.id,
                                num: e.num,
                                imageIcon: this.icon,
                                isLoadImage: !1
                            });
                            this.dicomInfos.push(t)
                        }))
                    }
                    initMeta(e, t) {
                        e.sort(((e, t) => Number(e.imgnum) - Number(t.imgnum)));
                        const {
                            studyUID: n,
                            imgs: o,
                            flatSeries: r,
                            seriesUID: s
                        } = this, {
                            wado: l,
                            hospID: c
                        } = i.A.instanceOptions, u = e.length, d = (e, t) => e + (e.includes("?") ? "&" : "?") + `v=${t}`;
                        let h = [];
                        for (let t = 0; t < u; t++) {
                            const {
                                url: u
                            } = o[r ? 0 : t] || {}, {
                                url: f,
                                id: m,
                                acqtm: g,
                                isIM: p,
                                isDcm: v,
                                blocks: y
                            } = e[t];
                            let b;
                            1 === i.A.imageType ? (b = u || f || l + "/GetBlock/" + m + (0, a.stringify)({
                                studyuid: n,
                                hospitalid: c,
                                seriesId: s,
                                blockIndex: 0,
                                imageType: 1
                            }, {
                                addQueryPrefix: !0
                            }), b = d(b, g), e[t].url = b, b = "wadouri:" + b) : (b = u || f || l + "/GetBlock/" + m + (0, a.stringify)({
                                studyuid: n,
                                hospitalid: c,
                                seriesId: s,
                                blockIndex: 0
                            }, {
                                addQueryPrefix: !0
                            }), b = d(b, g), e[t].url = b, "1" === v ? b = "wadouri:" + b : (p || i.A.forceIM) && Number(y || 1) <= 1 && (b = "IM:" + b + "&isIM")), e[t].imageId = b, h.push(b)
                        }
                        this.seriesIndex = t, this.loadIds = r ? h.filter(((e, n) => n === t)) : h, this.metaArrOriginal = r ? e.filter(((e, n) => n === t)) : e
                    }
                };
                var l = n(8398);
                const c = class {
                    constructor({
                        wado: e,
                        age: t,
                        hasDesensitize: n,
                        hasseries: o,
                        hospID: r,
                        imgs: a,
                        imgcount: i,
                        modality: s,
                        name: c,
                        orginaltype: u,
                        orgname: d,
                        patientid: h,
                        serieses: f,
                        sex: m,
                        storageType: g,
                        studydate: p,
                        studyid: v,
                        studyuid: y,
                        studyuuid: b
                    }) {
                        this.seriesArr = [], this.images = [], this.wado = e, this.age = t, this.hasDesensitize = n, this.hospID = r, this.studyID = v, this.studyUID = b || y || v, this.studyUUID = b || y || v, this.hasseries = parseInt(o), this.orgname = d, this.imgCount = parseInt(i), this.imgs = a, this.modality = null == s ? void 0 : s.toUpperCase(), this.name = c.replace(/\^/g, ""), this.originalType = u, this.patientID = h, this.studydate = (0, l.i$)(p, "yyyy-MM-dd"), this.studytime = (0, l.i$)(p, "hh:mm:ss"), this.seriesArrOriginal = f.sort(((e, t) => Number(e.num) - Number(t.num))), this.sex = m, this.storageType = g, this.totaltype = "RAW", this.hasseries ? this.setSeries() : this.setImages(a)
                    }
                    setSeries(e = this.seriesArrOriginal) {
                        delete this.seriesArrOriginal, e.forEach(((e, t) => {
                            const {
                                desp: n = "",
                                imgs: o,
                                num: r,
                                uid: i,
                                uuid: l,
                                sign: c,
                                flatSeries: u = !1
                            } = e;
                            e.imgs.sort(((e, t) => Number(e.num) - Number(t.num))), this.seriesArr.push(new s({
                                describ: n,
                                imgs: o,
                                flatSeries: u,
                                uid: i + (u ? "?index=" + t : ""),
                                uuid: l + (u ? "?index=" + t : ""),
                                num: r,
                                studyUID: this.studyUID,
                                icon: this.wado + "/GetImageThumb/" + o[0].id + (0, a.stringify)({
                                    studyuid: this.studyUID,
                                    studyUID: this.studyUID,
                                    seriesId: l || i,
                                    seriesID: l || i,
                                    hospId: this.hospID,
                                    hospID: this.hospID,
                                    sign: c
                                }, {
                                    addQueryPrefix: !0
                                })
                            }))
                        }))
                    }
                    setImages(e) {
                        void 0 !== e && e.forEach((e => {
                            let t = new r({
                                id: e.id,
                                num: e.num,
                                imageIcon: this.wado + "/GetImageThumb" + e.id,
                                isLoadImage: !1
                            });
                            this.images.push(t)
                        }))
                    }
                    setSeriesDicom(e) {
                        e instanceof Array && e.forEach((e => {
                            this.setDicomMeta(e)
                        }))
                    }
                    setDicomMeta(e) {
                        for (let t = 0; t < this.seriesArr.length; t++) {
                            let n = this.seriesArr[t];
                            for (let t = 0; t < n.dicomInfos.length; t++) {
                                let o = n.dicomInfos[t];
                                o.id == e.id && o.setInfo(e)
                            }
                        }
                    }
                    deepCopy(e, t) {
                        t = t || new s(null);
                        for (let n in e) "object" == typeof e[n] && null != e[n] ? (t[n] = e[n].constructor === Array ? [] : {}, this.deepCopy(e[n], t[n])) : t[n] = e[n];
                        return t
                    }
                    getStudyType() {
                        let e = "";
                        return "JPG" == this.totaltype ? e = "jpg" : "RAW" == this.totaltype && (e = "series"), e
                    }
                    getSeriesLayoutCount() {
                        const {
                            x: e,
                            y: t
                        } = i.A.instanceOptions.seriesLayoutDefault || {}, n = {
                            x: 1,
                            y: 1
                        };
                        return e && t ? {
                            x: Math.max(Math.trunc(e) || 0, 1),
                            y: Math.max(Math.trunc(t) || 0, 1)
                        } : i.A.isMobile ? n : ["CT", "MR"].includes(this.modality) ? {
                            x: 2,
                            y: 2
                        } : n
                    }
                    getDicomByID(e) {
                        let t = null,
                            n = null;
                        for (let o = 0; o < this.seriesArr.length; o++) {
                            t = this.seriesArr[o];
                            for (let o = 0; o < t.arrImage.length; o++)
                                if (n = t.arrImage[o], n.id == e) return n
                        }
                    }
                    getAllDicom() {
                        let e = [];
                        return this.seriesArr.forEach((t => {
                            t.dicomInfos.forEach((t => {
                                e.push(t)
                            }))
                        })), e
                    }
                }
            },
            9572: e => {
                "use strict";
                e.exports = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAACZFBMVEUKAABHAABsAABcAABNAAA0AABYAgD3PAD3QQD3NwBBAAAqAAAeAADaAwD0GgDTBQB0AABmAABgAABRAABKAAAUAAD2agDGBADBAQCMAAA9AAC8AgCCAQAkAACNCwHvKwD1JwDfCQDkBgC4AQCzAQBjAACrDwHzUQD3TQD2MgDNIQDuIACRAgCtAQCiAQA6AAD//emUEQLvEgH3dgD2cgDDLADmJwDoHADjFgDiEQDuBQCbAgBxAgDgAQCGAAB6AABTAAD///3yPwXpFQTPEwT4fQD3VAD3RwDSRADDGgDUEgD1DwDaDgC5DgDpDQC2BwCpAwCWAwB+AwD+9+/96db5xaX6sgbaHQX5nQOkCQLnPwHyNQDyLwD2LgDBIwC2IQCuHQDnBQCEAAD+/tT34NP+/8v44bb89qb955j6u4zwpIz944f0t3jih3T1l2D81lHohFH3sUf7y0bigUT1d0LdSTL4qyfCOSfUKhH70Qv6uAbmSQH4iwD3ZAD2WwDwVwDaTgDbPwDBNwDQKwC7JADfIgClHQCSGgCaFACCEgDCDQCbDQAuCwB3CABSBwD+8+n+/93+89v43sj3ysL93L/+/7zuv7L+/6rftqP82aHgrqD215H60IfimYPtrID7y3fOiHPXqm7yg2LWfk31j0qVaEjzlkf820H3gT/Kej7oXTnCRjX5nC/hfy/iUCy5NSj6vSXwPiD3cRzXTBb2kRTuThPBKBP83xLUaw3BlAmSZwn6vgfOOgbylASEWQTOhAPISAOXJwPFVgLFfAGmKQHqYwDmVwDvOwBPHwBxGwBHDQDOAACwWnJmAAADLElEQVQ4y9WS07IkYRCE/3ZPu6dnWmObO/baR2vbtm3btm3bL7VzNvZun2Dzoioq8suomwT/mRiGpnBR9MEdmhWnmX98FDHG3APj1u2bwm18Wp1o/IuY/8ZFI45oHdl1fT58zPTZM25TSqrQfxza1okwdvHz+j4DN8pdvoPd77pskDNfxsN2ujOfwDAbAvv9G3t26Tn81cpPTfrtyqHNQw4b4b0JDFghaHsH3Loh00XODF/x7EUTeLliaGZNYN2qsTgyXgJl047NQsy/NdtHXiMPH/pm788fq1bLwW87o9ZUitq6DfhMm/ekxuuoccfIYO9e8trc1wC5OhCOSjpixGx4FlBwmzQuSyeQvoVw35FrI1ygVzCwvgIhmkgxZts2kBBEqIcdEieOJsJt+W7y9bmLHzhGCHA/d6sRR2kUNGAUs5rah7X0T+8qF7rNTnYddGjJABVX+Krba7QxAIEh2ob5R3GlCfFo/N7g/ceOJE/aY7CH/TXBgpcxANcxmrbneLZa6l7YsiQ5acqU5HE/6+F5jzpAZOMg3JdmJCXdknvycMaC9+e7Hp4xZN/kZY5Hr/t6LYpQLYGFz81mpO7NLph+beqi2dMGL093n9N16tk7S09f7adRCguSNxgzhmG7r5yaNf3+vEmDbll6zOw6bd7CE7Mu4FZMi4HJyxjA6Axtejr/9uP5F4ccPHN08Mybi5aeu5uyIrrVA+aMMAObGfXEWHZLdwvfb+6gA4tbXHy3bu6iw04JXtCjZjNjtH10ZILbkuZK1WFDLnOc0+BwcWRwLC7BQBUwTEPGEYSTbXf3799fvbQ8wkVaikWyV3AgDgsgXqsIXksPksx7BaXEVr0jLUrR6dLUUaN5reziQS7vUlysO+SIIlqxu0dlAwPLrlGRuk9RVN5BEIAkDIYxTo7zIA28PrFeax0br7XvikZ3FvKRMb17BYHBQBBNhhug1nw+UYRh2IfgDck3IkeQvUmCBGTnNjQ1AKakRrPaUgNBTKiEVvzDHKFQqPMFYQg5C5aKrlMQBKF/BJkoCDV2tMdawZiQ05nv1ybgFGRCTQmsaegJXYdMEEVBzfkbXuqtTGcwvUsAAAAASUVORK5CYII="
            },
            9584: e => {
                /*! cornerstone-core - 0.0.0-semantically-released - 2024-01-19 | (c) 2016 Chris Hafey | https://github.com/cornerstonejs/cornerstone */
                window,
                e.exports = function() {
                    return t = [function(e, t, n) {
                        "use strict";

                        function o(e) {
                            return (o = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                                return typeof e
                            } : function(e) {
                                return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
                            })(e)
                        }

                        function r(e, t) {
                            for (var n = 0; n < t.length; n++) {
                                var r = t[n];
                                r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, function(e) {
                                    return e = function(e, t) {
                                        if ("object" != o(e) || !e) return e;
                                        var n = e[Symbol.toPrimitive];
                                        if (void 0 === n) return ("string" === t ? String : Number)(e);
                                        if ("object" != o(n = n.call(e, t || "default"))) return n;
                                        throw new TypeError("@@toPrimitive must return a primitive value.")
                                    }(e, "string"), "symbol" == o(e) ? e : String(e)
                                }(r.key), r)
                            }
                        }
                        n.r(t), n.d(t, "drawImage", (function() {
                            return x
                        })), n.d(t, "generateLut", (function() {
                            return It
                        })), n.d(t, "getDefaultViewport", (function() {
                            return b
                        })), n.d(t, "setDefaultViewport", (function() {
                            return g
                        })), n.d(t, "requestAnimationFrame", (function() {
                            return Xt
                        })), n.d(t, "storedPixelDataToCanvasImageData", (function() {
                            return Ne
                        })), n.d(t, "storedColorPixelDataToCanvasImageData", (function() {
                            return kt
                        })), n.d(t, "storedPixelDataToCanvasImageDataColorLUT", (function() {
                            return Bt
                        })), n.d(t, "storedPixelDataToCanvasImageDataPseudocolorLUT", (function() {
                            return Rt
                        })), n.d(t, "internal", (function() {
                            return an
                        })), n.d(t, "renderLabelMapImage", (function() {
                            return Ft
                        })), n.d(t, "renderPseudoColorImage", (function() {
                            return Ut
                        })), n.d(t, "renderColorImage", (function() {
                            return Ot
                        })), n.d(t, "renderGrayscaleImage", (function() {
                            return Dt
                        })), n.d(t, "renderWebImage", (function() {
                            return mn
                        })), n.d(t, "renderToCanvas", (function() {
                            return fn
                        })), n.d(t, "canvasToPixel", (function() {
                            return Ce
                        })), n.d(t, "disable", (function() {
                            return Me
                        })), n.d(t, "displayImage", (function() {
                            return Pe
                        })), n.d(t, "draw", (function() {
                            return ke
                        })), n.d(t, "drawInvalidated", (function() {
                            return _e
                        })), n.d(t, "enable", (function() {
                            return $t
                        })), n.d(t, "getElementData", (function() {
                            return Z
                        })), n.d(t, "removeElementData", (function() {
                            return K
                        })), n.d(t, "getEnabledElement", (function() {
                            return l
                        })), n.d(t, "addEnabledElement", (function() {
                            return c
                        })), n.d(t, "getEnabledElementsByImageId", (function() {
                            return u
                        })), n.d(t, "getEnabledElements", (function() {
                            return d
                        })), n.d(t, "addLayer", (function() {
                            return A
                        })), n.d(t, "removeLayer", (function() {
                            return C
                        })), n.d(t, "getLayer", (function() {
                            return M
                        })), n.d(t, "getLayers", (function() {
                            return D
                        })), n.d(t, "getVisibleLayers", (function() {
                            return P
                        })), n.d(t, "setActiveLayer", (function() {
                            return k
                        })), n.d(t, "getActiveLayer", (function() {
                            return L
                        })), n.d(t, "purgeLayers", (function() {
                            return O
                        })), n.d(t, "setLayerImage", (function() {
                            return _
                        })), n.d(t, "fitToWindow", (function() {
                            return Le
                        })), n.d(t, "getDefaultViewportForImage", (function() {
                            return en
                        })), n.d(t, "getDisplayedArea", (function() {
                            return w
                        })), n.d(t, "getImage", (function() {
                            return tn
                        })), n.d(t, "getPixels", (function() {
                            return on
                        })), n.d(t, "getStoredPixels", (function() {
                            return nn
                        })), n.d(t, "getViewport", (function() {
                            return rn
                        })), n.d(t, "loadImage", (function() {
                            return ce
                        })), n.d(t, "loadAndCacheImage", (function() {
                            return ue
                        })), n.d(t, "registerImageLoader", (function() {
                            return de
                        })), n.d(t, "registerUnknownImageLoader", (function() {
                            return he
                        })), n.d(t, "invalidate", (function() {
                            return sn
                        })), n.d(t, "invalidateImageId", (function() {
                            return ln
                        })), n.d(t, "pageToPixel", (function() {
                            return dn
                        })), n.d(t, "pixelToCanvas", (function() {
                            return hn
                        })), n.d(t, "reset", (function() {
                            return pn
                        })), n.d(t, "resize", (function() {
                            return Oe
                        })), n.d(t, "setToPixelCoordinateSystem", (function() {
                            return Be
                        })), n.d(t, "setViewport", (function() {
                            return vn
                        })), n.d(t, "updateImage", (function() {
                            return T
                        })), n.d(t, "pixelDataToFalseColorData", (function() {
                            return z
                        })), n.d(t, "rendering", (function() {
                            return gn
                        })), n.d(t, "imageCache", (function() {
                            return ie
                        })), n.d(t, "metaData", (function() {
                            return un
                        })), n.d(t, "webGL", (function() {
                            return pt
                        })), n.d(t, "colors", (function() {
                            return j
                        })), n.d(t, "convertImageToFalseColorImage", (function() {
                            return G
                        })), n.d(t, "convertToFalseColorImage", (function() {
                            return Y
                        })), n.d(t, "restoreImage", (function() {
                            return W
                        })), n.d(t, "EVENTS", (function() {
                            return a
                        })), n.d(t, "events", (function() {
                            return i
                        })), n.d(t, "triggerEvent", (function() {
                            return I
                        })), n.d(t, "imageLoadPoolManager", (function() {
                            return we
                        })), n.d(t, "imageRetrievalPoolManager", (function() {
                            return xe
                        })), n.d(t, "RequestPoolManager", (function() {
                            return be
                        }));
                        var a = {
                                NEW_IMAGE: "cornerstonenewimage",
                                INVALIDATED: "cornerstoneinvalidated",
                                PRE_RENDER: "cornerstoneprerender",
                                IMAGE_CACHE_MAXIMUM_SIZE_CHANGED: "cornerstoneimagecachemaximumsizechanged",
                                IMAGE_CACHE_PROMISE_REMOVED: "cornerstoneimagecachepromiseremoved",
                                IMAGE_CACHE_FULL: "cornerstoneimagecachefull",
                                IMAGE_CACHE_CHANGED: "cornerstoneimagecachechanged",
                                WEBGL_TEXTURE_REMOVED: "cornerstonewebgltextureremoved",
                                WEBGL_TEXTURE_CACHE_FULL: "cornerstonewebgltexturecachefull",
                                IMAGE_LOADED: "cornerstoneimageloaded",
                                IMAGE_LOAD_PROGRESS: "cornerstoneimageloadprogress",
                                IMAGE_LOAD_FAILED: "cornerstoneimageloadfailed",
                                ELEMENT_RESIZED: "cornerstoneelementresized",
                                IMAGE_RENDERED: "cornerstoneimagerendered",
                                LAYER_ADDED: "cornerstonelayeradded",
                                LAYER_REMOVED: "cornerstonelayerremoved",
                                ACTIVE_LAYER_CHANGED: "cornerstoneactivelayerchanged",
                                ELEMENT_DISABLED: "cornerstoneelementdisabled",
                                ELEMENT_ENABLED: "cornerstoneelementenabled"
                            },
                            i = new(function() {
                                function e() {
                                    if (!(this instanceof e)) throw new TypeError("Cannot call a class as a function");
                                    this.listeners = {}, this.namespaces = {}
                                }
                                var t, n, o;
                                return t = e, (n = [{
                                    key: "addEventNamespaceListener",
                                    value: function(e, t) {
                                        e.indexOf(".") <= 0 || (this.namespaces[e] = t, this.addEventListener(e.split(".")[0], t))
                                    }
                                }, {
                                    key: "removeEventNamespaceListener",
                                    value: function(e) {
                                        e.indexOf(".") <= 0 || !this.namespaces[e] || (this.removeEventListener(e.split(".")[0], this.namespaces[e]), delete this.namespaces[e])
                                    }
                                }, {
                                    key: "addEventListener",
                                    value: function(e, t) {
                                        0 < e.indexOf(".") ? this.addEventNamespaceListener(e, t) : (e in this.listeners || (this.listeners[e] = []), this.listeners[e].push(t))
                                    }
                                }, {
                                    key: "removeEventListener",
                                    value: function(e, t) {
                                        if (0 < e.indexOf(".")) this.removeEventNamespaceListener(e);
                                        else if (e in this.listeners)
                                            for (var n = this.listeners[e], o = 0, r = n.length; o < r; o++)
                                                if (n[o] === t) return void n.splice(o, 1)
                                    }
                                }, {
                                    key: "dispatchEvent",
                                    value: function(e) {
                                        if (!(e.type in this.listeners)) return !0;
                                        for (var t = this.listeners[e.type].slice(), n = 0, o = t.length; n < o; n++) t[n].call(this, e);
                                        return !e.defaultPrevented
                                    }
                                }]) && r(t.prototype, n), o && r(t, o), Object.defineProperty(t, "prototype", {
                                    writable: !1
                                }), e
                            }()),
                            s = [];

                        function l(e) {
                            if (void 0 === e) throw new Error("getEnabledElement: parameter element must not be undefined");
                            for (var t = 0; t < s.length; t++)
                                if (s[t].element === e) return s[t];
                            throw new Error("element not enabled")
                        }

                        function c(e) {
                            if (void 0 === e) throw new Error("getEnabledElement: enabledElement element must not be undefined");
                            s.push(e)
                        }

                        function u(e) {
                            var t = [];
                            return s.forEach((function(n) {
                                n.image && n.image.imageId === e && t.push(n)
                            })), t
                        }

                        function d() {
                            return s
                        }

                        function h() {
                            return Math.floor(65536 * (1 + Math.random())).toString(16).substring(1)
                        }
                        var f = function() {
                                return "".concat(h() + h(), "-").concat(h(), "-").concat(h(), "-").concat(h(), "-").concat(h()).concat(h()).concat(h())
                            },
                            m = {
                                viewport: {}
                            },
                            g = function(e) {
                                m.viewport = e || {}
                            };

                        function p(e, t) {
                            if (null == e) throw new Error(t)
                        }

                        function v(e, t) {
                            var n, o = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : null,
                                r = (p(e, "getImageScale: parameter windowSize must not be undefined"), p(t, "getImageScale: parameter image must not be undefined"), o = y(t, o), 1),
                                a = 1;
                            return {
                                verticalScale: ((n = t.rowPixelSpacing || 1) < (t = t.columnPixelSpacing || 1) ? a = t / n : r = n / t, n = e.height / o.height / r),
                                horizontalScale: t = e.width / o.width / a,
                                scaleFactor: Math.min(t, n)
                            }
                        }
                        var y = function(e) {
                                var t = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : null;
                                return p(e, "getImageSize: parameter image must not be undefined"), p(e.width, "getImageSize: parameter image must have width"), p(e.height, "getImageSize: parameter image must have height"), null != t && 0 !== t && 180 !== t ? {
                                    height: e.width,
                                    width: e.height
                                } : {
                                    width: e.width,
                                    height: e.height
                                }
                            },
                            b = function(e, t) {
                                if (void 0 === e) throw new Error("getDefaultViewport: parameter canvas must not be undefined");
                                return void 0 === t ? Object.assign({}, {
                                    scale: 1,
                                    translation: {
                                        x: 0,
                                        y: 0
                                    },
                                    voi: {
                                        windowWidth: void 0,
                                        windowCenter: void 0
                                    },
                                    invert: !1,
                                    pixelReplication: !1,
                                    rotation: 0,
                                    hflip: !1,
                                    vflip: !1,
                                    modalityLUT: void 0,
                                    voiLUT: void 0,
                                    colormap: void 0,
                                    labelmap: !1,
                                    displayedArea: void 0
                                }, m.viewport) : {
                                    scale: v(e, t, 0).scaleFactor,
                                    translation: {
                                        x: 0,
                                        y: 0
                                    },
                                    voi: {
                                        windowWidth: t.windowWidth,
                                        windowCenter: t.windowCenter
                                    },
                                    invert: t.invert,
                                    pixelReplication: !1,
                                    rotation: 0,
                                    hflip: !1,
                                    vflip: !1,
                                    modalityLUT: t.modalityLUT,
                                    voiLUT: t.voiLUT,
                                    colormap: t.colormap,
                                    labelmap: Boolean(t.labelmap),
                                    displayedArea: void 0
                                }
                            },
                            w = function(e) {
                                var t = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : null;
                                if (t && t.displayedArea) return t.displayedArea;
                                if (void 0 === e) throw new Error("getDisplayedArea: parameter image must not be undefined");
                                return {
                                    tlhc: {
                                        x: 1,
                                        y: 1
                                    },
                                    brhc: {
                                        x: e.columns,
                                        y: e.rows
                                    },
                                    rowPixelSpacing: void 0 === e.rowPixelSpacing ? 1 : e.rowPixelSpacing,
                                    columnPixelSpacing: void 0 === e.columnPixelSpacing ? 1 : e.columnPixelSpacing,
                                    presentationSizeMode: "NONE"
                                }
                            },
                            x = function(e) {
                                var t = 1 < arguments.length && void 0 !== arguments[1] && arguments[1];
                                e.needsRedraw = !0, t && (e.invalid = !0)
                            },
                            T = function(e) {
                                var t = 1 < arguments.length && void 0 !== arguments[1] && arguments[1];
                                e = l(e), x(e, t)
                            };

                        function I(e, t) {
                            var n, o = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : null;
                            return "function" == typeof window.CustomEvent ? n = new CustomEvent(t, {
                                detail: o,
                                cancelable: !0
                            }) : (n = document.createEvent("CustomEvent")).initCustomEvent(t, !0, !0, o), e.dispatchEvent(n)
                        }

                        function E(e, t, n) {
                            I(t.element, e, {
                                viewport: t.viewport,
                                element: t.element,
                                image: t.image,
                                enabledElement: t,
                                layerId: n
                            })
                        }

                        function S(e, t) {
                            if (e.layerId === t.layerId) throw new Error("rescaleImage: both arguments represent the same layer");
                            var n, o, r = e.image,
                                a = t.image;
                            r.imageId && a.imageId && (o = w(a, t.viewport), n = w(r, e.viewport), o = o.columnPixelSpacing * a.width / (n.columnPixelSpacing * r.width), a = t.viewport.scale / e.viewport.scale * o, t.viewport.scale = e.viewport.scale * a)
                        }

                        function A(e, t, n) {
                            var o = f(),
                                r = l(e),
                                i = r.layers,
                                s = (t && (s = b(r.canvas, t), n) && n.viewport && (s = Object.assign(s, n.viewport)), !1 !== r.syncViewports && (r.syncViewports = !0), {
                                    image: t,
                                    layerId: o,
                                    viewport: s,
                                    options: n || {},
                                    renderingTools: {}
                                });
                            return i.length && t && S(i[0], s), i.push(s), E(a.LAYER_ADDED, r, o), 1 === i.length && t && k(e, o), o
                        }

                        function C(e, t) {
                            var n = l(e),
                                o = n.layers,
                                r = n.layers.findIndex((function(e) {
                                    return e.layerId === t
                                })); - 1 !== r && (o.splice(r, 1), t === n.activeLayerId && o.length && k(e, o[0].layerId), E(a.LAYER_REMOVED, n, t))
                        }

                        function M(e, t) {
                            return l(e).layers.find((function(e) {
                                return e.layerId === t
                            }))
                        }

                        function D(e) {
                            return l(e).layers
                        }

                        function P(e) {
                            return l(e).layers.filter((function(e) {
                                return e.options && !1 !== e.options.visible && 0 !== e.options.opacity
                            }))
                        }

                        function k(e, t) {
                            var n = l(e);
                            if (n.activeLayerId !== t) {
                                var o = n.layers.findIndex((function(e) {
                                    return e.layerId === t
                                }));
                                if (-1 === o) throw new Error("setActiveLayer: layer not found in layers array");
                                if (!(o = n.layers[o]).image) throw new Error("setActiveLayer: layer with undefined image cannot be set as active.");
                                n.activeLayerId = t, n.image = o.image, n.viewport = o.viewport, T(e), E(a.ACTIVE_LAYER_CHANGED, n, t)
                            }
                        }

                        function _(e, t, n) {
                            var o = l(e),
                                r = o.layers[0];
                            if (!(e = n ? M(e, n) : L(e))) throw new Error("setLayerImage: Layer not found");
                            (e.image = t) ? e.viewport || (o = b(o.canvas, t), e.options && e.options.viewport && (e.viewport = Object.assign(o, e.options.viewport)), r.layerId !== n && S(r, e)): e.viewport = void 0
                        }

                        function L(e) {
                            var t = l(e);
                            return t.layers.find((function(e) {
                                return e.layerId === t.activeLayerId
                            }))
                        }

                        function O(e) {
                            (e = l(e)).layers = [], delete e.activeLayerId, delete e.lastSyncViewportsState
                        }

                        function R(e) {
                            return (R = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                                return typeof e
                            } : function(e) {
                                return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
                            })(e)
                        }

                        function N(e, t) {
                            for (var n = 0; n < t.length; n++) {
                                var o = t[n];
                                o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, function(e) {
                                    return e = function(e, t) {
                                        if ("object" != R(e) || !e) return e;
                                        var n = e[Symbol.toPrimitive];
                                        if (void 0 === n) return ("string" === t ? String : Number)(e);
                                        if ("object" != R(n = n.call(e, t || "default"))) return n;
                                        throw new TypeError("@@toPrimitive must return a primitive value.")
                                    }(e, "string"), "symbol" == R(e) ? e : String(e)
                                }(o.key), o)
                            }
                        }
                        var U = function() {
                                function e() {
                                    if (!(this instanceof e)) throw new TypeError("Cannot call a class as a function");
                                    this.NumberOfColors = 256, this.Ramp = "linear", this.TableRange = [0, 255], this.HueRange = [0, .66667], this.SaturationRange = [1, 1], this.ValueRange = [1, 1], this.AlphaRange = [1, 1], this.NaNColor = [128, 0, 0, 255], this.BelowRangeColor = [0, 0, 0, 255], this.UseBelowRangeColor = !0, this.AboveRangeColor = [255, 255, 255, 255], this.UseAboveRangeColor = !0, this.InputRange = [0, 255], this.Table = []
                                }
                                var t, n, o;
                                return t = e, (n = [{
                                    key: "setNumberOfTableValues",
                                    value: function(e) {
                                        this.NumberOfColors = e
                                    }
                                }, {
                                    key: "setRamp",
                                    value: function(e) {
                                        this.Ramp = e
                                    }
                                }, {
                                    key: "setTableRange",
                                    value: function(e, t) {
                                        this.TableRange[0] = e, this.TableRange[1] = t
                                    }
                                }, {
                                    key: "setHueRange",
                                    value: function(e, t) {
                                        this.HueRange[0] = e, this.HueRange[1] = t
                                    }
                                }, {
                                    key: "setSaturationRange",
                                    value: function(e, t) {
                                        this.SaturationRange[0] = e, this.SaturationRange[1] = t
                                    }
                                }, {
                                    key: "setValueRange",
                                    value: function(e, t) {
                                        this.ValueRange[0] = e, this.ValueRange[1] = t
                                    }
                                }, {
                                    key: "setRange",
                                    value: function(e, t) {
                                        this.InputRange[0] = e, this.InputRange[1] = t
                                    }
                                }, {
                                    key: "setAlphaRange",
                                    value: function(e, t) {
                                        this.AlphaRange[0] = e, this.AlphaRange[1] = t
                                    }
                                }, {
                                    key: "getColor",
                                    value: function(e) {
                                        return this.mapValue(e)
                                    }
                                }, {
                                    key: "build",
                                    value: function(e) {
                                        if (!(1 < this.Table.length) || e) {
                                            this.Table = [];
                                            var t, n, o, r, a = this.NumberOfColors - 1;
                                            a ? (t = (this.HueRange[1] - this.HueRange[0]) / a, n = (this.SaturationRange[1] - this.SaturationRange[0]) / a, o = (this.ValueRange[1] - this.ValueRange[0]) / a, r = (this.AlphaRange[1] - this.AlphaRange[0]) / a) : t = n = o = r = 0;
                                            for (var i = 0; i <= a; i++) {
                                                var s = this.HueRange[0] + i * t,
                                                    l = this.SaturationRange[0] + i * n,
                                                    c = this.ValueRange[0] + i * o,
                                                    u = this.AlphaRange[0] + i * r,
                                                    d = function(e, t, n) {
                                                        if (1 < e) throw new Error("HSVToRGB expects hue < 1");
                                                        var o = [];
                                                        if (0 === t) o[0] = n, o[1] = n, o[2] = n;
                                                        else {
                                                            var r = Math.floor(6 * e),
                                                                a = n * (1 - t),
                                                                i = n * (1 - t * (e = 6 * e - r)),
                                                                s = n * (1 - t * (1 - e));
                                                            switch (r) {
                                                                case 0:
                                                                case 6:
                                                                    o[0] = n, o[1] = s, o[2] = a;
                                                                    break;
                                                                case 1:
                                                                    o[0] = i, o[1] = n, o[2] = a;
                                                                    break;
                                                                case 2:
                                                                    o[0] = a, o[1] = n, o[2] = s;
                                                                    break;
                                                                case 3:
                                                                    o[0] = a, o[1] = i, o[2] = n;
                                                                    break;
                                                                case 4:
                                                                    o[0] = s, o[1] = a, o[2] = n;
                                                                    break;
                                                                case 5:
                                                                    o[0] = n, o[1] = a, o[2] = i
                                                            }
                                                        }
                                                        return o
                                                    }(s, l, c),
                                                    h = [];
                                                switch (this.Ramp) {
                                                    case "scurve":
                                                        h[0] = Math.floor(127.5 * (1 + Math.cos((1 - d[0]) * Math.PI))), h[1] = Math.floor(127.5 * (1 + Math.cos((1 - d[1]) * Math.PI))), h[2] = Math.floor(127.5 * (1 + Math.cos((1 - d[2]) * Math.PI))), h[3] = Math.floor(255 * u);
                                                        break;
                                                    case "linear":
                                                        h[0] = Math.floor(255 * d[0] + .5), h[1] = Math.floor(255 * d[1] + .5), h[2] = Math.floor(255 * d[2] + .5), h[3] = Math.floor(255 * u + .5);
                                                        break;
                                                    case "sqrt":
                                                        h[0] = Math.floor(255 * Math.sqrt(d[0]) + .5), h[1] = Math.floor(255 * Math.sqrt(d[1]) + .5), h[2] = Math.floor(255 * Math.sqrt(d[2]) + .5), h[3] = Math.floor(255 * Math.sqrt(u) + .5);
                                                        break;
                                                    default:
                                                        throw new Error("Invalid Ramp value (".concat(this.Ramp, ")"))
                                                }
                                                this.Table.push(h)
                                            }
                                            this.buildSpecialColors()
                                        }
                                    }
                                }, {
                                    key: "buildSpecialColors",
                                    value: function() {
                                        var e = this.NumberOfColors,
                                            t = e + 0,
                                            n = e + 1,
                                            o = e + 2;
                                        this.UseBelowRangeColor || 0 === e ? this.Table[t] = this.BelowRangeColor : this.Table[t] = this.Table[0], this.UseAboveRangeColor || 0 === e ? this.Table[n] = this.AboveRangeColor : this.Table[n] = this.Table[e - 1], this.Table[o] = this.NaNColor
                                    }
                                }, {
                                    key: "mapValue",
                                    value: function(e) {
                                        var t = this.getIndex(e);
                                        if (t < 0) return this.NaNColor;
                                        if (0 === t) {
                                            if (this.UseBelowRangeColor && e < this.TableRange[0]) return this.BelowRangeColor
                                        } else if (t === this.NumberOfColors - 1 && this.UseAboveRangeColor && e > this.TableRange[1]) return this.AboveRangeColor;
                                        return this.Table[t]
                                    }
                                }, {
                                    key: "getIndex",
                                    value: function(e) {
                                        var t = {
                                            Range: []
                                        };
                                        return t.MaxIndex = this.NumberOfColors - 1, t.Shift = -this.TableRange[0], this.TableRange[1] <= this.TableRange[0] ? t.Scale = Number.MAX_VALUE : t.Scale = t.MaxIndex / (this.TableRange[1] - this.TableRange[0]), t.Range[0] = this.TableRange[0], t.Range[1] = this.TableRange[1], isNaN(e) ? -1 : (e = e < t.Range[0] ? t.MaxIndex + 0 + 1.5 : e > t.Range[1] ? t.MaxIndex + 1 + 1.5 : (e + t.Shift) * t.Scale, (t = Math.floor(e)) === this.NumberOfColors + 0 ? t = 0 : t === this.NumberOfColors + 1 && (t = this.NumberOfColors - 1), t)
                                    }
                                }, {
                                    key: "setTableValue",
                                    value: function(e, t) {
                                        if (5 === arguments.length && (t = Array.prototype.slice.call(arguments, 1)), e < 0) throw new Error("Can't set the table value for negative index (".concat(e, ")"));
                                        e >= this.NumberOfColors && new Error("Index ".concat(e, " is greater than the number of colors ").concat(this.NumberOfColors)), this.Table[e] = t, 0 !== e && e !== this.NumberOfColors - 1 || this.buildSpecialColors()
                                    }
                                }]) && N(t.prototype, n), o && N(t, o), Object.defineProperty(t, "prototype", {
                                    writable: !1
                                }), e
                            }(),
                            B = [0, 0, 0, 0],
                            V = {
                                hotIron: {
                                    name: "Hot Iron",
                                    numOfColors: 256,
                                    colors: [
                                        [0, 0, 0, 255],
                                        [2, 0, 0, 255],
                                        [4, 0, 0, 255],
                                        [6, 0, 0, 255],
                                        [8, 0, 0, 255],
                                        [10, 0, 0, 255],
                                        [12, 0, 0, 255],
                                        [14, 0, 0, 255],
                                        [16, 0, 0, 255],
                                        [18, 0, 0, 255],
                                        [20, 0, 0, 255],
                                        [22, 0, 0, 255],
                                        [24, 0, 0, 255],
                                        [26, 0, 0, 255],
                                        [28, 0, 0, 255],
                                        [30, 0, 0, 255],
                                        [32, 0, 0, 255],
                                        [34, 0, 0, 255],
                                        [36, 0, 0, 255],
                                        [38, 0, 0, 255],
                                        [40, 0, 0, 255],
                                        [42, 0, 0, 255],
                                        [44, 0, 0, 255],
                                        [46, 0, 0, 255],
                                        [48, 0, 0, 255],
                                        [50, 0, 0, 255],
                                        [52, 0, 0, 255],
                                        [54, 0, 0, 255],
                                        [56, 0, 0, 255],
                                        [58, 0, 0, 255],
                                        [60, 0, 0, 255],
                                        [62, 0, 0, 255],
                                        [64, 0, 0, 255],
                                        [66, 0, 0, 255],
                                        [68, 0, 0, 255],
                                        [70, 0, 0, 255],
                                        [72, 0, 0, 255],
                                        [74, 0, 0, 255],
                                        [76, 0, 0, 255],
                                        [78, 0, 0, 255],
                                        [80, 0, 0, 255],
                                        [82, 0, 0, 255],
                                        [84, 0, 0, 255],
                                        [86, 0, 0, 255],
                                        [88, 0, 0, 255],
                                        [90, 0, 0, 255],
                                        [92, 0, 0, 255],
                                        [94, 0, 0, 255],
                                        [96, 0, 0, 255],
                                        [98, 0, 0, 255],
                                        [100, 0, 0, 255],
                                        [102, 0, 0, 255],
                                        [104, 0, 0, 255],
                                        [106, 0, 0, 255],
                                        [108, 0, 0, 255],
                                        [110, 0, 0, 255],
                                        [112, 0, 0, 255],
                                        [114, 0, 0, 255],
                                        [116, 0, 0, 255],
                                        [118, 0, 0, 255],
                                        [120, 0, 0, 255],
                                        [122, 0, 0, 255],
                                        [124, 0, 0, 255],
                                        [126, 0, 0, 255],
                                        [128, 0, 0, 255],
                                        [130, 0, 0, 255],
                                        [132, 0, 0, 255],
                                        [134, 0, 0, 255],
                                        [136, 0, 0, 255],
                                        [138, 0, 0, 255],
                                        [140, 0, 0, 255],
                                        [142, 0, 0, 255],
                                        [144, 0, 0, 255],
                                        [146, 0, 0, 255],
                                        [148, 0, 0, 255],
                                        [150, 0, 0, 255],
                                        [152, 0, 0, 255],
                                        [154, 0, 0, 255],
                                        [156, 0, 0, 255],
                                        [158, 0, 0, 255],
                                        [160, 0, 0, 255],
                                        [162, 0, 0, 255],
                                        [164, 0, 0, 255],
                                        [166, 0, 0, 255],
                                        [168, 0, 0, 255],
                                        [170, 0, 0, 255],
                                        [172, 0, 0, 255],
                                        [174, 0, 0, 255],
                                        [176, 0, 0, 255],
                                        [178, 0, 0, 255],
                                        [180, 0, 0, 255],
                                        [182, 0, 0, 255],
                                        [184, 0, 0, 255],
                                        [186, 0, 0, 255],
                                        [188, 0, 0, 255],
                                        [190, 0, 0, 255],
                                        [192, 0, 0, 255],
                                        [194, 0, 0, 255],
                                        [196, 0, 0, 255],
                                        [198, 0, 0, 255],
                                        [200, 0, 0, 255],
                                        [202, 0, 0, 255],
                                        [204, 0, 0, 255],
                                        [206, 0, 0, 255],
                                        [208, 0, 0, 255],
                                        [210, 0, 0, 255],
                                        [212, 0, 0, 255],
                                        [214, 0, 0, 255],
                                        [216, 0, 0, 255],
                                        [218, 0, 0, 255],
                                        [220, 0, 0, 255],
                                        [222, 0, 0, 255],
                                        [224, 0, 0, 255],
                                        [226, 0, 0, 255],
                                        [228, 0, 0, 255],
                                        [230, 0, 0, 255],
                                        [232, 0, 0, 255],
                                        [234, 0, 0, 255],
                                        [236, 0, 0, 255],
                                        [238, 0, 0, 255],
                                        [240, 0, 0, 255],
                                        [242, 0, 0, 255],
                                        [244, 0, 0, 255],
                                        [246, 0, 0, 255],
                                        [248, 0, 0, 255],
                                        [250, 0, 0, 255],
                                        [252, 0, 0, 255],
                                        [254, 0, 0, 255],
                                        [255, 0, 0, 255],
                                        [255, 2, 0, 255],
                                        [255, 4, 0, 255],
                                        [255, 6, 0, 255],
                                        [255, 8, 0, 255],
                                        [255, 10, 0, 255],
                                        [255, 12, 0, 255],
                                        [255, 14, 0, 255],
                                        [255, 16, 0, 255],
                                        [255, 18, 0, 255],
                                        [255, 20, 0, 255],
                                        [255, 22, 0, 255],
                                        [255, 24, 0, 255],
                                        [255, 26, 0, 255],
                                        [255, 28, 0, 255],
                                        [255, 30, 0, 255],
                                        [255, 32, 0, 255],
                                        [255, 34, 0, 255],
                                        [255, 36, 0, 255],
                                        [255, 38, 0, 255],
                                        [255, 40, 0, 255],
                                        [255, 42, 0, 255],
                                        [255, 44, 0, 255],
                                        [255, 46, 0, 255],
                                        [255, 48, 0, 255],
                                        [255, 50, 0, 255],
                                        [255, 52, 0, 255],
                                        [255, 54, 0, 255],
                                        [255, 56, 0, 255],
                                        [255, 58, 0, 255],
                                        [255, 60, 0, 255],
                                        [255, 62, 0, 255],
                                        [255, 64, 0, 255],
                                        [255, 66, 0, 255],
                                        [255, 68, 0, 255],
                                        [255, 70, 0, 255],
                                        [255, 72, 0, 255],
                                        [255, 74, 0, 255],
                                        [255, 76, 0, 255],
                                        [255, 78, 0, 255],
                                        [255, 80, 0, 255],
                                        [255, 82, 0, 255],
                                        [255, 84, 0, 255],
                                        [255, 86, 0, 255],
                                        [255, 88, 0, 255],
                                        [255, 90, 0, 255],
                                        [255, 92, 0, 255],
                                        [255, 94, 0, 255],
                                        [255, 96, 0, 255],
                                        [255, 98, 0, 255],
                                        [255, 100, 0, 255],
                                        [255, 102, 0, 255],
                                        [255, 104, 0, 255],
                                        [255, 106, 0, 255],
                                        [255, 108, 0, 255],
                                        [255, 110, 0, 255],
                                        [255, 112, 0, 255],
                                        [255, 114, 0, 255],
                                        [255, 116, 0, 255],
                                        [255, 118, 0, 255],
                                        [255, 120, 0, 255],
                                        [255, 122, 0, 255],
                                        [255, 124, 0, 255],
                                        [255, 126, 0, 255],
                                        [255, 128, 4, 255],
                                        [255, 130, 8, 255],
                                        [255, 132, 12, 255],
                                        [255, 134, 16, 255],
                                        [255, 136, 20, 255],
                                        [255, 138, 24, 255],
                                        [255, 140, 28, 255],
                                        [255, 142, 32, 255],
                                        [255, 144, 36, 255],
                                        [255, 146, 40, 255],
                                        [255, 148, 44, 255],
                                        [255, 150, 48, 255],
                                        [255, 152, 52, 255],
                                        [255, 154, 56, 255],
                                        [255, 156, 60, 255],
                                        [255, 158, 64, 255],
                                        [255, 160, 68, 255],
                                        [255, 162, 72, 255],
                                        [255, 164, 76, 255],
                                        [255, 166, 80, 255],
                                        [255, 168, 84, 255],
                                        [255, 170, 88, 255],
                                        [255, 172, 92, 255],
                                        [255, 174, 96, 255],
                                        [255, 176, 100, 255],
                                        [255, 178, 104, 255],
                                        [255, 180, 108, 255],
                                        [255, 182, 112, 255],
                                        [255, 184, 116, 255],
                                        [255, 186, 120, 255],
                                        [255, 188, 124, 255],
                                        [255, 190, 128, 255],
                                        [255, 192, 132, 255],
                                        [255, 194, 136, 255],
                                        [255, 196, 140, 255],
                                        [255, 198, 144, 255],
                                        [255, 200, 148, 255],
                                        [255, 202, 152, 255],
                                        [255, 204, 156, 255],
                                        [255, 206, 160, 255],
                                        [255, 208, 164, 255],
                                        [255, 210, 168, 255],
                                        [255, 212, 172, 255],
                                        [255, 214, 176, 255],
                                        [255, 216, 180, 255],
                                        [255, 218, 184, 255],
                                        [255, 220, 188, 255],
                                        [255, 222, 192, 255],
                                        [255, 224, 196, 255],
                                        [255, 226, 200, 255],
                                        [255, 228, 204, 255],
                                        [255, 230, 208, 255],
                                        [255, 232, 212, 255],
                                        [255, 234, 216, 255],
                                        [255, 236, 220, 255],
                                        [255, 238, 224, 255],
                                        [255, 240, 228, 255],
                                        [255, 242, 232, 255],
                                        [255, 244, 236, 255],
                                        [255, 246, 240, 255],
                                        [255, 248, 244, 255],
                                        [255, 250, 248, 255],
                                        [255, 252, 252, 255],
                                        [255, 255, 255, 255]
                                    ]
                                },
                                pet: {
                                    name: "PET",
                                    numColors: 256,
                                    colors: [
                                        [0, 0, 0, 255],
                                        [0, 2, 1, 255],
                                        [0, 4, 3, 255],
                                        [0, 6, 5, 255],
                                        [0, 8, 7, 255],
                                        [0, 10, 9, 255],
                                        [0, 12, 11, 255],
                                        [0, 14, 13, 255],
                                        [0, 16, 15, 255],
                                        [0, 18, 17, 255],
                                        [0, 20, 19, 255],
                                        [0, 22, 21, 255],
                                        [0, 24, 23, 255],
                                        [0, 26, 25, 255],
                                        [0, 28, 27, 255],
                                        [0, 30, 29, 255],
                                        [0, 32, 31, 255],
                                        [0, 34, 33, 255],
                                        [0, 36, 35, 255],
                                        [0, 38, 37, 255],
                                        [0, 40, 39, 255],
                                        [0, 42, 41, 255],
                                        [0, 44, 43, 255],
                                        [0, 46, 45, 255],
                                        [0, 48, 47, 255],
                                        [0, 50, 49, 255],
                                        [0, 52, 51, 255],
                                        [0, 54, 53, 255],
                                        [0, 56, 55, 255],
                                        [0, 58, 57, 255],
                                        [0, 60, 59, 255],
                                        [0, 62, 61, 255],
                                        [0, 65, 63, 255],
                                        [0, 67, 65, 255],
                                        [0, 69, 67, 255],
                                        [0, 71, 69, 255],
                                        [0, 73, 71, 255],
                                        [0, 75, 73, 255],
                                        [0, 77, 75, 255],
                                        [0, 79, 77, 255],
                                        [0, 81, 79, 255],
                                        [0, 83, 81, 255],
                                        [0, 85, 83, 255],
                                        [0, 87, 85, 255],
                                        [0, 89, 87, 255],
                                        [0, 91, 89, 255],
                                        [0, 93, 91, 255],
                                        [0, 95, 93, 255],
                                        [0, 97, 95, 255],
                                        [0, 99, 97, 255],
                                        [0, 101, 99, 255],
                                        [0, 103, 101, 255],
                                        [0, 105, 103, 255],
                                        [0, 107, 105, 255],
                                        [0, 109, 107, 255],
                                        [0, 111, 109, 255],
                                        [0, 113, 111, 255],
                                        [0, 115, 113, 255],
                                        [0, 117, 115, 255],
                                        [0, 119, 117, 255],
                                        [0, 121, 119, 255],
                                        [0, 123, 121, 255],
                                        [0, 125, 123, 255],
                                        [0, 128, 125, 255],
                                        [1, 126, 127, 255],
                                        [3, 124, 129, 255],
                                        [5, 122, 131, 255],
                                        [7, 120, 133, 255],
                                        [9, 118, 135, 255],
                                        [11, 116, 137, 255],
                                        [13, 114, 139, 255],
                                        [15, 112, 141, 255],
                                        [17, 110, 143, 255],
                                        [19, 108, 145, 255],
                                        [21, 106, 147, 255],
                                        [23, 104, 149, 255],
                                        [25, 102, 151, 255],
                                        [27, 100, 153, 255],
                                        [29, 98, 155, 255],
                                        [31, 96, 157, 255],
                                        [33, 94, 159, 255],
                                        [35, 92, 161, 255],
                                        [37, 90, 163, 255],
                                        [39, 88, 165, 255],
                                        [41, 86, 167, 255],
                                        [43, 84, 169, 255],
                                        [45, 82, 171, 255],
                                        [47, 80, 173, 255],
                                        [49, 78, 175, 255],
                                        [51, 76, 177, 255],
                                        [53, 74, 179, 255],
                                        [55, 72, 181, 255],
                                        [57, 70, 183, 255],
                                        [59, 68, 185, 255],
                                        [61, 66, 187, 255],
                                        [63, 64, 189, 255],
                                        [65, 63, 191, 255],
                                        [67, 61, 193, 255],
                                        [69, 59, 195, 255],
                                        [71, 57, 197, 255],
                                        [73, 55, 199, 255],
                                        [75, 53, 201, 255],
                                        [77, 51, 203, 255],
                                        [79, 49, 205, 255],
                                        [81, 47, 207, 255],
                                        [83, 45, 209, 255],
                                        [85, 43, 211, 255],
                                        [86, 41, 213, 255],
                                        [88, 39, 215, 255],
                                        [90, 37, 217, 255],
                                        [92, 35, 219, 255],
                                        [94, 33, 221, 255],
                                        [96, 31, 223, 255],
                                        [98, 29, 225, 255],
                                        [100, 27, 227, 255],
                                        [102, 25, 229, 255],
                                        [104, 23, 231, 255],
                                        [106, 21, 233, 255],
                                        [108, 19, 235, 255],
                                        [110, 17, 237, 255],
                                        [112, 15, 239, 255],
                                        [114, 13, 241, 255],
                                        [116, 11, 243, 255],
                                        [118, 9, 245, 255],
                                        [120, 7, 247, 255],
                                        [122, 5, 249, 255],
                                        [124, 3, 251, 255],
                                        [126, 1, 253, 255],
                                        [128, 0, 255, 255],
                                        [130, 2, 252, 255],
                                        [132, 4, 248, 255],
                                        [134, 6, 244, 255],
                                        [136, 8, 240, 255],
                                        [138, 10, 236, 255],
                                        [140, 12, 232, 255],
                                        [142, 14, 228, 255],
                                        [144, 16, 224, 255],
                                        [146, 18, 220, 255],
                                        [148, 20, 216, 255],
                                        [150, 22, 212, 255],
                                        [152, 24, 208, 255],
                                        [154, 26, 204, 255],
                                        [156, 28, 200, 255],
                                        [158, 30, 196, 255],
                                        [160, 32, 192, 255],
                                        [162, 34, 188, 255],
                                        [164, 36, 184, 255],
                                        [166, 38, 180, 255],
                                        [168, 40, 176, 255],
                                        [170, 42, 172, 255],
                                        [171, 44, 168, 255],
                                        [173, 46, 164, 255],
                                        [175, 48, 160, 255],
                                        [177, 50, 156, 255],
                                        [179, 52, 152, 255],
                                        [181, 54, 148, 255],
                                        [183, 56, 144, 255],
                                        [185, 58, 140, 255],
                                        [187, 60, 136, 255],
                                        [189, 62, 132, 255],
                                        [191, 64, 128, 255],
                                        [193, 66, 124, 255],
                                        [195, 68, 120, 255],
                                        [197, 70, 116, 255],
                                        [199, 72, 112, 255],
                                        [201, 74, 108, 255],
                                        [203, 76, 104, 255],
                                        [205, 78, 100, 255],
                                        [207, 80, 96, 255],
                                        [209, 82, 92, 255],
                                        [211, 84, 88, 255],
                                        [213, 86, 84, 255],
                                        [215, 88, 80, 255],
                                        [217, 90, 76, 255],
                                        [219, 92, 72, 255],
                                        [221, 94, 68, 255],
                                        [223, 96, 64, 255],
                                        [225, 98, 60, 255],
                                        [227, 100, 56, 255],
                                        [229, 102, 52, 255],
                                        [231, 104, 48, 255],
                                        [233, 106, 44, 255],
                                        [235, 108, 40, 255],
                                        [237, 110, 36, 255],
                                        [239, 112, 32, 255],
                                        [241, 114, 28, 255],
                                        [243, 116, 24, 255],
                                        [245, 118, 20, 255],
                                        [247, 120, 16, 255],
                                        [249, 122, 12, 255],
                                        [251, 124, 8, 255],
                                        [253, 126, 4, 255],
                                        [255, 128, 0, 255],
                                        [255, 130, 4, 255],
                                        [255, 132, 8, 255],
                                        [255, 134, 12, 255],
                                        [255, 136, 16, 255],
                                        [255, 138, 20, 255],
                                        [255, 140, 24, 255],
                                        [255, 142, 28, 255],
                                        [255, 144, 32, 255],
                                        [255, 146, 36, 255],
                                        [255, 148, 40, 255],
                                        [255, 150, 44, 255],
                                        [255, 152, 48, 255],
                                        [255, 154, 52, 255],
                                        [255, 156, 56, 255],
                                        [255, 158, 60, 255],
                                        [255, 160, 64, 255],
                                        [255, 162, 68, 255],
                                        [255, 164, 72, 255],
                                        [255, 166, 76, 255],
                                        [255, 168, 80, 255],
                                        [255, 170, 85, 255],
                                        [255, 172, 89, 255],
                                        [255, 174, 93, 255],
                                        [255, 176, 97, 255],
                                        [255, 178, 101, 255],
                                        [255, 180, 105, 255],
                                        [255, 182, 109, 255],
                                        [255, 184, 113, 255],
                                        [255, 186, 117, 255],
                                        [255, 188, 121, 255],
                                        [255, 190, 125, 255],
                                        [255, 192, 129, 255],
                                        [255, 194, 133, 255],
                                        [255, 196, 137, 255],
                                        [255, 198, 141, 255],
                                        [255, 200, 145, 255],
                                        [255, 202, 149, 255],
                                        [255, 204, 153, 255],
                                        [255, 206, 157, 255],
                                        [255, 208, 161, 255],
                                        [255, 210, 165, 255],
                                        [255, 212, 170, 255],
                                        [255, 214, 174, 255],
                                        [255, 216, 178, 255],
                                        [255, 218, 182, 255],
                                        [255, 220, 186, 255],
                                        [255, 222, 190, 255],
                                        [255, 224, 194, 255],
                                        [255, 226, 198, 255],
                                        [255, 228, 202, 255],
                                        [255, 230, 206, 255],
                                        [255, 232, 210, 255],
                                        [255, 234, 214, 255],
                                        [255, 236, 218, 255],
                                        [255, 238, 222, 255],
                                        [255, 240, 226, 255],
                                        [255, 242, 230, 255],
                                        [255, 244, 234, 255],
                                        [255, 246, 238, 255],
                                        [255, 248, 242, 255],
                                        [255, 250, 246, 255],
                                        [255, 252, 250, 255],
                                        [255, 255, 255, 255]
                                    ]
                                },
                                hotMetalBlue: {
                                    name: "Hot Metal Blue",
                                    numColors: 256,
                                    colors: [
                                        [0, 0, 0, 255],
                                        [0, 0, 2, 255],
                                        [0, 0, 4, 255],
                                        [0, 0, 6, 255],
                                        [0, 0, 8, 255],
                                        [0, 0, 10, 255],
                                        [0, 0, 12, 255],
                                        [0, 0, 14, 255],
                                        [0, 0, 16, 255],
                                        [0, 0, 17, 255],
                                        [0, 0, 19, 255],
                                        [0, 0, 21, 255],
                                        [0, 0, 23, 255],
                                        [0, 0, 25, 255],
                                        [0, 0, 27, 255],
                                        [0, 0, 29, 255],
                                        [0, 0, 31, 255],
                                        [0, 0, 33, 255],
                                        [0, 0, 35, 255],
                                        [0, 0, 37, 255],
                                        [0, 0, 39, 255],
                                        [0, 0, 41, 255],
                                        [0, 0, 43, 255],
                                        [0, 0, 45, 255],
                                        [0, 0, 47, 255],
                                        [0, 0, 49, 255],
                                        [0, 0, 51, 255],
                                        [0, 0, 53, 255],
                                        [0, 0, 55, 255],
                                        [0, 0, 57, 255],
                                        [0, 0, 59, 255],
                                        [0, 0, 61, 255],
                                        [0, 0, 63, 255],
                                        [0, 0, 65, 255],
                                        [0, 0, 67, 255],
                                        [0, 0, 69, 255],
                                        [0, 0, 71, 255],
                                        [0, 0, 73, 255],
                                        [0, 0, 75, 255],
                                        [0, 0, 77, 255],
                                        [0, 0, 79, 255],
                                        [0, 0, 81, 255],
                                        [0, 0, 83, 255],
                                        [0, 0, 84, 255],
                                        [0, 0, 86, 255],
                                        [0, 0, 88, 255],
                                        [0, 0, 90, 255],
                                        [0, 0, 92, 255],
                                        [0, 0, 94, 255],
                                        [0, 0, 96, 255],
                                        [0, 0, 98, 255],
                                        [0, 0, 100, 255],
                                        [0, 0, 102, 255],
                                        [0, 0, 104, 255],
                                        [0, 0, 106, 255],
                                        [0, 0, 108, 255],
                                        [0, 0, 110, 255],
                                        [0, 0, 112, 255],
                                        [0, 0, 114, 255],
                                        [0, 0, 116, 255],
                                        [0, 0, 117, 255],
                                        [0, 0, 119, 255],
                                        [0, 0, 121, 255],
                                        [0, 0, 123, 255],
                                        [0, 0, 125, 255],
                                        [0, 0, 127, 255],
                                        [0, 0, 129, 255],
                                        [0, 0, 131, 255],
                                        [0, 0, 133, 255],
                                        [0, 0, 135, 255],
                                        [0, 0, 137, 255],
                                        [0, 0, 139, 255],
                                        [0, 0, 141, 255],
                                        [0, 0, 143, 255],
                                        [0, 0, 145, 255],
                                        [0, 0, 147, 255],
                                        [0, 0, 149, 255],
                                        [0, 0, 151, 255],
                                        [0, 0, 153, 255],
                                        [0, 0, 155, 255],
                                        [0, 0, 157, 255],
                                        [0, 0, 159, 255],
                                        [0, 0, 161, 255],
                                        [0, 0, 163, 255],
                                        [0, 0, 165, 255],
                                        [0, 0, 167, 255],
                                        [3, 0, 169, 255],
                                        [6, 0, 171, 255],
                                        [9, 0, 173, 255],
                                        [12, 0, 175, 255],
                                        [15, 0, 177, 255],
                                        [18, 0, 179, 255],
                                        [21, 0, 181, 255],
                                        [24, 0, 183, 255],
                                        [26, 0, 184, 255],
                                        [29, 0, 186, 255],
                                        [32, 0, 188, 255],
                                        [35, 0, 190, 255],
                                        [38, 0, 192, 255],
                                        [41, 0, 194, 255],
                                        [44, 0, 196, 255],
                                        [47, 0, 198, 255],
                                        [50, 0, 200, 255],
                                        [52, 0, 197, 255],
                                        [55, 0, 194, 255],
                                        [57, 0, 191, 255],
                                        [59, 0, 188, 255],
                                        [62, 0, 185, 255],
                                        [64, 0, 182, 255],
                                        [66, 0, 179, 255],
                                        [69, 0, 176, 255],
                                        [71, 0, 174, 255],
                                        [74, 0, 171, 255],
                                        [76, 0, 168, 255],
                                        [78, 0, 165, 255],
                                        [81, 0, 162, 255],
                                        [83, 0, 159, 255],
                                        [85, 0, 156, 255],
                                        [88, 0, 153, 255],
                                        [90, 0, 150, 255],
                                        [93, 2, 144, 255],
                                        [96, 4, 138, 255],
                                        [99, 6, 132, 255],
                                        [102, 8, 126, 255],
                                        [105, 9, 121, 255],
                                        [108, 11, 115, 255],
                                        [111, 13, 109, 255],
                                        [114, 15, 103, 255],
                                        [116, 17, 97, 255],
                                        [119, 19, 91, 255],
                                        [122, 21, 85, 255],
                                        [125, 23, 79, 255],
                                        [128, 24, 74, 255],
                                        [131, 26, 68, 255],
                                        [134, 28, 62, 255],
                                        [137, 30, 56, 255],
                                        [140, 32, 50, 255],
                                        [143, 34, 47, 255],
                                        [146, 36, 44, 255],
                                        [149, 38, 41, 255],
                                        [152, 40, 38, 255],
                                        [155, 41, 35, 255],
                                        [158, 43, 32, 255],
                                        [161, 45, 29, 255],
                                        [164, 47, 26, 255],
                                        [166, 49, 24, 255],
                                        [169, 51, 21, 255],
                                        [172, 53, 18, 255],
                                        [175, 55, 15, 255],
                                        [178, 56, 12, 255],
                                        [181, 58, 9, 255],
                                        [184, 60, 6, 255],
                                        [187, 62, 3, 255],
                                        [190, 64, 0, 255],
                                        [194, 66, 0, 255],
                                        [198, 68, 0, 255],
                                        [201, 70, 0, 255],
                                        [205, 72, 0, 255],
                                        [209, 73, 0, 255],
                                        [213, 75, 0, 255],
                                        [217, 77, 0, 255],
                                        [221, 79, 0, 255],
                                        [224, 81, 0, 255],
                                        [228, 83, 0, 255],
                                        [232, 85, 0, 255],
                                        [236, 87, 0, 255],
                                        [240, 88, 0, 255],
                                        [244, 90, 0, 255],
                                        [247, 92, 0, 255],
                                        [251, 94, 0, 255],
                                        [255, 96, 0, 255],
                                        [255, 98, 3, 255],
                                        [255, 100, 6, 255],
                                        [255, 102, 9, 255],
                                        [255, 104, 12, 255],
                                        [255, 105, 15, 255],
                                        [255, 107, 18, 255],
                                        [255, 109, 21, 255],
                                        [255, 111, 24, 255],
                                        [255, 113, 26, 255],
                                        [255, 115, 29, 255],
                                        [255, 117, 32, 255],
                                        [255, 119, 35, 255],
                                        [255, 120, 38, 255],
                                        [255, 122, 41, 255],
                                        [255, 124, 44, 255],
                                        [255, 126, 47, 255],
                                        [255, 128, 50, 255],
                                        [255, 130, 53, 255],
                                        [255, 132, 56, 255],
                                        [255, 134, 59, 255],
                                        [255, 136, 62, 255],
                                        [255, 137, 65, 255],
                                        [255, 139, 68, 255],
                                        [255, 141, 71, 255],
                                        [255, 143, 74, 255],
                                        [255, 145, 76, 255],
                                        [255, 147, 79, 255],
                                        [255, 149, 82, 255],
                                        [255, 151, 85, 255],
                                        [255, 152, 88, 255],
                                        [255, 154, 91, 255],
                                        [255, 156, 94, 255],
                                        [255, 158, 97, 255],
                                        [255, 160, 100, 255],
                                        [255, 162, 103, 255],
                                        [255, 164, 106, 255],
                                        [255, 166, 109, 255],
                                        [255, 168, 112, 255],
                                        [255, 169, 115, 255],
                                        [255, 171, 118, 255],
                                        [255, 173, 121, 255],
                                        [255, 175, 124, 255],
                                        [255, 177, 126, 255],
                                        [255, 179, 129, 255],
                                        [255, 181, 132, 255],
                                        [255, 183, 135, 255],
                                        [255, 184, 138, 255],
                                        [255, 186, 141, 255],
                                        [255, 188, 144, 255],
                                        [255, 190, 147, 255],
                                        [255, 192, 150, 255],
                                        [255, 194, 153, 255],
                                        [255, 196, 156, 255],
                                        [255, 198, 159, 255],
                                        [255, 200, 162, 255],
                                        [255, 201, 165, 255],
                                        [255, 203, 168, 255],
                                        [255, 205, 171, 255],
                                        [255, 207, 174, 255],
                                        [255, 209, 176, 255],
                                        [255, 211, 179, 255],
                                        [255, 213, 182, 255],
                                        [255, 215, 185, 255],
                                        [255, 216, 188, 255],
                                        [255, 218, 191, 255],
                                        [255, 220, 194, 255],
                                        [255, 222, 197, 255],
                                        [255, 224, 200, 255],
                                        [255, 226, 203, 255],
                                        [255, 228, 206, 255],
                                        [255, 229, 210, 255],
                                        [255, 231, 213, 255],
                                        [255, 233, 216, 255],
                                        [255, 235, 219, 255],
                                        [255, 237, 223, 255],
                                        [255, 239, 226, 255],
                                        [255, 240, 229, 255],
                                        [255, 242, 232, 255],
                                        [255, 244, 236, 255],
                                        [255, 246, 239, 255],
                                        [255, 248, 242, 255],
                                        [255, 250, 245, 255],
                                        [255, 251, 249, 255],
                                        [255, 253, 252, 255],
                                        [255, 255, 255, 255]
                                    ]
                                },
                                pet20Step: {
                                    name: "PET 20 Step",
                                    numColors: 256,
                                    colors: [
                                        [0, 0, 0, 255],
                                        [0, 0, 0, 255],
                                        [0, 0, 0, 255],
                                        [0, 0, 0, 255],
                                        [0, 0, 0, 255],
                                        [0, 0, 0, 255],
                                        [0, 0, 0, 255],
                                        [0, 0, 0, 255],
                                        [0, 0, 0, 255],
                                        [0, 0, 0, 255],
                                        [0, 0, 0, 255],
                                        [0, 0, 0, 255],
                                        [0, 0, 0, 255],
                                        [96, 0, 80, 255],
                                        [96, 0, 80, 255],
                                        [96, 0, 80, 255],
                                        [96, 0, 80, 255],
                                        [96, 0, 80, 255],
                                        [96, 0, 80, 255],
                                        [96, 0, 80, 255],
                                        [96, 0, 80, 255],
                                        [96, 0, 80, 255],
                                        [96, 0, 80, 255],
                                        [96, 0, 80, 255],
                                        [96, 0, 80, 255],
                                        [96, 0, 80, 255],
                                        [48, 48, 80, 255],
                                        [48, 48, 80, 255],
                                        [48, 48, 80, 255],
                                        [48, 48, 80, 255],
                                        [48, 48, 80, 255],
                                        [48, 48, 80, 255],
                                        [48, 48, 80, 255],
                                        [48, 48, 80, 255],
                                        [48, 48, 80, 255],
                                        [48, 48, 80, 255],
                                        [48, 48, 80, 255],
                                        [48, 48, 80, 255],
                                        [48, 48, 80, 255],
                                        [48, 48, 112, 255],
                                        [48, 48, 112, 255],
                                        [48, 48, 112, 255],
                                        [48, 48, 112, 255],
                                        [48, 48, 112, 255],
                                        [48, 48, 112, 255],
                                        [48, 48, 112, 255],
                                        [48, 48, 112, 255],
                                        [48, 48, 112, 255],
                                        [48, 48, 112, 255],
                                        [48, 48, 112, 255],
                                        [48, 48, 112, 255],
                                        [80, 80, 128, 255],
                                        [80, 80, 128, 255],
                                        [80, 80, 128, 255],
                                        [80, 80, 128, 255],
                                        [80, 80, 128, 255],
                                        [80, 80, 128, 255],
                                        [80, 80, 128, 255],
                                        [80, 80, 128, 255],
                                        [80, 80, 128, 255],
                                        [80, 80, 128, 255],
                                        [80, 80, 128, 255],
                                        [80, 80, 128, 255],
                                        [80, 80, 128, 255],
                                        [96, 96, 176, 255],
                                        [96, 96, 176, 255],
                                        [96, 96, 176, 255],
                                        [96, 96, 176, 255],
                                        [96, 96, 176, 255],
                                        [96, 96, 176, 255],
                                        [96, 96, 176, 255],
                                        [96, 96, 176, 255],
                                        [96, 96, 176, 255],
                                        [96, 96, 176, 255],
                                        [96, 96, 176, 255],
                                        [96, 96, 176, 255],
                                        [96, 96, 176, 255],
                                        [112, 112, 192, 255],
                                        [112, 112, 192, 255],
                                        [112, 112, 192, 255],
                                        [112, 112, 192, 255],
                                        [112, 112, 192, 255],
                                        [112, 112, 192, 255],
                                        [112, 112, 192, 255],
                                        [112, 112, 192, 255],
                                        [112, 112, 192, 255],
                                        [112, 112, 192, 255],
                                        [112, 112, 192, 255],
                                        [112, 112, 192, 255],
                                        [112, 112, 192, 255],
                                        [128, 128, 224, 255],
                                        [128, 128, 224, 255],
                                        [128, 128, 224, 255],
                                        [128, 128, 224, 255],
                                        [128, 128, 224, 255],
                                        [128, 128, 224, 255],
                                        [128, 128, 224, 255],
                                        [128, 128, 224, 255],
                                        [128, 128, 224, 255],
                                        [128, 128, 224, 255],
                                        [128, 128, 224, 255],
                                        [128, 128, 224, 255],
                                        [48, 96, 48, 255],
                                        [48, 96, 48, 255],
                                        [48, 96, 48, 255],
                                        [48, 96, 48, 255],
                                        [48, 96, 48, 255],
                                        [48, 96, 48, 255],
                                        [48, 96, 48, 255],
                                        [48, 96, 48, 255],
                                        [48, 96, 48, 255],
                                        [48, 96, 48, 255],
                                        [48, 96, 48, 255],
                                        [48, 96, 48, 255],
                                        [48, 96, 48, 255],
                                        [48, 144, 48, 255],
                                        [48, 144, 48, 255],
                                        [48, 144, 48, 255],
                                        [48, 144, 48, 255],
                                        [48, 144, 48, 255],
                                        [48, 144, 48, 255],
                                        [48, 144, 48, 255],
                                        [48, 144, 48, 255],
                                        [48, 144, 48, 255],
                                        [48, 144, 48, 255],
                                        [48, 144, 48, 255],
                                        [48, 144, 48, 255],
                                        [48, 144, 48, 255],
                                        [80, 192, 80, 255],
                                        [80, 192, 80, 255],
                                        [80, 192, 80, 255],
                                        [80, 192, 80, 255],
                                        [80, 192, 80, 255],
                                        [80, 192, 80, 255],
                                        [80, 192, 80, 255],
                                        [80, 192, 80, 255],
                                        [80, 192, 80, 255],
                                        [80, 192, 80, 255],
                                        [80, 192, 80, 255],
                                        [80, 192, 80, 255],
                                        [80, 192, 80, 255],
                                        [64, 224, 64, 255],
                                        [64, 224, 64, 255],
                                        [64, 224, 64, 255],
                                        [64, 224, 64, 255],
                                        [64, 224, 64, 255],
                                        [64, 224, 64, 255],
                                        [64, 224, 64, 255],
                                        [64, 224, 64, 255],
                                        [64, 224, 64, 255],
                                        [64, 224, 64, 255],
                                        [64, 224, 64, 255],
                                        [64, 224, 64, 255],
                                        [224, 224, 80, 255],
                                        [224, 224, 80, 255],
                                        [224, 224, 80, 255],
                                        [224, 224, 80, 255],
                                        [224, 224, 80, 255],
                                        [224, 224, 80, 255],
                                        [224, 224, 80, 255],
                                        [224, 224, 80, 255],
                                        [224, 224, 80, 255],
                                        [224, 224, 80, 255],
                                        [224, 224, 80, 255],
                                        [224, 224, 80, 255],
                                        [224, 224, 80, 255],
                                        [208, 208, 96, 255],
                                        [208, 208, 96, 255],
                                        [208, 208, 96, 255],
                                        [208, 208, 96, 255],
                                        [208, 208, 96, 255],
                                        [208, 208, 96, 255],
                                        [208, 208, 96, 255],
                                        [208, 208, 96, 255],
                                        [208, 208, 96, 255],
                                        [208, 208, 96, 255],
                                        [208, 208, 96, 255],
                                        [208, 208, 96, 255],
                                        [208, 208, 96, 255],
                                        [208, 176, 64, 255],
                                        [208, 176, 64, 255],
                                        [208, 176, 64, 255],
                                        [208, 176, 64, 255],
                                        [208, 176, 64, 255],
                                        [208, 176, 64, 255],
                                        [208, 176, 64, 255],
                                        [208, 176, 64, 255],
                                        [208, 176, 64, 255],
                                        [208, 176, 64, 255],
                                        [208, 176, 64, 255],
                                        [208, 176, 64, 255],
                                        [208, 176, 64, 255],
                                        [208, 144, 0, 255],
                                        [208, 144, 0, 255],
                                        [208, 144, 0, 255],
                                        [208, 144, 0, 255],
                                        [208, 144, 0, 255],
                                        [208, 144, 0, 255],
                                        [208, 144, 0, 255],
                                        [208, 144, 0, 255],
                                        [208, 144, 0, 255],
                                        [208, 144, 0, 255],
                                        [208, 144, 0, 255],
                                        [208, 144, 0, 255],
                                        [192, 96, 0, 255],
                                        [192, 96, 0, 255],
                                        [192, 96, 0, 255],
                                        [192, 96, 0, 255],
                                        [192, 96, 0, 255],
                                        [192, 96, 0, 255],
                                        [192, 96, 0, 255],
                                        [192, 96, 0, 255],
                                        [192, 96, 0, 255],
                                        [192, 96, 0, 255],
                                        [192, 96, 0, 255],
                                        [192, 96, 0, 255],
                                        [192, 96, 0, 255],
                                        [176, 48, 0, 255],
                                        [176, 48, 0, 255],
                                        [176, 48, 0, 255],
                                        [176, 48, 0, 255],
                                        [176, 48, 0, 255],
                                        [176, 48, 0, 255],
                                        [176, 48, 0, 255],
                                        [176, 48, 0, 255],
                                        [176, 48, 0, 255],
                                        [176, 48, 0, 255],
                                        [176, 48, 0, 255],
                                        [176, 48, 0, 255],
                                        [176, 48, 0, 255],
                                        [255, 0, 0, 255],
                                        [255, 0, 0, 255],
                                        [255, 0, 0, 255],
                                        [255, 0, 0, 255],
                                        [255, 0, 0, 255],
                                        [255, 0, 0, 255],
                                        [255, 0, 0, 255],
                                        [255, 0, 0, 255],
                                        [255, 0, 0, 255],
                                        [255, 0, 0, 255],
                                        [255, 0, 0, 255],
                                        [255, 0, 0, 255],
                                        [255, 0, 0, 255],
                                        [255, 255, 255, 255],
                                        [255, 255, 255, 255],
                                        [255, 255, 255, 255],
                                        [255, 255, 255, 255],
                                        [255, 255, 255, 255],
                                        [255, 255, 255, 255],
                                        [255, 255, 255, 255],
                                        [255, 255, 255, 255],
                                        [255, 255, 255, 255],
                                        [255, 255, 255, 255],
                                        [255, 255, 255, 255],
                                        [255, 255, 255, 255],
                                        [255, 255, 255, 255]
                                    ]
                                },
                                gray: {
                                    name: "Gray",
                                    numColors: 256,
                                    gamma: 1,
                                    segmentedData: {
                                        red: [
                                            [0, 0, 0],
                                            [1, 1, 1]
                                        ],
                                        green: [
                                            [0, 0, 0],
                                            [1, 1, 1]
                                        ],
                                        blue: [
                                            [0, 0, 0],
                                            [1, 1, 1]
                                        ]
                                    }
                                },
                                jet: {
                                    name: "Jet",
                                    numColors: 256,
                                    gamma: 1,
                                    segmentedData: {
                                        red: [
                                            [0, 0, 0],
                                            [.35, 0, 0],
                                            [.66, 1, 1],
                                            [.89, 1, 1],
                                            [1, .5, .5]
                                        ],
                                        green: [
                                            [0, 0, 0],
                                            [.125, 0, 0],
                                            [.375, 1, 1],
                                            [.64, 1, 1],
                                            [.91, 0, 0],
                                            [1, 0, 0]
                                        ],
                                        blue: [
                                            [0, .5, .5],
                                            [.11, 1, 1],
                                            [.34, 1, 1],
                                            [.65, 0, 0],
                                            [1, 0, 0]
                                        ]
                                    }
                                },
                                hsv: {
                                    name: "HSV",
                                    numColors: 256,
                                    gamma: 1,
                                    segmentedData: {
                                        red: [
                                            [0, 1, 1],
                                            [.15873, 1, 1],
                                            [.174603, .96875, .96875],
                                            [.333333, .03125, .03125],
                                            [.349206, 0, 0],
                                            [.666667, 0, 0],
                                            [.68254, .03125, .03125],
                                            [.84127, .96875, .96875],
                                            [.857143, 1, 1],
                                            [1, 1, 1]
                                        ],
                                        green: [
                                            [0, 0, 0],
                                            [.15873, .9375, .9375],
                                            [.174603, 1, 1],
                                            [.507937, 1, 1],
                                            [.666667, .0625, .0625],
                                            [.68254, 0, 0],
                                            [1, 0, 0]
                                        ],
                                        blue: [
                                            [0, 0, 0],
                                            [.333333, 0, 0],
                                            [.349206, .0625, .0625],
                                            [.507937, 1, 1],
                                            [.84127, 1, 1],
                                            [.857143, .9375, .9375],
                                            [1, .09375, .09375]
                                        ]
                                    }
                                },
                                hot: {
                                    name: "Hot",
                                    numColors: 256,
                                    gamma: 1,
                                    segmentedData: {
                                        red: [
                                            [0, .0416, .0416],
                                            [.365079, 1, 1],
                                            [1, 1, 1]
                                        ],
                                        green: [
                                            [0, 0, 0],
                                            [.365079, 0, 0],
                                            [.746032, 1, 1],
                                            [1, 1, 1]
                                        ],
                                        blue: [
                                            [0, 0, 0],
                                            [.746032, 0, 0],
                                            [1, 1, 1]
                                        ]
                                    }
                                },
                                cool: {
                                    name: "Cool",
                                    numColors: 256,
                                    gamma: 1,
                                    segmentedData: {
                                        red: [
                                            [0, 0, 0],
                                            [1, 1, 1]
                                        ],
                                        green: [
                                            [0, 1, 1],
                                            [1, 0, 0]
                                        ],
                                        blue: [
                                            [0, 1, 1],
                                            [1, 1, 1]
                                        ]
                                    }
                                },
                                spring: {
                                    name: "Spring",
                                    numColors: 256,
                                    gamma: 1,
                                    segmentedData: {
                                        red: [
                                            [0, 1, 1],
                                            [1, 1, 1]
                                        ],
                                        green: [
                                            [0, 0, 0],
                                            [1, 1, 1]
                                        ],
                                        blue: [
                                            [0, 1, 1],
                                            [1, 0, 0]
                                        ]
                                    }
                                },
                                summer: {
                                    name: "Summer",
                                    numColors: 256,
                                    gamma: 1,
                                    segmentedData: {
                                        red: [
                                            [0, 0, 0],
                                            [1, 1, 1]
                                        ],
                                        green: [
                                            [0, .5, .5],
                                            [1, 1, 1]
                                        ],
                                        blue: [
                                            [0, .4, .4],
                                            [1, .4, .4]
                                        ]
                                    }
                                },
                                autumn: {
                                    name: "Autumn",
                                    numColors: 256,
                                    gamma: 1,
                                    segmentedData: {
                                        red: [
                                            [0, 1, 1],
                                            [1, 1, 1]
                                        ],
                                        green: [
                                            [0, 0, 0],
                                            [1, 1, 1]
                                        ],
                                        blue: [
                                            [0, 0, 0],
                                            [1, 0, 0]
                                        ]
                                    }
                                },
                                winter: {
                                    name: "Winter",
                                    numColors: 256,
                                    gamma: 1,
                                    segmentedData: {
                                        red: [
                                            [0, 0, 0],
                                            [1, 0, 0]
                                        ],
                                        green: [
                                            [0, 0, 0],
                                            [1, 1, 1]
                                        ],
                                        blue: [
                                            [0, 1, 1],
                                            [1, .5, .5]
                                        ]
                                    }
                                },
                                bone: {
                                    name: "Bone",
                                    numColors: 256,
                                    gamma: 1,
                                    segmentedData: {
                                        red: [
                                            [0, 0, 0],
                                            [.746032, .652778, .652778],
                                            [1, 1, 1]
                                        ],
                                        green: [
                                            [0, 0, 0],
                                            [.365079, .319444, .319444],
                                            [.746032, .777778, .777778],
                                            [1, 1, 1]
                                        ],
                                        blue: [
                                            [0, 0, 0],
                                            [.365079, .444444, .444444],
                                            [1, 1, 1]
                                        ]
                                    }
                                },
                                copper: {
                                    name: "Copper",
                                    numColors: 256,
                                    gamma: 1,
                                    segmentedData: {
                                        red: [
                                            [0, 0, 0],
                                            [.809524, 1, 1],
                                            [1, 1, 1]
                                        ],
                                        green: [
                                            [0, 0, 0],
                                            [1, .7812, .7812]
                                        ],
                                        blue: [
                                            [0, 0, 0],
                                            [1, .4975, .4975]
                                        ]
                                    }
                                },
                                spectral: {
                                    name: "Spectral",
                                    numColors: 256,
                                    gamma: 1,
                                    segmentedData: {
                                        red: [
                                            [0, 0, 0],
                                            [.05, .4667, .4667],
                                            [.1, .5333, .5333],
                                            [.15, 0, 0],
                                            [.2, 0, 0],
                                            [.25, 0, 0],
                                            [.3, 0, 0],
                                            [.35, 0, 0],
                                            [.4, 0, 0],
                                            [.45, 0, 0],
                                            [.5, 0, 0],
                                            [.55, 0, 0],
                                            [.6, 0, 0],
                                            [.65, .7333, .7333],
                                            [.7, .9333, .9333],
                                            [.75, 1, 1],
                                            [.8, 1, 1],
                                            [.85, 1, 1],
                                            [.9, .8667, .8667],
                                            [.95, .8, .8],
                                            [1, .8, .8]
                                        ],
                                        green: [
                                            [0, 0, 0],
                                            [.05, 0, 0],
                                            [.1, 0, 0],
                                            [.15, 0, 0],
                                            [.2, 0, 0],
                                            [.25, .4667, .4667],
                                            [.3, .6, .6],
                                            [.35, .6667, .6667],
                                            [.4, .6667, .6667],
                                            [.45, .6, .6],
                                            [.5, .7333, .7333],
                                            [.55, .8667, .8667],
                                            [.6, 1, 1],
                                            [.65, 1, 1],
                                            [.7, .9333, .9333],
                                            [.75, .8, .8],
                                            [.8, .6, .6],
                                            [.85, 0, 0],
                                            [.9, 0, 0],
                                            [.95, 0, 0],
                                            [1, .8, .8]
                                        ],
                                        blue: [
                                            [0, 0, 0],
                                            [.05, .5333, .5333],
                                            [.1, .6, .6],
                                            [.15, .6667, .6667],
                                            [.2, .8667, .8667],
                                            [.25, .8667, .8667],
                                            [.3, .8667, .8667],
                                            [.35, .6667, .6667],
                                            [.4, .5333, .5333],
                                            [.45, 0, 0],
                                            [.5, 0, 0],
                                            [.55, 0, 0],
                                            [.6, 0, 0],
                                            [.65, 0, 0],
                                            [.7, 0, 0],
                                            [.75, 0, 0],
                                            [.8, 0, 0],
                                            [.85, 0, 0],
                                            [.9, 0, 0],
                                            [.95, 0, 0],
                                            [1, .8, .8]
                                        ]
                                    }
                                },
                                coolwarm: {
                                    name: "CoolWarm",
                                    numColors: 256,
                                    gamma: 1,
                                    segmentedData: {
                                        red: [
                                            [0, .2298057, .2298057],
                                            [.03125, .26623388, .26623388],
                                            [.0625, .30386891, .30386891],
                                            [.09375, .342804478, .342804478],
                                            [.125, .38301334, .38301334],
                                            [.15625, .424369608, .424369608],
                                            [.1875, .46666708, .46666708],
                                            [.21875, .509635204, .509635204],
                                            [.25, .552953156, .552953156],
                                            [.28125, .596262162, .596262162],
                                            [.3125, .639176211, .639176211],
                                            [.34375, .681291281, .681291281],
                                            [.375, .722193294, .722193294],
                                            [.40625, .761464949, .761464949],
                                            [.4375, .798691636, .798691636],
                                            [.46875, .833466556, .833466556],
                                            [.5, .865395197, .865395197],
                                            [.53125, .897787179, .897787179],
                                            [.5625, .924127593, .924127593],
                                            [.59375, .944468518, .944468518],
                                            [.625, .958852946, .958852946],
                                            [.65625, .96732803, .96732803],
                                            [.6875, .969954137, .969954137],
                                            [.71875, .966811177, .966811177],
                                            [.75, .958003065, .958003065],
                                            [.78125, .943660866, .943660866],
                                            [.8125, .923944917, .923944917],
                                            [.84375, .89904617, .89904617],
                                            [.875, .869186849, .869186849],
                                            [.90625, .834620542, .834620542],
                                            [.9375, .795631745, .795631745],
                                            [.96875, .752534934, .752534934],
                                            [1, .705673158, .705673158]
                                        ],
                                        green: [
                                            [0, .298717966, .298717966],
                                            [.03125, .353094838, .353094838],
                                            [.0625, .406535296, .406535296],
                                            [.09375, .458757618, .458757618],
                                            [.125, .50941904, .50941904],
                                            [.15625, .558148092, .558148092],
                                            [.1875, .604562568, .604562568],
                                            [.21875, .648280772, .648280772],
                                            [.25, .688929332, .688929332],
                                            [.28125, .726149107, .726149107],
                                            [.3125, .759599947, .759599947],
                                            [.34375, .788964712, .788964712],
                                            [.375, .813952739, .813952739],
                                            [.40625, .834302879, .834302879],
                                            [.4375, .849786142, .849786142],
                                            [.46875, .860207984, .860207984],
                                            [.5, .86541021, .86541021],
                                            [.53125, .848937047, .848937047],
                                            [.5625, .827384882, .827384882],
                                            [.59375, .800927443, .800927443],
                                            [.625, .769767752, .769767752],
                                            [.65625, .734132809, .734132809],
                                            [.6875, .694266682, .694266682],
                                            [.71875, .650421156, .650421156],
                                            [.75, .602842431, .602842431],
                                            [.78125, .551750968, .551750968],
                                            [.8125, .49730856, .49730856],
                                            [.84375, .439559467, .439559467],
                                            [.875, .378313092, .378313092],
                                            [.90625, .312874446, .312874446],
                                            [.9375, .24128379, .24128379],
                                            [.96875, .157246067, .157246067],
                                            [1, .01555616, .01555616]
                                        ],
                                        blue: [
                                            [0, .753683153, .753683153],
                                            [.03125, .801466763, .801466763],
                                            [.0625, .84495867, .84495867],
                                            [.09375, .883725899, .883725899],
                                            [.125, .917387822, .917387822],
                                            [.15625, .945619588, .945619588],
                                            [.1875, .968154911, .968154911],
                                            [.21875, .98478814, .98478814],
                                            [.25, .995375608, .995375608],
                                            [.28125, .999836203, .999836203],
                                            [.3125, .998151185, .998151185],
                                            [.34375, .990363227, .990363227],
                                            [.375, .976574709, .976574709],
                                            [.40625, .956945269, .956945269],
                                            [.4375, .931688648, .931688648],
                                            [.46875, .901068838, .901068838],
                                            [.5, .865395561, .865395561],
                                            [.53125, .820880546, .820880546],
                                            [.5625, .774508472, .774508472],
                                            [.59375, .726736146, .726736146],
                                            [.625, .678007945, .678007945],
                                            [.65625, .628751763, .628751763],
                                            [.6875, .579375448, .579375448],
                                            [.71875, .530263762, .530263762],
                                            [.75, .481775914, .481775914],
                                            [.78125, .434243684, .434243684],
                                            [.8125, .387970225, .387970225],
                                            [.84375, .343229596, .343229596],
                                            [.875, .300267182, .300267182],
                                            [.90625, .259301199, .259301199],
                                            [.9375, .220525627, .220525627],
                                            [.96875, .184115123, .184115123],
                                            [1, .150232812, .150232812]
                                        ]
                                    }
                                },
                                blues: {
                                    name: "Blues",
                                    numColors: 256,
                                    gamma: 1,
                                    segmentedData: {
                                        red: [
                                            [0, .9686274528503418, .9686274528503418],
                                            [.125, .8705882430076599, .8705882430076599],
                                            [.25, .7764706015586853, .7764706015586853],
                                            [.375, .6196078658103943, .6196078658103943],
                                            [.5, .41960784792900085, .41960784792900085],
                                            [.625, .25882354378700256, .25882354378700256],
                                            [.75, .12941177189350128, .12941177189350128],
                                            [.875, .0313725508749485, .0313725508749485],
                                            [1, .0313725508749485, .0313725508749485]
                                        ],
                                        green: [
                                            [0, .9843137264251709, .9843137264251709],
                                            [.125, .9215686321258545, .9215686321258545],
                                            [.25, .8588235378265381, .8588235378265381],
                                            [.375, .7921568751335144, .7921568751335144],
                                            [.5, .6823529601097107, .6823529601097107],
                                            [.625, .572549045085907, .572549045085907],
                                            [.75, .4431372582912445, .4431372582912445],
                                            [.875, .3176470696926117, .3176470696926117],
                                            [1, .1882352977991104, .1882352977991104]
                                        ],
                                        blue: [
                                            [0, 1, 1],
                                            [.125, .9686274528503418, .9686274528503418],
                                            [.25, .9372549057006836, .9372549057006836],
                                            [.375, .8823529481887817, .8823529481887817],
                                            [.5, .8392156958580017, .8392156958580017],
                                            [.625, .7764706015586853, .7764706015586853],
                                            [.75, .7098039388656616, .7098039388656616],
                                            [.875, .6117647290229797, .6117647290229797],
                                            [1, .41960784792900085, .41960784792900085]
                                        ]
                                    }
                                }
                            };

                        function F(e, t) {
                            var n, o = [],
                                r = t.length;
                            for (e.sort((function(e, t) {
                                    return e - t
                                })), n = 0; n < r; n++) o[n] = function(e, t) {
                                for (var n = 0, o = e.length - 1; n <= o;) {
                                    var r = n + Math.floor((o - n) / 2),
                                        a = e[r];
                                    if (a === t) return r;
                                    t < a ? o = r - 1 : n = r + 1
                                }
                                return n
                            }(e, t[n]);
                            return o
                        }

                        function H(e, t, n) {
                            var o = [],
                                r = [],
                                a = [],
                                i = [];
                            for (n = null === n ? 1 : n, c = 0; c < t.length; c++) {
                                var s = t[c];
                                o.push((e - 1) * s[0]), r.push(s[1]), a.push(s[1])
                            }
                            for (var l = function(e, t, n) {
                                    for (var o = (t - e) / ((n = null === n ? 100 : n) - 1), r = []; 0 < n--;) r.push(e), e += o;
                                    return r[r.length - 1] = t, r
                                }(0, 1, e), c = 0; c < e; c++) l[c] = (e - 1) * Math.pow(l[c], n);
                            var u = F(o, l);
                            for (c = 1; c < e - 1; c++) {
                                var d = u[c],
                                    h = (l[c] - o[d - 1]) / (o[d] - o[d - 1]);
                                i[c] = h * (r[d] - a[d - 1]) + a[d - 1]
                            }
                            return i[0] = a[0], i[e - 1] = r[t.length - 1], i
                        }

                        function q(e, t) {
                            var n = V[e];
                            return !(n = n || (V[e] = t || {
                                name: "",
                                colors: []
                            })).colors && n.segmentedData && (n.colors = function(e, t, n) {
                                for (var o = [], r = H(t = null === t ? 256 : t, e.red, n = null === n ? 1 : n), a = H(t, e.green, n), i = H(t, e.blue, n), s = 0; s < t; s++) {
                                    var l = Math.round(255 * r[s]),
                                        c = Math.round(255 * a[s]),
                                        u = Math.round(255 * i[s]);
                                    o.push([l, c, u, 255])
                                }
                                return o
                            }(n.segmentedData, n.numColors, n.gamma)), {
                                getId: function() {
                                    return e
                                },
                                getColorSchemeName: function() {
                                    return n.name
                                },
                                setColorSchemeName: function(e) {
                                    n.name = e
                                },
                                getNumberOfColors: function() {
                                    return n.colors.length
                                },
                                setNumberOfColors: function(e) {
                                    for (; n.colors.length < e;) n.colors.push(B);
                                    n.colors.length = e
                                },
                                getColor: function(e) {
                                    return this.isValidIndex(e) ? n.colors[e] : B
                                },
                                getColorRepeating: function(e) {
                                    var t = n.colors.length;
                                    return this.getColor(e = t ? e % t : 0)
                                },
                                setColor: function(e, t) {
                                    this.isValidIndex(e) && (n.colors[e] = t)
                                },
                                addColor: function(e) {
                                    n.colors.push(e)
                                },
                                insertColor: function(e, t) {
                                    this.isValidIndex(e) && n.colors.splice(e, 1, t)
                                },
                                removeColor: function(e) {
                                    this.isValidIndex(e) && n.colors.splice(e, 1)
                                },
                                clearColors: function() {
                                    n.colors = []
                                },
                                buildLookupTable: function(e) {
                                    if (e) {
                                        var t = n.colors.length;
                                        e.setNumberOfTableValues(t);
                                        for (var o = 0; o < t; o++) e.setTableValue(o, n.colors[o])
                                    }
                                },
                                createLookupTable: function() {
                                    var e = new U;
                                    return this.buildLookupTable(e), e
                                },
                                isValidIndex: function(e) {
                                    return 0 <= e && e < n.colors.length
                                }
                            }
                        }
                        var j = {
                            getColormap: q,
                            getColormapsList: function() {
                                var e = [];
                                return Object.keys(V).forEach((function(t) {
                                    var n;
                                    V.hasOwnProperty(t) && (n = V[t], e.push({
                                        id: t,
                                        name: n.name
                                    }))
                                })), e.sort((function(e, t) {
                                    return (e = e.name.toLowerCase()) === (t = t.name.toLowerCase()) ? 0 : e < t ? -1 : 1
                                })), e
                            },
                            LookupTable: U
                        };

                        function z(e, t) {
                            if (e.color && !e.falseColor) throw new Error("Color transforms are not implemented yet");
                            var n, o, r = e.minPixelValue,
                                a = 0,
                                i = 0,
                                s = e.width * e.height,
                                l = e.origPixelData || e.getPixelData(),
                                c = new Uint8Array(4 * s);
                            if (e.color = !0, e.falseColor = !0, e.origPixelData = l, t instanceof j.LookupTable)
                                for (t.build(); i < s;) n = l[i++], o = t.mapValue(n), c[a++] = o[0], c[a++] = o[1], c[a++] = o[2], c[a++] = o[3];
                            else if (r < 0)
                                for (; i < s;) n = l[i++], c[a++] = t[n + -r][0], c[a++] = t[n + -r][1], c[a++] = t[n + -r][2], c[a++] = t[n + -r][3];
                            else
                                for (; i < s;) n = l[i++], c[a++] = t[n][0], c[a++] = t[n][1], c[a++] = t[n][2], c[a++] = t[n][3];
                            e.rgba = !0, e.cachedLut = void 0, e.render = void 0, e.slope = 1, e.intercept = 0, e.minPixelValue = 0, e.maxPixelValue = 255, e.windowWidth = 255, e.windowCenter = 128, e.getPixelData = function() {
                                return c
                            }
                        }

                        function W(e) {
                            return !(!e.restore || "function" != typeof e.restore || (e.restore(), 0))
                        }

                        function G(e, t) {
                            if (e.color && !e.falseColor) throw new Error("Color transforms are not implemented yet");
                            var n, o, r, a, i, s, l, c, u, d, h, f = (t = f = (f = t) && "string" == typeof f ? q(f) : f).getId();
                            return e.colormapId !== f && (W(e), f && (o = e.minPixelValue || 0, n = e.maxPixelValue || 255, e.restore = (r = e).restore || (a = r.color, i = r.rgba, s = r.cachedLut, l = r.slope, c = r.windowWidth, u = r.windowCenter, d = r.minPixelValue, h = r.maxPixelValue, function() {
                                var e;
                                r.color = a, r.rgba = i, r.cachedLut = s, r.slope = l, r.windowWidth = c, r.windowCenter = u, r.minPixelValue = d, r.maxPixelValue = h, r.origPixelData && (e = r.origPixelData, r.getPixelData = function() {
                                    return e
                                }), r.origPixelData = void 0, r.colormapId = void 0, r.falseColor = void 0
                            }), (t = t.createLookupTable()).setTableRange(o, n), z(e, t), o = function(e) {
                                for (var t, n = Number.MAX_VALUE, o = Number.MIN_VALUE, r = e.length, a = 0; a < r; a++) n = n < (t = e[a]) ? n : t, o = t < o ? o : t;
                                return {
                                    minPixelValue: n,
                                    maxPixelValue: o
                                }
                            }(e.getPixelData()), e.minPixelValue = o.minPixelValue, e.maxPixelValue = o.maxPixelValue, e.windowWidth = 255, e.windowCenter = 128, e.colormapId = f), !0)
                        }

                        function Y(e, t) {
                            return G(l(e).image, t)
                        }

                        function Z(e, t) {
                            return !1 === (e = l(e)).data.hasOwnProperty(t) && (e.data[t] = {}), e.data[t]
                        }

                        function K(e, t) {
                            delete l(e).data[t]
                        }
                        var X = 1073741824,
                            J = 0,
                            Q = {},
                            $ = [];

                        function ee() {
                            if (!(J <= X)) {
                                for ($.sort((function(e, t) {
                                        return e.timeStamp > t.timeStamp ? -1 : e.timeStamp < t.timeStamp ? 1 : 0
                                    })); X < J;) {
                                    var e = $[$.length - 1].imageId;
                                    oe(e), I(i, a.IMAGE_CACHE_PROMISE_REMOVED, {
                                        imageId: e
                                    })
                                }
                                var t = re();
                                I(i, a.IMAGE_CACHE_FULL, t)
                            }
                        }

                        function te(e, t) {
                            if (void 0 === e) throw new Error("putImageLoadObject: imageId must not be undefined");
                            if (void 0 === t.promise) throw new Error("putImageLoadObject: imageLoadObject.promise must not be undefined");
                            if (!0 === Q.hasOwnProperty(e)) throw new Error("putImageLoadObject: imageId already in cache");
                            if (t.cancelFn && "function" != typeof t.cancelFn) throw new Error("putImageLoadObject: imageLoadObject.cancelFn must be a function");
                            var n = {
                                loaded: !1,
                                imageId: e,
                                sharedCacheKey: void 0,
                                imageLoadObject: t,
                                timeStamp: Date.now(),
                                sizeInBytes: 0
                            };
                            Q[e] = n, $.push(n), t.promise.then((function(e) {
                                if (-1 !== $.indexOf(n)) {
                                    if (n.loaded = !0, void 0 === (n.image = e).sizeInBytes) throw new Error("putImageLoadObject: image.sizeInBytes must not be undefined");
                                    if (void 0 === e.sizeInBytes.toFixed) throw new Error("putImageLoadObject: image.sizeInBytes is not a number");
                                    n.sizeInBytes = e.sizeInBytes, J += n.sizeInBytes;
                                    var t = {
                                        action: "addImage",
                                        image: n
                                    };
                                    I(i, a.IMAGE_CACHE_CHANGED, t), n.sharedCacheKey = e.sharedCacheKey, ee()
                                }
                            }), (function() {
                                var t = Q[e];
                                $.splice($.indexOf(t), 1), delete Q[e]
                            }))
                        }

                        function ne(e) {
                            if (void 0 === e) throw new Error("getImageLoadObject: imageId must not be undefined");
                            if (void 0 !== (e = Q[e])) return e.timeStamp = Date.now(), e.imageLoadObject
                        }

                        function oe(e) {
                            if (void 0 === e) throw new Error("removeImageLoadObject: imageId must not be undefined");
                            var t, n = Q[e];
                            if (void 0 === n) throw new Error("removeImageLoadObject: imageId was not present in imageCache");
                            $.splice($.indexOf(n), 1), J -= n.sizeInBytes, I(i, a.IMAGE_CACHE_CHANGED, {
                                action: "deleteImage",
                                image: n
                            }), (t = n.imageLoadObject).promise.then((function() {
                                t.decache && t.decache()
                            }), (function() {
                                t.decache && t.decache()
                            })), delete Q[e]
                        }

                        function re() {
                            return {
                                maximumSizeInBytes: X,
                                cacheSizeInBytes: J,
                                numberOfImagesCached: $.length
                            }
                        }
                        var ae, ie = {
                                imageCache: Q,
                                cachedImages: $,
                                setMaximumSizeBytes: function(e) {
                                    if (void 0 === e) throw new Error("setMaximumSizeBytes: parameter numBytes must not be undefined");
                                    if (void 0 === e.toFixed) throw new Error("setMaximumSizeBytes: parameter numBytes must be a number");
                                    X = e, I(i, a.IMAGE_CACHE_MAXIMUM_SIZE_CHANGED), ee()
                                },
                                putImageLoadObject: te,
                                getImageLoadObject: ne,
                                removeImageLoadObject: oe,
                                getCacheInfo: re,
                                purgeCache: function() {
                                    for (; 0 < $.length;) oe($[0].imageId)
                                },
                                changeImageIdCacheSize: function(e, t) {
                                    var n = Q[e];
                                    n && n.imageLoadObject.promise.then((function(e) {
                                        var o = t - e.sizeInBytes;
                                        e.sizeInBytes = t, n.sizeInBytes = t, J += o, o = {
                                            action: "changeImageSize",
                                            image: e
                                        }, I(i, a.IMAGE_CACHE_CHANGED, o)
                                    }))
                                }
                            },
                            se = {};

                        function le(e, t) {
                            var n = e.indexOf(":");
                            if (n = e.substring(0, n), null == (n = se[n])) {
                                if (void 0 !== ae) return ae(e);
                                throw new Error("loadImageFromImageLoader: no image loader for imageId")
                            }
                            return (n = n(e, t)).promise.then((function(e) {
                                I(i, a.IMAGE_LOADED, {
                                    image: e
                                })
                            }), (function(t) {
                                I(i, a.IMAGE_LOAD_FAILED, {
                                    imageId: e,
                                    error: t
                                })
                            })), n
                        }

                        function ce(e, t) {
                            if (void 0 === e) throw new Error("loadImage: parameter imageId must not be undefined");
                            var n = ne(e);
                            return (void 0 !== n ? n : le(e, t)).promise
                        }

                        function ue(e, t) {
                            if (void 0 === e) throw new Error("loadAndCacheImage: parameter imageId must not be undefined");
                            var n = ne(e);
                            return void 0 === n && te(e, n = le(e, t)), n.promise
                        }

                        function de(e, t) {
                            se[e] = t
                        }

                        function he(e) {
                            var t = ae;
                            return ae = e, t
                        }

                        function fe(e) {
                            return (fe = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                                return typeof e
                            } : function(e) {
                                return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
                            })(e)
                        }

                        function me(e, t) {
                            var n, o, r, a, i = "undefined" != typeof Symbol && e[Symbol.iterator] || e["@@iterator"];
                            if (i) return o = !(n = !0), {
                                s: function() {
                                    i = i.call(e)
                                },
                                n: function() {
                                    var e = i.next();
                                    return n = e.done, e
                                },
                                e: function(e) {
                                    o = !0, r = e
                                },
                                f: function() {
                                    try {
                                        n || null == i.return || i.return()
                                    } finally {
                                        if (o) throw r
                                    }
                                }
                            };
                            if (Array.isArray(e) || (i = function(e, t) {
                                    var n;
                                    if (e) return "string" == typeof e ? ge(e, t) : "Map" === (n = "Object" === (n = Object.prototype.toString.call(e).slice(8, -1)) && e.constructor ? e.constructor.name : n) || "Set" === n ? Array.from(e) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? ge(e, t) : void 0
                                }(e)) || t && e && "number" == typeof e.length) return i && (e = i), a = 0, {
                                s: t = function() {},
                                n: function() {
                                    return a >= e.length ? {
                                        done: !0
                                    } : {
                                        done: !1,
                                        value: e[a++]
                                    }
                                },
                                e: function(e) {
                                    throw e
                                },
                                f: t
                            };
                            throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                        }

                        function ge(e, t) {
                            (null == t || t > e.length) && (t = e.length);
                            for (var n = 0, o = new Array(t); n < t; n++) o[n] = e[n];
                            return o
                        }

                        function pe(e, t) {
                            for (var n = 0; n < t.length; n++) {
                                var o = t[n];
                                o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, ye(o.key), o)
                            }
                        }

                        function ve(e, t, n) {
                            (t = ye(t)) in e ? Object.defineProperty(e, t, {
                                value: n,
                                enumerable: !0,
                                configurable: !0,
                                writable: !0
                            }) : e[t] = n
                        }

                        function ye(e) {
                            return e = function(e, t) {
                                if ("object" != fe(e) || !e) return e;
                                var n = e[Symbol.toPrimitive];
                                if (void 0 === n) return ("string" === t ? String : Number)(e);
                                if ("object" != fe(n = n.call(e, t || "default"))) return n;
                                throw new TypeError("@@toPrimitive must return a primitive value.")
                            }(e, "string"), "symbol" == fe(e) ? e : String(e)
                        }
                        var be = function() {
                                function e() {
                                    if (!(this instanceof e)) throw new TypeError("Cannot call a class as a function");
                                    ve(this, "requestPool", void 0), ve(this, "awake", void 0), ve(this, "numRequests", void 0), ve(this, "maxNumRequests", void 0), ve(this, "grabDelay", void 0), ve(this, "timeoutHandle", void 0), this.requestPool = {
                                        interaction: {
                                            0: []
                                        },
                                        thumbnail: {
                                            0: []
                                        },
                                        prefetch: {
                                            0: []
                                        }
                                    }, this.awake = !1, this.grabDelay = 5, this.numRequests = {
                                        interaction: 0,
                                        thumbnail: 0,
                                        prefetch: 0
                                    }, this.maxNumRequests = {
                                        interaction: 6,
                                        thumbnail: 6,
                                        prefetch: 5
                                    }
                                }
                                var t, n, o;
                                return t = e, (n = [{
                                    key: "destroy",
                                    value: function() {
                                        this.timeoutHandle && window.clearTimeout(this.timeoutHandle)
                                    }
                                }, {
                                    key: "addRequest",
                                    value: function(e, t, n) {
                                        var o = 3 < arguments.length && void 0 !== arguments[3] ? arguments[3] : 0,
                                            r = 4 < arguments.length && void 0 !== arguments[4] && arguments[4];
                                        e = {
                                            requestFn: e,
                                            type: t,
                                            additionalDetails: n
                                        }, void 0 === this.requestPool[t][o] && (this.requestPool[t][o] = []), r ? this.requestPool[t][o].unshift(e) : this.requestPool[t][o].push(e), this.awake || (this.awake = !0, this.startGrabbing())
                                    }
                                }, {
                                    key: "filterRequests",
                                    value: function(e) {
                                        var t = this;
                                        Object.keys(this.requestPool).forEach((function(n) {
                                            var o = t.requestPool[n];
                                            Object.keys(o).forEach((function(t) {
                                                o[t] = o[t].filter((function(t) {
                                                    return e(t)
                                                }))
                                            }))
                                        }))
                                    }
                                }, {
                                    key: "clearRequestStack",
                                    value: function(e) {
                                        if (!this.requestPool[e]) throw new Error("No category for the type ".concat(e, " found"));
                                        this.requestPool[e] = {
                                            0: []
                                        }
                                    }
                                }, {
                                    key: "sendRequest",
                                    value: function(e) {
                                        var t = this,
                                            n = e.requestFn,
                                            o = e.type;
                                        this.numRequests[o]++, this.awake = !0, n().finally((function() {
                                            t.numRequests[o]--, t.startAgain()
                                        }))
                                    }
                                }, {
                                    key: "startGrabbing",
                                    value: function() {
                                        for (var e = this.maxNumRequests.interaction + this.maxNumRequests.thumbnail + this.maxNumRequests.prefetch - (this.numRequests.interaction + this.numRequests.thumbnail + this.numRequests.prefetch), t = 0; t < e; t++) {
                                            var n = this.getNextRequest();
                                            if (!1 === n) break;
                                            n && this.sendRequest(n)
                                        }
                                    }
                                }, {
                                    key: "startAgain",
                                    value: function() {
                                        var e = this;
                                        this.awake && (this.grabDelay ? this.timeoutHandle = window.setTimeout((function() {
                                            e.startGrabbing()
                                        }), this.grabDelay) : this.startGrabbing())
                                    }
                                }, {
                                    key: "getSortedPriorityGroups",
                                    value: function(e) {
                                        var t = this;
                                        return Object.keys(this.requestPool[e]).map(Number).filter((function(n) {
                                            return t.requestPool[e][n].length
                                        })).sort()
                                    }
                                }, {
                                    key: "getNextRequest",
                                    value: function() {
                                        var e, t = this.getSortedPriorityGroups("interaction"),
                                            n = me(t);
                                        try {
                                            for (n.s(); !(e = n.n()).done;) {
                                                var o = e.value;
                                                if (this.requestPool.interaction[o].length && this.numRequests.interaction < this.maxNumRequests.interaction) return this.requestPool.interaction[o].shift()
                                            }
                                        } catch (e) {
                                            n.e(e)
                                        } finally {
                                            n.f()
                                        }
                                        var r, a = this.getSortedPriorityGroups("thumbnail"),
                                            i = me(a);
                                        try {
                                            for (i.s(); !(r = i.n()).done;) {
                                                var s = r.value;
                                                if (this.requestPool.thumbnail[s].length && this.numRequests.thumbnail < this.maxNumRequests.thumbnail) return this.requestPool.thumbnail[s].shift()
                                            }
                                        } catch (e) {
                                            i.e(e)
                                        } finally {
                                            i.f()
                                        }
                                        var l, c = this.getSortedPriorityGroups("prefetch"),
                                            u = me(c);
                                        try {
                                            for (u.s(); !(l = u.n()).done;) {
                                                var d = l.value;
                                                if (this.requestPool.prefetch[d].length && this.numRequests.prefetch < this.maxNumRequests.prefetch) return this.requestPool.prefetch[d].shift()
                                            }
                                        } catch (e) {
                                            u.e(e)
                                        } finally {
                                            u.f()
                                        }
                                        return t.length || a.length || c.length || (this.awake = !1), !1
                                    }
                                }, {
                                    key: "getRequestPool",
                                    value: function() {
                                        return this.requestPool
                                    }
                                }]) && pe(t.prototype, n), o && pe(t, o), Object.defineProperty(t, "prototype", {
                                    writable: !1
                                }), e
                            }(),
                            we = ((n = new be).maxNumRequests = {
                                interaction: 1e3,
                                thumbnail: 1e3,
                                prefetch: 1e3
                            }, n.grabDelay = 0, n),
                            xe = ((n = new be).maxNumRequests = {
                                interaction: 20,
                                thumbnail: 20,
                                prefetch: 20
                            }, n.grabDelay = 0, n);

                        function Te(e) {
                            return (Te = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                                return typeof e
                            } : function(e) {
                                return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
                            })(e)
                        }

                        function Ie(e, t) {
                            for (var n = 0; n < t.length; n++) {
                                var o = t[n];
                                o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, function(e) {
                                    return e = function(e, t) {
                                        if ("object" != Te(e) || !e) return e;
                                        var n = e[Symbol.toPrimitive];
                                        if (void 0 === n) return ("string" === t ? String : Number)(e);
                                        if ("object" != Te(n = n.call(e, t || "default"))) return n;
                                        throw new TypeError("@@toPrimitive must return a primitive value.")
                                    }(e, "string"), "symbol" == Te(e) ? e : String(e)
                                }(o.key), o)
                            }
                        }

                        function Ee(e) {
                            return Ae(e)
                        }
                        var Se = function() {
                                function e() {
                                    if (!(this instanceof e)) throw new TypeError("Cannot call a class as a function");
                                    this.reset()
                                }
                                var t, n, o;
                                return t = e, (n = [{
                                    key: "reset",
                                    value: function() {
                                        this.m = [1, 0, 0, 1, 0, 0]
                                    }
                                }, {
                                    key: "clone",
                                    value: function() {
                                        var t = new e;
                                        return t.m[0] = this.m[0], t.m[1] = this.m[1], t.m[2] = this.m[2], t.m[3] = this.m[3], t.m[4] = this.m[4], t.m[5] = this.m[5], t
                                    }
                                }, {
                                    key: "multiply",
                                    value: function(e) {
                                        var t = this.m[0] * e.m[0] + this.m[2] * e.m[1],
                                            n = this.m[1] * e.m[0] + this.m[3] * e.m[1],
                                            o = this.m[0] * e.m[2] + this.m[2] * e.m[3],
                                            r = this.m[1] * e.m[2] + this.m[3] * e.m[3],
                                            a = this.m[0] * e.m[4] + this.m[2] * e.m[5] + this.m[4];
                                        e = this.m[1] * e.m[4] + this.m[3] * e.m[5] + this.m[5], this.m[0] = t, this.m[1] = n, this.m[2] = o, this.m[3] = r, this.m[4] = a, this.m[5] = e
                                    }
                                }, {
                                    key: "invert",
                                    value: function() {
                                        var e = 1 / (this.m[0] * this.m[3] - this.m[1] * this.m[2]),
                                            t = this.m[3] * e,
                                            n = -this.m[1] * e,
                                            o = -this.m[2] * e,
                                            r = this.m[0] * e,
                                            a = e * (this.m[2] * this.m[5] - this.m[3] * this.m[4]);
                                        e *= this.m[1] * this.m[4] - this.m[0] * this.m[5], this.m[0] = t, this.m[1] = n, this.m[2] = o, this.m[3] = r, this.m[4] = a, this.m[5] = e
                                    }
                                }, {
                                    key: "rotate",
                                    value: function(e) {
                                        var t = Math.cos(e),
                                            n = (e = Math.sin(e), this.m[0] * t + this.m[2] * e),
                                            o = this.m[1] * t + this.m[3] * e,
                                            r = this.m[0] * -e + this.m[2] * t;
                                        e = this.m[1] * -e + this.m[3] * t, this.m[0] = n, this.m[1] = o, this.m[2] = r, this.m[3] = e
                                    }
                                }, {
                                    key: "translate",
                                    value: function(e, t) {
                                        this.m[4] += this.m[0] * e + this.m[2] * t, this.m[5] += this.m[1] * e + this.m[3] * t
                                    }
                                }, {
                                    key: "scale",
                                    value: function(e, t) {
                                        this.m[0] *= e, this.m[1] *= e, this.m[2] *= t, this.m[3] *= t
                                    }
                                }, {
                                    key: "transformPoint",
                                    value: function(e, t) {
                                        var n = e,
                                            o = t;
                                        return {
                                            x: e = n * this.m[0] + o * this.m[2] + this.m[4],
                                            y: t = n * this.m[1] + o * this.m[3] + this.m[5]
                                        }
                                    }
                                }]) && Ie(t.prototype, n), o && Ie(t, o), Object.defineProperty(t, "prototype", {
                                    writable: !1
                                }), e
                            }(),
                            Ae = function(e, t) {
                                var n, o, r = new Se,
                                    a = (r.translate(e.canvas.width / 2, e.canvas.height / 2), e.viewport.rotation),
                                    i = (0 !== a && r.rotate(a * Math.PI / 180), e.viewport.scale),
                                    s = e.viewport.scale,
                                    l = w(e.image, e.viewport),
                                    c = l.tlhc.x - 1,
                                    u = l.tlhc.y - 1,
                                    d = l.brhc.x - c,
                                    h = l.brhc.y - u;
                                return "NONE" === l.presentationSizeMode ? e.image.rowPixelSpacing < e.image.columnPixelSpacing ? i *= e.image.columnPixelSpacing / e.image.rowPixelSpacing : e.image.columnPixelSpacing < e.image.rowPixelSpacing && (s *= e.image.rowPixelSpacing / e.image.columnPixelSpacing) : (i = l.columnPixelSpacing, s = l.rowPixelSpacing, "SCALE TO FIT" === l.presentationSizeMode && (n = e.canvas.height / (h * s), o = e.canvas.width / (d * i), i = s = Math.min(o, n), l.rowPixelSpacing < l.columnPixelSpacing ? i *= l.columnPixelSpacing / l.rowPixelSpacing : l.columnPixelSpacing < l.rowPixelSpacing && (s *= l.rowPixelSpacing / l.columnPixelSpacing))), r.scale(i, s), 0 !== a && r.rotate(-a * Math.PI / 180), r.translate(e.viewport.translation.x, e.viewport.translation.y), 0 !== a && r.rotate(a * Math.PI / 180), void 0 !== t && r.scale(t, t), e.viewport.hflip && r.scale(-1, 1), e.viewport.vflip && r.scale(1, -1), r.translate(-d / 2, -h / 2), r.translate(-c, -u), r
                            },
                            Ce = function(e, t) {
                                return (e = Ee(e = l(e))).invert(), e.transformPoint(t.x, t.y)
                            },
                            Me = function(e) {
                                if (void 0 === e) throw new Error("disable: element must not be undefined");
                                for (var t = s, n = 0; n < t.length; n++)
                                    if (t[n].element === e) {
                                        var o = {
                                            element: e
                                        };
                                        I(e, a.ELEMENT_DISABLED, o), I(i, a.ELEMENT_DISABLED, o), t[n].element.removeChild(t[n].canvas), t[n].canvas = void 0, t.splice(n, 1);
                                        break
                                    }
                            },
                            De = function() {
                                return (window.performance ? performance : Date).now()
                            },
                            Pe = function(e, t, n) {
                                if (void 0 === e) throw new Error("displayImage: parameter element must not be undefined");
                                if (void 0 === t) throw new Error("displayImage: parameter image must not be undefined");
                                var o, r = l(e),
                                    i = r.image;
                                if (r.image = t, r.layers && r.layers.length && _(e, t), void 0 === r.viewport && (r.viewport = b(r.canvas, t)), n)
                                    for (var s in n) null !== n[s] && (r.viewport[s] = n[s]);
                                void 0 !== r.lastImageTimeStamp && (o = (1e3 / (De() - r.lastImageTimeStamp)).toFixed()), r.lastImageTimeStamp = De(), t = {
                                    viewport: r.viewport,
                                    element: r.element,
                                    image: r.image,
                                    oldImage: i,
                                    enabledElement: r,
                                    frameRate: o
                                }, I(r.element, a.NEW_IMAGE, t), T(e)
                            },
                            ke = function(e) {
                                e = l(e), x(e)
                            },
                            _e = function() {
                                for (var e = s, t = 0; t < e.length; t++) {
                                    var n = e[t];
                                    !0 === n.invalid && x(n, !0)
                                }
                            },
                            Le = function(e) {
                                var t = l(e),
                                    n = t.image;
                                t.viewport.scale = v(t.canvas, n, t.viewport.rotation).scaleFactor, t.viewport.translation.x = 0, t.viewport.translation.y = 0, T(e)
                            },
                            Oe = function(e, t) {
                                var n, o, r, i, s, c = l(e),
                                    u = c.canvas.width,
                                    d = c.canvas.height;
                                o = e, (n = c.canvas).width !== o.clientWidth && (n.width = o.clientWidth, n.style.width = "".concat(o.clientWidth, "px")), n.height !== o.clientHeight && (n.height = o.clientHeight, n.style.height = "".concat(o.clientHeight, "px")), I(e, a.ELEMENT_RESIZED, {
                                    element: e
                                }), void 0 !== c.image && (t || (n = u, o = d, r = (t = c).viewport.scale, i = y(t.image, t.viewport.rotation), s = Math.round(i.width * r), i = Math.round(i.height * r), r = t.viewport.translation.x, t = t.viewport.translation.y, s === n && i <= o) || s <= n && i === o && 0 === r && 0 === t ? Le : (n = (s = c).viewport.scale, i = s.canvas.width, o = s.canvas.height, i = Math.sqrt(i / u * (o / d)), s.viewport.scale = i * n, T))(e)
                            },
                            Re = function(e) {
                                var t = (e.viewport || {}).invert;
                                return e = (e.options || {}).fillStyle, -1 !== ["black", "white"].indexOf(e) && t ? "white" : "black"
                            },
                            Ne = function(e, t, n) {
                                var o = De(),
                                    r = e.getPixelData(),
                                    a = (e.stats.lastGetPixelDataTime = De() - o, r.length),
                                    i = e.minPixelValue,
                                    s = 3,
                                    l = 0;
                                if (o = De(), r instanceof Int16Array)
                                    if (i < 0)
                                        for (; l < a;) n[s] = t[r[l++] + -i], s += 4;
                                    else
                                        for (; l < a;) n[s] = t[r[l++]], s += 4;
                                else if (r instanceof Uint16Array)
                                    for (; l < a;) n[s] = t[r[l++]], s += 4;
                                else if (i < 0)
                                    for (; l < a;) n[s] = t[r[l++] + -i], s += 4;
                                else
                                    for (; l < a;) n[s] = t[r[l++]], s += 4;
                                e.stats.lastStoredPixelDataToCanvasImageDataTime = De() - o
                            },
                            Ue = function(e, t, n) {
                                var o, r = De(),
                                    a = e.getPixelData(),
                                    i = (e.stats.lastGetPixelDataTime = De() - r, a.length),
                                    s = e.minPixelValue,
                                    l = 0,
                                    c = 0;
                                if (r = De(), a instanceof Int16Array)
                                    if (s < 0)
                                        for (; c < i;) o = t[a[c++] + -s], n[l++] = o, n[l++] = o, n[l++] = o, n[l++] = 255;
                                    else
                                        for (; c < i;) o = t[a[c++]], n[l++] = o, n[l++] = o, n[l++] = o, n[l++] = 255;
                                else if (a instanceof Uint16Array)
                                    for (; c < i;) o = t[a[c++]], n[l++] = o, n[l++] = o, n[l++] = o, n[l++] = 255;
                                else if (s < 0)
                                    for (; c < i;) o = t[a[c++] + -s], n[l++] = o, n[l++] = o, n[l++] = o, n[l++] = 255;
                                else
                                    for (; c < i;) o = t[a[c++]], n[l++] = o, n[l++] = o, n[l++] = o, n[l++] = 255;
                                e.stats.lastStoredPixelDataToCanvasImageDataTime = De() - r
                            },
                            Be = function(e, t, n) {
                                if (void 0 === e) throw new Error("setToPixelCoordinateSystem: parameter enabledElement must not be undefined");
                                if (void 0 === t) throw new Error("setToPixelCoordinateSystem: parameter context must not be undefined");
                                e = Ae(e, n), t.setTransform(e.m[0], e.m[1], e.m[2], e.m[3], e.m[4], e.m[5])
                            },
                            Ve = {
                                storedPixelDataToImageData: function(e) {
                                    for (var t = e.getPixelData(), n = new Uint8Array(e.width * e.height * 3), o = 0, r = 0; r < t.length; r++) {
                                        var a = Math.abs(t[r]);
                                        n[o++] = 255 & a, n[o++] = a >> 8, n[o++] = t[r] < 0 ? 0 : 1
                                    }
                                    return n
                                }
                            },
                            Fe = ((n = {}).frag = "precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0 + color.g*65536.0;if (color.b == 0.0)intensity = -intensity;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}", {}),
                            He = {
                                storedPixelDataToImageData: function(e) {
                                    for (var t = e.getPixelData(), n = new Uint8Array(e.width * e.height * 2), o = 0, r = 0; r < t.length; r++) n[o++] = t[r], n[o++] = t[r] < 0 ? 0 : 1;
                                    return n
                                }
                            },
                            qe = (Fe.frag = "precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.;if (color.a == 0.0)intensity = -intensity;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}", {}),
                            je = {
                                storedPixelDataToImageData: function(e) {
                                    var t = e.minPixelValue,
                                        n = 0,
                                        o = 0,
                                        r = e.width * e.height * 4,
                                        a = e.width * e.height * 3,
                                        i = e.getPixelData(),
                                        s = new Uint8Array(a);
                                    if (t < 0)
                                        for (; o < r;) s[n++] = i[o++] + -t, s[n++] = i[o++] + -t, s[n++] = i[o++] + -t, o += 1;
                                    else
                                        for (; o < r;) s[n++] = i[o++], s[n++] = i[o++], s[n++] = i[o++], o += 1;
                                    return s
                                }
                            },
                            ze = (qe.frag = "precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform float minPixelValue;uniform int invert;varying vec2 v_texCoord;void main() {vec3 color = texture2D(u_image, v_texCoord).xyz;color = color * 256.0 * slope + intercept;float center0 = wc - 0.5 - minPixelValue;float width0 = max(ww, 1.0);color = (color - center0) / width0 + 0.5;gl_FragColor = vec4(color, 1);if (invert == 1)gl_FragColor.rgb = 1. - gl_FragColor.rgb;}", {}),
                            We = {
                                storedPixelDataToImageData: function(e) {
                                    for (var t = e.getPixelData(), n = new Uint8Array(e.width * e.height * 2), o = 0, r = 0; r < t.length; r++) {
                                        var a = t[r];
                                        n[o++] = 255 & a, n[o++] = a >> 8
                                    }
                                    return n
                                }
                            },
                            Ge = (ze.frag = "precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0 + color.a*65536.0;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}", {}),
                            Ye = {
                                storedPixelDataToImageData: function(e) {
                                    return e.getPixelData()
                                }
                            },
                            Ze = (Ge.frag = "precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}", {
                                int16: n,
                                int8: Fe,
                                rgb: qe,
                                uint16: ze,
                                uint8: Ge
                            }),
                            Ke = {
                                int16: Ve,
                                int8: He,
                                rgb: je,
                                uint16: We,
                                uint8: Ye
                            },
                            Xe = "attribute vec2 a_position;attribute vec2 a_texCoord;uniform vec2 u_resolution;varying vec2 v_texCoord;void main() {vec2 zeroToOne = a_position / u_resolution;vec2 zeroToTwo = zeroToOne * 2.0;vec2 clipSpace = zeroToTwo - 1.0;gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);v_texCoord = a_texCoord;}",
                            Je = {},
                            Qe = [],
                            $e = 268435456,
                            et = 0;

                        function tt() {
                            if (!(et <= $e)) {
                                for (Qe.sort((function(e, t) {
                                        return e.timeStamp > t.timeStamp ? -1 : e.timeStamp < t.timeStamp ? 1 : 0
                                    })); $e < et;) {
                                    var e = Qe[Qe.length - 1];
                                    et -= e.sizeInBytes, delete Je[e.imageId], Qe.pop(), I(i, a.WEBGL_TEXTURE_REMOVED, {
                                        imageId: e.imageId
                                    })
                                }
                                var t = {
                                    maximumSizeInBytes: $e,
                                    cacheSizeInBytes: et,
                                    numberOfImagesCached: Qe.length
                                };
                                I(i, a.WEBGL_TEXTURE_CACHE_FULL, t)
                            }
                        }
                        var nt = {
                            purgeCache: function() {
                                for (; 0 < Qe.length;) {
                                    var e = Qe.pop();
                                    delete Je[e.imageId]
                                }
                                et = 0
                            },
                            getImageTexture: function(e) {
                                if (void 0 === e) throw new Error("getImageTexture: imageId must not be undefined");
                                if (void 0 !== (e = Je[e])) return e.timeStamp = new Date, e.imageTexture
                            },
                            putImageTexture: function(e, t) {
                                var n = e.imageId;
                                if (void 0 === e) throw new Error("putImageTexture: image must not be undefined");
                                if (void 0 === n) throw new Error("putImageTexture: imageId must not be undefined");
                                if (void 0 === t) throw new Error("putImageTexture: imageTexture must not be undefined");
                                if (!0 === Object.prototype.hasOwnProperty.call(Je, n)) throw new Error("putImageTexture: imageId already in cache");
                                if (e = {
                                        imageId: n,
                                        imageTexture: t,
                                        timeStamp: new Date,
                                        sizeInBytes: t.sizeInBytes
                                    }, Je[n] = e, Qe.push(e), void 0 === t.sizeInBytes) throw new Error("putImageTexture: imageTexture.sizeInBytes must not be undefined");
                                if (void 0 === t.sizeInBytes.toFixed) throw new Error("putImageTexture: imageTexture.sizeInBytes is not a number");
                                et += e.sizeInBytes, tt()
                            },
                            removeImageTexture: function(e) {
                                if (void 0 === e) throw new Error("removeImageTexture: imageId must not be undefined");
                                var t = Je[e];
                                if (void 0 === t) throw new Error("removeImageTexture: imageId must not be undefined");
                                return Qe.splice(Qe.indexOf(t), 1), et -= t.sizeInBytes, delete Je[e], t.imageTexture
                            },
                            setMaximumSizeBytes: function(e) {
                                if (void 0 === e) throw new Error("setMaximumSizeBytes: parameter numBytes must not be undefined");
                                if (void 0 === e.toFixed) throw new Error("setMaximumSizeBytes: parameter numBytes must be a number");
                                $e = e, tt()
                            }
                        };

                        function ot(e, t, n) {
                            return n = e.createShader(n), e.shaderSource(n, t), e.compileShader(n), e.getShaderParameter(n, e.COMPILE_STATUS) || e.isContextLost() || (t = e.getShaderInfoLog(n), console.error("Could not compile shader:\n".concat(t))), n
                        }
                        var rt, at, it, st = function(e, t, n) {
                                var o;
                                return t = ot(e, t, e.VERTEX_SHADER), n = ot(e, n, e.FRAGMENT_SHADER), o = e.createProgram(), e.attachShader(o, t), e.attachShader(o, n), e.linkProgram(o), e.getProgramParameter(o, e.LINK_STATUS) || e.isContextLost() || (t = e.getProgramInfoLog(o), console.error("WebGL program filed to link:\n".concat(t))), o
                            },
                            lt = document.createElement("canvas"),
                            ct = !1;

                        function ut() {
                            if (!0 !== ct && function(e) {
                                    rt = null;
                                    try {
                                        var t = {
                                            desynchronized: !0,
                                            preserveDrawingBuffer: !0
                                        };
                                        rt = e.getContext("webgl", t) || e.getContext("experimental-webgl", t), e.removeEventListener("webglcontextlost", dt, !1), e.addEventListener("webglcontextlost", dt, !1), e.removeEventListener("webglcontextrestored", ht, !1), e.addEventListener("webglcontextrestored", ht, !1)
                                    } catch (e) {
                                        throw new Error("Error creating WebGL context")
                                    }
                                    return rt || (console.error("Unable to initialize WebGL. Your browser may not support it."), rt = null), rt
                                }(lt)) {
                                for (var e in it = rt.createBuffer(), rt.bindBuffer(rt.ARRAY_BUFFER, it), rt.bufferData(rt.ARRAY_BUFFER, new Float32Array([1, 1, 0, 1, 1, 0, 0, 0]), rt.STATIC_DRAW), at = rt.createBuffer(), rt.bindBuffer(rt.ARRAY_BUFFER, at), rt.bufferData(rt.ARRAY_BUFFER, new Float32Array([1, 1, 0, 1, 1, 0, 0, 0]), rt.STATIC_DRAW), Ze)(e = Ze[e]).attributes = {}, e.uniforms = {}, e.vert = Xe, e.program = st(rt, e.vert, e.frag), e.attributes.texCoordLocation = rt.getAttribLocation(e.program, "a_texCoord"), rt.enableVertexAttribArray(e.attributes.texCoordLocation), e.attributes.positionLocation = rt.getAttribLocation(e.program, "a_position"), rt.enableVertexAttribArray(e.attributes.positionLocation), e.uniforms.resolutionLocation = rt.getUniformLocation(e.program, "u_resolution");
                                ct = !0
                            }
                        }

                        function dt(e) {
                            e.preventDefault(), console.warn("WebGL Context Lost!")
                        }

                        function ht(e) {
                            e.preventDefault(), ct = !1, nt.purgeCache(), ut()
                        }

                        function ft(e) {
                            return e.color ? "rgb" : (e = e.getPixelData()) instanceof Int16Array ? "int16" : e instanceof Uint16Array ? "uint16" : e instanceof Int8Array ? "int8" : "uint8"
                        }

                        function mt(e) {
                            var t, n, o, r, a, i = nt.getImageTexture(e.imageId);
                            return i || (t = e, n = (n = {
                                uint8: rt.LUMINANCE,
                                int8: rt.LUMINANCE_ALPHA,
                                uint16: rt.LUMINANCE_ALPHA,
                                int16: rt.RGB,
                                rgb: rt.RGB
                            })[o = ft(t)], r = rt.createTexture(), rt.bindTexture(rt.TEXTURE_2D, r), rt.texParameteri(rt.TEXTURE_2D, rt.TEXTURE_MIN_FILTER, rt.NEAREST), rt.texParameteri(rt.TEXTURE_2D, rt.TEXTURE_MAG_FILTER, rt.NEAREST), rt.texParameteri(rt.TEXTURE_2D, rt.TEXTURE_WRAP_S, rt.CLAMP_TO_EDGE), rt.texParameteri(rt.TEXTURE_2D, rt.TEXTURE_WRAP_T, rt.CLAMP_TO_EDGE), rt.pixelStorei(rt.UNPACK_ALIGNMENT, 1), a = Ke[o].storedPixelDataToImageData(t, t.width, t.height), rt.texImage2D(rt.TEXTURE_2D, 0, n, t.width, t.height, 0, n, rt.UNSIGNED_BYTE, a), i = {
                                texture: r,
                                sizeInBytes: t.width * t.height * {
                                    int8: 1,
                                    uint16: 2,
                                    int16: 3,
                                    rgb: 3
                                }[o]
                            }, nt.putImageTexture(e, i)), i.texture
                        }

                        function gt(e, t, n, o, r) {
                            for (var a in rt.clearColor(1, 0, 0, 1), rt.viewport(0, 0, o, r), rt.clear(rt.COLOR_BUFFER_BIT | rt.DEPTH_BUFFER_BIT), rt.useProgram(e.program), rt.bindBuffer(rt.ARRAY_BUFFER, at), rt.vertexAttribPointer(e.attributes.texCoordLocation, 2, rt.FLOAT, !1, 0, 0), rt.bindBuffer(rt.ARRAY_BUFFER, it), rt.vertexAttribPointer(e.attributes.positionLocation, 2, rt.FLOAT, !1, 0, 0), t) {
                                var i, s = rt.getUniformLocation(e.program, a);
                                s && (i = (a = t[a]).type, a = a.value, "i" === i ? rt.uniform1i(s, a) : "f" === i ? rt.uniform1f(s, a) : "2f" === i && rt.uniform2f(s, a[0], a[1]))
                            }
                            var l;
                            (l = rt).bufferData(l.ARRAY_BUFFER, new Float32Array([o, r, 0, r, o, 0, 0, 0]), l.STATIC_DRAW), rt.activeTexture(rt.TEXTURE0), rt.bindTexture(rt.TEXTURE_2D, n), rt.drawArrays(rt.TRIANGLE_STRIP, 0, 4)
                        }
                        n = {
                            createProgramFromString: st,
                            renderer: {
                                render: function(e) {
                                    var t = e.image,
                                        n = (lt.width = t.width, lt.height = t.height, e = e.viewport, n = ft(n = t), Ze.hasOwnProperty(n) ? Ze[n] : Ze.rgb),
                                        o = mt(t);
                                    return gt(n, {
                                        u_resolution: {
                                            type: "2f",
                                            value: [t.width, t.height]
                                        },
                                        wc: {
                                            type: "f",
                                            value: e.voi.windowCenter
                                        },
                                        ww: {
                                            type: "f",
                                            value: e.voi.windowWidth
                                        },
                                        slope: {
                                            type: "f",
                                            value: t.slope
                                        },
                                        intercept: {
                                            type: "f",
                                            value: t.intercept
                                        },
                                        minPixelValue: {
                                            type: "f",
                                            value: t.minPixelValue
                                        },
                                        invert: {
                                            type: "i",
                                            value: e.invert ? 1 : 0
                                        }
                                    }, o, t.width, t.height), lt
                                },
                                initRenderer: ut,
                                getRenderCanvas: function() {
                                    return lt
                                },
                                isWebGLAvailable: function() {
                                    var e = {
                                        failIfMajorPerformanceCaveat: !0
                                    };
                                    try {
                                        var t = document.createElement("canvas");
                                        return Boolean(window.WebGLRenderingContext) && (t.getContext("webgl", e) || t.getContext("experimental-webgl", e))
                                    } catch (e) {
                                        return !1
                                    }
                                }
                            },
                            textureCache: nt
                        };
                        var pt = (Object.defineProperty(n, "isWebGLInitialized", {
                            enumerable: !0,
                            configurable: !1,
                            get: function() {
                                return ct
                            }
                        }), n);

                        function vt(e, t) {
                            var n, o;
                            (o = e).voiLUT && o.voiLUT.lut && 0 < o.voiLUT.lut.length || void 0 !== o.voi.windowWidth && void 0 !== o.voi.windowCenter || (n = (o = t.maxPixelValue * t.slope + t.intercept) - (t = t.minPixelValue * t.slope + t.intercept), o = (o + t) / 2, void 0 === e.voi ? e.voi = {
                                windowWidth: n,
                                windowCenter: o
                            } : (e.voi.windowWidth = n, e.voi.windowCenter = o))
                        }

                        function yt(e, t) {
                            return !e && !t || !(!e || !t) && e.id === t.id
                        }

                        function bt(e, t, n) {
                            var o, r, a, i, s, l;
                            return n ? (r = (o = n).lut[0], a = o.lut[o.lut.length - 1], i = o.firstValueMapped + o.lut.length, function(e) {
                                return e < o.firstValueMapped ? r : i <= e ? a : o.lut[e]
                            }) : (s = e, l = t, function(e) {
                                return e * s + l
                            })
                        }

                        function wt(e) {
                            return function(e) {
                                if (Array.isArray(e)) return xt(e)
                            }(e) || function(e) {
                                if ("undefined" != typeof Symbol && null != e[Symbol.iterator] || null != e["@@iterator"]) return Array.from(e)
                            }(e) || function(e, t) {
                                var n;
                                if (e) return "string" == typeof e ? xt(e, t) : "Map" === (n = "Object" === (n = Object.prototype.toString.call(e).slice(8, -1)) && e.constructor ? e.constructor.name : n) || "Set" === n ? Array.from(e) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? xt(e, t) : void 0
                            }(e) || function() {
                                throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                            }()
                        }

                        function xt(e, t) {
                            (null == t || t > e.length) && (t = e.length);
                            for (var n = 0, o = new Array(t); n < t; n++) o[n] = e[n];
                            return o
                        }
                        var Tt = function(e, t, n, o) {
                                var r, a, i, s, l, c, u, d;
                                return n ? (r = n, a = o, i = Math.max.apply(Math, wt(r.lut)).toString(2).length - 8, s = r.lut[0] >> i, l = r.lut[r.lut.length - 1] >> i, c = r.firstValueMapped + r.lut.length - 1, function(e) {
                                    return e < r.firstValueMapped ? s : c <= e ? l : a ? r.lut[Math.round(e) - r.firstValueMapped] >> i : r.lut[e - r.firstValueMapped] >> i
                                }) : (u = e, d = t, function(e) {
                                    return 255 * ((e - d) / u + .5)
                                })
                            },
                            It = function(e, t, n, o, r, a) {
                                var i = e.maxPixelValue,
                                    s = e.minPixelValue,
                                    l = Math.min(s, 0),
                                    c = (void 0 === e.cachedLut && (u = i - l + 1, e.cachedLut = {}, e.cachedLut.lutArray = new Uint8ClampedArray(u)), e.cachedLut.lutArray),
                                    u = Boolean(e.slope % 1) || Boolean(e.intercept % 1),
                                    d = bt(e.slope, e.intercept, r),
                                    h = Tt(t, n, a, u);
                                if (!0 === o)
                                    for (var f = s; f <= i; f++) c[f + -l] = 255 - h(d(f));
                                else
                                    for (var m = s; m <= i; m++) c[m + -l] = h(d(m));
                                return c
                            },
                            Et = function(e, t, n) {
                                return void 0 !== e.cachedLut && e.cachedLut.windowCenter === t.voi.windowCenter && e.cachedLut.windowWidth === t.voi.windowWidth && yt(e.cachedLut.modalityLUT, t.modalityLUT) && yt(e.cachedLut.voiLUT, t.voiLUT) && e.cachedLut.invert === t.invert && !0 !== n || (vt(t, e), It(e, t.voi.windowWidth, t.voi.windowCenter, t.invert, t.modalityLUT, t.voiLUT), e.cachedLut.windowWidth = t.voi.windowWidth, e.cachedLut.windowCenter = t.voi.windowCenter, e.cachedLut.invert = t.invert, e.cachedLut.voiLUT = t.voiLUT, e.cachedLut.modalityLUT = t.modalityLUT), e.cachedLut.lutArray
                            },
                            St = function(e, t) {
                                var n = e.renderingTools.lastRenderedImageId,
                                    o = e.renderingTools.lastRenderedViewport;
                                return t.imageId !== n || !o || o.windowCenter !== e.viewport.voi.windowCenter || o.windowWidth !== e.viewport.voi.windowWidth || o.invert !== e.viewport.invert || o.rotation !== e.viewport.rotation || o.hflip !== e.viewport.hflip || o.vflip !== e.viewport.vflip || o.modalityLUT !== e.viewport.modalityLUT || o.voiLUT !== e.viewport.voiLUT || o.colormap !== e.viewport.colormap
                            },
                            At = function(e, t) {
                                var n = ((o = e.renderingTools.renderCanvas).width = t.width, o.height = t.height, o.getContext("2d", {
                                        desynchronized: !0
                                    })),
                                    o = (n.fillStyle = "white", n.fillRect(0, 0, o.width, o.height), n.getImageData(0, 0, t.width, t.height));
                                e.renderingTools.renderCanvasContext = n, e.renderingTools.renderCanvasData = o
                            },
                            Ct = function(e) {
                                var t = e.image.imageId,
                                    n = e.viewport,
                                    o = e.image.color;
                                return e.renderingTools.lastRenderedImageId = t, e.renderingTools.lastRenderedIsColor = o, e.renderingTools.lastRenderedViewport = {
                                    windowCenter: n.voi.windowCenter,
                                    windowWidth: n.voi.windowWidth,
                                    invert: n.invert,
                                    rotation: n.rotation,
                                    hflip: n.hflip,
                                    vflip: n.vflip,
                                    modalityLUT: n.modalityLUT,
                                    voiLUT: n.voiLUT,
                                    colormap: n.colormap
                                }, e.renderingTools
                            };

                        function Mt(e, t, n, o) {
                            o = !(3 < arguments.length && void 0 !== o) || o;
                            var r, a, i = !0 === e.renderingTools.lastRenderedIsColor;
                            return e.renderingTools.renderCanvas && !i || (e.renderingTools.renderCanvas = document.createElement("canvas"), At(e, t)), i = e.renderingTools.renderCanvas, !1 === St(e, t) && !0 !== n || (i.width === t.width && i.height === t.height || At(e, t), r = De(), n = Et(t, e.viewport, n), t.stats = t.stats || {}, t.stats.lastLutGenerateTime = De() - r, a = e.renderingTools.renderCanvasData, e = e.renderingTools.renderCanvasContext, (o ? Ne : Ue)(t, n, a.data), r = De(), e.putImageData(a, 0, 0), t.stats.lastPutImageDataTime = De() - r), i
                        }

                        function Dt(e, t) {
                            if (void 0 === e) throw new Error("drawImage: enabledElement parameter must not be undefined");
                            var n = e.image;
                            if (void 0 === n) throw new Error("drawImage: image must be loaded before it can be drawn");
                            var o = e.canvas.getContext("2d", {
                                    desynchronized: !0
                                }),
                                r = (o.setTransform(1, 0, 0, 1, 0, 0), o.fillStyle = Re(e), o.fillRect(0, 0, e.canvas.width, e.canvas.height), o.imageSmoothingEnabled = !e.viewport.pixelReplication, o.mozImageSmoothingEnabled = o.imageSmoothingEnabled, Be(e, o), n = e.options && e.options.renderer && "webgl" === e.options.renderer.toLowerCase() ? pt.renderer.render(e) : Mt(e, n, t), t = w(e.image, e.viewport)).tlhc.x - 1,
                                a = t.tlhc.y - 1,
                                i = t.brhc.x - r;
                            t = t.brhc.y - a, o.drawImage(n, r, a, i, t, r, a, i, t), e.renderingTools = Ct(e)
                        }

                        function Pt(e, t, n, o, r) {
                            var a, i = e.maxPixelValue,
                                s = e.minPixelValue,
                                l = Math.min(s, 0),
                                c = (void 0 === e.cachedLut && (a = i - l + 1, e.cachedLut = {}, e.cachedLut.lutArray = new Uint8ClampedArray(a)), e.cachedLut.lutArray),
                                u = Tt(t, n, r);
                            if (!0 === o)
                                for (var d = s; d <= i; d++) c[d + -l] = 255 - u(d);
                            else
                                for (var h = s; h <= i; h++) c[h + -l] = u(h)
                        }
                        var kt = function(e, t, n) {
                                var o = De(),
                                    r = e.getPixelData(),
                                    a = (e.stats.lastGetPixelDataTime = De() - o, e.minPixelValue),
                                    i = 0,
                                    s = 0,
                                    l = r.length;
                                if (o = De(), a < 0)
                                    for (; s < l;) n[i++] = t[r[s++] + -a], n[i++] = t[r[s++] + -a], n[i] = t[r[s] + -a], s += 2, i += 2;
                                else
                                    for (; s < l;) n[i++] = t[r[s++]], n[i++] = t[r[s++]], n[i] = t[r[s]], s += 2, i += 2;
                                e.stats.lastStoredPixelDataToCanvasImageDataTime = De() - o
                            },
                            _t = function(e, t, n) {
                                var o = De(),
                                    r = e.getPixelData(),
                                    a = (e.stats.lastGetPixelDataTime = De() - o, e.minPixelValue),
                                    i = 0,
                                    s = 0,
                                    l = r.length;
                                if (o = De(), a < 0)
                                    for (; s < l;) n[i++] = t[r[s++] + -a], n[i++] = t[r[s++] + -a], n[i++] = t[r[s++] + -a], n[i++] = r[s++];
                                else
                                    for (; s < l;) n[i++] = t[r[s++]], n[i++] = t[r[s++]], n[i++] = t[r[s++]], n[i++] = r[s++];
                                e.stats.lastStoredPixelDataToCanvasImageDataTime = De() - o
                            };

                        function Lt(e, t, n) {
                            var o, r, a = !0 === e.renderingTools.lastRenderedIsColor;
                            return e.renderingTools.renderCanvas && a || (e.renderingTools.renderCanvas = document.createElement("canvas")), a = e.renderingTools.renderCanvas, 255 !== e.viewport.voi.windowWidth && 256 !== e.viewport.voi.windowWidth || 127 !== e.viewport.voi.windowCenter && 128 !== e.viewport.voi.windowCenter || !1 !== e.viewport.invert || !t.getCanvas || !t.getCanvas() ? (!1 === St(e, t) && !0 !== n || (a.width === t.width && a.height === t.height || At(e, t), n = De(), r = t, o = e.viewport, void 0 !== r.cachedLut && r.cachedLut.windowCenter === o.voi.windowCenter && r.cachedLut.windowWidth === o.voi.windowWidth && r.cachedLut.invert === o.invert || (Pt(r, o.voi.windowWidth, o.voi.windowCenter, o.invert), r.cachedLut.windowWidth = o.voi.windowWidth, r.cachedLut.windowCenter = o.voi.windowCenter, r.cachedLut.invert = o.invert), o = r.cachedLut.lutArray, t.stats = t.stats || {}, t.stats.lastLutGenerateTime = De() - n, r = e.renderingTools.renderCanvasData, e = e.renderingTools.renderCanvasContext, (t.rgba ? _t : kt)(t, o, r.data), n = De(), e.putImageData(r, 0, 0), t.stats.lastPutImageDataTime = De() - n), a) : t.getCanvas()
                        }

                        function Ot(e, t) {
                            if (void 0 === e) throw new Error("renderColorImage: enabledElement parameter must not be undefined");
                            var n = e.image;
                            if (void 0 === n) throw new Error("renderColorImage: image must be loaded before it can be drawn");
                            var o = e.canvas.getContext("2d", {
                                    desynchronized: !0
                                }),
                                r = (o.setTransform(1, 0, 0, 1, 0, 0), o.fillStyle = Re(e), o.fillRect(0, 0, e.canvas.width, e.canvas.height), o.imageSmoothingEnabled = !e.viewport.pixelReplication, o.mozImageSmoothingEnabled = o.imageSmoothingEnabled, Be(e, o), n = e.options && e.options.renderer && "webgl" === e.options.renderer.toLowerCase() ? pt.renderer.render(e) : Lt(e, n, t), t = w(e.image, e.viewport)).tlhc.x - 1,
                                a = t.tlhc.y - 1,
                                i = t.brhc.x - r;
                            t = t.brhc.y - a, o.drawImage(n, r, a, i, t, r, a, i, t), e.renderingTools = Ct(e)
                        }
                        var Rt = function(e, t, n, o) {
                            var r, a, i = De(),
                                s = e.getPixelData(),
                                l = (e.stats.lastGetPixelDataTime = De() - i, s.length),
                                c = e.minPixelValue,
                                u = 0,
                                d = 0,
                                h = (i = De(), n instanceof j.LookupTable ? n.Table : n);
                            if (!0 === e.color || !0 === e.rgba)
                                if (c < 0)
                                    for (; d < l;) r = t[s[d] + -c], d += 4, a = h[r], o[u++] = a[0], o[u++] = a[1], o[u++] = a[2], o[u++] = a[3];
                                else
                                    for (; d < l;) r = t[s[d]], d += 4, a = h[r], o[u++] = a[0], o[u++] = a[1], o[u++] = a[2], o[u++] = a[3];
                            else if (c < 0)
                                for (; d < l;) a = h[r = t[s[d++] + -c]], o[u++] = a[0], o[u++] = a[1], o[u++] = a[2], o[u++] = a[3];
                            else
                                for (; d < l;) a = h[r = t[s[d++]]], o[u++] = a[0], o[u++] = a[1], o[u++] = a[2], o[u++] = a[3];
                            e.stats.lastStoredPixelDataToCanvasImageDataTime = De() - i
                        };

                        function Nt(e, t, n) {
                            e.renderingTools.renderCanvas || (e.renderingTools.renderCanvas = document.createElement("canvas"));
                            var o, r, a = e.renderingTools.renderCanvas,
                                i = e.viewport.colormap || e.options.colormap;
                            if (e.options && e.options.colormap && console.warn("enabledElement.options.colormap is deprecated. Use enabledElement.viewport.colormap instead"), i = i && "string" == typeof i ? j.getColormap(i) : i) return r = i.getId(), !1 === St(e, t) && !0 !== n && e.renderingTools.colormapId === r || (a.width === t.width && a.height === t.height || At(e, t), o = De(), e.renderingTools.colorLut && !n && e.renderingTools.colormapId === r || (i.setNumberOfColors(256), e.renderingTools.colorLut = i.createLookupTable(), e.renderingTools.colormapId = r), i = Et(t, e.viewport, n), t.stats = t.stats || {}, t.stats.lastLutGenerateTime = De() - o, r = e.renderingTools.colorLut, n = e.renderingTools.renderCanvasData, e = e.renderingTools.renderCanvasContext, Rt(t, i, r, n.data), o = De(), e.putImageData(n, 0, 0), t.stats.lastPutImageDataTime = De() - o), a;
                            throw new Error("renderPseudoColorImage: colormap not found.")
                        }

                        function Ut(e, t) {
                            if (void 0 === e) throw new Error("drawImage: enabledElement parameter must not be undefined");
                            if (void 0 === (o = e.image)) throw new Error("drawImage: image must be loaded before it can be drawn");
                            var n = e.canvas.getContext("2d", {
                                    desynchronized: !0
                                }),
                                o = (n.setTransform(1, 0, 0, 1, 0, 0), n.fillStyle = Re(e), n.fillRect(0, 0, e.canvas.width, e.canvas.height), n.imageSmoothingEnabled = !e.viewport.pixelReplication, n.mozImageSmoothingEnabled = n.imageSmoothingEnabled, Be(e, n), Nt(e, o, t)),
                                r = (t = w(e.image, e.viewport)).tlhc.x - 1,
                                a = t.tlhc.y - 1,
                                i = t.brhc.x - r;
                            t = t.brhc.y - a, n.drawImage(o, r, a, i, t, r, a, i, t), e.renderingTools = Ct(e)
                        }
                        var Bt = function(e, t, n) {
                            var o, r = De(),
                                a = e.getPixelData(),
                                i = (e.stats.lastGetPixelDataTime = De() - r, a.length),
                                s = e.minPixelValue,
                                l = 0,
                                c = 0,
                                u = (r = De(), t instanceof j.LookupTable ? t.Table : t);
                            if (s < 0)
                                for (; c < i;) o = u[a[c++] + -s], n[l++] = o[0], n[l++] = o[1], n[l++] = o[2], n[l++] = o[3];
                            else
                                for (; c < i;) o = u[a[c++]], n[l++] = o[0], n[l++] = o[1], n[l++] = o[2], n[l++] = o[3];
                            e.stats.lastStoredPixelDataToCanvasImageDataTime = De() - r
                        };

                        function Vt(e, t, n) {
                            e.renderingTools.renderCanvas || (e.renderingTools.renderCanvas = document.createElement("canvas"));
                            var o, r, a = e.renderingTools.renderCanvas,
                                i = e.viewport.colormap || e.options.colormap;
                            if (e.options.colormap && console.warn("enabledElement.options.colormap is deprecated. Use enabledElement.viewport.colormap instead"), i = i && "string" == typeof i ? j.getColormap(i) : i) return r = i.getId(), !1 === St(e, t) && !0 !== n && e.renderingTools.colormapId === r || (a.width === t.width && a.height === t.height || At(e, t), o = De(), e.renderingTools.colorLut && !n && e.renderingTools.colormapId === r || (e.renderingTools.colorLut = i.createLookupTable(), e.renderingTools.colormapId = r), t.stats = t.stats || {}, t.stats.lastLutGenerateTime = De() - o, n = e.renderingTools.colorLut, i = e.renderingTools.renderCanvasData, r = e.renderingTools.renderCanvasContext, Bt(t, n, i.data), o = De(), r.putImageData(i, 0, 0), t.stats.lastPutImageDataTime = De() - o), a;
                            throw new Error("renderLabelMapImage: colormap not found.")
                        }

                        function Ft(e, t) {
                            if (void 0 === e) throw new Error("renderLabelMapImage: enabledElement parameter must not be undefined");
                            if (void 0 === (o = e.image)) throw new Error("renderLabelMapImage: image must be loaded before it can be drawn");
                            var n = e.canvas.getContext("2d", {
                                    desynchronized: !0
                                }),
                                o = (n.setTransform(1, 0, 0, 1, 0, 0), n.fillStyle = Re(e), n.fillRect(0, 0, e.canvas.width, e.canvas.height), n.imageSmoothingEnabled = !e.viewport.pixelReplication, n.mozImageSmoothingEnabled = n.imageSmoothingEnabled, Be(e, n), Vt(e, o, t)),
                                r = (t = w(e.image, e.viewport)).tlhc.x - 1,
                                a = t.tlhc.y - 1,
                                i = t.brhc.x - r;
                            t = t.brhc.y - a, n.drawImage(o, r, a, i, t, r, a, i, t), e.renderingTools = Ct(e)
                        }

                        function Ht(e) {
                            var t = e.syncProps || {};
                            t.originalScale = e.viewport.scale, e.syncProps = t
                        }

                        function qt(e, t) {
                            e.forEach((function(e) {
                                var n, o;
                                e !== t && e.viewport && t.viewport && (e.syncProps || Ht(e), o = e, (n = t).syncProps || Ht(n), o.syncProps || Ht(o), o = o.syncProps.originalScale / n.syncProps.originalScale, e.viewport.scale = t.viewport.scale * o, e.viewport.rotation = t.viewport.rotation, e.viewport.translation = {
                                    x: t.viewport.translation.x / o,
                                    y: t.viewport.translation.y / o
                                }, e.viewport.hflip = t.viewport.hflip, e.viewport.vflip = t.viewport.vflip)
                            }))
                        }

                        function jt(e, t, n) {
                            t.forEach((function(t, o) {
                                if (t.image) {
                                    e.save(), t.canvas = e.canvas, Be(t, e);
                                    var r = t.viewport.colormap || t.options.colormap,
                                        a = t.viewport.labelmap,
                                        i = t.invalid || n;
                                    if (r && "" !== r && !0 === a) {
                                        var s = i;
                                        if (void 0 === (a = t)) throw new Error("addLabelMapLayer: layer parameter must not be undefined");
                                        var l = a.image;
                                        if (void 0 === l) throw new Error("addLabelMapLayer: image must be loaded before it can be drawn");
                                        a.canvas = Vt(a, l, s), (l = a.canvas.getContext("2d", {
                                            desynchronized: !0
                                        })).imageSmoothingEnabled = !a.viewport.pixelReplication, l.mozImageSmoothingEnabled = l.imageSmoothingEnabled, a.renderingTools = Ct(a)
                                    } else if (r && "" !== r) {
                                        if (l = i, void 0 === (s = t)) throw new Error("addPseudoColorLayer: layer parameter must not be undefined");
                                        if (void 0 === (a = s.image)) throw new Error("addPseudoColorLayer: image must be loaded before it can be drawn");
                                        s.canvas = Nt(s, a, l), (a = s.canvas.getContext("2d", {
                                            desynchronized: !0
                                        })).imageSmoothingEnabled = !s.viewport.pixelReplication, a.mozImageSmoothingEnabled = a.imageSmoothingEnabled, s.renderingTools = Ct(s)
                                    } else if (!0 === t.image.color) {
                                        if (a = i, void 0 === (r = t)) throw new Error("addColorLayer: layer parameter must not be undefined");
                                        var c = r.image;
                                        if (void 0 === c) throw new Error("addColorLayer: image must be loaded before it can be drawn");
                                        c.rgba = !0, r.canvas = Lt(r, c, a), (c = r.canvas.getContext("2d", {
                                            desynchronized: !0
                                        })).imageSmoothingEnabled = !r.viewport.pixelReplication, c.mozImageSmoothingEnabled = c.imageSmoothingEnabled, r.renderingTools = Ct(r)
                                    } else ! function(e, t, n) {
                                        if (n = 2 < arguments.length && void 0 !== n && n, void 0 === e) throw new Error("addGrayscaleLayer: layer parameter must not be undefined");
                                        var o = e.image;
                                        if (void 0 === o) throw new Error("addGrayscaleLayer: image must be loaded before it can be drawn");
                                        e.canvas = Mt(e, o, t, n), (o = e.canvas.getContext("2d", {
                                            desynchronized: !0
                                        })).imageSmoothingEnabled = !e.viewport.pixelReplication, o.mozImageSmoothingEnabled = o.imageSmoothingEnabled, e.renderingTools = Ct(e)
                                    }(t, i, 0 === o);
                                    t.options && t.options.opacity ? e.globalAlpha = t.options.opacity : e.globalAlpha = 1, t.options && t.options.fillStyle && (e.fillStyle = t.options.fillStyle), e.imageSmoothingEnabled = !t.viewport.pixelReplication, e.mozImageSmoothingEnabled = e.imageSmoothingEnabled, c = (a = w(t.image, t.viewport)).tlhc.x - 1, r = a.tlhc.y - 1, i = a.brhc.x - c, o = a.brhc.y - r, e.drawImage(t.canvas, c, r, i, o, c, r, i, o), e.restore(), t.invalid = !1
                                }
                            }))
                        }

                        function zt(e) {
                            return (zt = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                                return typeof e
                            } : function(e) {
                                return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
                            })(e)
                        }

                        function Wt() { /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
                            Wt = function() {
                                return t
                            };
                            var e, t = {},
                                n = Object.prototype,
                                o = n.hasOwnProperty,
                                r = Object.defineProperty || function(e, t, n) {
                                    e[t] = n.value
                                },
                                a = (b = "function" == typeof Symbol ? Symbol : {}).iterator || "@@iterator",
                                i = b.asyncIterator || "@@asyncIterator",
                                s = b.toStringTag || "@@toStringTag";

                            function l(e, t, n) {
                                return Object.defineProperty(e, t, {
                                    value: n,
                                    enumerable: !0,
                                    configurable: !0,
                                    writable: !0
                                }), e[t]
                            }
                            try {
                                l({}, "")
                            } catch (e) {
                                l = function(e, t, n) {
                                    return e[t] = n
                                }
                            }

                            function c(t, n, o, a) {
                                var i, s, l, c;
                                return n = n && n.prototype instanceof p ? n : p, n = Object.create(n.prototype), a = new A(a || []), r(n, "_invoke", {
                                    value: (i = t, s = o, l = a, c = d, function(t, n) {
                                        if (c === f) throw new Error("Generator is already running");
                                        if (c === m) {
                                            if ("throw" === t) throw n;
                                            return {
                                                value: e,
                                                done: !0
                                            }
                                        }
                                        for (l.method = t, l.arg = n;;) {
                                            var o = l.delegate;
                                            if (o && (o = function t(n, o) {
                                                    var r = o.method,
                                                        a = n.iterator[r];
                                                    return a === e ? (o.delegate = null, "throw" === r && n.iterator.return && (o.method = "return", o.arg = e, t(n, o), "throw" === o.method) || "return" !== r && (o.method = "throw", o.arg = new TypeError("The iterator does not provide a '" + r + "' method")), g) : "throw" === (r = u(a, n.iterator, o.arg)).type ? (o.method = "throw", o.arg = r.arg, o.delegate = null, g) : (a = r.arg) ? a.done ? (o[n.resultName] = a.value, o.next = n.nextLoc, "return" !== o.method && (o.method = "next", o.arg = e), o.delegate = null, g) : a : (o.method = "throw", o.arg = new TypeError("iterator result is not an object"), o.delegate = null, g)
                                                }(o, l), o)) {
                                                if (o === g) continue;
                                                return o
                                            }
                                            if ("next" === l.method) l.sent = l._sent = l.arg;
                                            else if ("throw" === l.method) {
                                                if (c === d) throw c = m, l.arg;
                                                l.dispatchException(l.arg)
                                            } else "return" === l.method && l.abrupt("return", l.arg);
                                            if (c = f, "normal" === (o = u(i, s, l)).type) {
                                                if (c = l.done ? m : h, o.arg === g) continue;
                                                return {
                                                    value: o.arg,
                                                    done: l.done
                                                }
                                            }
                                            "throw" === o.type && (c = m, l.method = "throw", l.arg = o.arg)
                                        }
                                    })
                                }), n
                            }

                            function u(e, t, n) {
                                try {
                                    return {
                                        type: "normal",
                                        arg: e.call(t, n)
                                    }
                                } catch (e) {
                                    return {
                                        type: "throw",
                                        arg: e
                                    }
                                }
                            }
                            t.wrap = c;
                            var d = "suspendedStart",
                                h = "suspendedYield",
                                f = "executing",
                                m = "completed",
                                g = {};

                            function p() {}

                            function v() {}

                            function y() {}
                            var b, w, x = (l(b = {}, a, (function() {
                                return this
                            })), (w = (w = Object.getPrototypeOf) && w(w(C([])))) && w !== n && o.call(w, a) && (b = w), y.prototype = p.prototype = Object.create(b));

                            function T(e) {
                                ["next", "throw", "return"].forEach((function(t) {
                                    l(e, t, (function(e) {
                                        return this._invoke(t, e)
                                    }))
                                }))
                            }

                            function I(e, t) {
                                var n;
                                r(this, "_invoke", {
                                    value: function(r, a) {
                                        function i() {
                                            return new t((function(n, i) {
                                                ! function n(r, a, i, s) {
                                                    var l;
                                                    if ("throw" !== (r = u(e[r], e, a)).type) return (a = (l = r.arg).value) && "object" == zt(a) && o.call(a, "__await") ? t.resolve(a.__await).then((function(e) {
                                                        n("next", e, i, s)
                                                    }), (function(e) {
                                                        n("throw", e, i, s)
                                                    })) : t.resolve(a).then((function(e) {
                                                        l.value = e, i(l)
                                                    }), (function(e) {
                                                        return n("throw", e, i, s)
                                                    }));
                                                    s(r.arg)
                                                }(r, a, n, i)
                                            }))
                                        }
                                        return n = n ? n.then(i, i) : i()
                                    }
                                })
                            }

                            function E(e) {
                                var t = {
                                    tryLoc: e[0]
                                };
                                1 in e && (t.catchLoc = e[1]), 2 in e && (t.finallyLoc = e[2], t.afterLoc = e[3]), this.tryEntries.push(t)
                            }

                            function S(e) {
                                var t = e.completion || {};
                                t.type = "normal", delete t.arg, e.completion = t
                            }

                            function A(e) {
                                this.tryEntries = [{
                                    tryLoc: "root"
                                }], e.forEach(E, this), this.reset(!0)
                            }

                            function C(t) {
                                if (t || "" === t) {
                                    var n, r = t[a];
                                    if (r) return r.call(t);
                                    if ("function" == typeof t.next) return t;
                                    if (!isNaN(t.length)) return n = -1, (r = function r() {
                                        for (; ++n < t.length;)
                                            if (o.call(t, n)) return r.value = t[n], r.done = !1, r;
                                        return r.value = e, r.done = !0, r
                                    }).next = r
                                }
                                throw new TypeError(zt(t) + " is not iterable")
                            }
                            return r(x, "constructor", {
                                value: v.prototype = y,
                                configurable: !0
                            }), r(y, "constructor", {
                                value: v,
                                configurable: !0
                            }), v.displayName = l(y, s, "GeneratorFunction"), t.isGeneratorFunction = function(e) {
                                return !!(e = "function" == typeof e && e.constructor) && (e === v || "GeneratorFunction" === (e.displayName || e.name))
                            }, t.mark = function(e) {
                                return Object.setPrototypeOf ? Object.setPrototypeOf(e, y) : (e.__proto__ = y, l(e, s, "GeneratorFunction")), e.prototype = Object.create(x), e
                            }, t.awrap = function(e) {
                                return {
                                    __await: e
                                }
                            }, T(I.prototype), l(I.prototype, i, (function() {
                                return this
                            })), t.AsyncIterator = I, t.async = function(e, n, o, r, a) {
                                void 0 === a && (a = Promise);
                                var i = new I(c(e, n, o, r), a);
                                return t.isGeneratorFunction(n) ? i : i.next().then((function(e) {
                                    return e.done ? e.value : i.next()
                                }))
                            }, T(x), l(x, s, "Generator"), l(x, a, (function() {
                                return this
                            })), l(x, "toString", (function() {
                                return "[object Generator]"
                            })), t.keys = function(e) {
                                var t, n = Object(e),
                                    o = [];
                                for (t in n) o.push(t);
                                return o.reverse(),
                                    function e() {
                                        for (; o.length;) {
                                            var t = o.pop();
                                            if (t in n) return e.value = t, e.done = !1, e
                                        }
                                        return e.done = !0, e
                                    }
                            }, t.values = C, A.prototype = {
                                constructor: A,
                                reset: function(t) {
                                    if (this.prev = 0, this.next = 0, this.sent = this._sent = e, this.done = !1, this.delegate = null, this.method = "next", this.arg = e, this.tryEntries.forEach(S), !t)
                                        for (var n in this) "t" === n.charAt(0) && o.call(this, n) && !isNaN(+n.slice(1)) && (this[n] = e)
                                },
                                stop: function() {
                                    this.done = !0;
                                    var e = this.tryEntries[0].completion;
                                    if ("throw" === e.type) throw e.arg;
                                    return this.rval
                                },
                                dispatchException: function(t) {
                                    if (this.done) throw t;
                                    var n = this;

                                    function r(o, r) {
                                        return s.type = "throw", s.arg = t, n.next = o, r && (n.method = "next", n.arg = e), !!r
                                    }
                                    for (var a = this.tryEntries.length - 1; 0 <= a; --a) {
                                        var i = this.tryEntries[a],
                                            s = i.completion;
                                        if ("root" === i.tryLoc) return r("end");
                                        if (i.tryLoc <= this.prev) {
                                            var l = o.call(i, "catchLoc"),
                                                c = o.call(i, "finallyLoc");
                                            if (l && c) {
                                                if (this.prev < i.catchLoc) return r(i.catchLoc, !0);
                                                if (this.prev < i.finallyLoc) return r(i.finallyLoc)
                                            } else if (l) {
                                                if (this.prev < i.catchLoc) return r(i.catchLoc, !0)
                                            } else {
                                                if (!c) throw new Error("try statement without catch or finally");
                                                if (this.prev < i.finallyLoc) return r(i.finallyLoc)
                                            }
                                        }
                                    }
                                },
                                abrupt: function(e, t) {
                                    for (var n = this.tryEntries.length - 1; 0 <= n; --n) {
                                        var r = this.tryEntries[n];
                                        if (r.tryLoc <= this.prev && o.call(r, "finallyLoc") && this.prev < r.finallyLoc) {
                                            var a = r;
                                            break
                                        }
                                    }
                                    var i = (a = a && ("break" === e || "continue" === e) && a.tryLoc <= t && t <= a.finallyLoc ? null : a) ? a.completion : {};
                                    return i.type = e, i.arg = t, a ? (this.method = "next", this.next = a.finallyLoc, g) : this.complete(i)
                                },
                                complete: function(e, t) {
                                    if ("throw" === e.type) throw e.arg;
                                    return "break" === e.type || "continue" === e.type ? this.next = e.arg : "return" === e.type ? (this.rval = this.arg = e.arg, this.method = "return", this.next = "end") : "normal" === e.type && t && (this.next = t), g
                                },
                                finish: function(e) {
                                    for (var t = this.tryEntries.length - 1; 0 <= t; --t) {
                                        var n = this.tryEntries[t];
                                        if (n.finallyLoc === e) return this.complete(n.completion, n.afterLoc), S(n), g
                                    }
                                },
                                catch: function(e) {
                                    for (var t = this.tryEntries.length - 1; 0 <= t; --t) {
                                        var n, o, r = this.tryEntries[t];
                                        if (r.tryLoc === e) return "throw" === (n = r.completion).type && (o = n.arg, S(r)), o
                                    }
                                    throw new Error("illegal catch attempt")
                                },
                                delegateYield: function(t, n, o) {
                                    return this.delegate = {
                                        iterator: C(t),
                                        resultName: n,
                                        nextLoc: o
                                    }, "next" === this.method && (this.arg = e), g
                                }
                            }, t
                        }

                        function Gt(e, t, n, o, r, a, i) {
                            try {
                                var s = e[a](i),
                                    l = s.value
                            } catch (e) {
                                return void n(e)
                            }
                            s.done ? t(l) : Promise.resolve(l).then(o, r)
                        }

                        function Yt(e, t) {
                            return Zt.apply(this, arguments)
                        }

                        function Zt() {
                            var e;
                            return e = Wt().mark((function e(t, n) {
                                var o, r, i, s, l, c;
                                return Wt().wrap((function(e) {
                                    for (;;) switch (e.prev = e.next) {
                                        case 0:
                                            if (r = t.image, i = t.element, s = t.layers || [], t.canvas && t.image) {
                                                e.next = 5;
                                                break
                                            }
                                            return e.abrupt("return");
                                        case 5:
                                            return c = De(), r.stats = {
                                                lastGetPixelDataTime: -1,
                                                lastStoredPixelDataToCanvasImageDataTime: -1,
                                                lastPutImageDataTime: -1,
                                                lastRenderTime: -1,
                                                lastLutGenerateTime: -1
                                            }, s && s.length ? (d = n, g = h = m = f = h = void 0, f = D(h = (u = t).element), m = L(h), h = P(h), g = !u.lastSyncViewportsState && u.syncViewports, u.lastSyncViewportsState = u.syncViewports, g && f.forEach((function(e) {
                                                e.viewport && Ht(e)
                                            })), !0 === u.syncViewports && qt(h, m), (g = u.canvas.getContext("2d", {
                                                desynchronized: !0
                                            })).setTransform(1, 0, 0, 1, 0, 0), g.fillStyle = "black", g.fillRect(0, 0, u.canvas.width, u.canvas.height), jt(g, h, d)) : r && ((l = r.render) || (l = t.viewport.colormap && "" !== t.viewport.colormap && !0 === t.image.labelmap ? Ft : t.viewport.colormap && "" !== t.viewport.colormap ? Ut : r.color ? Ot : Dt, r._render = l), l(t, n)), l = De() - c, c = {
                                                viewport: t.viewport,
                                                element: i,
                                                image: r,
                                                enabledElement: t,
                                                canvasContext: t.canvas.getContext("2d", {
                                                    desynchronized: !0
                                                }),
                                                renderTimeInMs: l
                                            }, r.stats.lastRenderTime = l, t.invalid = !1, t.needsRedraw = !1, e.next = 15, null == (o = globalThis.drawImageSyncHandler) ? void 0 : o.call(globalThis, c);
                                        case 15:
                                            I(i, a.IMAGE_RENDERED, c);
                                        case 16:
                                        case "end":
                                            return e.stop()
                                    }
                                    var u, d, h, f, m, g
                                }), e)
                            })), (Zt = function() {
                                var t = this,
                                    n = arguments;
                                return new Promise((function(o, r) {
                                    var a = e.apply(t, n);

                                    function i(e) {
                                        Gt(a, o, r, i, s, "next", e)
                                    }

                                    function s(e) {
                                        Gt(a, o, r, i, s, "throw", e)
                                    }
                                    i(void 0)
                                }))
                            }).apply(this, arguments)
                        }

                        function Kt(e) {
                            pt.renderer.isWebGLAvailable() ? (pt.renderer.initRenderer(), e.renderer = "webgl", e.desynchronized = !0, e.preserveDrawingBuffer = !0) : (console.error("WebGL not available, falling back to Canvas renderer"), delete e.renderer, delete e.preserveDrawingBuffer)
                        }
                        var Xt = function(e) {
                                return window.requestAnimationFrame(e) || window.webkitRequestAnimationFrame(e) || window.mozRequestAnimationFrame(e) || window.oRequestAnimationFrame(e) || window.msRequestAnimationFrame(e) || void window.setTimeout(e, 1e3 / 60)
                            },
                            Jt = "cornerstone-canvas";

                        function Qt(e) {
                            var t = "canvas.".concat(Jt);
                            return e.querySelector(t) || (t = e, (e = document.createElement("canvas")).style.display = "block", e.classList.add(Jt), t.appendChild(e), e)
                        }
                        var $t = function(e, t) {
                                if (void 0 === e) throw new Error("enable: parameter element cannot be undefined");
                                t && t.renderer && "webgl" === t.renderer.toLowerCase() && Kt(t);
                                var n, o = {
                                    element: e,
                                    canvas: Qt(e),
                                    image: void 0,
                                    invalid: !1,
                                    needsRedraw: !0,
                                    options: Object.assign({}, t),
                                    layers: [],
                                    data: {},
                                    renderingTools: {},
                                    uuid: (n = (new Date).getTime(), "undefined" != typeof performance && "function" == typeof performance.now && (n += performance.now()), "x.x.x.x.x.x.xxxx.xxx.x.x.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx".replace(/[xy]/g, (function(e) {
                                        var t = (n + 16 * Math.random()) % 16 | 0;
                                        return n = Math.floor(n / 16), ("x" === e ? t : 3 & t | 8).toString(16)
                                    })))
                                };
                                c(o), I(i, a.ELEMENT_ENABLED, o), Oe(e, !0),
                                    function e(t) {
                                        void 0 !== o.canvas && (I(o.element, a.PRE_RENDER, {
                                            enabledElement: o,
                                            timestamp: t
                                        }), o.needsRedraw && (void 0 !== (t = o).image || 0 < t.layers.length) && Yt(o, o.invalid), Xt(e))
                                    }()
                            },
                            en = function(e, t) {
                                return e = l(e), b(e.canvas, t)
                            },
                            tn = function(e) {
                                return l(e).image
                            },
                            nn = function(e, t, n, o, r) {
                                if (void 0 === e) throw new Error("getStoredPixels: parameter element must not be undefined");
                                t = Math.round(t), n = Math.round(n);
                                for (var a = l(e), i = [], s = 0, c = a.image.getPixelData(), u = 0; u < r; u++)
                                    for (var d = 0; d < o; d++) {
                                        var h = (u + n) * a.image.columns + (d + t);
                                        i[s++] = c[h]
                                    }
                                return i
                            },
                            on = function(e, t, n, o, r) {
                                return t = nn(e, t, n, o, r), o = bt((n = l(e)).image.slope, n.image.intercept, n.viewport.modalityLUT), t.map(o)
                            },
                            rn = function(e) {
                                if (void 0 !== (e = l(e).viewport)) return Object.assign({}, e)
                            },
                            an = {
                                drawImage: x,
                                generateLut: It,
                                getDefaultViewport: b,
                                requestAnimationFrame: Xt,
                                setDefaultViewport: g,
                                storedPixelDataToCanvasImageData: Ne,
                                storedPixelDataToCanvasImageDataRGBA: Ue,
                                storedPixelDataToCanvasImageDataColorLUT: Bt,
                                storedPixelDataToCanvasImageDataPseudocolorLUT: Rt,
                                storedColorPixelDataToCanvasImageData: kt,
                                getTransform: Ee,
                                calculateTransform: Ae,
                                Transform: Se
                            },
                            sn = function(e) {
                                var t = l(e);
                                t.invalid = !0, t.needsRedraw = !0, I(e, a.INVALIDATED, {
                                    element: e
                                })
                            },
                            ln = function(e) {
                                u(e).forEach((function(e) {
                                    x(e, !0)
                                }))
                            },
                            cn = [],
                            un = {
                                addProvider: function(e) {
                                    for (var t = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : 0, n = 0; n < cn.length && !(cn[n].priority <= t); n++);
                                    cn.splice(n, 0, {
                                        priority: t,
                                        provider: e
                                    })
                                },
                                removeProvider: function(e) {
                                    for (var t = 0; t < cn.length; t++)
                                        if (cn[t].provider === e) {
                                            cn.splice(t, 1);
                                            break
                                        }
                                },
                                get: function(e, t) {
                                    for (var n = 0; n < cn.length; n++) {
                                        var o = cn[n].provider(e, t);
                                        if (void 0 !== o) return o
                                    }
                                }
                            },
                            dn = function(e, t, n) {
                                var o = l(e);
                                if (void 0 === o.image) throw new Error("image has not been loaded yet");
                                return t = {
                                    x: t - (e = e.getBoundingClientRect()).left - window.pageXOffset,
                                    y: n - e.top - window.pageYOffset
                                }, (n = Ee(o)).invert(), n.transformPoint(t.x, t.y)
                            },
                            hn = function(e, t) {
                                return Ee(e = l(e)).transformPoint(t.x, t.y)
                            },
                            fn = function(e, t) {
                                var n = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : null,
                                    o = 3 < arguments.length && void 0 !== arguments[3] ? arguments[3] : null;
                                if (void 0 === e) throw new Error("renderToCanvas: parameter canvas cannot be undefined");
                                o && o.renderer && "webgl" === o.renderer.toLowerCase() && Kt(o);
                                var r = b(e, t);
                                n = {
                                    enabledElement: (n && Object.assign(r, n), e = {
                                        element: n = e,
                                        canvas: n,
                                        image: t,
                                        invalid: !0,
                                        needsRedraw: !0,
                                        options: o,
                                        layers: [],
                                        data: {},
                                        renderingTools: {},
                                        viewport: r
                                    }),
                                    timestamp: Date.now()
                                }, I(e.element, a.PRE_RENDER, n), Yt(e, e.invalid)
                            };

                        function mn(e, t) {
                            if (void 0 === e) throw new Error("renderWebImage: enabledElement parameter must not be undefined");
                            var n, o, r, a, i, s = e.image;
                            if (void 0 === s) throw new Error("renderWebImage: image must be loaded before it can be drawn");
                            e.viewport.voi.windowWidth === e.image.windowWidth && e.viewport.voi.windowCenter === e.image.windowCenter && !1 === e.viewport.invert ? ((n = e.canvas.getContext("2d", {
                                desynchronized: !0
                            })).setTransform(1, 0, 0, 1, 0, 0), n.fillStyle = "black", n.fillRect(0, 0, e.canvas.width, e.canvas.height), n.imageSmoothingEnabled = !e.viewport.pixelReplication, n.mozImageSmoothingEnabled = n.imageSmoothingEnabled, Be(e, n), o = (i = w(e.image, e.viewport)).tlhc.x - 1, r = i.tlhc.y - 1, a = i.brhc.x - o, i = i.brhc.y - r, n.drawImage(s.getImage(), o, r, a, i, o, r, a, i)) : Ot(e, t)
                        }
                        var gn = {
                                colorImage: Ot,
                                grayscaleImage: Dt,
                                webImage: mn,
                                pseudoColorImage: Ut,
                                labelMapImage: Ft,
                                toCanvas: fn
                            },
                            pn = function(e) {
                                var t = l(e);
                                t.viewport = b(t.canvas, t.image), T(e)
                            },
                            vn = function(e, t) {
                                var n = l(e);
                                if (void 0 === n.viewport && (n.viewport = b(n.canvas)), t)
                                    for (var o in t) null !== t[o] && (n.viewport[o] = t[o]);
                                n.viewport.voi.windowWidth && (n.viewport.voi.windowWidth = Math.max(n.viewport.voi.windowWidth, 1e-6)), n.viewport.scale && (n.viewport.scale = Math.max(n.viewport.scale, 1e-4)), n.viewport.rotation %= 360, n.viewport.rotation < 0 && (n.viewport.rotation += 360), n.image && T(e)
                            };
                        t.default = {
                            drawImage: x,
                            generateLut: It,
                            getDefaultViewport: b,
                            requestAnimationFrame: Xt,
                            storedPixelDataToCanvasImageData: Ne,
                            storedColorPixelDataToCanvasImageData: kt,
                            storedPixelDataToCanvasImageDataColorLUT: Bt,
                            storedPixelDataToCanvasImageDataPseudocolorLUT: Rt,
                            internal: an,
                            renderLabelMapImage: Ft,
                            renderPseudoColorImage: Ut,
                            renderColorImage: Ot,
                            renderGrayscaleImage: Dt,
                            renderWebImage: mn,
                            renderToCanvas: fn,
                            canvasToPixel: Ce,
                            disable: Me,
                            displayImage: Pe,
                            draw: ke,
                            drawInvalidated: _e,
                            enable: $t,
                            getElementData: Z,
                            removeElementData: K,
                            getEnabledElement: l,
                            addEnabledElement: c,
                            getEnabledElementsByImageId: u,
                            getEnabledElements: d,
                            addLayer: A,
                            removeLayer: C,
                            getLayer: M,
                            getLayers: D,
                            getVisibleLayers: P,
                            setActiveLayer: k,
                            getActiveLayer: L,
                            purgeLayers: O,
                            setLayerImage: _,
                            fitToWindow: Le,
                            getDefaultViewportForImage: en,
                            getDisplayedArea: w,
                            setDefaultViewport: g,
                            getImage: tn,
                            getPixels: on,
                            getStoredPixels: nn,
                            getViewport: rn,
                            loadImage: ce,
                            loadAndCacheImage: ue,
                            registerImageLoader: de,
                            registerUnknownImageLoader: he,
                            invalidate: sn,
                            invalidateImageId: ln,
                            pageToPixel: dn,
                            pixelToCanvas: hn,
                            reset: pn,
                            resize: Oe,
                            setToPixelCoordinateSystem: Be,
                            setViewport: vn,
                            updateImage: T,
                            pixelDataToFalseColorData: z,
                            rendering: gn,
                            imageCache: ie,
                            metaData: un,
                            webGL: pt,
                            colors: j,
                            convertImageToFalseColorImage: G,
                            convertToFalseColorImage: Y,
                            restoreImage: W,
                            EVENTS: a,
                            events: i,
                            triggerEvent: I,
                            imageLoadPoolManager: we,
                            imageRetrievalPoolManager: xe,
                            RequestPoolManager: be
                        }
                    }], n = {}, e.m = t, e.c = n, e.d = function(t, n, o) {
                        e.o(t, n) || Object.defineProperty(t, n, {
                            enumerable: !0,
                            get: o
                        })
                    }, e.r = function(e) {
                        "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {
                            value: "Module"
                        }), Object.defineProperty(e, "__esModule", {
                            value: !0
                        })
                    }, e.t = function(t, n) {
                        if (1 & n && (t = e(t)), 8 & n) return t;
                        if (4 & n && "object" == typeof t && t && t.__esModule) return t;
                        var o = Object.create(null);
                        if (e.r(o), Object.defineProperty(o, "default", {
                                enumerable: !0,
                                value: t
                            }), 2 & n && "string" != typeof t)
                            for (var r in t) e.d(o, r, function(e) {
                                return t[e]
                            }.bind(null, r));
                        return o
                    }, e.n = function(t) {
                        var n = t && t.__esModule ? function() {
                            return t.default
                        } : function() {
                            return t
                        };
                        return e.d(n, "a", n), n
                    }, e.o = function(e, t) {
                        return Object.prototype.hasOwnProperty.call(e, t)
                    }, e.p = "", e(e.s = 0);

                    function e(o) {
                        var r;
                        return (n[o] || (r = n[o] = {
                            i: o,
                            l: !1,
                            exports: {}
                        }, t[o].call(r.exports, r, r.exports, e), r.l = !0, r)).exports
                    }
                    var t, n
                }()
            },
            9612: e => {
                "use strict";
                e.exports = Object
            },
            9662: e => {
                "use strict";
                e.exports = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAxlBMVEX3APz4cYj4V6D3A+T5dYT3BuH3Bej4XZv3Ra/4U6P3D9v4T6f4ZJT3GtP3OLv3AO73A/P3QbX3Kcj4a433C973FNn3JMv4fH33McL4YZf4Z5H5h3P3S6v4eYD3H9D3M7/3P7T9+B73Pbf5g3f6olv3Et/3Gtz3Hdj3Ftb3LMT5kGz84C/6m2T6rVX80Dz98yH3Cu33Hc/5i3D6mGj7sk77uk37xkH82DT97CX6plv7vkb+/hz3D+f3I9X3L8n5bJL6omL85yoC7QzSAAACeUlEQVQ4y9WSVY4cMRRFbZfLDMWMzdzT3AOh/W8qnslXlBXkyHpXeud+WJbBf0YQvMwX35ZL3UXfly/BP34uhEGs6HqKTEPDbPl3JVgKkUYdyuOwqtWpoUXSvXwZa798sWKxYmhafwMfeV1N65zp4qtBrLXL1WTCz+fz5XWG3UrOZuf6PEVpt/iwIPP8SaaHqnbsrtfcFdB+VudtC/liwQRY+2upJ5OBl9NpvZttlovvcDNtIYuyvvcGA1JfZj0jvojits2nucIt3mBeJEQIYlMOvJVJGmQ9ISmXMK9UnrcYnjyxTr0gsAaQLvVk4aVRDLkpcb3b73BstEYoTIVP5iBZ+SSbF5Sqsi8QfhvfxwfmbMEa6So2cAXPWjLEFUV91NPn+HyOt8LoQTLERE+A7qy166qRklJa4nE8HsfbIIemMSHS0gDe2GDOSqrazf2qLu/b++G4VTEs5RCyE0fghoNg0Rm6375tL2/bZ1mqn+/b62Z/eOURCSUYpwEghHz8ODwe1/vx+CNEt/df97fH4zXNSGTALxqAgLivgHazy+71sN0fnrd6M7vnJhMkm4CfJgAWzAcjOaVhw/fj8YKQhBjRKvK0ATKzgNgCVu5lSoUkOswqd8cYVbiVia9BqAmJ0gbjmK+RUmW4oapSFFGctyzRGvSZ7kzIMS4nmlHJDWQMxShiMG6iAnGgKGecI1itRYRoGPKcFQiqTjQslBWEAEMMYaxUKPzklHXRIPus6KOI0VLBNm8B/IPiLEsderUSSeL7wiiIPwH4M6EDac9PnHRDeL7v6wmN3Rr8sTFlmhDP4X/iwh1xWpsBfNqSG518OWJdEIdrONz8DcHFP4n/xvdzAAAAAElFTkSuQmCC"
            },
            9675: e => {
                "use strict";
                e.exports = TypeError
            },
            9770: (e, t, n) => {
                "use strict";
                var o;
                n.d(t, {
                        A: () => r
                    }),
                    function(e) {
                        e.Interaction = "interaction", e.Thumbnail = "thumbnail", e.Prefetch = "prefetch", e.Compute = "compute"
                    }(o || (o = {}));
                const r = o
            },
            9788: (e, t, n) => {
                "use strict";
                n.d(t, {
                    Ay: () => a,
                    FK: () => r
                });
                let o = new Map;
                const r = () => {
                        o.clear()
                    },
                    a = (e, t, ...n) => {
                        const r = o.get(e);
                        return r ? r(...n) : (o.set(e, t), t(...n))
                    }
            },
            9897: (e, t, n) => {
                "use strict";
                n.d(t, {
                    A: () => c
                });
                var o = n(4594),
                    r = n(346),
                    a = n.n(r),
                    i = n(9473),
                    s = n(2117),
                    l = n(2290);

                function c(e, t, n = "", r = "", c) {
                    return new Promise((u => {
                        const {
                            enter: d,
                            OK: h,
                            cancel: f
                        } = (0, s.Tl)("toast.prompt");
                        a().question(Object.assign({
                            class: o.A.isMobile ? "custom-iziToast-question-mobile" : "custom-iziToast-question",
                            close: !1,
                            drag: !1,
                            timeout: !1,
                            overlay: !0,
                            theme: "dark",
                            color: "unset",
                            message: e,
                            position: "center",
                            icon: "",
                            progressBar: !1,
                            inputs: [
                                [`<input type="text" value='${r}' maxLength=32 placeholder='${d}' >`, "keyup", function(e, t, n, o) {
                                    "" !== n.value && (n.placeholder = d)
                                }, !0]
                            ],
                            buttons: [
                                [`<button class='confirm' >${h}</button>`, function(e, o, r, a, s) {
                                    const {
                                        value: l
                                    } = s[0];
                                    if ((e => {
                                            let n = !0;
                                            switch ((0, i.Bc)(t)) {
                                                case "RegExp":
                                                    n = t.test(e);
                                                    break;
                                                case "function":
                                                    n = t(e);
                                                    break;
                                                default:
                                                    console.error("verification is necessary, interceptor required for RegExp or Function")
                                            }
                                            return n
                                        })(l)) return e.destroy(), void u(l);
                                    s[0].value = "", s[0].placeholder = n
                                }, !1],
                                [`<button class='cancel' >${f}</button>`, function(e, t, n, o) {
                                    e.hide({}, t, "cancel")
                                }, !1]
                            ],
                            onOpening: (e, t) => {
                                (0, l._)(t)
                            },
                            onClosing: function(e, t, n) {
                                "confirm" !== n && u(null)
                            }
                        }, c))
                    }))
                }
            },
            9957: (e, t, n) => {
                "use strict";
                var o = Function.prototype.call,
                    r = Object.prototype.hasOwnProperty,
                    a = n(6743);
                e.exports = a.call(o, r)
            }
        },
        __webpack_module_cache__ = {},
        inProgress, dataWebpackPrefix;

    function __webpack_require__(e) {
        var t = __webpack_module_cache__[e];
        if (void 0 !== t) return t.exports;
        var n = __webpack_module_cache__[e] = {
            id: e,
            loaded: !1,
            exports: {}
        };
        return __webpack_modules__[e].call(n.exports, n, n.exports, __webpack_require__), n.loaded = !0, n.exports
    }
    __webpack_require__.m = __webpack_modules__, __webpack_require__.amdD = function() {
        throw new Error("define cannot be used indirect")
    }, __webpack_require__.amdO = {}, __webpack_require__.n = e => {
        var t = e && e.__esModule ? () => e.default : () => e;
        return __webpack_require__.d(t, {
            a: t
        }), t
    }, __webpack_require__.d = (e, t) => {
        for (var n in t) __webpack_require__.o(t, n) && !__webpack_require__.o(e, n) && Object.defineProperty(e, n, {
            enumerable: !0,
            get: t[n]
        })
    }, __webpack_require__.f = {}, __webpack_require__.e = e => Promise.all(Object.keys(__webpack_require__.f).reduce(((t, n) => (__webpack_require__.f[n](e, t), t)), [])), __webpack_require__.u = e => (({
        83: "webDicomViewPrint",
        107: "webDicomViewStitching",
        385: "webDicomViewMPR"
    }[e] || e) + ".min.js"), __webpack_require__.miniCssF = e => e + ".css", __webpack_require__.g = function() {
        if ("object" == typeof globalThis) return globalThis;
        try {
            return this || new Function("return this")()
        } catch (e) {
            if ("object" == typeof window) return window
        }
    }(), __webpack_require__.o = (e, t) => Object.prototype.hasOwnProperty.call(e, t), inProgress = {}, dataWebpackPrefix = "dicom-webview:", __webpack_require__.l = (e, t, n, o) => {
        if (inProgress[e]) inProgress[e].push(t);
        else {
            var r, a;
            if (void 0 !== n)
                for (var i = document.getElementsByTagName("script"), s = 0; s < i.length; s++) {
                    var l = i[s];
                    if (l.getAttribute("src") == e || l.getAttribute("data-webpack") == dataWebpackPrefix + n) {
                        r = l;
                        break
                    }
                }
            r || (a = !0, (r = document.createElement("script")).charset = "utf-8", r.timeout = 120, __webpack_require__.nc && r.setAttribute("nonce", __webpack_require__.nc), r.setAttribute("data-webpack", dataWebpackPrefix + n), r.src = e), inProgress[e] = [t];
            var c = (t, n) => {
                    r.onerror = r.onload = null, clearTimeout(u);
                    var o = inProgress[e];
                    if (delete inProgress[e], r.parentNode && r.parentNode.removeChild(r), o && o.forEach((e => e(n))), t) return t(n)
                },
                u = setTimeout(c.bind(null, void 0, {
                    type: "timeout",
                    target: r
                }), 12e4);
            r.onerror = c.bind(null, r.onerror), r.onload = c.bind(null, r.onload), a && document.head.appendChild(r)
        }
    }, __webpack_require__.r = e => {
        "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {
            value: "Module"
        }), Object.defineProperty(e, "__esModule", {
            value: !0
        })
    }, __webpack_require__.nmd = e => (e.paths = [], e.children || (e.children = []), e), __webpack_require__.p = "/", (() => {
        if ("undefined" != typeof document) {
            var e = e => new Promise(((t, n) => {
                    var o = __webpack_require__.miniCssF(e),
                        r = __webpack_require__.p + o;
                    if (((e, t) => {
                            for (var n = document.getElementsByTagName("link"), o = 0; o < n.length; o++) {
                                var r = (i = n[o]).getAttribute("data-href") || i.getAttribute("href");
                                if ("stylesheet" === i.rel && (r === e || r === t)) return i
                            }
                            var a = document.getElementsByTagName("style");
                            for (o = 0; o < a.length; o++) {
                                var i;
                                if ((r = (i = a[o]).getAttribute("data-href")) === e || r === t) return i
                            }
                        })(o, r)) return t();
                    ((e, t, n, o, r) => {
                        var a = document.createElement("link");
                        a.rel = "stylesheet", a.type = "text/css", __webpack_require__.nc && (a.nonce = __webpack_require__.nc), a.onerror = a.onload = n => {
                            if (a.onerror = a.onload = null, "load" === n.type) o();
                            else {
                                var i = n && n.type,
                                    s = n && n.target && n.target.href || t,
                                    l = new Error("Loading CSS chunk " + e + " failed.\n(" + i + ": " + s + ")");
                                l.name = "ChunkLoadError", l.code = "CSS_CHUNK_LOAD_FAILED", l.type = i, l.request = s, a.parentNode && a.parentNode.removeChild(a), r(l)
                            }
                        }, a.href = t, n ? n.parentNode.insertBefore(a, n.nextSibling) : document.head.appendChild(a)
                    })(e, r, null, t, n)
                })),
                t = {
                    170: 0
                };
            __webpack_require__.f.miniCss = (n, o) => {
                t[n] ? o.push(t[n]) : 0 !== t[n] && {
                    83: 1,
                    107: 1
                }[n] && o.push(t[n] = e(n).then((() => {
                    t[n] = 0
                }), (e => {
                    throw delete t[n], e
                })))
            }
        }
    })(), (() => {
        var e = {
            170: 0
        };
        __webpack_require__.f.j = (t, n) => {
            var o = __webpack_require__.o(e, t) ? e[t] : void 0;
            if (0 !== o)
                if (o) n.push(o[2]);
                else {
                    var r = new Promise(((n, r) => o = e[t] = [n, r]));
                    n.push(o[2] = r);
                    var a = __webpack_require__.p + __webpack_require__.u(t),
                        i = new Error;
                    __webpack_require__.l(a, (n => {
                        if (__webpack_require__.o(e, t) && (0 !== (o = e[t]) && (e[t] = void 0), o)) {
                            var r = n && ("load" === n.type ? "missing" : n.type),
                                a = n && n.target && n.target.src;
                            i.message = "Loading chunk " + t + " failed.\n(" + r + ": " + a + ")", i.name = "ChunkLoadError", i.type = r, i.request = a, o[1](i)
                        }
                    }), "chunk-" + t, t)
                }
        };
        var t = (t, n) => {
                var o, r, [a, i, s] = n,
                    l = 0;
                if (a.some((t => 0 !== e[t]))) {
                    for (o in i) __webpack_require__.o(i, o) && (__webpack_require__.m[o] = i[o]);
                    if (s) s(__webpack_require__)
                }
                for (t && t(n); l < a.length; l++) r = a[l], __webpack_require__.o(e, r) && e[r] && e[r][0](), e[r] = 0
            },
            n = Object("undefined" != typeof self ? self : this).webpackChunkdicom_webview = Object("undefined" != typeof self ? self : this).webpackChunkdicom_webview || [];
        n.forEach(t.bind(null, 0)), n.push = t.bind(null, n.push.bind(n))
    })();
    var __webpack_exports__ = {};
    return (() => {
        "use strict";
        __webpack_require__.d(__webpack_exports__, {
            default: () => zt
        });
        var e = __webpack_require__(4508),
            t = __webpack_require__(3678),
            n = __webpack_require__(5915),
            o = __webpack_require__.n(n),
            r = __webpack_require__(9584),
            a = __webpack_require__.n(r),
            i = __webpack_require__(1706),
            s = __webpack_require__(7185),
            l = __webpack_require__(1948),
            c = __webpack_require__(6581),
            u = __webpack_require__(8398),
            d = __webpack_require__(6613),
            h = __webpack_require__(2881),
            f = __webpack_require__(4594),
            m = __webpack_require__(8319),
            g = __webpack_require__(2117),
            p = function(e, t, n, o) {
                return new(n || (n = Promise))((function(r, a) {
                    function i(e) {
                        try {
                            l(o.next(e))
                        } catch (e) {
                            a(e)
                        }
                    }

                    function s(e) {
                        try {
                            l(o.throw(e))
                        } catch (e) {
                            a(e)
                        }
                    }

                    function l(e) {
                        var t;
                        e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                            e(t)
                        }))).then(i, s)
                    }
                    l((o = o.apply(e, t || [])).next())
                }))
            };
        a()._renderWebImage = r.renderWebImage, a().renderWebImage = void 0, a().Enums = i, a().canRenderFloatTextures = s.lk;
        const v = XMLHttpRequest.prototype,
            y = v.open;
        v.open = function(e, t, n, o, r) {
            this._url = t, y.apply(this, [e, t, !!n, o, r])
        };
        (0, u.m_)();
        const b = .5 * (navigator.hardwareConcurrency || 1) - (f.A.systemInfo.performanceLevel < 1 ? 1 : 0);

        function w() {
            switch (l.external.cornerstone = a(), l.external.dicomParser = o(), f.A.imageType) {
                case -1:
                case 0:
                    (0, c.wj)(r.registerImageLoader), (0, c.Up)(r.registerImageLoader)
            }
        }(0, l.configure)({
            useWebWorkers: !0,
            strict: !1,
            decodeConfig: {
                convertFloatPixelDataToInt: !1,
                use16BitDataType: !0
            },
            beforeSend: (e, t, n, o) => p(void 0, void 0, void 0, (function*() {
                e._send = e.send, e.send = () => {}, e.timeout = 6e4;
                try {
                    const n = yield(t = e._url, p(void 0, void 0, void 0, (function*() {
                        const {
                            DBCacheImages: e,
                            imageType: n
                        } = f.A, {
                            indexedDBKey: o
                        } = (0, d.A)(t, n);
                        if (e.enable || e.temporaryEnable) {
                            yield m.A.open();
                            const e = yield m.A.dispatch("get", {
                                mode: "readonly"
                            }, o);
                            if (e) return e;
                            throw {
                                indexedDBKey: o
                            }
                        }
                        throw {
                            indexedDBKey: o
                        }
                    })));
                    o.deferred.resolve(n), e = null
                } catch (t) {
                    (e => {
                        e.addEventListener("error", (e => {
                            const {
                                acquisitionFailed: t,
                                networkDis: n
                            } = (0, g.Tl)("toast.loadAndCacheImage");
                            (0, h.A)("xhrError", navigator.onLine ? t : n), console.error(e)
                        })), e.addEventListener("timeout", (() => {
                            const {
                                acquisitionFailed: e
                            } = (0, g.Tl)("toast.loadAndCacheImage");
                            (0, h.A)("xhrTimeout", e)
                        }))
                    })(e), e.addEventListener("load", (() => p(void 0, void 0, void 0, (function*() {
                        try {
                            const {
                                indexedDBKey: n
                            } = t;
                            yield m.A.open(), n && e.response.byteLength && m.A.dispatch("put", {}, e.response, n)
                        } catch (e) {
                            console.error(e)
                        }
                        e = null
                    })))), e._send()
                }
                var t
            }))
        }), l.webWorkerManager.initialize({
            maxWebWorkers: Math.max(Math.floor(b), 1),
            startWebWorkersOnDemand: !0,
            taskConfiguration: {
                decodeTask: {
                    initializeCodecsOnStartup: !0,
                    strict: !1,
                    loadCodecsOnStartup: !0
                },
                decodingoldPlatformImages: {}
            },
            webWorkerTaskPaths: ["./encryptionPngDecode.worker.js"]
        });
        __webpack_require__(7510);
        var x = __webpack_require__(5947);
        (0, x.configure)({
            parent: ".viewerContentWrapper"
        });
        var T = __webpack_require__(2290),
            I = __webpack_require__(346),
            E = __webpack_require__.n(I),
            S = __webpack_require__(9473);
        const A = function() {
            const e = function() {
                try {
                    const e = navigator.userAgent.toLowerCase();
                    if (/(win32|wow32|x86|x32)/.test(e)) return 32;
                    if (/(win64|wow64|x64)/.test(e)) return 64;
                    if (new ActiveXObject("Wscript.Shell").RegRead("HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Environment\\PROCESSOR_ARCHITECTURE").toLowerCase().indexOf("32") >= 0) return 32
                } catch (e) {}
            }();
            let t = !1;
            console.info("systemInfo", {
                performance,
                navigator,
                screen,
                history,
                location,
                window,
                systemArchitecture: e
            }), (navigator.hardwareConcurrency || 1) <= 2 && (E().info({
                title: (0, g.Tl)("toast.concurrencyLow"),
                timeout: 0
            }), console.warn("hardwareConcurrency <= 2")), 32 === e && (E().info({
                title: (0, g.Tl)("toast.is32System"),
                timeout: 0
            }), console.warn("is32System")), (0, u.iP)() || (t = !0, console.warn("StaticBlock is not supported")), (0, u.m_)() || (t = !0, console.warn("OffscreenCanvas is not supported")), (0, u.jk)("OES_texture_float_linear") || (!(0, S._K)().isIphone && (t = !0), console.warn("OES_texture_float_linear is not supported")), void 0 === __webpack_require__.g.structuredClone && (t = !0, __webpack_require__.g.structuredClone = e => JSON.parse(JSON.stringify(e))), t && E().info({
                title: (0, g.Tl)("toast.kernelVersionLow"),
                timeout: 0
            })
        };
        __webpack_require__.p = (0, e.A)(), A();
        var C = __webpack_require__(6402),
            M = __webpack_require__(281),
            D = __webpack_require__(8712),
            P = __webpack_require__(226);
        const k = new S.PC,
            _ = () => {
                const e = (0, g.Tl)("tools"),
                    t = (0, g.Z0)().includes("zh");
                return {
                    main: [{
                        toolName: e.seriesBar,
                        toolTag: "seriesBar",
                        icon: "icon-dicom-side",
                        disActive: !0,
                        visibility: () => f.A.isMobile && f.A.toolsBar.seriesBarVisibility
                    }, {
                        toolName: e.MPR,
                        toolTag: "MPR",
                        icon: "icon-dicom-MPR",
                        disActive: !0,
                        visibility: () => f.A.toolsBar.MPRVisibility
                    }, {
                        toolName: e["3D"],
                        toolTag: "VRT",
                        icon: "icon-dicom-3D",
                        disActive: !0,
                        visibility: () => f.A.toolsBar.VRTVisibility
                    }, {
                        toolName: e.fusion,
                        toolTag: "fusion",
                        icon: "icon-dicom-fused",
                        disActive: !0,
                        visibility: () => f.A.toolsBar.MPRFusionVisibility
                    }, {
                        toolName: e.AI,
                        toolTag: "AI",
                        icon: "icon-dicom-ai",
                        isToggle: !0,
                        visibility: () => f.A.toolsBar.AIVisibility && !(0, S.TB)(f.A.instanceOptions.AI)
                    }, {
                        toolName: () => (0, P.O)()[f.A.imageType + 1],
                        toolTag: "imageType",
                        icon: () => ["icon-dicom-mode3", "icon-dicom-mode1", "icon-dicom-mode2"][f.A.imageType + 1],
                        disActive: !0,
                        select: !0,
                        visibility: () => f.A.toolsBar.imageModeVisibility
                    }, {
                        toolName: e.reload,
                        toolTag: "reload",
                        icon: "icon-dicom-reload",
                        disActive: !0
                    }, {
                        toolName: e.release,
                        toolTag: "disableAllTool",
                        icon: "icon-dicom-release"
                    }, {
                        toolName: e.restore,
                        toolTag: "cancelToolAndDefaultViewport",
                        icon: "icon-dicom-restore",
                        disActive: !0
                    }, {
                        toolName: e.stackScroll,
                        toolTag: "stackScroll",
                        icon: "icon-dicom-paging",
                        visibility: () => f.A.isMobile
                    }, {
                        toolName: e.modulation,
                        toolTag: "modulation",
                        icon: "icon-dicom-tiaochuang",
                        select: !0
                    }, {
                        toolName: e.modulationPreset,
                        toolTag: "modulationMenu",
                        icon: "icon-dicom-tiaochuang2",
                        select: !0
                    }, {
                        toolName: e.pan,
                        toolTag: "pan",
                        icon: "icon-dicom-move",
                        visibility: () => !f.A.isMobile
                    }, {
                        toolName: e.seriesLayout,
                        toolTag: "series",
                        icon: "icon-dicom-series",
                        disActive: !0,
                        select: !0
                    }, {
                        toolName: e.imagesLayout,
                        toolTag: "image",
                        icon: "icon-dicom-layout",
                        disActive: !0,
                        select: !0
                    }, {
                        toolName: e.magnifier,
                        toolTag: "magnify",
                        icon: "icon-dicom-magnifier"
                    }, {
                        toolName: e.player,
                        toolTag: "player",
                        icon: "icon-dicom-play",
                        isToggle: !0
                    }, {
                        toolName: e.rotate,
                        toolTag: "rotate",
                        icon: "icon-dicom-rotate",
                        select: !0
                    }, {
                        toolName: e.invert,
                        toolTag: "invert",
                        disActive: !0,
                        icon: "icon-dicom-negative"
                    }, {
                        toolName: e.zoom,
                        toolTag: "zoom",
                        icon: "icon-dicom-scale",
                        select: !0,
                        visibility: () => !f.A.isMobile
                    }, {
                        toolName: e.measure,
                        toolTag: "measureGroup",
                        icon: "icon-dicom-measure"
                    }, {
                        toolName: e.length,
                        toolTag: "length",
                        icon: "icon-dicom-line"
                    }, {
                        toolName: e.freehandRoi,
                        toolTag: "freehandRoi",
                        icon: "icon-dicom-curve"
                    }, {
                        toolName: e.angle,
                        toolTag: "angle",
                        icon: "icon-dicom-angle"
                    }, {
                        toolName: e.cobbAngle,
                        toolTag: "cobbAngle",
                        icon: "icon-dicom-cobb"
                    }, {
                        toolName: e.rectangleRoi,
                        toolTag: "rectangleRoi",
                        icon: "icon-dicom-rectangle"
                    }, {
                        toolName: e.ellipticalRoi,
                        toolTag: "ellipticalRoi",
                        icon: "icon-dicom-round"
                    }, {
                        toolName: e.circleRoi,
                        toolTag: "circleRoi",
                        icon: "icon-dicom-round",
                        visibility: !1
                    }, {
                        toolName: e.probeCT,
                        toolTag: "probeCT",
                        icon: "icon-dicom-ct"
                    }, {
                        toolName: e.annotate,
                        toolTag: "annotateGroup",
                        icon: "icon-dicom-annotate"
                    }, {
                        toolName: e.annotateText,
                        toolTag: "annotateText",
                        icon: "icon-dicom-text"
                    }, {
                        toolName: e.annotateArrow,
                        toolTag: "annotateArrow",
                        icon: "icon-dicom-one-line-arrow"
                    }, {
                        toolName: e.markerL,
                        toolTag: "markerL",
                        icon: "icon-dicom-L"
                    }, {
                        toolName: e.markerR,
                        toolTag: "markerR",
                        icon: "icon-dicom-R"
                    }, {
                        toolName: e.saveLabels,
                        toolTag: "saveLabels",
                        icon: "icon-dicom-labels-save",
                        disActive: !0,
                        visibility: () => f.A.instanceOptions.syncLabels
                    }, {
                        toolName: e.visibilityLabels,
                        toolTag: "visibilityLabels",
                        icon: "icon-dicom-labels-hidden",
                        isToggle: !0
                    }, {
                        toolName: e.deleteLabel,
                        toolTag: "eraser",
                        icon: "icon-dicom-rubber"
                    }, {
                        toolName: e.cancelLabels,
                        toolTag: "cancelToolState",
                        icon: "icon-dicom-clean",
                        disActive: !0
                    }, {
                        toolName: e.enhance,
                        toolTag: "enhanceGroup",
                        icon: "icon-dicom-enhance",
                        visibility: () => f.A.toolsBar.enhanceVisibility,
                        disChildrenCustom: !0,
                        isLonelyGroup: !0,
                        disActive: !0,
                        children: [{
                            toolName: e.sharpen,
                            toolTag: "sharpen",
                            icon: "icon-dicom-sharpen",
                            isLonelyGroup: !0,
                            children: [{
                                toolName: e.sharpenDefault,
                                toolTag: "sharpenDefault",
                                toolType: "x0",
                                isActive: !0
                            }, {
                                toolName: e.sharpenHeight,
                                toolTag: "sharpenHeight",
                                toolType: "x6"
                            }, {
                                toolName: e.sharpenMedium,
                                toolTag: "sharpenMedium",
                                toolType: "x4"
                            }, {
                                toolName: e.sharpenLow,
                                toolTag: "sharpenLow",
                                toolType: "x2"
                            }]
                        }, {
                            toolName: e.blur,
                            toolTag: "blur",
                            icon: "icon-dicom-blur",
                            isLonelyGroup: !0,
                            children: [{
                                toolName: e.blurDefault,
                                toolTag: "blurDefault",
                                toolType: "x0",
                                isActive: !0
                            }, {
                                toolName: e.blurHeight,
                                toolTag: "blurHeight",
                                toolType: "x6"
                            }, {
                                toolName: e.blurMedium,
                                toolTag: "blurMedium",
                                toolType: "x4"
                            }, {
                                toolName: e.blurLow,
                                toolTag: "blurLow",
                                toolType: "x2"
                            }]
                        }]
                    }, {
                        toolName: e.colorMap,
                        toolTag: "colorMap",
                        disActive: !0,
                        icon: "icon-dicom-color-map",
                        select: !0
                    }, {
                        toolName: e.referenceLine,
                        toolTag: "referenceLine",
                        isToggle: !0,
                        icon: "icon-dicom-referenceLine"
                    }, {
                        toolName: e.CTR,
                        toolTag: "CTR",
                        icon: "icon-dicom-CTR"
                    }, {
                        toolName: e.crosshairs2D,
                        toolTag: "crosshairs",
                        icon: "icon-dicom-aim"
                    }, {
                        toolName: e.imageStitching,
                        toolTag: "imageStitching",
                        icon: "icon-dicom-stitching",
                        disActive: !0
                    }, {
                        toolName: e.print,
                        toolTag: "print",
                        icon: "icon-dicom-print",
                        disActive: !0,
                        visibility: () => f.A.toolsBar.printVisibility
                    }, {
                        toolName: e.synchronizer,
                        toolTag: "stackImageSynchronizeMode",
                        icon: "icon-dicom-sync-mode",
                        isLonelyGroup: !0,
                        disChildrenCustom: !0,
                        disActive: !0,
                        children: [{
                            toolName: e.stackIndexSynchronizer,
                            toolTag: "stackIndexSynchronizer",
                            icon: "icon-dicom-sync-index",
                            isActive: "stackIndexSynchronizer" === f.A.tackSynchronizerType
                        }, {
                            toolName: e.stackPositionSynchronizer,
                            toolTag: "stackPositionSynchronizer",
                            icon: "icon-dicom-sync-position",
                            isActive: "stackPositionSynchronizer" === f.A.tackSynchronizerType
                        }, {
                            toolName: e.stackScrollSynchronizer,
                            toolTag: "stackScrollSynchronizer",
                            icon: "icon-dicom-sync-scroll",
                            isActive: "stackScrollSynchronizer" === f.A.tackSynchronizerType
                        }]
                    }, {
                        toolName: e.more,
                        toolTag: "moreGroup",
                        icon: "icon-dicom-more",
                        isLonelyGroup: !0
                    }, {
                        toolName: e.DICOMInfo,
                        toolTag: "DICOMMetaInfo",
                        disActive: !0,
                        icon: "icon-dicom-info"
                    }, {
                        toolName: e.aroundInfo,
                        toolTag: "cavanAroundInfo",
                        isToggle: !0,
                        isActive: f.A.cavanAroundInfo,
                        icon: "icon-dicom-show"
                    }, {
                        toolName: e.disSeries,
                        toolTag: "disSeries",
                        icon: "icon-dicom-delete",
                        disActive: !0
                    }, {
                        toolName: e.saveImage,
                        toolTag: "saveImage",
                        icon: "icon-dicom-img-save",
                        disActive: !0
                    }, {
                        toolName: e.markersImage,
                        toolTag: "markersImage",
                        icon: "icon-dicom-key-image-save",
                        disActive: !0,
                        visibility: () => f.A.instanceOptions.syncMarkersImage
                    }, {
                        toolName: e.useCacheImage,
                        toolTag: "useCacheImage",
                        icon: "icon-dicom-save",
                        isToggle: !0,
                        isActive: f.A.DBCacheImages.enable
                    }, {
                        toolName: e.imageCacheType,
                        toolTag: "imageCacheType",
                        icon: "icon-dicom-speed",
                        isToggle: !0,
                        isActive: 1 === f.A.imageCacheTypeDefault
                    }, {
                        toolName: "Language",
                        toolTag: "languageGroup",
                        icon: "icon-dicom-language",
                        isLonelyGroup: !0,
                        disChildrenCustom: !0,
                        disActive: !0,
                        children: [...Object.entries(__webpack_require__.g.webDicomViewLocal).map((([e, {
                            name: t,
                            language: n
                        }]) => ({
                            toolName: t,
                            toolType: n,
                            toolTag: "setLanguage",
                            isActive: (0, g.Z0)() == n,
                            visibility: "default" !== e
                        })))],
                        visibility: () => f.A.toolsBar.languageVisibility
                    }, {
                        toolName: e.aboutUs,
                        toolTag: "aboutUs",
                        icon: "icon-dicom-about",
                        disActive: !0,
                        floatRight: !0,
                        visibility: () => f.A.toolsBar.aboutUsVisibility
                    }],
                    MPR: [{
                        toolName: e["2D"],
                        toolTag: "MPRReload2D",
                        icon: "icon-dicom-2D",
                        disActive: !0
                    }, {
                        toolName: e["3D"],
                        toolTag: "VRT",
                        icon: "icon-dicom-3D",
                        disActive: !0,
                        visibility: () => f.A.toolsBar.VRTVisibility
                    }, {
                        toolName: e.fusion,
                        toolTag: "MPRFusion",
                        icon: "icon-dicom-fused",
                        select: !0,
                        disActive: !0
                    }, {
                        toolName: e.stackScroll,
                        toolTag: "MPRStackScroll",
                        icon: "icon-dicom-paging",
                        visibility: () => f.A.isMobile
                    }, {
                        toolName: e.crosshairs,
                        toolTag: "MPRCrosshairs",
                        icon: "icon-dicom-aim"
                    }, {
                        toolName: e.pan,
                        toolTag: "MPRPan",
                        icon: "icon-dicom-move",
                        visibility: !1
                    }, {
                        toolName: e.modulation,
                        toolTag: "MPRModulation",
                        icon: "icon-dicom-tiaochuang",
                        select: !0
                    }, {
                        toolName: e.modulationPreset,
                        toolTag: "MPRModulationMenu",
                        icon: "icon-dicom-tiaochuang2",
                        select: !0
                    }, {
                        toolName: e.zoom,
                        toolTag: "MPRZoom",
                        icon: "icon-dicom-scale",
                        visibility: () => !f.A.isMobile
                    }, {
                        toolName: e.reset,
                        toolTag: "MPRReset",
                        icon: "icon-dicom-reload",
                        disActive: !0
                    }, {
                        toolName: e.blendModes,
                        toolTag: "blendGroup",
                        icon: "icon-dicom-projection",
                        isLonelyGroup: !0,
                        disChildrenCustom: !0,
                        disActive: !0,
                        children: [{
                            toolName: e.blendMax,
                            toolTag: "MPRMaxIntensity"
                        }, {
                            toolName: e.blendMin,
                            toolTag: "MPRMinIntensity"
                        }, {
                            toolName: e.blendAverage,
                            toolTag: "MPRAverageIntensity"
                        }, {
                            toolName: e.blendComposite,
                            toolTag: "MPRComposite",
                            isActive: !0
                        }]
                    }, {
                        toolName: e.thickness,
                        toolTag: "MPRThickness",
                        icon: "icon-dicom-thickness",
                        isLonelyGroup: !0,
                        select: !0
                    }, {
                        toolName: e.volume,
                        toolTag: "MPRVolume",
                        icon: "icon-dicom-volume",
                        isToggle: !0
                    }, {
                        toolName: e.viewportPresets,
                        toolTag: "MPRViewportPresets",
                        icon: "icon-dicom-color-map",
                        isLonelyGroup: !0,
                        disChildrenCustom: !0,
                        children: [{
                            toolName: e.viewportPresetsDefault,
                            toolType: "default",
                            toolTag: "MPRApplyPreset"
                        }, ...D.Ay.map((({
                            type: e,
                            name: n
                        }) => ({
                            toolName: t && n || e,
                            toolType: e,
                            toolTag: "MPRApplyPreset"
                        })))]
                    }, {
                        toolName: e.fusionLayout,
                        toolTag: "MPRFusionLayout",
                        icon: "icon-dicom-layout",
                        isLonelyGroup: !0,
                        disChildrenCustom: !0,
                        disActive: !0,
                        children: [{
                            toolName: e.fusionLayoutDefault,
                            toolType: "ACS9",
                            toolTag: "MPRApplyFusionLayout",
                            isActive: !f.A.isMobile
                        }, {
                            toolName: e.fusionLayoutCoronal,
                            toolType: "coronal",
                            toolTag: "MPRApplyFusionLayout",
                            isActive: f.A.isMobile
                        }, {
                            toolName: e.fusionLayoutSagittal,
                            toolType: "sagittal",
                            toolTag: "MPRApplyFusionLayout"
                        }, {
                            toolName: e.fusionLayoutAxial,
                            toolType: "axial",
                            toolTag: "MPRApplyFusionLayout"
                        }]
                    }, {
                        toolName: e.quality,
                        toolTag: "MPRLevel",
                        icon: "icon-dicom-picture-quality2",
                        disActive: !0,
                        visibility: () => !1 === f.A.instanceOptions.losslessMPR
                    }],
                    VRT: [{
                        toolName: e["2D"],
                        toolTag: "VTRReload2D",
                        icon: "icon-dicom-2D",
                        disActive: !0
                    }, {
                        toolName: e.MPR,
                        toolTag: "MPR",
                        icon: "icon-dicom-MPR",
                        disActive: !0,
                        visibility: () => f.A.toolsBar.MPRVisibility
                    }, {
                        toolName: e.rotate,
                        toolTag: "VRTRotate",
                        icon: "icon-dicom-rotate3d",
                        visibility: () => f.A.isMobile
                    }, {
                        toolName: e.VRTModulation,
                        toolTag: "VRTModulation",
                        icon: "icon-dicom-tiaochuang",
                        visibility: () => f.A.isMobile
                    }, {
                        toolName: e.knifeIn,
                        toolTag: "VRTKnifeIn",
                        icon: "icon-dicom-shoushudao1"
                    }, {
                        toolName: e.knifeOut,
                        toolTag: "VRTKnifeOut",
                        icon: "icon-dicom-shoushudao"
                    }, {
                        toolName: e.reset,
                        toolTag: "VRTReset",
                        icon: "icon-dicom-reload",
                        disActive: !0
                    }]
                }
            },
            L = () => k.get(_);
        var O = function(e, t) {
            var n = {};
            for (var o in e) Object.prototype.hasOwnProperty.call(e, o) && t.indexOf(o) < 0 && (n[o] = e[o]);
            if (null != e && "function" == typeof Object.getOwnPropertySymbols) {
                var r = 0;
                for (o = Object.getOwnPropertySymbols(e); r < o.length; r++) t.indexOf(o[r]) < 0 && Object.prototype.propertyIsEnumerable.call(e, o[r]) && (n[o[r]] = e[o[r]])
            }
            return n
        };
        const R = new S.PC,
            N = () => {
                const e = (0, g.Tl)("tools");
                return {
                    main: [{
                        toolName: e.MPR
                    }, {
                        toolName: e["3D"]
                    }, {
                        toolName: e.fusion
                    }, {
                        toolName: e.AI
                    }, {
                        toolTag: "imageType"
                    }, {
                        toolName: e.reload
                    }, {
                        toolName: e.release
                    }, {
                        toolName: e.restore,
                        divider: !0
                    }, {
                        toolName: e.modulation
                    }, {
                        toolName: e.pan
                    }, {
                        toolName: e.seriesLayout
                    }, {
                        toolName: e.imagesLayout
                    }, {
                        toolName: e.magnifier
                    }, {
                        toolName: e.player
                    }, {
                        toolName: e.rotate
                    }, {
                        toolName: e.invert
                    }, {
                        toolName: e.zoom,
                        divider: !0
                    }, {
                        toolName: e.measure,
                        children: [{
                            toolName: e.length
                        }, {
                            toolName: e.freehandRoi,
                            toolNameAlias: e.freehandRoi
                        }, {
                            toolName: e.angle
                        }, {
                            toolName: e.cobbAngle
                        }, {
                            toolName: e.rectangleRoi
                        }, {
                            toolName: e.ellipticalRoi
                        }, {
                            toolName: e.probeCT
                        }]
                    }, {
                        toolName: e.annotate,
                        children: [{
                            toolName: e.annotateText
                        }, {
                            toolName: e.annotateArrow
                        }, {
                            toolName: e.markerL
                        }, {
                            toolName: e.markerR
                        }]
                    }, {
                        toolName: e.saveLabels
                    }, {
                        toolName: e.visibilityLabels
                    }, {
                        toolName: e.deleteLabel
                    }, {
                        toolName: e.cancelLabels,
                        divider: !0
                    }, {
                        toolName: e.synchronizer
                    }, {
                        toolName: e.enhance
                    }, {
                        toolName: e.colorMap
                    }, {
                        toolName: e.referenceLine
                    }, {
                        toolName: e.CTR
                    }, {
                        toolName: e.crosshairs2D
                    }, {
                        toolName: e.imageStitching
                    }, {
                        toolName: e.print,
                        divider: !0
                    }, {
                        toolName: "Language"
                    }, {
                        toolName: e.more,
                        children: [{
                            toolName: e.DICOMInfo
                        }, {
                            toolName: e.aroundInfo
                        }, {
                            toolName: e.disSeries
                        }, {
                            toolName: e.saveImage
                        }, {
                            toolName: e.markersImage
                        }, {
                            toolName: e.useCacheImage
                        }, {
                            toolName: e.imageCacheType
                        }]
                    }, {
                        toolName: e.aboutUs
                    }],
                    MPR: [{
                        toolName: e["2D"]
                    }, {
                        toolName: e["3D"]
                    }, {
                        toolName: e.fusion
                    }, {
                        toolName: e.stackScroll
                    }, {
                        toolName: e.crosshairs
                    }, {
                        toolName: e.pan
                    }, {
                        toolName: e.modulation
                    }, {
                        toolName: e.zoom
                    }, {
                        toolName: e.blendModes
                    }, {
                        toolName: e.thickness
                    }, {
                        toolName: e.reset,
                        divider: !0
                    }, {
                        toolName: e.volume
                    }, {
                        toolName: e.viewportPresets,
                        divider: !0
                    }, {
                        toolName: e.fusionLayout
                    }, {
                        toolName: e.quality
                    }],
                    VRT: [{
                        toolName: e["2D"]
                    }, {
                        toolName: e.MPR
                    }, {
                        toolName: e.rotate
                    }, {
                        toolName: e.VRTModulation
                    }, {
                        toolName: e.knifeIn
                    }, {
                        toolName: e.knifeOut
                    }, {
                        toolName: e.reset
                    }]
                }
            },
            U = () => {
                const e = (0, g.Tl)("tools");
                return {
                    main: [{
                        toolName: e.seriesBar
                    }, {
                        toolName: e.modulation,
                        select: !1
                    }, {
                        toolName: e.modulationPreset
                    }, {
                        toolName: e.stackScroll
                    }, {
                        toolName: e.MPR
                    }, {
                        toolName: e.measure,
                        children: [{
                            toolName: e.length
                        }, {
                            toolName: e.freehandRoi,
                            toolNameAlias: e.freehandRoi
                        }, {
                            toolName: e.angle
                        }, {
                            toolName: e.cobbAngle
                        }, {
                            toolName: e.rectangleRoi
                        }, {
                            toolName: e.ellipticalRoi,
                            divider: !0
                        }, {
                            toolName: e.CTR
                        }, {
                            toolName: e.referenceLine,
                            divider: !0
                        }, {
                            toolName: e.probeCT
                        }, {
                            toolName: e.annotateText
                        }, {
                            toolName: e.annotateArrow
                        }, {
                            toolName: e.markerL
                        }, {
                            toolName: e.markerR,
                            divider: !0
                        }, {
                            toolName: e.saveLabels
                        }, {
                            toolName: e.visibilityLabels
                        }, {
                            toolName: e.deleteLabel
                        }, {
                            toolName: e.cancelLabels
                        }]
                    }, {
                        toolName: e.major,
                        toolTag: "majorGroup",
                        icon: "icon-dicom-box",
                        children: [{
                            toolName: e.reload
                        }, {
                            toolName: e.release
                        }, {
                            toolName: e.restore,
                            divider: !0
                        }, {
                            toolName: e["3D"]
                        }, {
                            toolName: e.crosshairs2D
                        }, {
                            toolName: e.fusion
                        }, {
                            toolName: e.AI,
                            divider: !0
                        }, {
                            toolName: e.rotate
                        }, {
                            toolName: e.magnifier
                        }, {
                            toolName: e.invert
                        }, {
                            toolName: e.colorMap
                        }, {
                            toolName: e.player,
                            divider: !0
                        }, {
                            toolName: e.seriesLayout
                        }, {
                            toolName: e.imagesLayout
                        }]
                    }, {
                        toolName: e.enhance
                    }, {
                        toolName: "Language"
                    }, {
                        toolName: e.more,
                        floatRight: !0,
                        children: [{
                            toolTag: "imageType"
                        }, {
                            toolName: e.synchronizer
                        }, {
                            toolName: e.DICOMInfo
                        }, {
                            toolName: e.aroundInfo
                        }, {
                            toolName: e.disSeries
                        }, {
                            toolName: e.saveImage
                        }, {
                            toolName: e.markersImage
                        }, {
                            toolName: e.useCacheImage
                        }, {
                            toolName: e.imageCacheType
                        }, {
                            toolName: e.aboutUs
                        }]
                    }],
                    MPR: [{
                        toolName: e["2D"]
                    }, {
                        toolName: e["3D"]
                    }, {
                        toolName: e.fusion
                    }, {
                        toolName: e.stackScroll
                    }, {
                        toolName: e.crosshairs
                    }, {
                        toolName: e.pan
                    }, {
                        toolName: e.modulation
                    }, {
                        toolName: e.blendModes
                    }, {
                        toolName: e.thickness
                    }, {
                        toolName: e.reset,
                        divider: !0
                    }, {
                        toolName: e.volume
                    }, {
                        toolName: e.viewportPresets
                    }, {
                        toolName: e.fusionLayout
                    }, {
                        toolName: e.quality
                    }],
                    VRT: [{
                        toolName: e["2D"]
                    }, {
                        toolName: e.MPR
                    }, {
                        toolName: e.rotate
                    }, {
                        toolName: e.VRTModulation
                    }, {
                        toolName: e.knifeIn
                    }, {
                        toolName: e.knifeOut
                    }, {
                        toolName: e.reset
                    }]
                }
            },
            B = (e, t, n, o = !1) => {
                const r = L()[t],
                    a = [];
                for (const i of e()) {
                    const {
                        toolName: e,
                        toolTag: s,
                        children: l
                    } = i, c = O(i, ["toolName", "toolTag", "children"]);
                    let u = r.find((t => s ? t.toolTag === s : t.toolName === e));
                    if (s || e || console.warn('"toolTag" or "toolName" is require:', i), !u && l && (u = Object.assign({}, i)), u) {
                        if (o && (l && console.warn("Multi-layer menu is not recommended, which affects the interactive experience.", l), (u.children || u.select) && console.warn("Nesting of menus is not recommended, which affects the interactive experience.", u)), l) {
                            const e = B((() => l), t, n, !0);
                            e && (u.children = e)
                        }
                        a.push(Object.assign(Object.assign({}, n ? n(u) : u), c))
                    }
                }
                return a
            },
            V = () => R.get(f.A.isMobile ? U : N),
            F = e => {
                var t, n;
                void 0 === e && (e = Object.keys(__webpack_require__.g.webDicomViewLocal).length > 2 && !(!f.A.instanceOptions.languageDefault && !(null === (n = null === (t = f.A.instanceOptions) || void 0 === t ? void 0 : t.toolsBar) || void 0 === n ? void 0 : n.languageVisibility)));
                const o = R.get(U),
                    r = R.get(N);
                if (console.info(e ? "Return to i18n menu" : "Return to zh-CN menu"), !e) return {
                    mobile: o,
                    PC: r
                };
                const a = e => ((e, ...t) => {
                    const n = {};
                    (e = Object.assign({}, e)).disChildrenCustom && delete e.children, e.toolTag || console.warn('"toolTag" is require:', e);
                    for (const o of t) {
                        const t = e[o];
                        t && "function" != typeof t && (n[o] = e[o])
                    }
                    return n
                })(e, "toolName", "toolTag", "children");
                return {
                    mobile: {
                        main: B((() => o.main), "main", a),
                        MPR: B((() => o.MPR), "MPR", a),
                        VRT: B((() => o.VRT), "VRT", a)
                    },
                    PC: {
                        main: B((() => r.main), "main", a),
                        MPR: B((() => r.MPR), "MPR", a),
                        VRT: B((() => r.VRT), "VRT", a)
                    }
                }
            },
            H = () => B((() => f.A.toolsBar.customMenu.main || V().main), "main"),
            q = () => B((() => f.A.toolsBar.customMenu.MPR || V().MPR), "MPR"),
            j = () => B((() => f.A.toolsBar.customMenu.VRT || V().VRT), "VRT");
        var z = __webpack_require__(334);

        function W(e) {
            "Error: element not enabled" !== (null == e ? void 0 : e.toString()) && console.error(e)
        }
        var G = function(e, t, n, o) {
            return new(n || (n = Promise))((function(r, a) {
                function i(e) {
                    try {
                        l(o.next(e))
                    } catch (e) {
                        a(e)
                    }
                }

                function s(e) {
                    try {
                        l(o.throw(e))
                    } catch (e) {
                        a(e)
                    }
                }

                function l(e) {
                    var t;
                    e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                        e(t)
                    }))).then(i, s)
                }
                l((o = o.apply(e, t || [])).next())
            }))
        };
        const Y = (0, M.importInternal)("util/triggerEvent"),
            Z = {
                x: null,
                y: null
            },
            K = {
                client: Z,
                page: Z
            },
            X = e => {
                try {
                    if (!e) return;
                    const {
                        image: t
                    } = (0, r.getEnabledElement)(e), n = f.A.isMobile ? [M.EVENTS.TOUCH_DRAG, M.EVENTS.TOUCH_END] : [M.EVENTS.MOUSE_UP], {
                        mode: o,
                        args: [a, i]
                    } = M.store.state.globalToolChangeHistory.slice(-1)[0] || {};
                    if ("active" !== o || !i.mouseButtonMask.includes(1)) return;
                    switch (a) {
                        case "Wwwc":
                        case "Rotate":
                            break;
                        case "FreehandRoi":
                            (0, M.getToolForElement)(e, "FreehandRoi").cancelDrawing(e);
                            break;
                        default:
                            n.forEach((n => {
                                Y(e, n, {
                                    image: t,
                                    element: e,
                                    startPoints: K,
                                    lastPoints: K,
                                    currentPoints: K,
                                    deltaPoints: K,
                                    type: n,
                                    isTouchEvent: !0
                                })
                            }))
                    }
                } catch (e) {
                    W(e)
                }
            },
            J = () => G(void 0, void 0, void 0, (function*() {
                for (const {
                        element: e
                    } of (0, r.getEnabledElements)()) X(e);
                yield(0, u.uk)(), M.store.state.isToolLocked = !1
            })),
            Q = new Map,
            $ = e => {
                const t = Q.get(e.key);
                if (!t) return;
                const {
                    altKey: n = !1,
                    ctrlKey: o = !1,
                    metaKey: r = !1,
                    shiftKey: a = !1,
                    callback: i
                } = t;
                n === e.altKey && o === e.ctrlKey && r === e.metaKey && a === e.shiftKey && (null == i || i(e), e.preventDefault())
            };

        function ee(e) {
            const {
                key: t
            } = e;
            Q.has(t) && console.warn("keyboard keys are registered"), Q.set(t, e)
        }
        const te = class {
            constructor(e) {
                const {
                    btnTarget: t,
                    toolData: n,
                    toolDefault: o,
                    classNameCopilot: a
                } = e;
                new ne(a || "moreLayout", e, (e => {
                    for (const a of n.children) {
                        const {
                            toolName: i,
                            toolNameAlias: s,
                            toolType: l,
                            toolTag: c = "",
                            icon: d,
                            isActive: h,
                            visibility: f,
                            divider: m,
                            select: g,
                            children: p
                        } = a, v = s || ("function" == typeof i ? i() : i), y = Object.assign(Object.assign({}, a), {
                            parentData: n
                        }), b = (0, S.n)({
                            tagName: "i",
                            className: "iconfont"
                        });
                        d && (0, u.wf)(b, !0, "function" == typeof d ? d() : d);
                        const w = (0, S.n)({
                                className: "text",
                                tagName: "span",
                                innerText: v
                            }),
                            x = (0, S.n)({
                                className: `select-popup-item tool-event-link ${l||c}`,
                                title: v,
                                onclick: e => {
                                    (0, r.triggerEvent)(r.events, "tool_event", {
                                        events: e,
                                        toolData: y,
                                        btnTarget: x,
                                        btnOriginTarget: t
                                    })
                                }
                            });
                        x.dataset.toolData = JSON.stringify(y), x.dataset.toolType = l || c, h && ((0, u.wf)(x, !0), !n.disActive && (0, u.wf)(t, !0)), c === (null == o ? void 0 : o.toolTag) && ((0, u.wf)(x, !0), (0, u.uk)().then((() => {
                            (0, r.triggerEvent)(r.events, "tool_event", {
                                toolData: y,
                                btnTarget: x,
                                btnOriginTarget: t
                            })
                        }))), (!1 === f || "function" == typeof f && !f()) && (0, u.wf)(x, !0, "hidden"), m && (0, u.wf)(x, !0, "menu-divider"), (p || g) && x.appendChild((0, S.n)({
                            tagName: "i",
                            className: "triangle"
                        })), x.append(b, w), e.appendChild(x)
                    }
                }))
            }
        };
        const ne = class {
            constructor(e, t, n, o) {
                this.className = "select-popup-layout";
                const {
                    btnTarget: r,
                    events: a,
                    forceRender: i,
                    destroy: s
                } = t;
                let l = this.layout = r.querySelector(`.${this.className}.${e}`);
                if (this.layout && (i || s)) {
                    const e = !this.layout.classList.contains("invisible");
                    if (this.layout.remove(), this.layout = void 0, s || e) return
                }
                if (!this.layout) {
                    l = this.layout = (0, S.n)({
                        className: `${this.className} ${e} invisible`,
                        onclick: e => {
                            const n = e.target,
                                o = n.classList.contains("tool-event-link") ? n : n.parentElement,
                                r = JSON.parse((null == o ? void 0 : o.dataset.toolData) || "{}"),
                                {
                                    select: a,
                                    children: i,
                                    toolTag: s
                                } = r;
                            if (e.stopPropagation(), n !== l)
                                if (i) {
                                    const e = (0, u.wf)(o, void 0, "open-mark");
                                    new te({
                                        events: {},
                                        toolData: r,
                                        btnTarget: o,
                                        classNameCopilot: "menu-nest",
                                        isMenuNest: !0,
                                        destroy: !e
                                    })
                                } else if (a) {
                                const e = f.A.webDicomView.layoutView.toolsContainer.querySelector(`.${this.className}.${s}:not(.invisible)`);
                                e && this.setLeft(Object.assign(Object.assign({}, t), {
                                    btnTarget: o,
                                    _layout: e,
                                    forceShow: !0,
                                    isMenuNest: !0
                                }))
                            } else this.hideLayout(!0)
                        },
                        ontouchmove: e => {
                            e.stopPropagation()
                        }
                    });
                    const o = (0, S.n)({
                        className: "select-popup-container"
                    });
                    null == n || n(o), l.appendChild(o), r.appendChild(l), r.addEventListener("mouseleave", (() => this.mouseleaveHandle())), r.addEventListener("mouseenter", (() => this.mouseenterHandle()))
                }
                null == o || o(l), a && this.setLeft(t)
            }
            mouseleaveHandle() {
                this.timer = setTimeout((() => {
                    this.hideLayout()
                }), f.A.isMobile ? 0 : 300)
            }
            mouseenterHandle() {
                this.timer && clearTimeout(this.timer)
            }
            hideLayout(e) {
                if (!this.layout) throw "Layout not found for SelectPopupLayout";
                (0, u.wf)(this.layout, !0, "invisible"), f.A.webDicomView.layoutView.removeOpenMark(), e && f.A.webDicomView.layoutView.selectPopupHidden()
            }
            setLeft(e) {
                var t, n, o, r;
                const {
                    btnTarget: a,
                    isMenuNest: i,
                    _layout: s,
                    forceShow: l,
                    direction: c
                } = e, {
                    left: d,
                    bottom: h,
                    top: m,
                    right: g
                } = (null == a ? void 0 : a.getBoundingClientRect()) || {}, p = s || this.layout, v = f.A.webDicomView.globalContainer.clientWidth, y = null !== (t = null == p ? void 0 : p.clientWidth) && void 0 !== t ? t : NaN, b = null !== (n = null == p ? void 0 : p.clientHeight) && void 0 !== n ? n : NaN;
                if (!p) throw "layout is undefined for setLeft";
                if (i) {
                    const e = parseFloat((null === (r = null === (o = a.parentElement) || void 0 === o ? void 0 : o.parentElement) || void 0 === r ? void 0 : r.dataset.isRight) || "1") && g + y <= v;
                    p.style.left = `${e?g:d-y}px`, p.dataset.isRight = e ? "1" : "0", p.style.top = `${m}px`
                } else p.style.left = `${d+y>v?v-y:d}px`, p.style.top = `${h}px`;
                "top" === c && (p.style.top = m - b + "px"), (0, u.wf)(p, !l && !p.classList.contains("invisible"), "invisible")
            }
        };
        const oe = class {
            constructor() {
                const e = (0, P.O)();
                this.data = [{
                    title: e[0],
                    icon: "icon-dicom-mode3",
                    type: -1,
                    visibility: () => {
                        var e, t;
                        return null !== (t = null === (e = f.A.toolsBar) || void 0 === e ? void 0 : e.fastImageModeVisibility) && void 0 !== t ? t : f.A.toolsBar.fasModeVisibility
                    }
                }, {
                    title: e[1],
                    icon: "icon-dicom-mode1",
                    type: 0,
                    visibility: () => f.A.toolsBar.staModeVisibility
                }, {
                    title: e[2],
                    icon: "icon-dicom-mode2",
                    type: 1,
                    visibility: () => f.A.toolsBar.majModeVisibility
                }]
            }
            createLayout(e) {
                new ne("imageType", Object.assign(Object.assign({}, e.detail), {
                    forceRender: !0
                }), (t => {
                    for (const n of this.data) {
                        const {
                            title: o,
                            icon: a,
                            type: i,
                            visibility: s
                        } = n;
                        if (!1 !== (null == s ? void 0 : s())) {
                            const s = (0, S.n)({
                                    tagName: "i",
                                    className: `iconfont ${a}`
                                }),
                                l = (0, S.n)({
                                    tagName: "span",
                                    innerText: o
                                }),
                                c = (0, S.n)({
                                    className: "select-popup-item " + (f.A.imageType === i ? "active" : ""),
                                    title: o,
                                    onclick: () => {
                                        (0, r.triggerEvent)(r.events, "tool_imageType", Object.assign(Object.assign({}, n), e.detail))
                                    }
                                });
                            c.append(s, l), t.appendChild(c)
                        }
                    }
                }))
            }
            handleLayout(e) {
                let {
                    title: t,
                    btnTarget: n,
                    icon: o,
                    custom: r
                } = e;
                if (r) {
                    const e = this.data.find((e => e.type === f.A.imageType));
                    if (!e) throw "imageTypeMap is undefined for ImageTypeLayout";
                    t = e.title, o = e.icon, n = f.A.webDicomView.layoutView.querySelectorForTool(".imageType")
                }
                if (!n) throw "btnTarget is undefined for ImageTypeLayout";
                const a = n.querySelector(".toolbar-text") || n.querySelector(".text"),
                    i = n.querySelector("i.iconfont");
                n.title = t, a.innerText = t, i.className = "iconfont " + o
            }
        };
        var re = __webpack_require__(3399),
            ae = __webpack_require__(9897),
            ie = function(e, t, n, o) {
                return new(n || (n = Promise))((function(r, a) {
                    function i(e) {
                        try {
                            l(o.next(e))
                        } catch (e) {
                            a(e)
                        }
                    }

                    function s(e) {
                        try {
                            l(o.throw(e))
                        } catch (e) {
                            a(e)
                        }
                    }

                    function l(e) {
                        var t;
                        e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                            e(t)
                        }))).then(i, s)
                    }
                    l((o = o.apply(e, t || [])).next())
                }))
            };

        function se() {
            const {
                color: e,
                modality: t
            } = f.A.webDicomView.queryImage();
            return e || "CT" !== t
        }
        const le = class {
            constructor() {
                this.t = (0, g.Tl)("toast.prompt"), this.isZh = (0, g.Z0)().includes("zh"), this.data = [{
                    title: "",
                    name: "lungs",
                    WW: 1750,
                    WC: -500,
                    keyboard: {
                        key: "F1"
                    }
                }, {
                    title: "",
                    name: "mediastinum",
                    WW: 300,
                    WC: 40,
                    keyboard: {
                        key: "F2"
                    }
                }, {
                    title: "",
                    name: "bone",
                    WW: 1250,
                    WC: 300,
                    keyboard: {
                        key: "F3"
                    }
                }, {
                    title: "",
                    name: "skull",
                    WW: 90,
                    WC: 35,
                    keyboard: {
                        key: "F4"
                    }
                }, {
                    title: "",
                    name: "flab",
                    WW: 400,
                    WC: 50,
                    divider: !0,
                    keyboard: {
                        key: "F5"
                    }
                }, {
                    title: "/",
                    name: "custom"
                }];
                for (const e of this.data) {
                    const {
                        keyboard: t
                    } = e;
                    t && ee(Object.assign(Object.assign({}, t), {
                        callback: () => {
                            se() || this._triggerEvent(e)
                        }
                    }))
                }
            }
            createLayout(e) {
                new ne("modulation", Object.assign(Object.assign({}, e.detail), {
                    forceRender: !0
                }), (e => {
                    for (const t of se() ? [this.data[5]] : this.data) {
                        const {
                            title: n,
                            name: o,
                            divider: r,
                            keyboard: a
                        } = t, i = (0, S.n)({
                            className: "select-popup-item",
                            title: n,
                            innerText: this.isZh ? n : (0, u.Zr)(o),
                            onclick: () => {
                                this._triggerEvent(t)
                            }
                        });
                        r && (0, u.wf)(i, !0, "menu-divider"), a && !f.A.isMobile && (i.innerHTML += `<span style='color:#ffffffb0;'>&nbsp;${a.key}</span>`), e.appendChild(i)
                    }
                }))
            }
            _triggerEvent(e) {
                var t;
                (0, r.triggerEvent)(r.events, (null === (t = f.A.webDicomView.layoutView.querySelector(".toolsMPR", {
                    tip: !1
                })) || void 0 === t ? void 0 : t.classList.contains("active")) ? "tool_WwWc_MPR" : "tool_WwWc", e)
            }
            getWindowRange(e) {
                return ie(this, void 0, void 0, (function*() {
                    const {
                        enterWL: t,
                        example: n,
                        verificationError: o
                    } = this.t;
                    let {
                        name: r,
                        WW: a,
                        WC: i
                    } = e;
                    if ("custom" === r) {
                        const e = yield(0, ae.A)(`${t}(${n}255&emsp;128`, /^[-+]?\d+(\.\d*)?[a-zA-Z\s;',/\\/]+[-+]?\d+(\.\d*)?$/, o);
                        if (!e) throw "modulation cancel";
                        const r = e.split(/[a-zA-Z\s;',/\\/]+/);
                        [a, i] = [parseFloat(r[0]), parseFloat(r[1])]
                    }
                    if (!a || !i || isNaN(a) || isNaN(i)) throw "WW and WC is undefined for windowRange";
                    return [a, i]
                }))
            }
            setViewport(e, t) {
                return ie(this, void 0, void 0, (function*() {
                    const [n, o] = yield this.getWindowRange(t);
                    (0, r.setViewport)((0, re.er)(e) || e, {
                        voi: {
                            windowWidth: n,
                            windowCenter: o
                        }
                    })
                }))
            }
        };
        const ce = class {
            constructor() {
                const {
                    restore: e,
                    right90: t,
                    left90: n,
                    HFlip: o,
                    VFlip: r
                } = (0, g.Tl)("rotate");
                this.data = [{
                    title: e,
                    name: "default",
                    icon: "icon-dicom-restore"
                }, {
                    title: t,
                    name: "anticlockwise",
                    icon: "icon-dicom-rotate90R"
                }, {
                    title: n,
                    name: "clockwise",
                    icon: "icon-dicom-rotate90L"
                }, {
                    title: o,
                    name: "leftRight",
                    icon: "icon-dicom-leftRight"
                }, {
                    title: r,
                    name: "upDown",
                    icon: "icon-dicom-upDown"
                }]
            }
            createLayout(e) {
                new ne("rotate", e.detail, (e => {
                    for (const t of this.data) {
                        const {
                            title: n,
                            icon: o
                        } = t, a = (0, S.n)({
                            tagName: "i",
                            className: "iconfont " + o
                        }), i = (0, S.n)({
                            tagName: "span",
                            innerText: n
                        }), s = (0, S.n)({
                            className: "select-popup-item",
                            title: n,
                            onclick: () => {
                                (0, r.triggerEvent)(r.events, "tool_rotate", t)
                            }
                        });
                        s.append(a, i), e.appendChild(s)
                    }
                }))
            }
            handleLayout(e, t) {
                if (!e) throw "canvas is undefined for rotate";
                e = (0, re.er)(e) || e;
                let n = (0, r.getViewport)(e);
                if (!n) throw "viewport is undefined";
                const {
                    name: o
                } = t;
                switch (o) {
                    case "default":
                        n.rotation = 0, n.hflip = !1, n.vflip = !1;
                        break;
                    case "anticlockwise":
                        n.rotation -= 90;
                        break;
                    case "clockwise":
                        n.rotation += 90;
                        break;
                    case "leftRight":
                        n.hflip = !n.hflip;
                        break;
                    case "upDown":
                        n.vflip = !n.vflip
                }(0, r.setViewport)(e, n)
            }
        };
        var ue = __webpack_require__(3893),
            de = __webpack_require__(7369);

        function he() {
            return new M.Synchronizer(r.EVENTS.IMAGE_RENDERED, (() => {}))
        }
        let fe = he();
        const me = (0, S.sg)((function() {
            return (0, de.A)(fe, !1)
        }), 500);

        function ge(e) {
            const t = fe.getHandler();
            fe.setHandler(((n, o, r, a, ...i) => {
                null == t || t(n, o, r, a, ...i), e(n, o, r, a, ...i)
            }))
        }

        function pe() {
            fe.destroy()
        }
        r.colors.getColormap("myCustomColorMap", {
            name: "myCustomColorMap",
            numColors: 256,
            gamma: 1,
            segmentedData: {
                red: [
                    [0, 1, 0],
                    [1, 1, 0]
                ],
                green: [
                    [0, 0, 0],
                    [1, 1, 1]
                ],
                blue: [
                    [0, 1, 1],
                    [1, .5, .5]
                ]
            }
        });
        const ve = [{
            id: "gray",
            name: "",
            icon: __webpack_require__(1008)
        }, {
            id: "blues",
            name: "",
            icon: __webpack_require__(3522)
        }, {
            id: "bone",
            name: "",
            icon: __webpack_require__(2007)
        }, {
            id: "cool",
            name: "Cool",
            icon: __webpack_require__(6030)
        }, {
            id: "coolwarm",
            name: "",
            icon: __webpack_require__(9141)
        }, {
            id: "copper",
            name: "",
            icon: __webpack_require__(642)
        }, {
            id: "hot",
            name: "",
            icon: __webpack_require__(9572)
        }, {
            id: "hotIron",
            name: "",
            icon: __webpack_require__(8962)
        }, {
            id: "hotMetalBlue",
            name: "",
            icon: __webpack_require__(2723)
        }, {
            id: "hsv",
            name: "HSV",
            icon: __webpack_require__(6178)
        }, {
            id: "jet",
            name: "Jet",
            icon: __webpack_require__(904)
        }, {
            id: "pet",
            name: "PET",
            icon: __webpack_require__(6446)
        }, {
            id: "pet20Step",
            name: "PET 20 Step",
            icon: __webpack_require__(6206)
        }, {
            id: "spectral",
            name: "",
            icon: __webpack_require__(2489)
        }, {
            id: "spring",
            name: "",
            icon: __webpack_require__(9662)
        }, {
            id: "summer",
            name: "",
            icon: __webpack_require__(8774)
        }, {
            id: "autumn",
            name: "",
            icon: __webpack_require__(8011)
        }, {
            id: "winter",
            name: "",
            icon: __webpack_require__(7990)
        }];
        const ye = class {
            constructor() {
                this.data = ve
            }
            createLayout(e) {
                new ne("colorMap", e.detail, (e => {
                    for (const t of this.data) {
                        const {
                            id: n,
                            icon: o,
                            name: a
                        } = t, i = (0, S.n)({
                            tagName: "div",
                            className: "select-grid-item2",
                            title: (0, g.Z0)().includes("zh") ? n == a ? n : `${n},${a}` : (0, u.Zr)(n),
                            onclick: () => {
                                (0, r.triggerEvent)(r.events, "tool_colorMap", t)
                            }
                        }), s = (0, S.n)({
                            tagName: "img",
                            width: 30,
                            height: 30,
                            src: o
                        });
                        i.appendChild(s), e.appendChild(i)
                    }(0, u.Wp)(e, {
                        style: "\n\t\t\t\t\tdisplay: grid;\n\t\t\t\t\tgrid-template-columns: repeat(4, 40px);\n\t\t\t\t\tpadding: 4px;\n\t\t\t \t"
                    })
                }))
            }
            handleLayout(e, t) {
                const {
                    id: n
                } = t;
                if (!e) throw "canvas is required for colorMap";
                e = (0, re.er)(e) || e, ge(ue.Qo), (0, r.setViewport)(e, {
                    colormap: n
                })
            }
        };
        var be = function(e, t, n, o) {
            return new(n || (n = Promise))((function(r, a) {
                function i(e) {
                    try {
                        l(o.next(e))
                    } catch (e) {
                        a(e)
                    }
                }

                function s(e) {
                    try {
                        l(o.throw(e))
                    } catch (e) {
                        a(e)
                    }
                }

                function l(e) {
                    var t;
                    e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                        e(t)
                    }))).then(i, s)
                }
                l((o = o.apply(e, t || [])).next())
            }))
        };
        const {
            zoomTool: {
                minScale: we,
                maxScale: xe
            }
        } = f.A.toolsOptions;
        const Te = class {
            constructor() {
                this.t = (0, g.Tl)("toast.prompt"), this.data = [{
                    title: (0, g.Tl)("other").custom,
                    name: "custom"
                }]
            }
            createLayout(e) {
                new ne("scale", e.detail, (e => {
                    for (const t of this.data) {
                        const {
                            title: n
                        } = t, o = (0, S.n)({
                            className: "select-popup-item",
                            title: n,
                            innerText: n,
                            onclick: () => {
                                (0, r.triggerEvent)(r.events, "tool_scale", t)
                            }
                        });
                        e.appendChild(o)
                    }
                }))
            }
            handleLayout(e, t) {
                return be(this, void 0, void 0, (function*() {
                    const {
                        enterScale: n,
                        example: o,
                        verificationError: a
                    } = this.t;
                    let {
                        name: i
                    } = t, s = null;
                    "custom" === i && (s = yield(0, ae.A)(`${n}(${o}${we}~${xe}`, (e => /^\d+(\.\d*)?$/.test(e) && parseFloat(e) >= we && parseFloat(e) <= xe), a)), null !== s && (0, r.setViewport)(e, {
                        scale: Number(s)
                    })
                }))
            }
        };
        var Ie = __webpack_require__(1950);
        const Ee = class {
            constructor() {
                this.DICOMTags = (0, g.Tl)("DICOMTags")
            }
            createSeriesMarker(e) {
                const t = e.querySelector(".ltMarker"),
                    n = e.querySelector(".rtMarker"),
                    o = e.querySelector(".lbMarker"),
                    r = e.querySelector(".rbMarker"),
                    a = {
                        position: "absolute",
                        fontSize: "10px",
                        textShadow: "1px 1px 1px #000",
                        cursor: "default",
                        pointerEvents: "none"
                    };
                if (!t) {
                    const t = (0, S.n)({
                        className: "ltMarker"
                    });
                    e.appendChild(t), Object.assign(t.style, a, {
                        left: "3px",
                        top: "3px",
                        textAlign: "left"
                    })
                }
                if (!n) {
                    const t = (0, S.n)({
                        className: "rtMarker"
                    });
                    Object.assign(t.style, a, {
                        right: (f.A.isMobile ? 6 : 16) + "px",
                        top: "3px",
                        textAlign: "right"
                    }), e.appendChild(t)
                }
                if (!o) {
                    const t = (0, S.n)({
                        className: "lbMarker"
                    });
                    Object.assign(t.style, a, {
                        width: "100%",
                        left: "3px",
                        bottom: "3px",
                        textAlign: "left"
                    }), e.appendChild(t)
                }
                if (!r) {
                    const t = (0, S.n)({
                        className: "rbMarker"
                    });
                    Object.assign(t.style, a, {
                        right: (f.A.isMobile ? 6 : 16) + "px",
                        bottom: "3px",
                        textAlign: "right"
                    }), e.appendChild(t)
                }
            }
            createParagraph(e, t, n, o, a) {
                var i, s;
                this.createSeriesMarker(e);
                let l = e.querySelector(`.${t}`);
                const {
                    name: c,
                    modality: u,
                    age: d,
                    sex: h,
                    date: f,
                    descriptionLite: m,
                    imageNumber: g,
                    KVP: p,
                    thickness: v,
                    scale: y,
                    windowCenter: b,
                    windowWidth: w
                } = this.DICOMTags, {
                    imageId: x
                } = n, T = r.metaData.get("_allModule", x), I = r.metaData.get("_referringPhysicianModule", x);
                if (l) switch (l.innerHTML = "", t) {
                    case "ltMarker":
                        {
                            const e = (0, S.n)({
                                    tagName: "p",
                                    innerText: `${c}${(null==a?void 0:a.name)||T.patientName}`
                                }),
                                t = (0, S.n)({
                                    tagName: "p",
                                    innerText: "ID" + ((null == a ? void 0 : a.patientID) || T.patientID)
                                }),
                                n = (0, S.n)({
                                    tagName: "p",
                                    innerText: `${u}${T.modality}`
                                }),
                                o = (0, S.n)({
                                    tagName: "p",
                                    innerText: `${h}${(0,Ie.E)((null==a?void 0:a.sex)||T.patientSex)}`
                                }),
                                r = (0, S.n)({
                                    tagName: "p",
                                    innerText: `${d}${(0,Ie.A)((null==a?void 0:a.age)||T.patientAge)}`
                                });l.append(e, t, n, o, r);
                            break
                        }
                    case "rtMarker":
                        {
                            const e = (0, S.n)({
                                    tagName: "p",
                                    innerText: `${f}${T.origin.acqdt||(null==a?void 0:a.studydate)}`
                                }),
                                t = (0, S.n)({
                                    tagName: "p",
                                    className: "filmMarker",
                                    innerText: `${g}` + [(null == a ? void 0 : a.studyID) || T.studyID, T.seriesNumber, T.instanceNumber].join("-").replace(/-{2,}/, "-")
                                });l.append(e, t);
                            break
                        }
                    case "lbMarker":
                        {
                            const e = (0, S.n)({
                                    tagName: "p",
                                    innerText: `${I||""}`
                                }),
                                t = (0, S.n)({
                                    tagName: "p",
                                    innerText: `${p}${T.KVP}`
                                }),
                                n = (0, S.n)({
                                    tagName: "p",
                                    innerText: `${v}${T.sliceThickness||""}`
                                }),
                                o = T.origin.serdes,
                                r = (0, S.n)({
                                    tagName: "p",
                                    innerText: o ? `${m}${o}` : ""
                                });Object.assign(r.style, {
                                width: "30%",
                                whiteSpace: "normal",
                                wordBreak: "break-all",
                                overflowWrap: "break-word"
                            }),
                            l.append(e, t, n, r);
                            break
                        }
                    case "rbMarker":
                        {
                            const e = (0, S.n)({
                                    tagName: "p",
                                    className: "scaleMarker",
                                    innerText: `${y}${Number(o.scale).toFixed(2)}`
                                }),
                                t = (0, S.n)({
                                    tagName: "p",
                                    className: "wwWMarker",
                                    innerText: `${b}${null===(i=o.voi)||void 0===i?void 0:i.windowWidth}`
                                }),
                                n = (0, S.n)({
                                    tagName: "p",
                                    className: "wwHMarker",
                                    innerText: `${w}${null===(s=o.voi)||void 0===s?void 0:s.windowCenter}`
                                }),
                                r = (0, S.n)({
                                    tagName: "p",
                                    innerText: (null == a ? void 0 : a.orgname) || T.institutionName
                                });l.append(e, t, n, r);
                            break
                        }
                }
            }
        };
        var Se = __webpack_require__(736),
            Ae = function(e, t, n, o) {
                return new(n || (n = Promise))((function(r, a) {
                    function i(e) {
                        try {
                            l(o.next(e))
                        } catch (e) {
                            a(e)
                        }
                    }

                    function s(e) {
                        try {
                            l(o.throw(e))
                        } catch (e) {
                            a(e)
                        }
                    }

                    function l(e) {
                        var t;
                        e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                            e(t)
                        }))).then(i, s)
                    }
                    l((o = o.apply(e, t || [])).next())
                }))
            };
        const Ce = function() {
            return Ae(this, void 0, void 0, (function*() {
                for (const {
                        element: e
                    } of yield(0, Se.A)(!1))(0, r.updateImage)(e)
            }))
        };
        var Me = __webpack_require__(9176),
            De = function(e, t, n, o) {
                return new(n || (n = Promise))((function(r, a) {
                    function i(e) {
                        try {
                            l(o.next(e))
                        } catch (e) {
                            a(e)
                        }
                    }

                    function s(e) {
                        try {
                            l(o.throw(e))
                        } catch (e) {
                            a(e)
                        }
                    }

                    function l(e) {
                        var t;
                        e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                            e(t)
                        }))).then(i, s)
                    }
                    l((o = o.apply(e, t || [])).next())
                }))
            };
        let Pe = {};

        function ke(e = {}) {
            Pe = e
        }

        function _e(e) {
            return De(this, arguments, void 0, (function*(e, t = !1) {
                if (!e) throw "studyUID must be provided";
                try {
                    const {
                        wado: n,
                        hospID: o,
                        departCode: r
                    } = f.A.instanceOptions, a = yield(0, Me.nu)(n, e, {
                        departCode: r,
                        hospID: o
                    }), i = JSON.parse(a.data.markKeyJson) || {};
                    ke(Object.assign(Object.assign({}, Pe), {
                        [e]: i
                    })), t && Ce()
                } catch (e) {
                    console.error(e)
                }
            }))
        }
        var Le = function(e, t, n, o) {
            return new(n || (n = Promise))((function(r, a) {
                function i(e) {
                    try {
                        l(o.next(e))
                    } catch (e) {
                        a(e)
                    }
                }

                function s(e) {
                    try {
                        l(o.throw(e))
                    } catch (e) {
                        a(e)
                    }
                }

                function l(e) {
                    var t;
                    e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                        e(t)
                    }))).then(i, s)
                }
                l((o = o.apply(e, t || [])).next())
            }))
        };
        const Oe = class {
            constructor() {
                this.layoutclassName = "crux-marker-description", this.EVENTSHandle = new Map
            }
            createLayout(e) {
                const t = (0, S.n)({
                        className: this.layoutclassName
                    }),
                    n = () => {
                        const {
                            enable: n,
                            description: o
                        } = function(e) {
                            var t;
                            const {
                                imageId: n
                            } = (0, r.getImage)(e), {
                                imageUID: o,
                                studyUID: a
                            } = r.metaData.get("_IDModule", n);
                            return null === (t = Pe[a]) || void 0 === t ? void 0 : t[o]
                        }(e) || {};
                        t.innerText = n ? o : "", e.querySelector(".crux-marker-checkbox").checked = n
                    },
                    o = (0, S.n)({
                        className: "crux-marker-checkbox" + (f.A.instanceOptions.syncMarkersImage ? "" : " hidden"),
                        tagName: "input",
                        type: "checkbox",
                        ontouchstart: e => {
                            e.target.click(), e.stopPropagation()
                        },
                        onmousedown: e => {
                            e.stopPropagation()
                        },
                        onchange: n => Le(this, void 0, void 0, (function*() {
                            const o = n.target;
                            if (o.checked) {
                                const e = yield(0, ae.A)((0, g.Tl)("toast.prompt.enterKeyImageDescription"), /\S/, (0, g.Tl)("toast.prompt.verificationError"));
                                if (null === e) return o.checked = !1;
                                t.innerText = e
                            } else t.innerText = "";
                            ! function(e, t) {
                                if (!f.A.instanceOptions.syncMarkersImage) return;
                                const {
                                    imageId: n
                                } = (0, r.getImage)(e), {
                                    imageUID: o,
                                    seriesUID: a,
                                    studyUID: i
                                } = r.metaData.get("_IDModule", n);
                                Pe[i] || (Pe[i] = {}), Pe[i][o] = Object.assign(Object.assign({}, t), {
                                    imageUID: o,
                                    seriesUID: a,
                                    studyUID: i
                                })
                            }(e, {
                                enable: o.checked,
                                description: t.innerText
                            })
                        }))
                    }),
                    a = e.querySelector(".rbMarker");
                null == a || a.prepend(o), null == a || a.prepend(t), this.EVENTSHandle.set(e, n), e.addEventListener(r.EVENTS.NEW_IMAGE, n), n()
            }
            removeLayout(e) {
                const t = this.EVENTSHandle.get(e),
                    n = e.querySelector(`.${this.layoutclassName}`);
                t && e.removeEventListener(r.EVENTS.NEW_IMAGE, t), this.EVENTSHandle.delete(e), null == n || n.remove()
            }
        };
        var Re = function(e, t, n, o) {
                return new(n || (n = Promise))((function(r, a) {
                    function i(e) {
                        try {
                            l(o.next(e))
                        } catch (e) {
                            a(e)
                        }
                    }

                    function s(e) {
                        try {
                            l(o.throw(e))
                        } catch (e) {
                            a(e)
                        }
                    }

                    function l(e) {
                        var t;
                        e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                            e(t)
                        }))).then(i, s)
                    }
                    l((o = o.apply(e, t || [])).next())
                }))
            },
            Ne = function(e, t) {
                var n = {};
                for (var o in e) Object.prototype.hasOwnProperty.call(e, o) && t.indexOf(o) < 0 && (n[o] = e[o]);
                if (null != e && "function" == typeof Object.getOwnPropertySymbols) {
                    var r = 0;
                    for (o = Object.getOwnPropertySymbols(e); r < o.length; r++) t.indexOf(o[r]) < 0 && Object.prototype.propertyIsEnumerable.call(e, o[r]) && (n[o[r]] = e[o[r]])
                }
                return n
            };

        function Ue(e = M.globalImageIdSpecificToolStateManager.saveToolState()) {
            const t = M.store.state.tools.filter((({
                    mode: e
                }) => "active" === e)).map((({
                    name: e
                }) => e)),
                n = new Set;
            for (const [o, r] of Object.entries(e)) {
                const e = r || {},
                    {
                        baseInfo: o
                    } = e,
                    a = Ne(e, ["baseInfo"]);
                for (const e in a) !t.includes(e) && n.add(e)
            }
            for (const e of n)(0, C.sO)(e)
        }

        function Be(e) {
            return Re(this, arguments, void 0, (function*(e, t = !0, n = !1) {
                if (!e) throw "studyUID must be provided";
                try {
                    const o = M.globalImageIdSpecificToolStateManager.saveToolState(),
                        {
                            wado: r,
                            hospID: a,
                            departCode: i
                        } = f.A.instanceOptions,
                        s = yield(0, Me.MY)(r, e, {
                            departCode: i,
                            hospID: a
                        }), l = JSON.parse(s.data.markJson) || {};
                    M.globalImageIdSpecificToolStateManager.restoreToolState(Object.assign(Object.assign({}, o), l)), t && Ue(l), n && Ce()
                } catch (e) {
                    console.error(e)
                }
            }))
        }
        var Ve = function(e, t, n, o) {
            return new(n || (n = Promise))((function(r, a) {
                function i(e) {
                    try {
                        l(o.next(e))
                    } catch (e) {
                        a(e)
                    }
                }

                function s(e) {
                    try {
                        l(o.throw(e))
                    } catch (e) {
                        a(e)
                    }
                }

                function l(e) {
                    var t;
                    e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                        e(t)
                    }))).then(i, s)
                }
                l((o = o.apply(e, t || [])).next())
            }))
        };
        const Fe = class {
                constructor() {}
                createTopTools(e, t, n, o = "toolsChild", a = !1) {
                    let i = e.querySelector(`.toolsChild.${o}`);
                    if ((0, u.M1)(e.querySelectorAll(".toolsChild"), (() => !1)), a && (null == i || i.remove(), i = null), i) return void(0, u.wf)(i, !0);
                    let s = (0, S.n)({
                        className: `toolsChild active ${o}`
                    });
                    for (const e of t) {
                        const {
                            toolName: t,
                            toolNameAlias: o,
                            toolType: a,
                            toolTag: i = "",
                            icon: l,
                            iconText: c,
                            iconImg: d,
                            isActive: h,
                            children: f,
                            divider: m,
                            floatRight: g,
                            select: p,
                            visibility: v
                        } = e, y = o || ("function" == typeof t ? t() : t), b = (0, S.n)({
                            tagName: "span",
                            className: `tool-btn-style tool-event-link ${a||i}`,
                            title: y || c,
                            onclick: t => {
                                const n = {
                                    events: t,
                                    toolData: e,
                                    btnTarget: b
                                };
                                "Array" === (0, S.Bc)(f) && new te(n), i && (0, r.triggerEvent)(r.events, "tool_event", n)
                            }
                        });
                        let w = (0, S.n)({
                            tagName: "i",
                            className: "iconfont"
                        });
                        const x = (0, S.n)({
                            tagName: "span",
                            className: "toolbar-text",
                            innerText: y
                        });
                        b.dataset.toolData = JSON.stringify(e), b.dataset.toolType = a || i, d ? w = (0, S.n)({
                            tagName: "img",
                            src: d,
                            className: "iconfont-img"
                        }) : l ? (0, u.wf)(w, !0, "function" == typeof l ? l() : l) : (w.innerHTML = c || "", (0, u.Wp)(w, {
                            style: "\n\t\t\t\t\tfont-size: 24px;\n\t\t\t\t\tpadding:0 2px\n\t\t\t\t\t"
                        }), y || (w.style.lineHeight = "48px", x.style.display = "none")), (!1 === v || "function" == typeof v && !v()) && (0, u.wf)(b, !0, "hidden"), n && i === n.toolTag && ((0, u.wf)(b, !0), (0, u.uk)(n.delay).then((() => {
                            (0, r.triggerEvent)(r.events, "tool_event", {
                                toolData: e,
                                btnTarget: b
                            })
                        }))), h && (0, u.wf)(b, !0), "Array" === (0, S.Bc)(f) && (new te({
                            toolData: e,
                            btnTarget: b,
                            toolDefault: n
                        }), w.appendChild((0, S.n)({
                            tagName: "i",
                            className: "triangle"
                        }))), p && w.appendChild((0, S.n)({
                            tagName: "i",
                            className: "triangle"
                        })), b.append(w, x), g && s.appendChild((0, S.n)({
                            className: "flex-1"
                        })), s.appendChild(b), m && s.appendChild((0, S.n)({
                            tagName: "span",
                            className: `divider ${a||i}`
                        }))
                    }
                    e.appendChild(s)
                }
                disableAllTool() {
                    fe.setHandler((() => {})), (0, C.fO)("Pointer", {
                        mouseButtonMask: 1,
                        synchronizationContext: fe
                    })
                }
                rectangleRoiTools() {
                    (0, C.fO)("RectangleRoi", {
                        mouseButtonMask: 1
                    })
                }
                ellipticalRoiTools() {
                    (0, C.fO)("EllipticalRoi", {
                        mouseButtonMask: 1
                    })
                }
                circleRoiTools() {
                    (0, C.fO)("CircleRoi", {
                        mouseButtonMask: 1
                    })
                }
                lengthTools() {
                    (0, C.fO)("Length", {
                        mouseButtonMask: 1
                    })
                }
                eraserTools() {
                    (0, C.fO)("Eraser", {
                        mouseButtonMask: 1
                    })
                }
                angleTools() {
                    (0, C.fO)("Angle", {
                        mouseButtonMask: 1
                    })
                }
                cobbAngleTools() {
                    (0, C.fO)("CobbAngle", {
                        mouseButtonMask: 1
                    })
                }
                rotateTool() {
                    fe.setHandler(ue.gk), (0, C.fO)("Rotate", {
                        mouseButtonMask: 1,
                        synchronizationContext: fe
                    })
                }
                zoomTool() {
                    fe.setHandler(ue.d8), (0, C.fO)("Zoom", {
                        mouseButtonMask: 1,
                        synchronizationContext: fe
                    })
                }
                magnifyTool() {
                    (0, C.fO)("Magnify", {
                        mouseButtonMask: 1
                    })
                }
                modulationTool() {
                    fe.setHandler(ue.rn), (0, C.fO)("Wwwc", {
                        mouseButtonMask: 1,
                        synchronizationContext: fe
                    })
                }
                stackScrollTool() {
                    (0, C.fO)("StackScroll", {
                        mouseButtonMask: 1
                    })
                }
                sharpenTool() {
                    (0, C.fO)("Sharpen", {
                        mouseButtonMask: 1
                    })
                }
                blurTool() {
                    (0, C.fO)("Blur", {
                        mouseButtonMask: 1
                    })
                }
                blurAndSharpenTool(e, t, n) {
                    const o = (0, r.getViewport)(n);
                    o[e.includes("sharpen") ? "sharpen" : "blur"] = (0, u.uo)(t) || 0, (0, r.setViewport)(n, o)
                }
                panTool() {
                    fe.setHandler(ue.ye), (0, C.fO)("Pan", {
                        mouseButtonMask: 1,
                        synchronizationContext: fe
                    })
                }
                freehandRoiTool() {
                    (0, C.fO)("FreehandRoi", {
                        mouseButtonMask: 1
                    })
                }
                probeCTTool() {
                    (0, C.fO)("ProbeCT", {
                        mouseButtonMask: 1
                    })
                }
                arrowAnnotateTool() {
                    (0, C.fO)("ArrowAnnotate", {
                        mouseButtonMask: 1
                    })
                }
                annotateTool() {
                    (0, C.fO)("Annotate", {
                        mouseButtonMask: 1
                    })
                }
                LRMarkerTool(e) {
                    "L" === e ? (0, C.fO)("AnnL", {
                        mouseButtonMask: 1
                    }) : (0, C.fO)("AnnR", {
                        mouseButtonMask: 1
                    })
                }
                heartratioTool() {
                    (0, C.fO)("Heartratio", {
                        mouseButtonMask: 1
                    })
                }
                AITool(e = !1) {
                    e ? (0, C.sO)("AI") : (0, C.lQ)("AI")
                }
                cancelTool(e, t = !0) {
                    M.globalImageIdSpecificToolStateManager.clear(e), t && (0, r.updateImage)(e)
                }
                cancelToolAndDefaultViewportTools(e) {
                    return Ve(this, arguments, void 0, (function*(e, t = !1, n = !1) {
                        t && (yield function() {
                            return Re(this, arguments, void 0, (function*(e = !0) {
                                const {
                                    studyArr: t
                                } = f.A.webDicomView;
                                M.globalImageIdSpecificToolStateManager.restoreToolState({});
                                for (const e of t) {
                                    const {
                                        studyUID: t
                                    } = e || {};
                                    yield Be(t, !1)
                                }
                                Ue(), e && Ce()
                            }))
                        }()), n && (yield function() {
                            return De(this, arguments, void 0, (function*(e = !1) {
                                const {
                                    studyArr: t
                                } = f.A.webDicomView;
                                ke({});
                                for (const e of t) {
                                    const {
                                        studyUID: t
                                    } = e || {};
                                    yield _e(t, !1)
                                }
                                e && Ce()
                            }))
                        }()), "all" === e && (e = (yield(0, Se.A)(!0)).map((({
                            element: e
                        }) => e)));
                        for (const n of e) try {
                            if (!n) continue;
                            const e = (0, r.getImage)(n),
                                o = (0, r.getDefaultViewportForImage)(n, e),
                                {
                                    colormap: a
                                } = (0, r.getViewport)(n) || {};
                            a && (0, C.fs)(n), !t && this.cancelTool(n, !1), (0, r.setViewport)(n, Object.assign(Object.assign({}, o), {
                                sharpen: 0,
                                blur: 0
                            }))
                        } catch (e) {
                            W(e)
                        }
                    }))
                }
            },
            He = (0, M.importInternal)("util/scrollToIndex");
        const qe = class {
            constructor() {
                this.layoutclassName = "series-slider-layout", this.EVENTSHandle = new Map
            }
            changMarker(e, t) {
                const n = e.querySelector(".filmMarker");
                n && (n.innerText = (0, u.gV)(n.innerText, String(t + 1)))
            }
            createLayout(e, n, o) {
                var a;
                this.removeLayout(e);
                let i = e.querySelector(`.${this.layoutclassName}`);
                const {
                    imgRow: s,
                    imgColumn: l
                } = e.dataset, c = Number(null != s ? s : 1) * Number(null != l ? l : 1), u = Math.ceil((null !== (a = null == n ? void 0 : n.imgs.length) && void 0 !== a ? a : NaN) / c), d = {
                    currentIndex: 0,
                    _scrollLen: 0,
                    get scrollLen() {
                        var e;
                        return this._scrollLen = null !== (e = this._scrollLen || (null == i ? void 0 : i.clientHeight)) && void 0 !== e ? e : NaN
                    },
                    set scrollLen(e) {
                        this._stepLen = 0, this._scrollLen = e
                    },
                    _stepLen: 0,
                    get stepLen() {
                        return this._stepLen = this._stepLen || this.scrollLen * (u - 1) / u
                    }
                }, h = t => {
                    e.dataset.currentImageIdIndex = String(d.currentIndex), (0, r.triggerEvent)(r.events, "series_scroll", {
                        element: e,
                        imageIds: t,
                        currentIndex: d.currentIndex,
                        isSeriesImage: 1 !== c
                    })
                };
                if (!i) {
                    const n = () => {
                        var n;
                        const [{
                            currentImageIdIndex: r = o || 0,
                            imageIds: a
                        }] = (null === (n = (0, M.getToolState)(e, "stack")) || void 0 === n ? void 0 : n.data) || [{}], {
                            scrollLen: s
                        } = d;
                        if (i && (i.scrollTop = s * r), r && r % 100 == 0 && (0, t.kX)("scroll", !1), 1 === c) this.changMarker(e, r), d.currentIndex = r;
                        else {
                            let t = r;
                            if (t >= u && (t = u, He(e, f.A.webDicomView.layoutView.iconPlayer.playerStatus ? 0 : t - 1)), d.currentIndex === t) return;
                            d.currentIndex = t
                        }
                        h(a)
                    };
                    i = (0, S.n)({
                        className: this.layoutclassName
                    });
                    const a = (0, S.n)();
                    a.style.height = `calc(100% * ${u})`, i.appendChild(a), e.appendChild(i), o && (He(e, o), i.scrollTop = d.scrollLen * o, o = void 0), this.EVENTSHandle.set(e, n), e.addEventListener(r.EVENTS.NEW_IMAGE, n), i.addEventListener("scroll", (t => {
                        var n;
                        if (i && d.scrollLen !== i.clientHeight) return d.scrollLen = i.clientHeight;
                        const o = t.target,
                            {
                                stepLen: a,
                                currentIndex: s
                            } = d,
                            l = Math.floor(o.scrollTop / a);
                        if (!(l >= u || s == l) && (He(e, l), d.currentIndex = l, (0, r.triggerEvent)(r.events, "canvas_active", {
                                $canvas: e,
                                type: "wheel"
                            }), 1 !== c)) {
                            const [{
                                imageIds: t
                            }] = (null === (n = (0, M.getToolState)(e, "stack")) || void 0 === n ? void 0 : n.data) || [{}];
                            h(t)
                        }
                    }))
                }
            }
            removeLayout(e) {
                const t = this.EVENTSHandle.get(e),
                    n = e.querySelector(`.${this.layoutclassName}`);
                t && e.removeEventListener(r.EVENTS.NEW_IMAGE, t), this.EVENTSHandle.delete(e), null == n || n.remove()
            }
        };
        var je = __webpack_require__(9788);
        const ze = class {
            constructor() {
                this.className = "study-slider-layout"
            }
            createLayout(e, t, n, o = !1) {
                let a = e.querySelector(`.${this.className}`);
                const {
                    x: i,
                    y: s
                } = n, l = Number(null != i ? i : 1) * Number(null != s ? s : 1), c = Math.ceil(t.length / l), u = this.scrollData = {
                    currentIndex: 0,
                    _scrollLen: 0,
                    get scrollLen() {
                        return this._scrollLen = this._scrollLen || (null == a ? void 0 : a.clientHeight)
                    },
                    set scrollLen(e) {
                        this._stepLen = 0, this._scrollLen = e
                    },
                    _stepLen: 0,
                    get stepLen() {
                        return this._stepLen = this._stepLen || this.scrollLen * (c - 1) / c
                    }
                };
                if (o && (this.container.remove(), this.container = a = null), !a) {
                    this.container = a = (0, S.n)({
                        className: this.className
                    });
                    const t = (0, S.n)();
                    f.A.webDicomView.layoutView.canvasContainer.style.paddingRight = c <= 1 || f.A.isMobile ? "0px" : "12px", a.style.display = c > 1 ? "block" : "none", t.style.height = `calc(100% * ${c})`, a.appendChild(t), e.appendChild(a), a.addEventListener("scroll", (e => {
                        if (a && u.scrollLen !== a.clientHeight) return u.scrollLen = a.clientHeight;
                        const {
                            target: t
                        } = e, {
                            stepLen: n,
                            currentIndex: o
                        } = u, i = Math.floor(t.scrollTop / n);
                        i >= c || o == i || ((0, je.Ay)("triggerEvent_study_scroll", (0, S.sg)((e => {
                            (0, r.triggerEvent)(r.events, "study_scroll", e)
                        }), 300), {
                            currentIndex: i,
                            layoutCount: l
                        }), u.currentIndex = i)
                    }))
                }
            }
            visibility(e) {
                this.container.style.visibility = e ? "visible" : "hidden"
            }
            setIndex(e) {
                this.container.scrollTop = this.scrollData.stepLen * e + 1
            }
        };
        const We = class {
            constructor(e, t) {
                this.iconPlayer = e, this.container = t
            }
            createLayout(e, t) {
                const n = 0 === t;
                n && this.createOrEditInfoBar(e, n), 1 === t && this.createMenuBtn(), this.addItemMenu(e, n)
            }
            createOrEditInfoBar(e, t) {
                const {
                    modality: n,
                    name: o,
                    sex: r,
                    age: a,
                    studydate: i
                } = e, s = `<span class='name' title='${o}'>${o||"-"}</span> / ${(0,Ie.E)(r)||"-"}  / ${(0,Ie.A)(a)||"-"}  / ${i||"-"} `;
                if (t) {
                    this.infoBarContainer = (0, S.n)({
                        className: "info-bar"
                    });
                    const e = (0, S.n)({
                            className: "modality",
                            innerText: `${n}`
                        }),
                        t = (0, S.n)({
                            className: "details",
                            innerHTML: s
                        });
                    this.infoBarContainer.append(e, t), this.container.appendChild(this.infoBarContainer)
                } else {
                    if (!this.infoBarContainer) throw "infoBarContainer is not defined for createOrEditInfoBar";
                    this.infoBarContainer.querySelector(".details").innerHTML = s, this.infoBarContainer.querySelector(".modality").innerText = n
                }
            }
            createMenuBtn() {
                if (!this.infoBarContainer) return;
                const e = (0, S.n)({
                    className: "menu-btn",
                    innerText: (0, g.Tl)("other.toggleStudy"),
                    onclick: () => {
                        this.iconPlayer.playerPause(), this.toggleMenuVisibility()
                    }
                });
                this.infoBarContainer.appendChild(e)
            }
            activeFirst() {
                var e;
                const t = null === (e = this.menuContainer) || void 0 === e ? void 0 : e.querySelector(".menu-item");
                null == t || t.click()
            }
            addItemMenu(e, t) {
                var n;
                const {
                    modality: o,
                    name: r,
                    sex: a,
                    age: i,
                    studydate: s,
                    studyUID: l
                } = e;
                t && (this.menuContainer = (0, S.n)({
                    className: "menu hidden"
                }), this.container.appendChild(this.menuContainer));
                const c = (0, S.n)({
                    className: `menu-item ${t&&"active"}`,
                    onclick: () => {
                        var t, n;
                        const o = null === (t = this.container.parentElement) || void 0 === t ? void 0 : t.querySelectorAll(".study-navigation-body .study-navigation-container"),
                            r = null === (n = this.menuContainer) || void 0 === n ? void 0 : n.querySelectorAll(".menu-item");
                        if (!o || !r) throw "navigationList and menuList is undefined for addItemMenu";
                        (0, u.M1)(o, (e => !(l === e.dataset.studyUID)), "hidden"), (0, u.M1)(r, (e => l === e.dataset.studyUID)), this.createOrEditInfoBar(e, !1), this.toggleMenuVisibility(!1)
                    }
                });
                c.dataset.studyUID = l;
                const d = (0, S.n)({
                        className: "modality",
                        innerText: `${o}`
                    }),
                    h = (0, S.n)({
                        className: "info",
                        innerHTML: `<span class='name' title='${r}'>${r}</span> / ${(0,Ie.E)(a)}  / ${(0,Ie.A)(i)} `
                    }),
                    f = (0, S.n)({
                        className: "study-date",
                        innerText: `${s}`
                    }),
                    m = (0, S.n)({
                        className: "icon",
                        innerHTML: '<i class="icon-dicom-arrow"</i>'
                    });
                c.append(d, h, f, m), null === (n = this.menuContainer) || void 0 === n || n.appendChild(c)
            }
            toggleMenuVisibility(e) {
                const t = this.menuContainer;
                if (!t) return;
                const n = void 0 === e ? t.classList.contains("hidden") : e;
                (0, u.wf)(t, !n, "hidden")
            }
        };
        var Ge = __webpack_require__(1468),
            Ye = __webpack_require__(5435);
        const Ze = class {
            constructor(e, t) {
                this.data = [{
                    title: "10FPS/S",
                    val: 10
                }, {
                    title: "20FPS/S",
                    val: 20
                }, {
                    title: "30FPS/S",
                    val: 30
                }, {
                    title: "40FPS/S",
                    val: 40
                }, {
                    title: "50FPS/S",
                    val: 50
                }];
                const n = e.target;
                new ne("fps", {
                    btnTarget: n,
                    events: e,
                    direction: "top"
                }, (e => {
                    for (const {
                            title: n,
                            val: o
                        } of this.data) {
                        const r = (0, S.n)({
                            className: "select-popup-item",
                            title: n,
                            innerText: n,
                            onclick: () => {
                                t(o)
                            }
                        });
                        e.appendChild(r)
                    }
                }))
            }
        };
        var Ke = function(e, t, n, o) {
            return new(n || (n = Promise))((function(r, a) {
                function i(e) {
                    try {
                        l(o.next(e))
                    } catch (e) {
                        a(e)
                    }
                }

                function s(e) {
                    try {
                        l(o.throw(e))
                    } catch (e) {
                        a(e)
                    }
                }

                function l(e) {
                    var t;
                    e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                        e(t)
                    }))).then(i, s)
                }
                l((o = o.apply(e, t || [])).next())
            }))
        };
        const Xe = (0, M.importInternal)("util/scrollToIndex"),
            Je = e => {
                var t;
                if (!(0, Ye.A)(e)) return {
                    imageIds: [],
                    currentImageIdIndex: NaN,
                    seriesImagesLen: 0,
                    imagesPages: NaN
                };
                const [{
                    currentImageIdIndex: n = 0,
                    imageIds: o = []
                }] = (null === (t = (0, M.getToolState)(e, "stack")) || void 0 === t ? void 0 : t.data) || [{}];
                return {
                    imageIds: o,
                    currentImageIdIndex: Number(n),
                    seriesImagesLen: o.length,
                    imagesPages: Qe(e, o.length)
                }
            },
            Qe = (e, t) => {
                var n;
                const o = null === (n = (0, re.z9)(e)) || void 0 === n ? void 0 : n.length;
                return o ? Math.ceil(t / o) : t
            };
        const $e = class {
            constructor() {
                this.eventNamespace = "player", this.enableColor = "white", this.disableColor = "gray", this.framesPerSecond = 10, this.addCanvasActiveEventLazy = (0, S.nF)(this.addCanvasActiveEvent, 100), this.toggleControlStyleLazy = (0, S.nF)(this.toggleControlStyle, 500);
                const e = this.t = (0, g.Tl)("player");
                this.EVENTSHandle = new Map, this.playerStatus = !0, this.playData = [{
                    id: "player1001",
                    title: e.first,
                    flag: "control",
                    icon: "icon-dicom-first",
                    cssText: "display: none;"
                }, {
                    id: "player1002",
                    title: e.prev,
                    flag: "control",
                    icon: "icon-dicom-previous"
                }, {
                    id: "player1003",
                    title: e.play,
                    flag: "control",
                    cssText: `color: ${this.enableColor};`,
                    icon: "icon-dicom-play"
                }, {
                    id: "player1004",
                    title: e.next,
                    flag: "control",
                    icon: "icon-dicom-next"
                }, {
                    id: "player1005",
                    title: e.last,
                    flag: "control",
                    icon: "icon-dicom-last",
                    cssText: "display: none;"
                }], this.iconControls = []
            }
            createPlayer(e, t, n = 10) {
                var o;
                const a = e.parentElement,
                    i = a.querySelector("div.player-bar");
                if (i) return this.playerStatus = !1, void a.removeChild(i);
                this.playerStatus = !((null === (o = t.loadIds) || void 0 === o ? void 0 : o.length) > 1), this.elementPlayClip = e, this.framesPerSecond = Math.round(n);
                const {
                    imagesPages: s,
                    currentImageIdIndex: l
                } = Je(e);
                if (!s) return;
                const c = (0, S.n)({
                        className: "player-bar"
                    }),
                    d = (0, S.n)({
                        className: "slider-group"
                    }),
                    h = (0, S.n)({
                        tagName: "input",
                        className: "slider",
                        type: "range",
                        min: 0,
                        max: s - 1,
                        step: 1,
                        value: l,
                        oninput: t => {
                            const n = Number(t.target.value);
                            Xe(e, n)
                        },
                        onmousedown: () => {
                            this.playerPause(e)
                        },
                        ontouchstart: () => {
                            this.playerPause(e)
                        }
                    }),
                    m = (0, S.n)({
                        className: "slider-info",
                        innerText: `${l+1}/${s}`
                    });
                d.append(h, m), c.appendChild(d);
                const g = (0, S.n)({
                        className: "body-group"
                    }),
                    p = (0, S.n)({
                        className: "fps-option",
                        innerHTML: `${this.framesPerSecond}FPS/S`,
                        onclick: e => Ke(this, void 0, void 0, (function*() {
                            yield(0, u.uk)(100), new Ze(e, (e => {
                                this.framesPerSecond = e, p.innerHTML = `${this.framesPerSecond}FPS/S`, y.value = String(this.framesPerSecond), this.playerStatus && this.playerStart()
                            }))
                        }))
                    }),
                    v = (0, S.n)({
                        className: "fps-custom"
                    }),
                    y = (0, S.n)({
                        className: "custom-input hidden",
                        tagName: "input",
                        type: "tel",
                        maxLength: 100,
                        value: this.framesPerSecond,
                        onkeyup: e => {
                            var t;
                            const n = e.target;
                            if ("Backspace" === e.key) return;
                            const o = null === (t = null == n ? void 0 : n.value) || void 0 === t ? void 0 : t.replace(/[^\d]/g, "");
                            if (n.value = String((0, u.qE)("" === o ? this.framesPerSecond : Number(o), 1, 50)), "Enter" === e.key) {
                                if (s <= 1) return;
                                this.playerStart(), (0, u.wf)(y, !0, "hidden")
                            }
                        },
                        onblur: e => {
                            const t = e.target,
                                n = null == t ? void 0 : t.value;
                            this.framesPerSecond = Number(n) || this.framesPerSecond || 10, t.value = String(this.framesPerSecond), (0, u.wf)(b, !1, "hidden"), (0, u.wf)(y, !0, "hidden"), p.innerHTML = `${this.framesPerSecond}FPS/S`, this.playerStatus && this.playerStart()
                        }
                    }),
                    b = (0, S.n)({
                        tagName: "span",
                        innerText: this.t.custom,
                        onclick: () => {
                            (0, u.wf)(b, !0, "hidden"), (0, u.wf)(y, !1, "hidden"), y.value = "", y.focus()
                        }
                    }),
                    w = (0, S.n)({
                        className: "fps-play"
                    });
                for (let n = 0; n < this.playData.length; n++) {
                    const {
                        flag: o,
                        title: a,
                        cssText: i,
                        icon: s,
                        id: l
                    } = this.playData[n];
                    switch (o) {
                        case "control":
                            {
                                const o = (0, S.n)({
                                    tagName: "i",
                                    className: `control ${s} ${l}`,
                                    title: a
                                });o.style.cssText = i,
                                o.addEventListener(f.A.isMobile ? "touchstart" : "click", (o => {
                                    const a = {
                                        event: o,
                                        series: t,
                                        playerData: this.playData[n],
                                        playerTarget: e
                                    };
                                    (0, r.triggerEvent)(r.events, "iconplayer_series", a)
                                })),
                                this.iconControls.push(o),
                                w.appendChild(o);
                                break
                            }
                    }
                }
                v.append(y, b), g.append(p, v, w), c.appendChild(g), a.appendChild(c), this.toggleControlStyle(l, s);
                const x = () => {
                    const {
                        imagesPages: t,
                        currentImageIdIndex: n
                    } = Je(e);
                    m.innerText = `${n+1}/${t}`, h.value = String(n), this.toggleControlStyleLazy(n, t)
                };
                this.addCanvasActiveEventLazy(), this.EVENTSHandle.set(e, x), e.addEventListener(r.EVENTS.NEW_IMAGE, x), this.togglePalyerTool(!0)
            }
            getPlayerBarELs() {
                return f.A.webDicomView.globalContainer.querySelectorAll(".player-bar")
            }
            addCanvasActiveEvent() {
                return Ke(this, void 0, void 0, (function*() {
                    this.removeCanvasActiveEvent(), r.events.addEventNamespaceListener(`canvas_active.${this.eventNamespace}`, (e => Ke(this, void 0, void 0, (function*() {
                        const {
                            $canvas: t
                        } = e.detail, n = f.A.webDicomView.queryCurrentSeries();
                        if (1 === this.getPlayerBarELs().length && (t === this.elementPlayClip || !(0, Ye.A)(t))) return this.playerPause();
                        yield this.playerAllPauseAndRemove(), this.createPlayer(t, n)
                    }))))
                }))
            }
            removeCanvasActiveEvent() {
                r.events.removeEventNamespaceListener(`canvas_active.${this.eventNamespace}`)
            }
            playerToggle(e, t) {
                var n;
                if (t && (this.elementPlayClip = t), !this.elementPlayClip) return;
                const o = null === (n = this.elementPlayClip.parentElement) || void 0 === n ? void 0 : n.querySelector(".player1003");
                o && this.playerToggleHandle(o, e)
            }
            playerStart(e) {
                this.playerToggle(!0, e)
            }
            playerPause(e) {
                this.playerToggle(!1, e)
            }
            playerAllPauseAndRemove(e) {
                return Ke(this, void 0, void 0, (function*() {
                    yield Promise.all((yield(0, Se.A)(!0)).filter((({
                        element: t
                    }) => e !== t)).map((e => Ke(this, [e], void 0, (function*({
                        element: e
                    }) {
                        (0, M.stopClip)(e), yield this.playerRemove(e)
                    })))))
                }))
            }
            playerRemove(e) {
                return Ke(this, arguments, void 0, (function*(e, n = !0) {
                    var o;
                    const a = e || this.elementPlayClip;
                    if (a) try {
                        const e = null === (o = a.parentElement) || void 0 === o ? void 0 : o.querySelector("div.player-bar");
                        e && ((0, M.stopClip)(a), e.remove(), n && (0, t.r)("playerRemove"), this.togglePalyerTool(!1)), this.playerStatus = !1, this.iconControls = [], this.elementPlayClip = null
                    } catch (e) {
                        W(e)
                    } finally {
                        const e = this.EVENTSHandle.get(a);
                        this.removeCanvasActiveEvent(), e && a.removeEventListener(r.EVENTS.NEW_IMAGE, e), this.EVENTSHandle.delete(a)
                    }
                }))
            }
            playerBarClickHandle(e) {
                return Ke(this, void 0, void 0, (function*() {
                    var t, n;
                    const {
                        playerData: o,
                        playerTarget: r,
                        event: a
                    } = e, i = a.target;
                    if (a.stopPropagation(), a.preventDefault(), this.getPlayerBarELs().length > 1) return null === (n = (0, Ge.A)(f.A.isMobile ? null === (t = f.A.webDicomView.queryCurrentContainer()) || void 0 === t ? void 0 : t.seriesDom : r)) || void 0 === n || n.click(), yield(0, u.uk)(100), void this.playerBarClickHandle(e);
                    if (a.target.style.color === this.disableColor) return;
                    const {
                        imagesPages: s,
                        currentImageIdIndex: l
                    } = Je(r);
                    let c = l;
                    switch (this.elementPlayClip = r, o.id) {
                        case "player1001":
                            c = 0;
                            break;
                        case "player1002":
                            l >= 1 && (c -= 1);
                            break;
                        case "player1003":
                            this.playerToggleHandle(i, !this.playerStatus);
                            break;
                        case "player1004":
                            l < s - 1 && (c += 1);
                            break;
                        case "player1005":
                            c = s - 1
                    }
                    Xe(r, c)
                }))
            }
            playerToggleHandle(e, n = !1) {
                if (!this.elementPlayClip) throw "container is not available";
                const {
                    currentImageIdIndex: o,
                    imagesPages: r
                } = Je(this.elementPlayClip);
                (0, t.r)(n ? "playerResume" : "playerPause"), (0, M.stopClip)(this.elementPlayClip), this.playerStatus = n, this.toggleControlStyle(o, r), n ? (e.title = this.t.pause, (0, u.wf)(e, !1, "icon-dicom-play"), (0, u.wf)(e, !0, "icon-dicom-pause"), (0, M.playClip)(this.elementPlayClip, this.framesPerSecond)) : (e.title = this.t.play, (0, u.wf)(e, !1, "icon-dicom-pause"), (0, u.wf)(e, !0, "icon-dicom-play"))
            }
            togglePalyerTool(e) {
                return Ke(this, void 0, void 0, (function*() {
                    yield(0, u.uk)(), (0, u.wf)(f.A.webDicomView.layoutView.querySelectorForTool(".player"), e)
                }))
            }
            toggleControlStyle(e, t) {
                if (this.iconControls.length) {
                    if (t <= 1) return this.iconControls[0].style.color = this.disableColor, this.iconControls[1].style.color = this.disableColor, this.iconControls[2].style.color = this.disableColor, this.iconControls[3].style.color = this.disableColor, void(this.iconControls[4].style.color = this.disableColor);
                    if (this.playerStatus) return this.iconControls[0].style.color = this.disableColor, this.iconControls[1].style.color = this.disableColor, this.iconControls[3].style.color = this.disableColor, void(this.iconControls[4].style.color = this.disableColor);
                    if (e <= 0) return this.iconControls[0].style.color = this.disableColor, this.iconControls[1].style.color = this.disableColor, this.iconControls[3].style.color = this.enableColor, void(this.iconControls[4].style.color = this.enableColor);
                    if (e >= t - 1) return this.iconControls[0].style.color = this.enableColor, this.iconControls[1].style.color = this.enableColor, this.iconControls[3].style.color = this.disableColor, void(this.iconControls[4].style.color = this.disableColor);
                    this.iconControls[0].style.color = this.enableColor, this.iconControls[1].style.color = this.enableColor, this.iconControls[3].style.color = this.enableColor, this.iconControls[4].style.color = this.enableColor
                }
            }
        };
        var et = function(e, t, n, o) {
            return new(n || (n = Promise))((function(r, a) {
                function i(e) {
                    try {
                        l(o.next(e))
                    } catch (e) {
                        a(e)
                    }
                }

                function s(e) {
                    try {
                        l(o.throw(e))
                    } catch (e) {
                        a(e)
                    }
                }

                function l(e) {
                    var t;
                    e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                        e(t)
                    }))).then(i, s)
                }
                l((o = o.apply(e, t || [])).next())
            }))
        };
        const tt = class {
            constructor(e, t, n) {
                this.seriesSlider = e, this.studySlider = t, this.iconSynchronizer = n, this.seriesLayouts = []
            }
            initSingle(e, t, n, o) {
                n = Object.assign({
                    imgRow: "1",
                    imgColumn: "1"
                }, n);
                const {
                    synchronizerStatus: r,
                    scrollIndex: a
                } = o || {};
                for (const [t, o] of Object.entries(n || {})) !(0, S.TB)(o) && (e.dataset[t] = o);
                (0, S.TB)(t) || (this.seriesSlider.createLayout(e, t, a), this.iconSynchronizer.createIconSynchronizer(e, r))
            }
            createCanvasSeries(e, t, n, o = !0) {
                var a;
                const i = [],
                    s = n.y,
                    l = n.x,
                    c = s * l;
                null === (a = e.querySelector(".container")) || void 0 === a || a.remove();
                const d = (0, S.n)({
                    className: "container"
                });
                (0, u.Wp)(d, {
                    style: `\n\t\t\t\tdisplay:grid;\n\t\t\t\tgrid-template-columns: repeat(${l}, calc(100% / ${l}));\n\t\t\t\tgrid-template-rows: repeat(${s}, calc(100% / ${s}));\n\t\t\t\t`
                });
                for (let e = 0; e < c; e++) {
                    const n = t[e],
                        {
                            seriesUID: r,
                            studyUID: a,
                            imgs: u,
                            flatSeries: h
                        } = n || {},
                        f = (0, S.n)({
                            className: "layoutCellsOuter" + (1 === c ? " singleBoxMode" : "")
                        }),
                        m = (0, S.n)({
                            className: re.r0
                        }),
                        g = (null == u ? void 0 : u.length) || 0;
                    r && (m.dataset.seriesUID = r, m.dataset.studyUID = a, m.dataset.seriesIndex = String(e), m.dataset.seriesRow = String(s), m.dataset.seriesColumn = String(l), h && (m.dataset.flatSeries = String(h))), this.initSeriesLayout(m, n), o && g && (this.seriesSlider.createLayout(m, n), this.iconSynchronizer.createIconSynchronizer(m)), i.push(m), f.appendChild(m), d.appendChild(f)
                }
                this.studySlider.createLayout(e, t, n), e.appendChild(d), (0, r.triggerEvent)(r.events, "first_active", {
                    $canvas: i[0]
                })
            }
            createImagesLayout(e, t, n) {
                const o = n.y,
                    r = n.x,
                    a = o * r;
                e.dataset.imgRow = String(o), e.dataset.imgColumn = String(r), this.seriesSlider.createLayout(e, t);
                const i = (0, S.n)({
                    className: "imageLayoutGroup"
                });
                (0, u.Wp)(i, {
                    style: `\n\t\t\t\theight:100%;\n\t\t\t\tdisplay:grid;\n\t\t\t\tgrid-template-columns: repeat(${r}, calc(100% / ${r}));\n\t\t\t\tgrid-template-rows: repeat(${o}, calc(100% / ${o}));\n\t\t\t\t`
                });
                for (let t = 0; t < a; t++) {
                    const n = (0, S.n)({
                        className: re.Ht + (0 === t ? " active" : "")
                    });
                    new Hammer(n).on("tap press panstart", (n => {
                        (0, u.M1)(e.querySelectorAll(`.${re.Ht}`), ((e, n) => t === n)), n.preventDefault()
                    })), i.appendChild(n)
                }
                e.appendChild(i)
            }
            dblclickCanvasLayout(e, t, n) {
                if (e.classList.contains("singleBoxMode")) return;
                const o = (0, re.z9)(t),
                    a = null != n ? n : e.classList.contains("signBigLayout"),
                    i = f.A.webDicomView.querySeries(t.dataset.seriesUID);
                i && ((0, u.wf)(e, !a, "signBigLayout"), o.length ? o.forEach((e => {
                    (0, r.resize)(e)
                })) : (0, r.resize)(t), this.studySlider.visibility(a), this.seriesSlider.createLayout(t, i, Number(t.dataset.currentImageIdIndex)))
            }
            initSeriesLayout(e, t) {
                const n = (e, t) => {
                    (0, r.triggerEvent)(r.events, "canvas_active", {
                        $canvas: e,
                        type: t
                    })
                };
                e.addEventListener("dragover", (e => {
                    e.preventDefault()
                })), e.addEventListener("drop", (t => {
                    t.preventDefault(), n(e, "drop")
                })), e.addEventListener("wheel", (() => {
                    n(e, "wheel")
                })), e.addEventListener("click", (t => {
                    "CANVAS" === t.target.tagName && n(e, "click")
                })), e.addEventListener("touchstart", (t => {
                    const {
                        type: o
                    } = t;
                    n(e, "touchstart"), (0, r.triggerEvent)(r.events, "layout_area_focus", {
                        area: "seriesLayout",
                        type: o
                    })
                })), new Hammer(e).on("doubletap", (t => et(this, void 0, void 0, (function*() {
                    if ("CANVAS" !== t.target.tagName) return;
                    const {
                        webDicomViewPrint: n,
                        webDicomViewStitching: o
                    } = f.A.webDicomView;
                    return (null == n ? void 0 : n.isInit) ? (0, r.triggerEvent)(r.events, "add_print", {
                        currentElement: e
                    }) : (null == o ? void 0 : o.isInit) ? (0, r.triggerEvent)(r.events, "add_stitching", {
                        currentElement: e
                    }) : void this.dblclickCanvasLayout(e.parentElement, e)
                })))), e.addEventListener(r.EVENTS.IMAGE_RENDERED, (e => {
                    (0, r.triggerEvent)(r.events, "images_viewport", e.detail)
                })), this.seriesLayouts.push({
                    seriesUID: null == t ? void 0 : t.seriesUID,
                    seriesDom: e
                })
            }
            seriesLayoutsUpdate(e, t) {
                this.seriesLayouts.forEach((n => {
                    e === n.seriesDom && (n.seriesUID = t)
                }))
            }
            toggleSeriesStyle(e) {
                const {
                    target: t,
                    seriesUID: n,
                    seriesIndex: o
                } = e;
                f.A.webDicomView.layoutView.canvasContainer.querySelectorAll(".layoutCellsOuter").forEach((e => {
                    const r = (0, re.Cb)(e);
                    if (!r) throw "canvas is init";
                    const {
                        seriesUID: a,
                        seriesIndex: i
                    } = r.dataset;
                    if (null != t && r === t || null != n && a === n || null != o && Number(i) === o) {
                        if ((0, u.wf)(e, !0), (0, u.wf)(r, !0), r.classList.contains("noActiveBorder")) {
                            const e = (0, re.z9)(r)[0];
                            e ? (0, re.er)(r) || e.click() : (0, u.wf)(r, !1, "noActiveBorder")
                        }
                    } else(0, u.wf)(e, !1), (0, u.wf)(r, !1), (0, u.M1)(e.querySelectorAll(`.${re.Ht}`), (() => !1))
                }))
            }
            toggleNavigatorInfo(e, t = !0) {
                f.A.webDicomView.layoutView.leftSideContainer.querySelectorAll(".viewer-navigator-wrapper").forEach((n => {
                    var o;
                    if (n.dataset.seriesUID == e) {
                        (0, u.wf)(n, !0), t && (0, u.wf)(n, !0, "showProgress");
                        const e = null === (o = n.parentElement) || void 0 === o ? void 0 : o.parentElement;
                        if (e.classList.contains("active"))(0, u.Rt)(n);
                        else {
                            const t = e.querySelector(".panel-info");
                            null == t || t.click(), (0, u.Rt)(n, 750)
                        }
                    } else(0, u.wf)(n, !1), !f.A.preload.fullLoad && (0, u.wf)(n, !1, "showProgress")
                }))
            }
        };
        const nt = class {
            constructor(e) {
                this.id = e, this.ElementContent = void 0
            }
            createLayout() {
                let e = f.A.webDicomView.layoutView.querySelector(`#${this.id}`, {
                    tip: !1
                });
                if (e) e.style.zIndex = "5";
                else {
                    const t = f.A.webDicomView.layoutView.querySelector(".viewerContentWrapper");
                    this.ElementContent = e = (0, S.n)({
                        id: this.id,
                        oncontextmenu: e => e.preventDefault()
                    }), (0, u.Wp)(e, {
                        style: "\n\t\t\t    position: absolute;\n\t\t\t\t\ttop: 0;\n\t\t\t\t\tleft: 0;\n\t\t\t\t\tright: 0;\n\t\t\t\t\tbottom: 0;\n\t\t\t\t\tz-index: 5;\n\t\t\t\t\tbackground: #000;\n\t\t\t\t\tborder: 2px solid #CACACA;\n\t\t\t\t\tborder-top: none;\n\t\t\t\t\t// padding: 2px;\n\t\t\t\t\t// margin: 2px;\n          "
                    }), e.addEventListener("touchmove", (e => {
                        const {
                            type: t
                        } = e;
                        (0, r.triggerEvent)(r.events, "layout_area_focus", {
                            area: "seriesMPROr3DLayout",
                            type: t
                        }), e.preventDefault()
                    }), {
                        passive: !1
                    }), t.appendChild(e)
                }
                return e
            }
            hidden() {
                this.ElementContent && (this.ElementContent.style.zIndex = "-1")
            }
        };
        var ot = __webpack_require__(9093),
            rt = function(e, t, n, o) {
                return new(n || (n = Promise))((function(r, a) {
                    function i(e) {
                        try {
                            l(o.next(e))
                        } catch (e) {
                            a(e)
                        }
                    }

                    function s(e) {
                        try {
                            l(o.throw(e))
                        } catch (e) {
                            a(e)
                        }
                    }

                    function l(e) {
                        var t;
                        e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                            e(t)
                        }))).then(i, s)
                    }
                    l((o = o.apply(e, t || [])).next())
                }))
            };
        const at = class {
            constructor() {
                this.t = (0, g.Tl)("synchronizerSwitch")
            }
            createIconSynchronizer(e, t) {
                let n = e.querySelector(".seriesSynchronizerLayout");
                if ("stackPositionSynchronizer" === f.A.tackSynchronizerType) return this.removeSynchronizer(e), me(), void ot.dt();
                if (n) return;
                const {
                    seriesIndex: o
                } = e.dataset, r = 'iconCheckBox"' + o, {
                    title: a,
                    on: i,
                    off: s
                } = this.t;
                n = (0, S.n)({
                    className: "seriesSynchronizerLayout",
                    title: a,
                    onmousedown: e => {
                        e.stopPropagation()
                    },
                    onclick: t => {
                        var n;
                        this.triggerEventHandle(e, null === (n = t.target) || void 0 === n ? void 0 : n.checked)
                    },
                    ontouchstart: e => {
                        e.target.click()
                    }
                });
                const l = (0, S.n)({
                        tagName: "input",
                        className: "checkbox-input",
                        type: "checkbox",
                        checked: t,
                        id: r
                    }),
                    c = (0, S.n)({
                        tagName: "label",
                        className: "checkbox-label"
                    });
                (0, u.Wp)(c, {
                    for: r
                }), c.append((0, S.n)({
                    tagName: "span",
                    className: "circle"
                }), (0, S.n)({
                    tagName: "span",
                    className: "text on",
                    innerHTML: s
                }), (0, S.n)({
                    tagName: "span",
                    className: "text off",
                    innerHTML: i
                })), n.append(l, c), e.appendChild(n), this.triggerEventHandle(e, t)
            }
            createIconSynchronizers() {
                return rt(this, void 0, void 0, (function*() {
                    for (const {
                            element: e
                        } of yield(0, Se.A)(!0)) this.createIconSynchronizer(e, f.A.webDicomView.seriesLayoutState.getSynchronizerStatus(Number(e.dataset.seriesIndex)))
                }))
            }
            triggerEventHandle(e, t) {
                const n = {
                    element: e
                };
                switch (t) {
                    case !0:
                        (0, r.triggerEvent)(r.events, "series_synchronizer_add", n);
                        break;
                    case !1:
                        (0, r.triggerEvent)(r.events, "series_synchronizer_remove", n)
                }
            }
            removeSynchronizer(e) {
                const t = e.querySelector(".seriesSynchronizerLayout");
                null == t || t.remove()
            }
        };
        const it = class {
            createLayout(e, t, n) {
                const o = e => e >= 0 ? `${e||Math.max(n,.1)}mm` : "",
                    a = (0, g.Tl)("DICOMTags.thickness");
                e.forceRender = !0, new ne("thicknessLayout", e, (e => {
                    const n = (0, S.n)({
                            tagName: "span",
                            className: "label",
                            innerText: `${a}`
                        }),
                        i = (0, S.n)({
                            tagName: "span",
                            className: "num",
                            innerText: o(t)
                        }),
                        s = (0, S.n)({
                            className: "select-popup-item tool-event-link thickness"
                        }),
                        l = (0, S.n)({
                            tagName: "input",
                            type: "range",
                            min: 0,
                            max: 10,
                            step: 1,
                            value: t,
                            onclick: e => {
                                e.stopPropagation()
                            },
                            oninput: e => {
                                const t = Number(e.target.value);
                                i.innerText = o(t), (0, r.triggerEvent)(r.events, "tool_event", {
                                    events: e,
                                    toolData: {
                                        toolTag: "MPRThicknessChange",
                                        disActive: !0
                                    },
                                    value: t,
                                    btnTarget: s
                                })
                            }
                        });
                    s.append(n, l, i), e.appendChild(s)
                }))
            }
        };
        const st = class {
            constructor() {
                this.confirmSeries = {}, this.toastDict = (0, g.Tl)("toast"), this.formData = () => [{
                    label: this.toastDict.prompt.PTLabel,
                    type: "PT",
                    seriesArr: f.A.fusionData.PT
                }, {
                    label: this.toastDict.prompt.CTLabel,
                    type: "CT",
                    seriesArr: f.A.fusionData.CT
                }]
            }
            createLayout(e) {
                return new Promise((t => {
                    var n, o, r, a;
                    const {
                        webDicomView: i,
                        fusionData: s,
                        fusionData: {
                            PT: l,
                            CT: c
                        }
                    } = f.A;
                    if (!i.isStudiesLoaded(!0)) return t(null);
                    if (!l.length) return t(null), E().error({
                        title: this.toastDict.NoPTData
                    });
                    if (1 === l.length && 1 === c.length) return t({
                        PT: l[0],
                        CT: c[0]
                    });
                    const {
                        metaArrOriginal: [{
                            mod: d
                        }]
                    } = e;
                    this.activeSeries = (s[d] || []).find((({
                        seriesUID: t
                    }) => t === e.seriesUID)) || l[0], this.activeSeries2 = i.queryFusionSeries(this.activeSeries.metaArrOriginal)[0];
                    const {
                        layoutView: h
                    } = f.A.webDicomView, {
                        prompt: {
                            OK: m,
                            cancel: g
                        }
                    } = this.toastDict, p = (0, S.n)({
                        className: "fusionLayout fusion-form"
                    });
                    for (const {
                            label: e,
                            type: t,
                            seriesArr: i
                        } of this.formData()) {
                        const s = (0, S.n)({
                                className: `form-item ${t}`
                            }),
                            l = (0, S.n)({
                                className: "item-label",
                                innerText: e
                            }),
                            c = (0, S.n)({
                                className: "item-value"
                            });
                        (0, u.kA)(c);
                        for (const e of i) {
                            const {
                                seriesUID: a
                            } = e, i = (null === (n = this.activeSeries) || void 0 === n ? void 0 : n.seriesUID) === a || (null === (o = this.activeSeries2) || void 0 === o ? void 0 : o.seriesUID) === a, s = null === (r = h.leftSideContainer.querySelector(`.viewer-navigator-wrapper[data-series-u-i-d='${a}']`)) || void 0 === r ? void 0 : r.cloneNode(!0);
                            s ? (s.onclick = () => {
                                (0, u.M1)(c.childNodes, (e => s === e)), (0, u.Rt)(s), this.confirmSeries[t] = e
                            }, i && (0, u.uk)().then((() => {
                                s.click()
                            })), c.appendChild(s)) : console.error("seriesEL for FusionLayout: " + a)
                        }
                        null === (a = c.querySelector(".viewer-navigator-wrapper")) || void 0 === a || a.click(), s.append(l, c), p.appendChild(s)
                    }
                    E().question({
                        class: f.A.isMobile ? "custom-iziToast-question-mobile" : "custom-iziToast-question",
                        close: !1,
                        drag: !1,
                        timeout: !1,
                        overlay: !0,
                        theme: "dark",
                        color: "unset",
                        message: this.toastDict.prompt.fusionTitle,
                        displayMode: 1,
                        position: "center",
                        icon: "",
                        progressBar: !1,
                        inputs: [
                            ['<div class="fusion-temp"/>', "change", (e, t, n, o) => {}, !1]
                        ],
                        buttons: [
                            [`<button class='confirm' >${m}</button>`, (e, n, o, r, a) => {
                                e.destroy(), t(this.confirmSeries)
                            }, !1],
                            [`<button class='cancel' >${g}</button>`, (e, t, n, o) => {
                                e.hide({}, t, "cancel")
                            }, !1]
                        ],
                        onOpening: (e, t) => {
                            var n;
                            (0, T._)(t), null === (n = document.querySelector(".fusion-temp")) || void 0 === n || n.appendChild(p)
                        },
                        onClosing: function(e, n, o) {
                            "confirm" !== o && t(null)
                        }
                    })
                }))
            }
        };
        const lt = class {
            createLayout(e, t) {
                e.forceRender = !0, new ne("fusionLayout2", e, (e => {
                    var n, o;
                    const {
                        layoutView: a
                    } = f.A.webDicomView;
                    for (const i of t || []) {
                        const {
                            seriesUID: t
                        } = i, s = (null === (n = this.activeSeries) || void 0 === n ? void 0 : n.seriesUID) === t, l = (0, S.n)({
                            className: "select-popup-item tool-event-link",
                            onclick: e => {
                                this.activeSeries = s ? void 0 : i, (0, r.triggerEvent)(r.events, "tool_event", {
                                    events: e,
                                    toolData: {
                                        toolTag: "MPRFusionChange",
                                        disActive: !0
                                    },
                                    btnTarget: l,
                                    activeSeries: this.activeSeries
                                })
                            }
                        }), c = null === (o = a.leftSideContainer.querySelector(`.viewer-navigator-wrapper[data-series-u-i-d='${t}']`)) || void 0 === o ? void 0 : o.cloneNode(!0);
                        s && ((0, u.wf)(l, !0), (0, u.wf)(c, !0)), l.appendChild(c), e.appendChild(l)
                    }
                }))
            }
        };
        const ct = class {
            constructor() {
                this.toastDict = (0, g.Tl)("toast.interGPU")
            }
            get disTips() {
                return S.IG.getItem("disTips")
            }
            set disTips(e) {
                S.IG.setItem("disTips", e)
            }
            createLayout(t) {
                return new Promise((n => {
                    var o, r;
                    const {
                        isMobile: a,
                        instanceOptions: {
                            losslessMPR: i
                        }
                    } = f.A, {
                        force: s,
                        gpuTier: l,
                        seriesData: c
                    } = t, {
                        series: u,
                        fusionData: d
                    } = c || {}, {
                        gpu: h
                    } = l || {}, m = null == h ? void 0 : h.includes("intel");
                    if (!s && (((null === (r = null === (o = u || (null == d ? void 0 : d.CT)) || void 0 === o ? void 0 : o.loadIds) || void 0 === r ? void 0 : r.length) || 0) <= 200 || this.disTips || !m || !1 === i)) return n(null);
                    const {
                        close: p,
                        disReminders: v,
                        title: y,
                        tips: b
                    } = this.toastDict, w = (0, S.n)({
                        innerText: (m ? b[0] : "") + b[1]
                    }), x = (0, S.n)({
                        tagName: "a",
                        target: "_blank",
                        innerText: b[2],
                        href: `${(0,e.A)()}doc/IntelGPU&BrowserCompatibilitySolutions-${(0,g.Z0)().includes("zh")?"zh":"en"}.pdf`
                    });
                    Object.assign(x.style, {
                        color: "var(--theme-color2-dicom-viewer)"
                    });
                    const I = (0, S.n)({
                        tagName: "span",
                        innerText: b[3]
                    });
                    w.append(x, I), E().question({
                        class: a ? "custom-iziToast-question-mobile" : "custom-iziToast-question",
                        close: !1,
                        drag: !1,
                        timeout: !1,
                        overlay: !0,
                        theme: "dark",
                        color: "unset",
                        message: y,
                        displayMode: 1,
                        position: "center",
                        icon: "",
                        progressBar: !1,
                        inputs: [
                            ['<div class="inter-GPU-temp"/>', "change", (e, t, n, o) => {}, !1]
                        ],
                        buttons: [
                            [`<button class='confirm' >${p}</button>`, (e, t, o, r, a) => {
                                e.destroy(), n("ok")
                            }, !1],
                            [`<button class=' ${s?"hidden":"cancel"}' >${v}</button>`, (e, t, n, o) => {
                                e.hide({}, t, "cancel")
                            }, !1]
                        ],
                        onOpening: (e, t) => {
                            var n;
                            (0, T._)(t), null === (n = document.querySelector(".inter-GPU-temp")) || void 0 === n || n.appendChild(w)
                        },
                        onClosing: (e, t, o) => {
                            "confirm" !== o && (this.disTips = !0, n(null), x.click())
                        }
                    })
                }))
            }
        };
        var ut = __webpack_require__(2147);
        const dt = () => {
            const e = (0, g.Tl)("DICOMInfo"),
                t = (0, g.Tl)("DICOMTags");
            return [{
                title: e.patient,
                labels: [{
                    title: "name",
                    alias: t.name
                }, {
                    title: "sex",
                    alias: t.sex,
                    format: Ie.E
                }, {
                    title: "age",
                    alias: t.age,
                    format: Ie.A
                }, {
                    title: "birth",
                    alias: t.birthday
                }, {
                    title: "patientID",
                    alias: t.patientID
                }]
            }, {
                title: e.examinations,
                labels: [{
                    title: "orgname",
                    alias: t.hospitals
                }, {
                    title: "studydate",
                    alias: t.acquisitionDate
                }, {
                    title: "acqtm",
                    alias: t.acquisitionTime
                }, {
                    title: "studt",
                    alias: t.studyDate
                }, {
                    title: "stutm",
                    alias: t.studyTime
                }, {
                    title: "studes",
                    alias: t.description
                }, {
                    title: "accnum",
                    alias: t.accessionNumber
                }]
            }, {
                title: e.series,
                labels: [{
                    title: "serid",
                    alias: t.seriesID
                }, {
                    title: "seruid",
                    alias: t.seriesUID
                }, {
                    title: "serdes",
                    alias: t.seriesDescription
                }]
            }, {
                title: e.series,
                labels: [{
                    title: "imgnum",
                    alias: t.imageNumber
                }, {
                    title: "wc",
                    alias: t.windowCenter
                }, {
                    title: "ww",
                    alias: t.windowWidth
                }, {
                    title: "kv",
                    alias: t.KVP
                }, {
                    title: "sliceth",
                    alias: t.thickness
                }, {
                    title: "row",
                    alias: t.rows
                }, {
                    title: "col",
                    alias: t.cols
                }, {
                    title: "pixx",
                    alias: t.pixelSpacingX
                }, {
                    title: "pixy",
                    alias: t.pixelSpacingY
                }, {
                    title: "bita",
                    alias: t.bitsAllocated
                }, {
                    title: "bits",
                    alias: t.bitsStored
                }, {
                    title: "hbit",
                    alias: t.highBit
                }, {
                    title: "rescin",
                    alias: t.rescaleIntercept
                }, {
                    title: "rescsl",
                    alias: t.rescaleSlope
                }, {
                    title: "pixrep",
                    alias: t.pixelRepresentation
                }, {
                    title: "frames",
                    alias: "Frames"
                }, {
                    title: "sappix",
                    alias: t.samplesPerPixel
                }, {
                    title: "phme",
                    alias: t.photometricInterpretation
                }, {
                    title: "imgpos",
                    alias: t.imagePosition
                }, {
                    title: "imgori",
                    alias: t.imageOrientation
                }, {
                    title: "imgtype",
                    alias: "ImgType"
                }, {
                    title: "orl",
                    alias: t.orientationLeft
                }, {
                    title: "orr",
                    alias: t.orientationRight
                }, {
                    title: "ort",
                    alias: t.orientationTop
                }, {
                    title: "orb",
                    alias: t.orientationBottom
                }, {
                    title: "scount",
                    alias: "Scount"
                }, {
                    title: "blocks",
                    alias: t.blocks
                }]
            }, {
                title: e.device,
                labels: [{
                    title: "mod",
                    alias: t.modality
                }, {
                    title: "manu",
                    alias: t.manufacturer
                }]
            }, {
                title: e.UID,
                labels: [{
                    title: "id",
                    alias: "ID"
                }, {
                    title: "uid",
                    alias: "UID"
                }, {
                    title: "uuid",
                    alias: "UUID"
                }, {
                    title: "sopuid",
                    alias: t.sopInstanceUID
                }, {
                    title: "studyid",
                    alias: t.studyID
                }, {
                    title: "stuuid",
                    alias: t.studyUID
                }, {
                    title: "stuuid",
                    alias: t.studyUID
                }, {
                    title: "syntaxuid",
                    alias: t.transferSyntaxUID
                }, {
                    title: "relationid",
                    alias: "RelationID"
                }]
            }, {
                title: e.other,
                labels: [{
                    title: "fileName",
                    alias: t.fileName
                }, {
                    title: "fileLocation",
                    alias: "FileLocation"
                }, {
                    title: "dcmfile",
                    alias: "DCMFile"
                }]
            }]
        };
        var ht = function(e, t, n, o) {
            return new(n || (n = Promise))((function(r, a) {
                function i(e) {
                    try {
                        l(o.next(e))
                    } catch (e) {
                        a(e)
                    }
                }

                function s(e) {
                    try {
                        l(o.throw(e))
                    } catch (e) {
                        a(e)
                    }
                }

                function l(e) {
                    var t;
                    e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                        e(t)
                    }))).then(i, s)
                }
                l((o = o.apply(e, t || [])).next())
            }))
        };
        const ft = class {
            constructor() {
                this.toolsDataMPR = q(), this.toolsDataVRT = j(), this.toolsData = H(), this.topTools = new Fe, this.rotatePop = new ce, this.imageTypeLayout = new oe, this.wwwcLayout = new le, this.scale = new Te, this.colorMap = new ye, this.seriesMarker = new Ee, this.seriesImageCruxMarker = new Oe, this.seriesSlider = new qe, this.studySlider = new ze, this.iconSynchronizer = new at, this.seriesLayout = new tt(this.seriesSlider, this.studySlider, this.iconSynchronizer), this.mprLayout = new nt("MPRContent"), this.vrtLayout = new nt("VRTContent"), this.iconPlayer = new $e, this.ThicknessLayout = new it, this.FusionLayout = new st, this.FusionLayout2 = new lt, this.IntelGPULayout = new ct
            }
            resizeLayout(e = this.canvasContainer) {
                (0, re.RZ)(e).forEach((e => {
                    (0, re.z9)(e).forEach((e => {
                        try {
                            (0, r.resize)(e)
                        } catch (e) {}
                    }));
                    try {
                        (0, r.resize)(e)
                    } catch (e) {}
                }))
            }
            createImageTypeLayout(e) {
                this.imageTypeLayout.createLayout(e)
            }
            createWWWCLayout(e) {
                this.wwwcLayout.createLayout(e)
            }
            createRotateLayout(e) {
                this.rotatePop.createLayout(e)
            }
            createScaleLayout(e) {
                this.scale.createLayout(e)
            }
            createColorMapLayout(e) {
                this.colorMap.createLayout(e)
            }
            createDICOMMetaInfoLayout(e) {
                var t;
                let n = "";
                for (const {
                        title: o,
                        labels: r
                    } of dt()) {
                    n += `<div class='title'>${o}</div>`;
                    for (const {
                            title: o,
                            alias: a,
                            format: i = e => e
                        } of r) {
                        let r = null !== (t = e[o]) && void 0 !== t ? t : "";
                        r = i(r), n += `\n\t\t\t\t\t\t<div class='DICOM-meta-data-cell' title='${a&&a.toLowerCase()===o.toLowerCase()?"":a+","}${o}${r||"undefined"}'>\n\t\t\t\t\t\t<div class='label'>${a||o}</div>\n\t\t\t\t\t\t<div class='value'>${r}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t`
                    }
                }
                new ut.A((0, g.Tl)("tools.DICOMInfo"), n), console.info(e)
            }
            createAboutUsLayout(e) {
                const t = (0, g.Tl)("aboutUs"),
                    {
                        version: n,
                        copyright: o,
                        description: r,
                        tel: a,
                        imgURl: i
                    } = e,
                    s = (0, S.n)({
                        tagName: "div",
                        className: "about-Us-2"
                    }),
                    l = (0, S.n)({
                        tagName: "div",
                        className: "contains"
                    }),
                    c = (0, S.n)({
                        tagName: "div",
                        className: "bar"
                    }),
                    u = (0, S.n)({
                        tagName: "div",
                        className: "logo"
                    }),
                    d = r ? (0, S.n)({
                        tagName: "div",
                        className: "dark description",
                        innerHTML: `${"function"===(0,S.Bc)(r)?r():r}`
                    }) : "",
                    h = n ? (0, S.n)({
                        tagName: "div",
                        innerHTML: `<span class="dark">${t.releaseVersion}</span><span class="bold">V${String(n).split(".")[0]}</span>`
                    }) : "",
                    f = n ? (0, S.n)({
                        tagName: "div",
                        innerHTML: `<span class="dark">${t.fullVersion}</span><span class="bold">V${n}</span>`
                    }) : "",
                    m = o ? (0, S.n)({
                        tagName: "div",
                        innerHTML: `<i class="iconfont icon-dicom-contacts"></i><span class="bold">${"function"===(0,S.Bc)(o)?o():o}</span>`
                    }) : "",
                    p = a ? (0, S.n)({
                        tagName: "div",
                        innerHTML: `<i class="iconfont icon-dicom-tel"></i><span class="bold">${"function"===(0,S.Bc)(a)?a():a}</span>`
                    }) : "";
                c.append(m, p), i && (u.style.backgroundImage = `url(${i})`), (i || void 0 === i) && l.appendChild(u), l.append(d, h, f), s.append(l, c), new ut.A((0, g.Tl)("tools.aboutUs"), s, {
                    contentStyle: {
                        padding: 0,
                        height: "auto"
                    }
                })
            }
            createImageLayout(e, t) {
                const n = (0, S.n)({
                    tagName: "img",
                    src: e,
                    alt: t
                });
                Object.assign(n.style, {
                    margin: "auto",
                    height: "100%"
                }), new ut.A((0, g.Tl)("toast.saveImage"), n)
            }
            createSeriesMarker(e, t, n, o) {
                const r = f.A.webDicomView.queryStudy(n.stuuid) || f.A.webDicomView.queryStudy(t.studyUID);
                this.seriesMarker.createParagraph(e, "ltMarker", n, o, r), this.seriesMarker.createParagraph(e, "rtMarker", n, o, r), this.seriesMarker.createParagraph(e, "lbMarker", n, o, r), this.seriesMarker.createParagraph(e, "rbMarker", n, o, r)
            }
            imageTypeMark() {
                (0, u.Wp)(this.toolsContainer, {
                    imageType: String(f.A.imageType)
                })
            }
            imageType(e) {
                this.imageTypeLayout.handleLayout(e)
            }
            wwwcImage(e, t) {
                this.wwwcLayout.setViewport(e, t)
            }
            scaleImage(e, t) {
                this.scale.handleLayout(e, t)
            }
            rotateImage(e, t) {
                this.rotatePop.handleLayout(e, t)
            }
            colorMapImage(e, t) {
                this.colorMap.handleLayout(e, t)
            }
            createSeriesCellLayout(e, t, n, o, r) {
                const {
                    x: a = 6,
                    y: i = 6
                } = o || {};
                new ne(t, e.detail, (e => {
                    for (let t = 1; t <= i; t++)
                        for (let o = 1; o <= a; o++) {
                            let r = (0, S.n)({
                                className: "select-grid-item",
                                title: `${o}*${t}`,
                                onclick: () => {
                                    n({
                                        x: o,
                                        y: t
                                    })
                                },
                                onmouseover: () => {
                                    this.gridHoverStyle(e, {
                                        x: o,
                                        y: t
                                    })
                                }
                            });
                            (0, u.Wp)(r, {
                                "data-x": o,
                                "data-y": t
                            }), e.appendChild(r)
                        }(0, u.Wp)(e, {
                            style: `\n\t\t\t\t\t\tdisplay: grid;\n\t\t\t\t\t\tgrid-template-columns: repeat(${a}, 24px);\n\t\t\t\t\t\tgrid-template-rows: repeat(${i}, 24px);\n\t\t\t\t\t\tpadding: 4px;\n\t\t\t\t\t\t`
                        })
                }), (e => {
                    r && this.gridHoverStyle(e, r)
                }))
            }
            initLayout(e) {
                const t = (0, S.n)({
                        className: "dicomViewToolbar"
                    }),
                    n = (0, S.n)({
                        tagName: "img",
                        src: f.A.logoURL,
                        className: "logo",
                        crossOrigin: "Anonymous"
                    }),
                    o = (0, S.n)({
                        className: "divider"
                    }),
                    a = (0, S.n)({
                        className: "viewerContentWrapper",
                        id: "viewerContentWrapper"
                    });
                if (this.leftSideContainer = (0, S.n)({
                        className: "viewerLeftSidePanel"
                    }), this.studyNavigationBody = (0, S.n)({
                        className: "study-navigation-body"
                    }), this.canvasContainer = (0, S.n)({
                        className: "canvasbox",
                        oncontextmenu: e => e.preventDefault()
                    }), this.toolsContainer = (0, S.n)({
                        className: "toolbar"
                    }), (0, u.kA)(this.toolsContainer), this.toolsContainer.addEventListener("touchmove", (function(e) {
                        const {
                            type: t
                        } = e;
                        (0, r.triggerEvent)(r.events, "layout_area_focus", {
                            area: "toolbarLayout",
                            type: t
                        })
                    })), " " !== f.A.logoURL) {
                    const e = this.logoGrouper = (0, S.n)({
                        className: "logoGroup"
                    });
                    e.append(o, n), t.appendChild(e)
                }
                f.A.isMobile && (0, u.wf)(e, !0, "isMobile"), f.A.toolsBar.navigationBottomLayout && ((0, u.wf)(e, !0, "navigationBottomLayout"), this.studyNavigationHead = (0, S.n)({
                    className: "study-navigation-head"
                }), this.studyMenuLayout = new We(this.iconPlayer, this.studyNavigationHead), this.leftSideContainer.style.height = "118px", this.leftSideContainer.appendChild(this.studyNavigationHead)), this.leftSideContainer.appendChild(this.studyNavigationBody), a.append(this.leftSideContainer, this.canvasContainer), t.appendChild(this.toolsContainer), (0, u.wf)(e, !0, "dicomView"), e.addEventListener("touchstart", (function(e) {
                    e.stopPropagation()
                })), e.append(t, a), this.imageTypeMark()
            }
            initTop2DTools(e, t = !1) {
                const n = L().main.find((t => t.toolTag === e));
                this.topTools.createTopTools(this.toolsContainer, this.toolsData, n, "tools2d", t)
            }
            initTopMPRTools(e, t = !0) {
                const n = L().MPR.find((t => t.toolTag === e));
                this.topTools.createTopTools(this.toolsContainer, this.toolsDataMPR, n ? Object.assign(Object.assign({}, n), {
                    delay: 1e3
                }) : void 0, "toolsMPR", t)
            }
            initTopVRTTools(e, t = !0) {
                const n = L().VRT.find((t => t.toolTag === e));
                this.topTools.createTopTools(this.toolsContainer, this.toolsDataVRT, n, "toolsVRT", t)
            }
            createStudyNavigationGroup(e, t) {
                var n;
                const {
                    seriesArr: o
                } = e, r = (0, S.n)({
                    className: "study-navigation-container"
                }), a = o.length;
                r.dataset.studyUID = e.studyUID, this.studyNavigationBody.appendChild(r), this.navigatorStudyToggleStyle(r, a), f.A.toolsBar.navigationBottomLayout ? (0 === t ? this.seriesBarIconToggle(!0) : (0, u.wf)(r, !0, "hidden"), null === (n = this.studyMenuLayout) || void 0 === n || n.createLayout(e, t)) : this.renderStudyInfo(r, e, a), this.renderDicomIcon(r, o, t)
            }
            renderDicomIcon(e, t, n) {
                let o, a = (0, S.n)({
                    className: "body-bar"
                });
                t.forEach(((e, t) => {
                    const {
                        describ: i,
                        icon: s,
                        seriesUID: l,
                        imgs: c,
                        flatSeries: d
                    } = e, h = {
                        series: e
                    }, m = (0, S.n)({
                        className: "viewer-navigator-wrapper",
                        draggable: !0,
                        onclick: e => {
                            clearTimeout(o), o = setTimeout((() => {
                                (0, r.triggerEvent)(r.events, "navigator_active", Object.assign(Object.assign({}, h), {
                                    target: e.target,
                                    type: "click",
                                    event: e
                                })), (0, u.Rt)(m, e.isTrusted ? 0 : 500)
                            }), 200)
                        },
                        ondblclick: () => {
                            clearTimeout(o), (0, r.triggerEvent)(r.events, "navigator_dbClick_drag", Object.assign(Object.assign({}, h), {
                                type: "dblclick"
                            })), (0, u.Rt)(m)
                        },
                        ondragend: e => {
                            var t;
                            "none" !== (null === (t = e.dataTransfer) || void 0 === t ? void 0 : t.dropEffect) && (0, r.triggerEvent)(r.events, "navigator_dbClick_drag", Object.assign(Object.assign({}, h), {
                                type: "drag"
                            }))
                        },
                        oncontextmenu: e => {
                            e.preventDefault()
                        }
                    });
                    f.A.isMobile && new Hammer(m).on("press doubletap", (() => {
                        (0, r.triggerEvent)(r.events, "navigator_dbClick_drag", Object.assign(Object.assign({}, h), {
                            type: "press doubletap"
                        }))
                    }));
                    const g = (0, S.n)({
                            className: "navigator-card"
                        }),
                        p = (0, S.n)({
                            tagName: "div",
                            className: "icon-image"
                        }),
                        v = (0, S.n)({
                            tagName: "div",
                            className: "navigator-text-wrapper"
                        }),
                        y = (0, S.n)({
                            tagName: "div",
                            className: "text",
                            innerHTML: `<i class=icon-dicom-series-2></i> <span>${t+1}</span> `
                        }),
                        b = (0, S.n)({
                            tagName: "div",
                            className: "num",
                            innerHTML: `<i class=icon-dicom-image></i> <span>${c.length}</span>`
                        }),
                        w = (0, S.n)({
                            tagName: "div",
                            className: "navigator-description",
                            title: i,
                            innerHTML: `${i||""}`
                        }),
                        x = (0, S.n)({
                            tagName: "img",
                            src: s,
                            crossOrigin: "Anonymous",
                            decoding: "async",
                            draggable: !1
                        }),
                        T = (0, S.n)({
                            className: "AI-icon",
                            tagName: "span"
                        }),
                        I = (0, S.n)({
                            tagName: "div",
                            className: "progressGroup"
                        }),
                        E = (0, S.n)({
                            tagName: "span",
                            className: "progressNum"
                        }),
                        A = (0, S.n)({
                            tagName: "div",
                            className: "progressBar"
                        });
                    if (0 == n && 0 === t && ((0, u.wf)(m, !0), E.innerText = "0%"), m.dataset.seriesUID = l, m.dataset.index = String(t), d && (m.dataset.flatSeries = String(d)), (0, S._K)().isWeChat) {
                        const e = (0, S.n)();
                        (0, u.Wp)(e, {
                            style: "\n\t\t\t\t\tposition: absolute;\n\t\t\t\t\tleft: 0;\n\t\t\t\t\ttop: 0;\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\theight: 100%;\n\t\t\t"
                        }), p.appendChild(e)
                    }
                    p.append(x, T), v.append(y, b), I.append(E, A), g.append(p, v, w), m.append(g, I), a.appendChild(m)
                })), e.appendChild(a)
            }
            renderStudyInfo(e, t, n) {
                const {
                    name: o,
                    sex: r,
                    age: a,
                    modality: i,
                    studydate: s
                } = t, l = (0, S.n)({
                    className: "panel-info"
                }), c = (0, S.n)({
                    tagName: "p",
                    innerHTML: `<span title='${o}'>${o||"-"}</span>/${(0,Ie.E)(r)||"-"}/${(0,Ie.A)(a)||"-"}`
                }), u = (0, S.n)({
                    tagName: "p",
                    innerText: i
                }), d = (0, S.n)({
                    tagName: "p",
                    innerText: s
                });
                l.append(u, c, d), e.appendChild(l), l.onclick = () => {
                    this.navigatorStudyToggleStyle(e, n)
                }
            }
            navigatorStudyToggleStyle(e, t) {
                e.classList.contains("active") ? e.removeAttribute("style") : f.A.toolsBar.navigationBottomLayout ? e.style.maxWidth = 68 * t + 100 + "px" : e.style.maxHeight = 120 * t + 100 + "px", (0, u.wf)(e)
            }
            seriesBarToggle(e) {
                (0, u.wf)(this.leftSideContainer, e, "show"), (0, u.wf)(this.logoGrouper, e, "show"), this.seriesBarIconToggle(e)
            }
            seriesBarIconToggle(e) {
                f.A.isMobile && (0, u.wf)(this.querySelectorForTool(".seriesBar"), e)
            }
            navigationMenuCloseHandle() {
                return ht(this, arguments, void 0, (function*(e = !1) {
                    var t;
                    f.A.toolsBar.navigationBottomLayout && (null === (t = this.studyMenuLayout) || void 0 === t || t.toggleMenuVisibility(!1), e && (yield(0, u.uk)(500).then((() => this.resizeLayout()))))
                }))
            }
            selectPopupHidden() {
                const e = this.toolsContainer.querySelector(".select-popup-layout:not(.invisible)");
                e && (0, u.wf)(e, !0, "invisible"), this.removeOpenMark()
            }
            removeOpenMark() {
                const e = this.toolsContainer.querySelector(".select-popup-layout .open-mark");
                e && (0, u.wf)(e, !1, "open-mark")
            }
            toggleToolStyle(e) {
                var t, n;
                const {
                    disActive: o,
                    isToggle: r,
                    btnTarget: a,
                    toolType: i,
                    toolTag: s,
                    btnOriginTarget: l,
                    parentData: c,
                    children: d
                } = e || {}, {
                    isLonelyGroup: h,
                    disActive: f
                } = c || {};
                if (o || (null == e ? void 0 : e.isLonelyGroup) || d) return;
                if (r && a) return (0, u.wf)(a), void(l && (0, u.wf)(l, !!(null === (t = a.parentElement) || void 0 === t ? void 0 : t.querySelector(".active"))));
                let m = this.toolsContainer.querySelectorAll(".toolsChild.active .tool-event-link");
                h && a && (m = null === (n = a.parentElement) || void 0 === n ? void 0 : n.querySelectorAll(".tool-event-link")), null == m || m.forEach((e => ht(this, void 0, void 0, (function*() {
                    const {
                        disActive: t,
                        isToggle: n,
                        children: o,
                        parentData: {
                            isLonelyGroup: r
                        } = {
                            isLonelyGroup: void 0
                        }
                    } = JSON.parse(e.dataset.toolData || "{}");
                    t && !o || n || (h === r && (0, u.wf)(e, !1), o && !t && (yield(0, u.uk)(), (0, u.wf)(e, !!e.querySelector(".active"))))
                })))), (0, u.wf)(a, !0), !f && l && (0, u.wf)(l, !0), this.toolsContainer.querySelectorAll(`.tool-event-link.${i||s}:not(.active)`).forEach((e => {
                    (0, u.wf)(e, !0)
                }))
            }
            gridHoverStyle(e, t) {
                (0, u.M1)(e.querySelectorAll("div"), (e => {
                    const n = Number(e.getAttribute("data-x")),
                        o = Number(e.getAttribute("data-y"));
                    return n <= t.x && o <= t.y
                }))
            }
            progressCountStyle(e, t, n = 0, o = !1) {
                const r = this.leftSideContainer.querySelector(`.viewer-navigator-wrapper[data-series-u-i-d='${e}']`);
                if (!r) return;
                if (o)(0, u.wf)(r, !0, "showProgress");
                else if (!r.classList.contains("showProgress") && !r.classList.contains("active")) return;
                const a = r.querySelector(".progressNum"),
                    i = r.querySelector(".progressBar");
                let s = "";
                if (a && i && void 0 !== t && t >= 0 && (s = (n / t * 100).toFixed(0) + "%", a.innerText = s, i.style.width = s), "100%" === s) return (0, u.wf)(r, !0, "loaded"), void(0, u.wf)(r, !1, "showProgress");
                void 0 !== t || o || (0, u.wf)(r, !1, "showProgress")
            }
            toggleCavanAroundInfoStyle(e) {
                this.canvasContainer.querySelectorAll(".ltMarker,.rtMarker,.lbMarker,.rbMarker").forEach((t => {
                    t.style.opacity = e ? "1" : "0"
                }))
            }
            toggleAIIconStyle(e) {
                (null == e ? void 0 : e.length) ? e.forEach((e => {
                    (0, u.wf)(this.leftSideContainer.querySelector(`.viewer-navigator-wrapper[data-series-u-i-d='${e}']`), !0, "show-AI")
                })): (0, u.M1)(this.leftSideContainer.querySelectorAll(".viewer-navigator-wrapper.show-AI"), (() => !1), "show-AI")
            }
            querySelector(e, t = {
                tip: !0
            }) {
                const n = f.A.webDicomView.globalContainer.querySelector(e);
                return t.tip && !n && console.warn("HTMLElement is undefined for querySelector:", e), n
            }
            querySelectorForTool(e, t, n = {
                tip: !0
            }) {
                const o = this.toolsContainer.querySelector(`${t||""} .tool-event-link${e}`);
                return n.tip && !o && console.warn("HTMLElement is undefined for querySelectorForTool:", e, t), o
            }
            containsClassName(e, t) {
                return null == e ? void 0 : e.classList.contains(t)
            }
            clearSeriesLayout(e, t = !1, n = !1) {
                var o;
                const r = e.querySelector(".imageLayoutGroup"),
                    a = e.querySelectorAll(".ltMarker,.rtMarker,.lbMarker,.rbMarker");
                if (this.iconPlayer.playerRemove(e), t ? null === (o = e.querySelector("canvas")) || void 0 === o || o.remove() : (0, C.b8)(e), (0, re.z9)(e).forEach((e => {
                        (0, C.b8)(e), null == e || e.remove()
                    })), null == r || r.remove(), a.forEach((e => {
                        null == e || e.remove()
                    })), this.seriesImageCruxMarker.removeLayout(e), this.seriesSlider.removeLayout(e), this.iconSynchronizer.removeSynchronizer(e), !n)
                    for (const t of ["studyUID", "seriesUID", "seriesColumn", "seriesRow", "seriesIndex", "currentImageIdIndex"]) delete e.dataset[t]
            }
        };
        var mt = __webpack_require__(7522),
            gt = __webpack_require__(5373),
            pt = function(e, t, n, o) {
                return new(n || (n = Promise))((function(r, a) {
                    function i(e) {
                        try {
                            l(o.next(e))
                        } catch (e) {
                            a(e)
                        }
                    }

                    function s(e) {
                        try {
                            l(o.throw(e))
                        } catch (e) {
                            a(e)
                        }
                    }

                    function l(e) {
                        var t;
                        e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                            e(t)
                        }))).then(i, s)
                    }
                    l((o = o.apply(e, t || [])).next())
                }))
            };
        class vt {
            constructor(e, t) {
                this.x = e, this.y = t
            }
        }
        const yt = class {
            constructor() {
                this.t = (0, g.Tl)("toast.3D"), this.ptLast = {
                    x: 0,
                    y: 0
                }, this.webDcmSocket = null, this.seriesUID = void 0, this.loadingAnimation = new mt.A({
                    message: this.t.loading
                }), this.zoomLazy = (0, S.nF)((e => {
                    this.zoom(e)
                }), f.A.isMobile ? 150 : 40), this.KnifeMoveLazy = (0, S.nF)((e => {
                    this.KnifeMove(e)
                }), 40), this.rotateLazy = (0, S.nF)((e => {
                    this.rotate(e)
                }), 100), this.windowsLevelLazy = (0, S.nF)((e => {
                    this.windowsLevel(e)
                }), 60), this.panLazy = (0, S.nF)((e => {
                    this.pan(e)
                }), 100)
            }
            open(e, t) {
                const {
                    seriesUID: n,
                    hospID: o,
                    studyUID: r,
                    wadoURL: a,
                    VRTWSURL: i,
                    layoutView: s
                } = t;
                if (!e.querySelector("#canvas-vrt")) {
                    const t = ["touchstart", "mousedown", "touchmove", "mousemove", "touchend", "mouseup", "mouseout", "wheel"],
                        n = this.canvas = (0, S.n)({
                            tagName: "canvas",
                            id: "canvas-vrt",
                            width: e.clientWidth,
                            height: e.clientHeight
                        });
                    e.appendChild(n);
                    const o = (0, S.nF)((() => {
                        n.width = e.clientWidth, n.height = e.clientHeight, this.resizeCanvasDrawImage()
                    }), 500);
                    this.resizeObserver = new ResizeObserver(o), this.resizeObserver.observe(e);
                    for (const e of t) n.addEventListener(e, this.msgTransform.bind(this));
                    const r = new Hammer.Manager(n);
                    r.add(new Hammer.Pinch({
                        threshold: .2
                    })), r.add(new Hammer.Pan({
                        threshold: 10,
                        pointers: 2
                    })), r.on("pinch", (e => {
                        this.zoomLazy(e), e.preventDefault()
                    })), r.on("panmove", (e => {
                        this.panLazy(e), e.preventDefault()
                    }))
                }
                const l = (0, u.aR)(n),
                    c = a + "/GetImagesPath" + (0, gt.stringify)({
                        seruuid: n,
                        seriesUID: n,
                        hospcode: o,
                        studyuid: r,
                        studyUID: r
                    }, {
                        addQueryPrefix: !0
                    });
                if (!i) throw "3D service path is undefined";
                if (this.webDcmSocket) {
                    if (this.seriesUID === l) return void this.refresh();
                    this.webDcmSocketClose()
                }
                this.seriesUID = l;
                let d = i + "/Wado?serurl=" + encodeURIComponent(c);
                this.webDcmSocket = new WebSocket(d), this.loadingAnimation.show(), this.webDcmSocket.onclose = e => {
                    this.loadingAnimation.hidden(), "leave" !== e.reason && ((0, h.A)("webDcmSocketError", this.t.close), console.info("Connection closed", e))
                }, this.webDcmSocket.onerror = e => {
                    this.loadingAnimation.hidden(), (0, h.A)("webDcmSocketError", this.t.error), console.info("An error occur", e), s.initTop2DTools(), Tt()
                }, this.webDcmSocket.onmessage = e => {
                    if ("string" == typeof e.data) console.info(JSON.parse(e.data));
                    else {
                        let t = new FileReader;
                        t.onload = e => {
                            var n;
                            (null === (n = e.target) || void 0 === n ? void 0 : n.readyState) == FileReader.DONE && (this.loadingAnimation.hidden(), this.webDcmSocketResult = t.result, this.canvas && (0, S.aA)(this.canvas, this.webDcmSocketResult))
                        }, t.readAsDataURL(e.data)
                    }
                }
            }
            resizeCanvasDrawImage() {
                this.canvas && this.webDcmSocketResult && (0, S.aA)(this.canvas, this.webDcmSocketResult)
            }
            msgTransform(e) {
                var t;
                if (!(e instanceof TouchEvent && (null === (t = e.targetTouches) || void 0 === t ? void 0 : t.length) > 1)) switch (e.type) {
                    case "touchstart":
                    case "mousedown":
                        if (e instanceof TouchEvent) {
                            const {
                                pageX: t,
                                pageY: n
                            } = e.targetTouches[0];
                            this.ptLast = new vt(t, n), this.which = 1
                        } else this.ptLast = new vt(e.pageX, e.pageY), this.which = e.which;
                        break;
                    case "touchmove":
                    case "mousemove":
                        this.mouseDownMove(e);
                        break;
                    case "touchend":
                    case "mouseup":
                    case "mouseout":
                        this.mouseUp(), this.which = void 0;
                        break;
                    case "wheel":
                        this.zoomLazy(e)
                }
            }
            mouseDownMove(e) {
                if (1 === this.which) switch (this.toolType) {
                    case "KnifeIn":
                    case "KnifeOut":
                        this.KnifeMoveLazy(e);
                        break;
                    case "Modulation":
                        this.windowsLevelLazy(e);
                        break;
                    default:
                        this.rotateLazy(e)
                } else 3 === this.which ? this.windowsLevelLazy(e) : 2 === this.which && this.panLazy(e)
            }
            mouseUp() {
                switch (this.toolType) {
                    case "KnifeIn":
                    case "KnifeOut":
                        this.knifeEnd(), this.toolType = void 0
                }
            }
            errorHandle(e, t) {
                "cancel" !== t && console.error(e, t)
            }
            getPosition(e) {
                const {
                    pageX: t,
                    pageY: n
                } = e instanceof TouchEvent ? e.targetTouches[0] : e, o = new vt(t, n), r = this.ptLast.x, a = this.ptLast.y, i = o.x - r, s = o.y - a;
                if (0 === i && 0 === s) return Promise.reject("cancel");
                const l = e.target.getBoundingClientRect(),
                    c = Math.round(l.left + window.scrollX),
                    u = Math.round(l.top + window.scrollY);
                return this.ptLast = o, Promise.resolve({
                    LastPosition: [r - c, a - u],
                    NowPosition: [t - c, n - u],
                    rect: l
                })
            }
            rotate(e) {
                return pt(this, void 0, void 0, (function*() {
                    try {
                        const {
                            LastPosition: t,
                            NowPosition: n
                        } = yield this.getPosition(e);
                        this.webDcmSocketSend({
                            Cmd: 1,
                            LastPosition: t,
                            NowPosition: n
                        })
                    } catch (e) {
                        this.errorHandle("rotate", e)
                    }
                }))
            }
            pan(e) {
                return pt(this, void 0, void 0, (function*() {
                    try {
                        if ("panmove" == e.type) {
                            const {
                                x: t,
                                y: n
                            } = e.center || {};
                            e.pageX = Math.floor(t), e.pageY = Math.floor(n)
                        }
                        const {
                            LastPosition: t,
                            NowPosition: n
                        } = yield this.getPosition(e);
                        this.webDcmSocketSend({
                            Cmd: 2,
                            LastPosition: t,
                            NowPosition: n
                        })
                    } catch (e) {
                        this.errorHandle("pan", e)
                    }
                }))
            }
            zoom(e) {
                const {
                    type: t,
                    scale: n,
                    deltaY: o
                } = e;
                this.webDcmSocketSend({
                    Cmd: 3,
                    DeltaY: "pinch" === t ? n >= 1 ? 1 : -1 : o > 0 ? -1 : 1
                })
            }
            windowsLevel(e) {
                return pt(this, void 0, void 0, (function*() {
                    try {
                        const {
                            LastPosition: t,
                            NowPosition: n
                        } = yield this.getPosition(e);
                        this.webDcmSocketSend({
                            Cmd: 4,
                            LastPosition: t,
                            NowPosition: n
                        })
                    } catch (e) {
                        this.errorHandle("windowsLevel", e)
                    }
                }))
            }
            KnifeMove(e) {
                return pt(this, void 0, void 0, (function*() {
                    try {
                        const {
                            LastPosition: t,
                            NowPosition: n,
                            rect: o
                        } = yield this.getPosition(e);
                        this.webDcmSocketSend({
                            Cmd: 5,
                            LastPosition: t,
                            NowPosition: n,
                            ViewWidth: Math.round(o.width),
                            ViewHeight: Math.round(o.height)
                        })
                    } catch (e) {
                        this.errorHandle("KnifeMove", e)
                    }
                }))
            }
            toolsToggle(e) {
                this.toolType = e
            }
            knifeBegin(e, t = () => {}) {
                if ("function" != typeof t) throw "callback function is required";
                this.toolType = e, this.knifeFinishCallback = t, this.webDcmSocketSend({
                    KnifeOut: {
                        Cmd: 6
                    },
                    KnifeIn: {
                        Cmd: 7
                    }
                }[e])
            }
            knifeEnd() {
                const e = this.knifeFinishCallback;
                if (this.webDcmSocketSend({
                        Cmd: 8
                    }), "function" != typeof e) throw "callback function is required";
                e()
            }
            reset() {
                if (this.webDcmSocket.readyState >= 2) return this.reconnect();
                this.webDcmSocketSend({
                    Cmd: 0
                })
            }
            refresh() {
                this.webDcmSocketSend({
                    Cmd: 99
                })
            }
            webDcmSocketClose() {
                this.webDcmSocket && (this.webDcmSocket.close(1e3, "leave"), this.webDcmSocket = null)
            }
            webDcmSocketSend(e) {
                this.webDcmSocket.send(JSON.stringify(e))
            }
            reconnect() {
                const {
                    onclose: e,
                    onerror: t,
                    onmessage: n,
                    onopen: o,
                    url: r
                } = this.webDcmSocket;
                this.webDcmSocketClose(), this.webDcmSocket = new WebSocket(r), this.webDcmSocket.onclose = e, this.webDcmSocket.onmessage = n, this.webDcmSocket.onerror = t, this.webDcmSocket.onopen = o
            }
            destroy() {
                var e, t;
                this.webDcmSocketClose(), null === (e = this.resizeObserver) || void 0 === e || e.disconnect(), null === (t = this.canvas) || void 0 === t || t.remove()
            }
        };
        let bt, wt;
        const xt = () => {
                var e;
                null === (e = wt.toolsContainer.querySelector(".toolsChild .tool-event-link.VRTRotate")) || void 0 === e || e.click()
            },
            Tt = () => {
                if (bt) try {
                    bt.destroy()
                } catch (e) {
                    console.error(e)
                } finally {
                    bt = null, wt.vrtLayout.hidden()
                }
            };
        var It = __webpack_require__(9426),
            Et = __webpack_require__(9553),
            St = __webpack_require__(7471),
            At = __webpack_require__(6260);

        function Ct() {
            return new M.Synchronizer(r.EVENTS.NEW_IMAGE, M.updateImageSynchronizer)
        }
        let Mt = Ct();

        function Dt() {
            return (0, de.A)(Mt, !0)
        }(0, S.sg)(Dt, 500);

        function Pt() {
            Mt.destroy(), Mt = Ct()
        }
        var kt = __webpack_require__(9083);

        function _t() {
            (function() {
                var e;
                const {
                    usedJSHeapSize: t,
                    totalJSHeapSize: n
                } = (null === (e = window.performance) || void 0 === e ? void 0 : e.memory) || {};
                return t / n
            })() > .99 && console.error((0, g.Tl)("toast.memoryRatioTips"))
        }
        var Lt = __webpack_require__(6299),
            Ot = __webpack_require__(4025),
            Rt = function(e, t, n, o) {
                return new(n || (n = Promise))((function(r, a) {
                    function i(e) {
                        try {
                            l(o.next(e))
                        } catch (e) {
                            a(e)
                        }
                    }

                    function s(e) {
                        try {
                            l(o.throw(e))
                        } catch (e) {
                            a(e)
                        }
                    }

                    function l(e) {
                        var t;
                        e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n((function(e) {
                            e(t)
                        }))).then(i, s)
                    }
                    l((o = o.apply(e, t || [])).next())
                }))
            };
        const Nt = (0, M.importInternal)("util/scrollToIndex"),
            {
                aboutUs: Ut,
                toolsBar: Bt,
                AI: Vt,
                DBCacheImages: Ft,
                preload: Ht,
                systemInfo: qt
            } = f.A;
        class jt {
            constructor(e, t, n, o, a) {
                this.studyScrollIndex = 0, this.eventNamespace = "clear", this.isDestroy = !1, this.getMenuDefault = F;
                const {
                    sharedArrayBuffer: i,
                    imageTypeDefault: s,
                    cacheImagesDefault: l = Ft.enableDefault,
                    scrollPreload: c = Ht.scroll,
                    scrollPreloadNum: u = Ht.scrollNum,
                    seriesPreFetchNum: d = Ht.seriesFetchNum,
                    fullLoad: h = Ht.fullLoad,
                    forceIM: m,
                    languageDefault: p,
                    logoURL: v,
                    minRenderCountMPR3D: y,
                    theme: b,
                    toolsBar: x,
                    AI: T,
                    aboutUs: I
                } = a || {};
                if (this.studyUIDArr = [...new Set(null == o ? void 0 : o.split(",").filter((e => e)))], this.studyArr = [], this.reqStudyCount = 0, f.A.imageTypeDefault = null != s ? s : (null == x ? void 0 : x.majModeVisibility) && !f.A.isMobile ? 1 : 0, this.seriesCount = {
                        x: 1,
                        y: 1
                    }, Ft.enableDefault = l, Ht.scroll = c, Ht.scrollNum = u, Ht.seriesFetchNum = d, Ht.fullLoad = h, f.A.AI = Object.assign(Object.assign({}, Vt), T), f.A.aboutUs = Object.assign(Object.assign({}, Ut), I), f.A.toolsBar = Object.assign(Object.assign({}, Bt), x), f.A.toolsBar.navigationBottomLayout = f.A.isMobile && f.A.toolsBar.navigationBottomLayout, f.A.logoURL = f.A.toolsBar.navigationBottomLayout ? " " : null != v ? v : f.A.logoURL, f.A.forceIM = null != m ? m : f.A.forceIM, f.A.sharedArrayBuffer = null != i ? i : f.A.sharedArrayBuffer, f.A.minRenderCountMPR3D = null != y ? y : f.A.minRenderCountMPR3D, f.A.instanceOptions = Object.assign(Object.assign({}, a), {
                        container: e,
                        wado: new URL(null == t ? void 0 : t.replace(/^:*\/\//, location.protocol + "//"), origin).href,
                        hospID: n,
                        studyUID: o
                    }), f.A.webDicomView = this, p && (0, g._z)(p), this.toastDict = (0, g.Tl)("toast"), this.globalContainer = (0, S.Bc)(e).includes("Element") ? e : document.getElementById(e), !this.globalContainer) throw new Error("container is required, type is id:string or HTMLDivElement");
                if (this.globalContainer.childElementCount) throw new Error(this.toastDict.globalContainerExistence);
                for (const e in b) this.globalContainer.style.setProperty(`--theme-${e}-dicom-viewer`, b[e] || null);
                this.layoutView = new ft, w(), this.bindEvents(), r.events.addEventNamespaceListener("tool_event.VRT", (e => {
                    const {
                        toolData: {
                            toolTag: t = ""
                        } = {}
                    } = e.detail;
                    if (bt) switch (t) {
                        case "VTRReload2D":
                            wt.initTop2DTools();
                        case "MPR":
                            Tt();
                            break;
                        case "VRTKnifeIn":
                            bt.knifeBegin("KnifeIn", xt);
                            break;
                        case "VRTKnifeOut":
                            bt.knifeBegin("KnifeOut", xt);
                            break;
                        case "VRTModulation":
                            bt.toolsToggle("Modulation");
                            break;
                        case "VRTRotate":
                            bt.toolsToggle("Rotate");
                            break;
                        case "VRTReset":
                            bt.reset()
                    }
                })), this.layoutView.initLayout(this.globalContainer), this.layoutView.initTop2DTools(f.A.isMobile ? "stackScroll" : "zoom"), this.initAI(void 0, !0).finally((() => {
                    this.getStudyInfos().then((() => {
                        this.initAI()
                    }))
                })), f.A.toolsBar.VRTVisibility && this.initVRTPath()
            }
            getStudyInfoHandle(e, t) {
                return Rt(this, void 0, void 0, (function*() {
                    var n;
                    try {
                        t > 0 && !this.studyArr[0] && (t = 0);
                        const {
                            wado: o,
                            departCode: r,
                            hospID: a
                        } = f.A.instanceOptions;
                        if (!o || !e) throw console.warn("wadoURL:", o, "studyUID:", e), "wadoURL,studyUID is required";
                        0 === t && mt.N.show({
                            message: this.toastDict.studyLoading
                        });
                        const i = yield(0, Me.Z3)(o, e, a, {
                            departCode: r
                        });
                        if (this.studyArr[t] = new Et.er(Object.assign(Object.assign({}, i.data), {
                                wado: o,
                                hospID: a
                            })), 0 == t) {
                            const e = this.studyArr[0],
                                {
                                    seriesUID: t,
                                    studyUID: o
                                } = (null === (n = e.seriesArr) || void 0 === n ? void 0 : n[0]) || {};
                            mt.N.hidden(), this.selectSeries = {
                                seriesUID: t,
                                studyUID: o,
                                seriesIndex: 0
                            }, this.studyScrollIndex = 0, this.initFirstStudySeriesLayoutState(e), this.seriesCount = e.getSeriesLayoutCount(), this.layoutView.seriesLayout.createCanvasSeries(this.layoutView.canvasContainer, e.seriesArr, this.seriesCount)
                        } else this.seriesLayoutState.addSeriesArr(this.studyArr[t].seriesArr);
                        Be(e), _e(e), this.initStudyNavigation(t), this.seriesLayoutState.syncState("originStates"), yield this.initSeries(t), t > 0 && this.addSeries(this.seriesLayoutState.getSeries("originStates"))
                    } catch (e) {
                        mt.N.hidden(), console.error(e)
                    } finally {
                        this.reqStudyCount += 1, this.isStudiesLoaded() && this.setFusionData()
                    }
                }))
            }
            getStudyInfos() {
                return Rt(this, void 0, void 0, (function*() {
                    if (!this.studyUIDArr.length) throw "studyUID is empty";
                    for (const [e, t] of Object.entries(this.studyUIDArr)) yield this.getStudyInfoHandle(t, Number(e))
                }))
            }
            addStudy(e) {
                return Rt(this, void 0, void 0, (function*() {
                    if ("string" != typeof e) throw "studyUID is required";
                    if (this.studyUIDArr.includes(e)) return;
                    const t = this.studyUIDArr.length;
                    if (!this.isStudiesLoaded()) return yield(0, u.uk)(1e3), void this.addStudy(e);
                    this.studyUIDArr.push(e);
                    const n = t;
                    this.getStudyInfoHandle(e, n)
                }))
            }
            setFusionData() {
                const e = this.queryModalitySeries("PT");
                e.length && (f.A.fusionData.PT = e, f.A.fusionData.CT = this.queryModalitySeries("CT"))
            }
            activeAI(e) {
                f.A.AI = Object.assign(Object.assign(Object.assign({}, f.A.AI), {
                    parseSuccess: !0,
                    active: !0
                }), e), this.initAI()
            }
            renderLayoutImageToCanvas(e, t, n, o) {
                return Rt(this, void 0, void 0, (function*() {
                    yield null == o ? void 0 : o(), (0, C.sS)(e);
                    const a = (0, r.getDefaultViewportForImage)(e, t);
                    (0, r.displayImage)(e, t, Object.assign({}, a));
                    const i = r.metaData.get("_originModule", t.imageId);
                    i && (this.layoutView.createSeriesMarker(e, n, i, a), this.layoutView.seriesImageCruxMarker.createLayout(e), this.layoutView.toggleCavanAroundInfoStyle(f.A.cavanAroundInfo)), this.initDicomTools(e, n, void 0)
                }))
            }
            initDicomTools(e, t, n) {
                return Rt(this, void 0, void 0, (function*() {
                    const {
                        loadIds: o,
                        multiframe: {
                            numFrames: r = 0
                        }
                    } = t;
                    o && o.length > 0 && ((0, M.addStackStateManager)(e, ["stack", "Crosshairs", "ReferenceLines", "stackRenderer"]), (0, M.addToolState)(e, "stack", {
                        currentImageIdIndex: n || 0,
                        imageIds: o,
                        series: t
                    }), r > 1 && (yield(0, u.uk)(), this.layoutView.iconPlayer.createPlayer(e, t)))
                }))
            }
            displaySeriesByImageindex(e, t, n) {
                return Rt(this, arguments, void 0, (function*(e, t, n, o = 0) {
                    if (!t) throw "series is not defined";
                    yield null == n ? void 0 : n();
                    try {
                        const r = yield(0, C.BY)(t.loadIds[o]);
                        return this.renderLayoutImageToCanvas(e, r, t, n), r
                    } catch (e) {
                        throw console.error(e), e
                    }
                }))
            }
            displayDcmByImages(e, t, n) {
                const o = (0, re.z9)(e),
                    a = o.length;
                a > 0 && o.forEach(((o, i) => Rt(this, void 0, void 0, (function*() {
                    const s = (n || 0) * a + i,
                        l = t[s];
                    if ((0, u.wf)((0, Ge.A)(o), !l, "hidden"), l)(0, C.sS)(o), (0, r.displayImage)(o, yield(0, C.BY)(l));
                    else {
                        e.querySelector("div.player-bar") && s > t.length && Nt(e, 0)
                    }
                }))))
            }
            displayDcmBySlider(e, t, n, o) {
                let a = n[o];
                a && (0, C.BY)(a).then((function(n) {
                    const a = e.seriesDom.clientWidth,
                        i = e.seriesDom.clientHeight;
                    let s = (0, r.getDefaultViewportForImage)(e.seriesDom, n),
                        l = i / n.height,
                        c = a / n.width;
                    s.scale = c < l ? parseFloat(c.toFixed(2)) : parseFloat(l.toFixed(2)), (0, r.displayImage)(e.seriesDom, n, s), t.currentImageIdIndex = o
                }), (function(e) {}))
            }
            initVRTPath() {
                return Rt(this, void 0, void 0, (function*() {
                    const e = e => {
                        f.A.toolsBar.VRTVisibility = e, (0, u.wf)(this.layoutView.querySelectorForTool(".VRT"), !e, "hidden")
                    };
                    try {
                        const t = yield(0, Me.SO)(f.A.instanceOptions.wado), {
                            path: n
                        } = (null == t ? void 0 : t.data) || {};
                        if (!n) throw "3D service path is undefined";
                        f.A.VRTWSURL = n, e(!0)
                    } catch (t) {
                        e(!1), console.error(t)
                    }
                }))
            }
            initAI(e, t) {
                return Rt(this, void 0, void 0, (function*() {
                    let n = 0;
                    const {
                        resultURL: o,
                        parseSuccess: a,
                        getParseHandler: i,
                        active: s,
                        jumpFirstAI: l
                    } = f.A.AI, c = this.layoutView.querySelectorForTool(".AI"), d = (e, t = !1) => {
                        if (!e) throw "seriesID is required";
                        return new Promise((n => {
                            if (t) {
                                const t = z.E4.getFirstIndex(e),
                                    o = this.layoutView.canvasContainer.querySelector(`.${re.r0}[data-series-u-i-d='${e}']`) || void 0;
                                o && Nt(o, t), n(o)
                            } else {
                                const t = r.EVENTS.NEW_IMAGE,
                                    o = this.layoutView.canvasContainer.querySelectorAll(`.${re.r0}`),
                                    a = r => Rt(this, void 0, void 0, (function*() {
                                        yield(0, u.uk)();
                                        const i = r.target;
                                        i.dataset.seriesUID === e && (o.forEach((e => {
                                            e.removeEventListener(t, a);
                                            const n = z.E4.getFirstIndex(e.dataset.seriesUID);
                                            n && Nt(e, n)
                                        })), n(i))
                                    }));
                                o.forEach((e => {
                                    e.addEventListener(t, a)
                                }))
                            }
                        }))
                    };
                    try {
                        const r = () => {
                            if ((0, u.uk)(100).then((() => {
                                    (0, u.wf)(c, !1)
                                })), "function" != typeof i) throw "AI configure error"; {
                                const {
                                    hospID: e,
                                    departCode: t
                                } = f.A.instanceOptions;
                                i({
                                    studyArr: this.studyUIDArr,
                                    departCode: t,
                                    hospId: e,
                                    hospID: e
                                }), console.info("GetParseHandler has been run")
                            }
                        };
                        if (!1 === e) return this.layoutView.toggleAIIconStyle(), void this.layoutView.topTools.AITool();
                        if (!a) return e ? r() : void 0;
                        if (!s && !e) return;
                        if (!o) throw "AI configure error";
                        for (const t of this.studyUIDArr.filter((e => !z.xJ[e]))) try {
                            const e = yield(0, Me.Ph)(o, t);
                            (0, z.KB)(e, t), (0, u.wf)(c, !0)
                        } catch (t) {
                            n += 1, console.error(t), e && n >= this.studyUIDArr.length && r()
                        }
                        if (t) return;
                        if (this.layoutView.toggleAIIconStyle(z.E4.getSeriesIDArr()), this.layoutView.topTools.AITool(!0), l) {
                            let e;
                            for (const t in z.E4.store) {
                                const n = yield d(t, !0);
                                n && (e = n)
                            }
                            if (!e) {
                                const e = this.layoutView.leftSideContainer.querySelector(".viewer-navigator-wrapper.show-AI");
                                if (!e) return;
                                e.click(), d(e.dataset.seriesUID, !1)
                            }
                        }
                    } catch (e) {
                        yield(0, u.uk)(), (0, u.wf)(c, !1), console.error("AI configure error" === e ? this.toastDict.AIConfigError : e)
                    }
                }))
            }
            initSeries(e) {
                return Rt(this, void 0, void 0, (function*() {
                    const t = this.studyArr[e];
                    let n = 0,
                        o = [];
                    if (yield(new S.TJ).init({
                            arr: t.seriesArr,
                            func: t => Rt(this, void 0, void 0, (function*() {
                                yield this.getSeriesMeta(t, e, n++)
                            })),
                            limit: 6
                        }), 0 == e) try {
                        if (Ht.fullLoad)
                            for (const {
                                    loadIds: e,
                                    seriesUID: n
                                } of t.seriesArr) {
                                const t = e.slice(1);
                                t.length ? (0, C.Sl)(t, {
                                    cancel: !1,
                                    countCallback: (e, o, r) => {
                                        this.layoutView.progressCountStyle(n, t.length, r, !0)
                                    }
                                }) : this.layoutView.progressCountStyle(n, 1, 1, !0)
                            } else {
                                const e = Math.max(Ht.seriesFetchNum || (t.seriesArr.length <= 6 ? 7 : 5), 0);
                                for (const {
                                        loadIds: n
                                    } of t.seriesArr) o = [...o, ...n.slice(1, e)];
                                o.length && (0, C.Sl)(o, {
                                    cancel: !1
                                });
                                const {
                                    loadIds: n,
                                    seriesUID: r
                                } = t.seriesArr[0], a = n.slice(e);
                                a.length ? (0, C.Sl)(a, {
                                    cancel: !1,
                                    countCallback: (e, t, n) => {
                                        this.layoutView.progressCountStyle(r, a.length, n)
                                    }
                                }) : this.layoutView.progressCountStyle(r, 1, 1, !0)
                            }
                    } catch (e) {
                        console.error("first series load error: " + e)
                    }
                }))
            }
            addSeries(e) {
                if (!(null == e ? void 0 : e.length)) return;
                const {
                    seriesLayouts: t
                } = this.layoutView.seriesLayout;
                t.forEach(((t, n) => Rt(this, [t, n], void 0, (function*({
                    seriesDom: t
                }, n) {
                    const o = e[n];
                    !(0, Ye.A)(t) && o && (yield this.displaySeriesByImageindex(t, o), this.layoutView.seriesLayout.initSingle(t, o, {
                        seriesUID: o.seriesUID,
                        studyUID: o.studyUID,
                        seriesIndex: n
                    }), this.layoutView.seriesLayout.seriesLayoutsUpdate(t, o.seriesUID))
                })))), this.layoutView.studySlider.createLayout(this.layoutView.canvasContainer, e, this.seriesCount, !0), this.layoutView.resizeLayout()
            }
            restoreSeries(e) {
                return Rt(this, void 0, void 0, (function*() {
                    if (!(null == e ? void 0 : e.length)) return;
                    yield this.layoutView.iconPlayer.playerAllPauseAndRemove(), pe(), ot.IU(), (0, C.O$)(!1), this.studyScrollIndex = 0, this.layoutView.seriesLayout.seriesLayouts = [], (0, u.bE)(this.layoutView.canvasContainer), this.layoutView.seriesLayout.createCanvasSeries(this.layoutView.canvasContainer, e, this.seriesCount);
                    const {
                        seriesLayouts: t
                    } = this.layoutView.seriesLayout;
                    t.forEach((({
                        seriesDom: t
                    }, n) => {
                        const o = e[n];
                        o && this.displaySeriesByImageindex(t, o)
                    })), this.reloadSynchronizerTools()
                }))
            }
            getSeriesMeta(e, t, n) {
                const {
                    studyUID: o,
                    seriesUID: r
                } = e;
                let a;
                if (0 === t) {
                    a = this.layoutView.seriesLayout.seriesLayouts[n];
                    const t = () => null == a ? void 0 : a.seriesDom.querySelector("canvas");
                    if (a && !t()) {
                        (0, C.sS)(a.seriesDom);
                        const n = t();
                        (0, S.aA)(n, e.icon, {
                            interceptors: () => Promise.resolve((0, S.nJ)(n))
                        }).catch((() => {}))
                    }
                }
                const {
                    wado: i,
                    hospID: s,
                    departCode: l
                } = f.A.instanceOptions;
                return (0, Me._n)(i, o, r, s, {
                    departCode: l
                }).then((i => Rt(this, [i], void 0, (function*({
                    data: i
                }) {
                    e.initMeta(i.imgs, n);
                    const {
                        metaArrOriginal: l,
                        loadIds: [c]
                    } = e;
                    for (const e of l)(0, St.zV)(e.imageId, e, {
                        seriesUID: r,
                        studyUID: o,
                        hospID: s
                    }, this.studyArr[t]);
                    if (-1 !== t) {
                        const t = this.seriesCount.x * this.seriesCount.y == 1,
                            o = z.E4.getSeriesIDArr(),
                            i = o.length,
                            s = () => (0, C.BY)(c).then((o => {
                                var r, s;
                                const l = Number((null === (r = o.data) || void 0 === r ? void 0 : r.string("x00280008")) || 0);
                                if (l) {
                                    const t = 1e3 / Number(null === (s = o.data) || void 0 === s ? void 0 : s.string("x00181063")),
                                        n = c.includes("?") ? "&" : "?";
                                    e.multiframe = {
                                        numFrames: l,
                                        frameRate: t
                                    };
                                    for (let t = 1; t < l; t++) e.loadIds[t] = `${c}${n}frame=${t}`
                                }!a || t && (0 !== n || i) || this.renderLayoutImageToCanvas(a.seriesDom, o, e)
                            }), (e => {
                                console.error("loadAndCacheImage", e)
                            }));
                        o.includes(r) ? yield s(): s()
                    }
                })))).catch((e => {
                    console.error(e)
                }))
            }
            initFirstStudySeriesLayoutState({
                seriesArr: e
            }) {
                this.seriesLayoutState = new It.A(e)
            }
            initStudyNavigation(e) {
                var t;
                const n = this.studyArr[e];
                ((null === (t = this.layoutView.studyNavigationBody) || void 0 === t ? void 0 : t.childElementCount) || 0) < this.studyArr.length && this.layoutView.createStudyNavigationGroup(n, e)
            }
            reload2d() {
                return Rt(this, void 0, void 0, (function*() {
                    yield this.layoutView.topTools.cancelToolAndDefaultViewportTools("all", !0, !0), this.layoutView.initTop2DTools();
                    const e = this.studyArr[0];
                    this.seriesCount = e.getSeriesLayoutCount(), this.seriesLayoutState.syncState(), this.restoreSeries(this.seriesLayoutState.getSeries())
                }))
            }
            initMPR(e) {
                return Rt(this, void 0, void 0, (function*() {
                    var t, n, o, r, a, i, s, l;
                    const c = new mt.A({
                        progressBar: !0
                    });
                    try {
                        const {
                            originalSeriesData: l,
                            levelDefault: d = (!1 === f.A.instanceOptions.losslessMPR ? null : 10),
                            modality: h = "all",
                            isFusionMode: m = !1,
                            fusionData: g,
                            series: p,
                            matchFusionSeries: v
                        } = e, y = l || {
                            series: p,
                            matchFusionSeries: v,
                            fusionData: g
                        }, b = (0, u.A4)(y), {
                            performanceLevel: w
                        } = qt, {
                            color: x
                        } = yield(0, C.BY)(m ? null === (t = b.fusionData) || void 0 === t ? void 0 : t.PT.loadIds[0] : null === (n = b.series) || void 0 === n ? void 0 : n.loadIds[0]);
                        if (void 0 === x) throw "isReturn";
                        let T = 10;
                        if (m)
                            for (const [e, t] of Object.entries(b.fusionData || {})) {
                                const {
                                    loadIds: e
                                } = t;
                                if (e.length > 60 * w * .6 || d) {
                                    const n = d || (0, u.qE)(Math.round(80 * w / e.length * 10 * .6), 1, 10);
                                    t.loadIds = (0, u.RZ)(e, 10 * n), T = Math.min(n, 10)
                                }
                                x && (t.loadIds = t.loadIds.map((e => e.replace("IM", "web"))))
                            } else {
                                if (!b.series) throw "isReturn";
                                const {
                                    loadIds: e
                                } = b.series;
                                if (e.length > 60 * w || d) {
                                    const t = d || (0, u.qE)(Math.round(80 * w / e.length * 10 * (v ? .6 : 1)), 1, 10);
                                    b.series.loadIds = (0, u.RZ)(e, 10 * t), null === (o = null == b ? void 0 : b.matchFusionSeries) || void 0 === o || o.forEach((e => {
                                        e.loadIds = (0, u.RZ)(e.loadIds, 10 * t)
                                    })), T = t
                                }
                                x && (b.series.loadIds = b.series.loadIds.map((e => e.replace("IM", "web"))), null === (r = null == b ? void 0 : b.matchFusionSeries) || void 0 === r || r.forEach((e => {
                                    e.loadIds = e.loadIds.map((e => e.replace("IM", "web")))
                                })))
                            }
                        const I = this.layoutView.mprLayout.createLayout(),
                            E = (null === (a = b.series) || void 0 === a ? void 0 : a.loadIds) || [...(null === (i = b.fusionData) || void 0 === i ? void 0 : i.CT.loadIds) || [], ...(null === (s = b.fusionData) || void 0 === s ? void 0 : s.PT.loadIds) || []];
                        c.show({
                            message: this.toastDict.MPR.loading
                        });
                        const [S] = yield Promise.all([Promise.all([__webpack_require__.e(477), __webpack_require__.e(385)]).then(__webpack_require__.bind(__webpack_require__, 2590)), (0, C.Sl)(E, {
                            type: "MPR",
                            countCallback: (e, t, n) => {
                                n % 5 == 0 && c.customProgress(n / E.length)
                            }
                        })]);
                        if (this.webDicomViewMPR = S.default, c.hidden(), _t(), void 0 === this.webDicomViewMPR) throw "unModule";
                        this.layoutView.initTopMPRTools(f.A.isMobile ? "MPRStackScroll" : "MPRCrosshairs"), (0, u.wf)(this.layoutView.querySelector(".toolsMPR"), m, "isFusionMode"), yield this.webDicomViewMPR.MPRRun(I, {
                            seriesData: b,
                            originalSeriesData: y,
                            isFusionMode: m,
                            recommendLevel: T,
                            modality: h
                        })
                    } catch (e) {
                        switch (Ft.temporaryEnable = !1, _t(), this.layoutView.mprLayout.hidden(), this.layoutView.initTop2DTools(), console.error(e), (0, S.u$)(e).message) {
                            case "isReturn":
                                return;
                            case "unModule":
                                return void E().error({
                                    title: this.toastDict.unModule
                                });
                            case "Out of memory":
                                E().error({
                                    title: this.toastDict.MPR.outOfMemory
                                });
                                break;
                            case "Array buffer allocation failed":
                                E().error({
                                    title: this.toastDict.MPR.bufferAllocationFailed
                                });
                                break;
                            default:
                                E().error({
                                    title: this.toastDict.MPR.renderError
                                })
                        }
                        null === (l = this.webDicomViewMPR) || void 0 === l || l.MPRDestroy()
                    } finally {
                        c.hidden()
                    }
                }))
            }
            initVRT() {
                try {
                    const {
                        VRTWSURL: e,
                        instanceOptions: {
                            wado: t,
                            hospID: n
                        }
                    } = f.A, {
                        seriesDom: o,
                        seriesUID: r
                    } = this.queryCurrentContainer() || {};
                    if (!r || !(null == o ? void 0 : o.dataset.seriesUID)) throw this.toastDict.noSerise;
                    const {
                        loadIds: a,
                        studyUID: i,
                        metaArrOriginal: [{
                            imgpos: s
                        } = {}]
                    } = this.querySeries(r) || {
                        metaArrOriginal: []
                    };
                    if (!e) throw this.toastDict["3D"].noURL;
                    if (!a || !i) throw this.toastDict.noSerise;
                    if (!s) throw this.toastDict.noImagePosition3D;
                    if (a.length < f.A.minRenderCountMPR3D) throw this.toastDict.seriesNumLow(f.A.minRenderCountMPR3D);
                    ((e, t) => {
                        try {
                            const {
                                layoutView: n
                            } = t;
                            bt = new yt, wt = n, bt.open(e, t)
                        } catch (e) {
                            throw console.error(e), e
                        }
                    })(this.layoutView.vrtLayout.createLayout(), {
                        VRTWSURL: e,
                        wadoURL: t,
                        hospID: n,
                        studyUID: i,
                        seriesUID: r,
                        layoutView: this.layoutView
                    }), this.layoutView.initTopVRTTools("VRTRotate")
                } catch (e) {
                    this.layoutView.vrtLayout.hidden(), this.layoutView.initTop2DTools(), console.error(e);
                    const {
                        message: t
                    } = (0, S.u$)(e);
                    if (t === this.toastDict.noSerise);
                    else E().error({
                        title: t
                    })
                }
            }
            reloadSynchronizerTools() {
                return Rt(this, void 0, void 0, (function*() {
                    yield this.referenceLineTool(this.layoutView.containsClassName(this.layoutView.querySelectorForTool(".referenceLine"), "active")), yield this.crosshairsTool(this.layoutView.containsClassName(this.layoutView.querySelectorForTool(".crosshairs"), "active"))
                }))
            }
            cancelToolAndDefaultViewport() {
                return Rt(this, void 0, void 0, (function*() {
                    const {
                        seriesDom: e
                    } = this.queryCurrentContainer() || {};
                    if (!e) throw "canvas is undefined for cancelToolAndDefaultViewport";
                    const t = (0, re.er)(e);
                    yield this.layoutView.topTools.cancelToolAndDefaultViewportTools([...fe.getSourceElements(), t || e])
                }))
            }
            saveImageTool() {
                var e, t, n;
                try {
                    const {
                        seriesDom: o,
                        seriesUID: a
                    } = this.queryCurrentContainer() || {};
                    if (!a || !o) throw this.toastDict.noSerise;
                    const i = (0, re.er)(o),
                        s = null === (t = null === (e = o.querySelector(".filmMarker")) || void 0 === e ? void 0 : e.textContent) || void 0 === t ? void 0 : t.split("")[1],
                        l = null === (n = i || o) || void 0 === n ? void 0 : n.querySelector("canvas");
                    if (!l) throw this.toastDict.noSerise;
                    const c = l.toDataURL("image/png", 1),
                        {
                            name: d,
                            mod: h,
                            age: f,
                            studt: m
                        } = r.metaData.get("_originModule", (0, r.getImage)(o).imageId) || {},
                        g = [d, f, h, m, s].join("_").replace(".", "_"),
                        {
                            isWeChat: p,
                            isMobile: v
                        } = (0, S._K)();
                    if (p && v) return this.layoutView.createImageLayout(c, g);
                    (0, u.CQ)(c, g)
                } catch (e) {
                    console.error(e);
                    const {
                        message: t
                    } = (0, S.u$)(e);
                    if (t === this.toastDict.noSerise);
                    else E().error({
                        title: t
                    })
                }
            }
            disableSeriesTool() {
                const {
                    seriesDom: e
                } = this.queryCurrentContainer() || {};
                if (!e) throw "seriesDom is undefined for disableSeriesTool";
                const {
                    seriesIndex: t
                } = e.dataset;
                this.seriesLayoutState.removeSerie(Number(t)), delete e.dataset.seriesUID, this.layoutView.clearSeriesLayout(e, !0)
            }
            invertTool() {
                let {
                    seriesDom: e
                } = this.queryCurrentContainer() || {};
                if (!e) throw "seriesDom is undefined for invertTool";
                e = (0, re.er)(e) || e;
                const {
                    invert: t
                } = (0, r.getViewport)(e) || {};
                ge(ue.BW), (0, r.setViewport)(e, {
                    invert: !t
                })
            }
            crosshairsTool(e) {
                return Rt(this, void 0, void 0, (function*() {
                    if ((0, t.r)(e ? "CrosshairsOpen" : "CrosshairsClose"), !e) return (0, C.lQ)("Crosshairs");
                    yield Dt(), (0, C.fO)("Crosshairs", {
                        mouseButtonMask: 1,
                        synchronizationContext: Mt
                    })
                }))
            }
            referenceLineTool(e) {
                return Rt(this, void 0, void 0, (function*() {
                    var n;
                    if ((0, t.r)(e ? "ReferenceLinesOpen" : "ReferenceLinesClose"), !e) return (0, C.lQ)("ReferenceLines");
                    const {
                        seriesLayouts: o
                    } = (null === (n = this.layoutView) || void 0 === n ? void 0 : n.seriesLayout) || {};
                    yield Dt(), (0, C.G7)("ReferenceLines", {
                        synchronizationContext: Mt
                    }), o.length < this.seriesLayoutState.getStatesLength() && console.warn(this.toastDict.referenceLinesWarn)
                }))
            }
            isStudiesLoaded(e = !1) {
                const t = this.reqStudyCount === this.studyUIDArr.length;
                return e && !t && (0, h.A)("studiesLoading", this.toastDict.studiesLoading), t
            }
            magnifyTool() {
                this.layoutView.topTools.magnifyTool()
            }
            queryImage() {
                const {
                    seriesDom: e,
                    seriesUID: t
                } = this.queryCurrentContainer(!1) || {};
                if (!e || !t) throw "seriesDom and seriesUID is required in queryImage";
                const n = this.querySeries(t),
                    o = (0, r.getImage)(e),
                    {
                        metaArrOriginal: [{
                            mod: a
                        }]
                    } = n || {
                        metaArrOriginal: []
                    };
                return Object.assign(Object.assign({}, o), {
                    modality: a
                })
            }
            queryStudy(e) {
                return this.studyArr.find((({
                    studyUID: t
                } = {}) => e === t))
            }
            querySeries(e) {
                let t;
                for (const n of this.studyArr) {
                    const {
                        seriesArr: o = []
                    } = n || {};
                    if (t = o.find((({
                            seriesUID: t
                        }) => t === e)), t) break
                }
                return t
            }
            queryCurrentContainer(e = !0) {
                var t;
                const n = null === (t = this.webDicomViewStitching) || void 0 === t ? void 0 : t.getActiveViewerContainer();
                if (n) return {
                    isStitching: !0,
                    seriesUID: void 0,
                    seriesDom: n
                };
                const o = this.layoutView.seriesLayout.seriesLayouts.find((({
                    seriesDom: e
                }) => {
                    var t;
                    return e.classList.contains("active") || (null === (t = e.parentElement) || void 0 === t ? void 0 : t.classList.contains("active"))
                }));
                return o || (console.error(this.toastDict.noSerise), e && E().error({
                    title: this.toastDict.noSerise
                })), o
            }
            queryCurrentSeries(e = this.queryCurrentContainer()) {
                const {
                    seriesUID: t
                } = e || {};
                return this.querySeries(t)
            }
            queryFusionSeries(e) {
                const [{
                    mod: t,
                    imgpos: n
                }] = e, o = e.length;
                if (!["CT", "PT"].includes(t)) return [];
                let r = [];
                for (const e of this.studyArr) {
                    const {
                        seriesArr: a = []
                    } = e || {};
                    r = [...r, ...a.filter((({
                        metaArrOriginal: e,
                        metaArrOriginal: [{
                            mod: r,
                            imgpos: a
                        }]
                    }) => e.length === o && r === ("CT" == t ? "PT" : "CT") && Math.abs((0, At.T)(n)[2] - (0, At.T)(a)[2]) <= .01))]
                }
                return r.sort(((e, t) => e.seriesIndex - t.seriesIndex))
            }
            queryModalitySeries(e) {
                let t = [];
                for (const n of this.studyArr) {
                    const {
                        seriesArr: o = []
                    } = n || {};
                    t = [...t, ...o.filter((({
                        metaArrOriginal: [{
                            mod: t
                        }]
                    }) => t === e))]
                }
                return t.sort(((e, t) => e.seriesIndex - t.seriesIndex))
            }
            bindEvents() {
                const e = this.eventNamespace,
                    n = (0, S.sg)((() => (0, r.triggerEvent)(r.events, "window_resize")), 50);
                ee({
                    key: "Escape",
                    callback: J
                }), window.addEventListener("keydown", $), window.addEventListener("resize", (function() {
                    n()
                }));
                for (const e of ["beforeunload", "unload", "pagehide", "visibilitychange"]) window.addEventListener(e, (function() {
                    const {
                        instanceOptions: {
                            closePageResetDefault: {
                                imageType: e,
                                cacheImages: t,
                                tackSynchronizerType: n
                            } = {}
                        },
                        DBCacheImages: o
                    } = f.A;
                    e && (f.A.imageType = null), t && (o.enable = null), n && (f.A.tackSynchronizerType = null)
                }));
                r.events.addEventNamespaceListener(`layout_area_focus.${e}`, (e => {
                    const {
                        area: t
                    } = e.detail;
                    (0, je.Ay)("layout_area_focus", (0, S.nF)((() => {
                        switch (t) {
                            case "toolbarLayout":
                            case "seriesLayout":
                            case "seriesMPROr3DLayout":
                                f.A.toolsBar.navigationBottomLayout || this.layoutView.seriesBarToggle(!1), this.layoutView.selectPopupHidden(), this.layoutView.navigationMenuCloseHandle()
                        }
                    }), 500, {
                        trailing: !1
                    }))
                })), r.events.addEventNamespaceListener(`tool_series_layout.${e}`, (({
                    detail: e
                }) => {
                    const {
                        ptCell: t
                    } = e;
                    this.seriesCount = t, this.restoreSeries(this.seriesLayoutState.getSeries())
                })), r.events.addEventNamespaceListener(`tool_series_image_layout.${e}`, (e => Rt(this, [e], void 0, (function*({
                    detail: e
                }) {
                    const {
                        ptCell: t,
                        ptCell: {
                            x: n,
                            y: o
                        }
                    } = e, {
                        seriesDom: a,
                        seriesUID: i
                    } = this.queryCurrentContainer() || {};
                    if (!i || !a) throw "seriesUID and seriesDom are required fro tool_series_image_layout";
                    const s = this.querySeries(i),
                        l = n * o == 1;
                    if (Nt(a, 0), this.layoutView.clearSeriesLayout(a, !0, !0), l) {
                        const {
                            seriesIndex: e
                        } = a.dataset, t = this.seriesLayoutState.getSynchronizerStatus(Number(e));
                        (0, u.wf)(a, !1, "noActiveBorder"), (0, C.b8)(a), yield this.displaySeriesByImageindex(a, s), this.layoutView.seriesLayout.initSingle(a, s, void 0, {
                            synchronizerStatus: t
                        })
                    } else {
                        (0, u.wf)(a, !0, "noActiveBorder"), (0, r.triggerEvent)(r.events, "series_synchronizer_remove", {
                            seriesDom: a,
                            setSynchronizerStatus: !1
                        }), this.layoutView.seriesLayout.createImagesLayout(a, s, t), this.displayDcmByImages(a, s.loadIds), yield Dt();
                        const {
                            isWeChat: e,
                            isAndroid: i
                        } = (0, S._K)();
                        if (e && i) {
                            const {
                                x: e,
                                y: t
                            } = this.seriesCount;
                            n * o + e * t > 8 && console.warn(this.toastDict.imageLayoutError)
                        }
                    }(0, r.triggerEvent)(r.events, "image_active", {
                        $canvas: a
                    })
                })))), r.events.addEventNamespaceListener(`study_scroll.${e}`, (e => Rt(this, void 0, void 0, (function*() {
                    const {
                        currentIndex: t = 0,
                        layoutCount: n = 1
                    } = e.detail, o = this.seriesLayoutState.getStates(), {
                        seriesLayouts: a
                    } = this.layoutView.seriesLayout, i = t * n;
                    this.studyScrollIndex = t, J(), a.forEach(((e, n) => {
                        try {
                            const r = n + i,
                                {
                                    seriesDom: a
                                } = e,
                                {
                                    seriesUID: s,
                                    studyUID: l,
                                    series: c,
                                    synchronizerStatus: u,
                                    scrollIndex: d
                                } = o[r] || {};
                            e.seriesUID = s, this.layoutView.clearSeriesLayout(a), c && (this.displaySeriesByImageindex(a, c, (() => Rt(this, void 0, void 0, (function*() {
                                if (this.studyScrollIndex !== t) throw "page  is old  render canceled"
                            })))), this.layoutView.seriesLayout.initSingle(a, c, {
                                seriesUID: s,
                                studyUID: l,
                                seriesIndex: r
                            }, {
                                synchronizerStatus: u,
                                scrollIndex: d
                            }))
                        } catch (e) {
                            console.error(e)
                        }
                    }));
                    const {
                        seriesUID: s
                    } = this.selectSeries || {};
                    (0, r.triggerEvent)(r.events, "image_active", {}), this.layoutView.seriesLayout.toggleSeriesStyle({
                        seriesUID: s
                    }), yield this.reloadSynchronizerTools()
                })))), r.events.addEventNamespaceListener(`series_scroll.${e}`, (e => {
                    const {
                        element: t,
                        currentIndex: n,
                        isSeriesImage: o,
                        imageIds: r
                    } = e.detail;
                    var a;
                    o && this.displayDcmByImages(t, r, n), this.seriesLayoutState.setScrollIndex(t.dataset.seriesIndex, n), a = 500, fe.enabled = !1, fe.timer && clearTimeout(fe.timer), fe.timer = setTimeout((() => {
                        fe.enabled = !0
                    }), a)
                })), r.events.addEventNamespaceListener(`tool_imageType.${e}`, (e => Rt(this, void 0, void 0, (function*() {
                    var n, o;
                    yield null === (n = this.webDicomViewPrint) || void 0 === n ? void 0 : n.close(), yield null === (o = this.webDicomViewStitching) || void 0 === o ? void 0 : o.close();
                    const {
                        type: r,
                        custom: a
                    } = e.detail;
                    a || (f.A.imageType = r, w(), this.layoutView.imageTypeMark()), this.studyArr = [], this.reqStudyCount = 0, this.layoutView.seriesLayout.seriesLayouts = [], this.layoutView.imageType(e.detail), this.layoutView.iconPlayer.playerAllPauseAndRemove(), (0, C.O$)(!1), (0, St.dZ)(), (0, t.r)("imageTypeToggle", !0), (0, C.Sl)([], {
                        forceCancelAll: !0
                    }), (0, T.H)(), (0, u.bE)(this.layoutView.canvasContainer), (0, u.bE)(this.layoutView.studyNavigationBody), (0, u.bE)(this.layoutView.studyNavigationHead), (0, t.OU)(), yield this.getStudyInfos(), this.reloadSynchronizerTools()
                })))), r.events.addEventNamespaceListener(`tool_WwWc.${e}`, (e => {
                    const {
                        seriesDom: t
                    } = this.queryCurrentContainer() || {};
                    this.layoutView.wwwcImage(t, e.detail)
                })), r.events.addEventNamespaceListener(`tool_scale.${e}`, (e => {
                    const {
                        seriesDom: t
                    } = this.queryCurrentContainer() || {};
                    this.layoutView.scaleImage(t, e.detail)
                })), r.events.addEventNamespaceListener(`tool_rotate.${e}`, (e => {
                    const {
                        seriesDom: t
                    } = this.queryCurrentContainer() || {};
                    this.layoutView.rotateImage(t, e.detail)
                })), r.events.addEventNamespaceListener(`tool_colorMap.${e}`, (e => {
                    const {
                        seriesDom: t
                    } = this.queryCurrentContainer() || {};
                    this.layoutView.colorMapImage(t, e.detail)
                })), r.events.addEventNamespaceListener(`window_resize.${e}`, (() => {
                    this.layoutView.resizeLayout(), f.A.env !== (0, Ot.A)() && E().info({
                        title: this.toastDict.deviceTypeChange
                    })
                }));
                const o = (e, n) => {
                    (0, t.r)("downloadActive"), (0, C.Sl)(e, {
                        countCallback: (t, o, r) => {
                            this.layoutView.progressCountStyle(n, e.length, r)
                        }
                    })
                };
                r.events.addEventNamespaceListener(`navigator_dbClick_drag.${e}`, (e => Rt(this, void 0, void 0, (function*() {
                    let {
                        series: t
                    } = e.detail;
                    const {
                        loadIds: n,
                        studyUID: r,
                        seriesUID: a
                    } = t, i = this.queryCurrentContainer();
                    if (!i) throw "currentContainer is undefined for navigator_dbClick_drag";
                    const {
                        seriesDom: s
                    } = i;
                    if ("isStitching" in i && i.isStitching) return;
                    const {
                        seriesIndex: l
                    } = s.dataset;
                    this.selectSeries = {
                        seriesUID: a,
                        studyUID: r,
                        seriesIndex: Number(l)
                    }, this.layoutView.seriesLayout.toggleNavigatorInfo(a), o(n, a), this.layoutView.clearSeriesLayout(s), i.seriesUID = a, this.seriesLayoutState.setState(Number(l), {
                        studyUID: r,
                        seriesUID: a,
                        series: t,
                        scrollIndex: 0,
                        synchronizerStatus: !1
                    }), yield this.displaySeriesByImageindex(s, t), this.layoutView.seriesLayout.initSingle(s, t, this.selectSeries), this.reloadSynchronizerTools()
                })))), r.events.addEventNamespaceListener(`first_active.${e}`, (e => {
                    var t;
                    const {
                        detail: {
                            $canvas: n
                        }
                    } = e;
                    (0, r.triggerEvent)(r.events, "canvas_active", {
                        $canvas: n
                    }), null === (t = this.layoutView.studyMenuLayout) || void 0 === t || t.activeFirst()
                })), r.events.addEventNamespaceListener(`navigator_active.${e}`, (e => Rt(this, void 0, void 0, (function*() {
                    var t;
                    let {
                        series: n,
                        target: a,
                        event: {
                            isTrusted: i
                        }
                    } = e.detail;
                    const {
                        loadIds: s,
                        studyUID: l,
                        seriesUID: c,
                        seriesIndex: d
                    } = n, {
                        x: h,
                        y: f
                    } = this.seriesCount, m = h * f, g = null !== (t = this.seriesLayoutState.getSeriesActiveIndex(c)) && void 0 !== t ? t : NaN;
                    this.selectSeries = {
                        seriesUID: c,
                        studyUID: l,
                        seriesIndex: d
                    }, this.layoutView.seriesLayout.toggleNavigatorInfo(c), i ? o(s, c) : this.layoutView.progressCountStyle(c);
                    const p = Math.floor(g / m),
                        v = p !== this.studyScrollIndex;
                    v ? p >= 0 ? this.layoutView.studySlider.setIndex(p) : (this.layoutView.seriesLayout.toggleNavigatorInfo(""), this.layoutView.seriesLayout.toggleSeriesStyle({})) : (this.layoutView.iconPlayer.playerAllPauseAndRemove(), (0, r.triggerEvent)(r.events, "image_active", {}), this.layoutView.seriesLayout.toggleSeriesStyle({
                        seriesUID: c
                    }));
                    const y = this.layoutView.canvasContainer.querySelector(".signBigLayout");
                    if (y) {
                        yield(0, u.uk)();
                        let e = this.layoutView.canvasContainer.querySelector(".layoutCellsOuter.active");
                        if (!e || v && e == y) return void(null == a || a.click());
                        this.layoutView.seriesLayout.dblclickCanvasLayout(y, (0, re.Cb)(y), !0), this.layoutView.seriesLayout.dblclickCanvasLayout(e, (0, re.Cb)(e), !1)
                    }
                })))), r.events.addEventNamespaceListener(`canvas_active.${e}`, (e => {
                    var t;
                    const {
                        detail: {
                            $canvas: n,
                            type: o
                        }
                    } = e, {
                        seriesUID: a,
                        seriesIndex: i,
                        studyUID: s
                    } = n.dataset, {
                        seriesUID: l
                    } = this.selectSeries || {};
                    if ((0, r.triggerEvent)(r.events, "image_active", {
                            $canvas: n
                        }), this.selectSeries = {
                            seriesUID: a,
                            seriesIndex: i,
                            studyUID: s
                        }, this.layoutView.seriesLayout.toggleSeriesStyle({
                            target: n
                        }), this.layoutView.seriesLayout.toggleNavigatorInfo(a, !1), ("wheel" === o || l !== a) && a) try {
                        const [{
                            imageIds: e = [],
                            currentImageIdIndex: o = 0
                        }] = (null === (t = (0, M.getToolState)(n, "stack")) || void 0 === t ? void 0 : t.data) || [{}];
                        Ht.scroll ? ((0, C.Sl)(e.slice(o, o + Math.max(Ht.scrollNum, 1))), this.layoutView.progressCountStyle(a, void 0, void 0, Ht.fullLoad)) : (0, C.Sl)(e, {
                            countCallback: (t, n, o) => {
                                this.layoutView.progressCountStyle(a, e.length, o, Ht.fullLoad)
                            }
                        })
                    } catch (e) {
                        W(e)
                    }
                })), r.events.addEventNamespaceListener(`tool_event.${e}`, (e => Rt(this, void 0, void 0, (function*() {
                    var n, o, a, i, s;
                    const {
                        toolData: c = {},
                        btnTarget: d,
                        btnOriginTarget: h
                    } = e.detail, m = !(null == d ? void 0 : d.classList.contains("active"));
                    let p = !0,
                        v = !0;
                    switch (c.btnTarget = d, c.btnOriginTarget = h, J(), c.toolTag) {
                        case "seriesBar":
                            v = !1, this.layoutView.seriesBarToggle(), this.layoutView.navigationMenuCloseHandle(!0);
                            break;
                        case "MPR":
                            try {
                                (0, t.r)("MPR"), this.layoutView.seriesBarToggle(!1);
                                const {
                                    seriesDom: e,
                                    seriesUID: n
                                } = this.queryCurrentContainer() || {};
                                if (!n) throw this.toastDict.noSerise;
                                const o = this.querySeries(n),
                                    {
                                        loadIds: r,
                                        metaArrOriginal: a,
                                        metaArrOriginal: [{
                                            mod: i = "",
                                            imgpos: s
                                        } = {}]
                                    } = o || {
                                        metaArrOriginal: []
                                    };
                                if (!r || !(null == e ? void 0 : e.dataset.seriesUID)) throw this.toastDict.noSerise;
                                if (!s) throw this.toastDict.noImagePositionMPR;
                                const {
                                    minRenderCountMPR3D: l
                                } = f.A;
                                if (r.length < l) throw this.toastDict.seriesNumLow(f.A.minRenderCountMPR3D);
                                const c = f.A.toolsBar.MPRFusion2Visibility ? this.queryFusionSeries(a) : [];
                                this.initMPR({
                                    modality: i,
                                    isFusionMode: !1,
                                    series: o,
                                    matchFusionSeries: c.length ? c : void 0
                                })
                            } catch (e) {
                                console.error(e);
                                const {
                                    message: t
                                } = (0, S.u$)(e);
                                if (t === this.toastDict.noSerise);
                                else E().error({
                                    title: t
                                })
                            }
                            break;
                        case "VRT":
                            (0, t.r)("VRT"), this.layoutView.seriesBarToggle(!1), this.initVRT();
                            break;
                        case "AI":
                            this.initAI(m);
                            break;
                        case "fusion":
                            {
                                const e = "fusionLayout is required";
                                try {
                                    const {
                                        seriesUID: t
                                    } = this.queryCurrentContainer() || {};
                                    if (!t) throw this.toastDict.noSerise;
                                    const n = this.querySeries(t),
                                        o = yield this.layoutView.FusionLayout.createLayout(n);
                                    if (!o) throw e;
                                    const {
                                        minRenderCountMPR3D: r
                                    } = f.A, {
                                        PT: a,
                                        CT: i
                                    } = o;
                                    if (a.loadIds.length < r || i.loadIds.length < r) throw this.toastDict.seriesNumLow(f.A.minRenderCountMPR3D);
                                    this.initMPR({
                                        isFusionMode: !0,
                                        modality: "CT",
                                        fusionData: o
                                    })
                                } catch (t) {
                                    console.error(t);
                                    const {
                                        message: n
                                    } = (0, S.u$)(t);
                                    switch (n) {
                                        case e:
                                        case this.toastDict.noSerise:
                                            break;
                                        default:
                                            E().error({
                                                title: n
                                            })
                                    }
                                }
                                break
                            }
                        case "imageType":
                            this.layoutView.createImageTypeLayout(e);
                            break;
                        case "stackPositionSynchronizer":
                        case "stackIndexSynchronizer":
                        case "stackScrollSynchronizer":
                            ot.$V(c.toolTag), this.layoutView.iconSynchronizer.createIconSynchronizers();
                            break;
                        case "reload":
                            (0, t.r)("reload"), this.reload2d();
                            break;
                        case "disableAllTool":
                            this.layoutView.topTools.disableAllTool();
                            break;
                        case "modulation":
                            this.layoutView.topTools.modulationTool();
                        case "modulationMenu":
                            c.select && this.layoutView.createWWWCLayout(e);
                            break;
                        case "stackScroll":
                            this.layoutView.topTools.stackScrollTool();
                            break;
                        case "enhanceGroup":
                            {
                                l.webWorkerManager.loadWebWorkerTask("./opencvDecode.worker.js");
                                const {
                                    seriesDom: e
                                } = this.queryCurrentContainer() || {};
                                if (!e) throw "seriesDom is undefined for enhanceGroup";
                                const {
                                    sharpen: t,
                                    blur: n
                                } = (0, r.getViewport)(e) || {},
                                o = this.layoutView.querySelectorForTool(".sharpen"),
                                a = this.layoutView.querySelectorForTool(".blur");
                                for (const {
                                        target: e,
                                        value: r
                                    } of [{
                                        target: o,
                                        value: t || 0
                                    }, {
                                        target: a,
                                        value: n || 0
                                    }])(0, u.M1)(e.querySelectorAll(".select-popup-item.tool-event-link"), (e => (0, u.uo)(e.dataset.toolType || "") === r));
                                break
                            }
                        case "sharpenDefault":
                        case "sharpenHeight":
                        case "sharpenMedium":
                        case "sharpenLow":
                        case "blurDefault":
                        case "blurHeight":
                        case "blurMedium":
                        case "blurLow":
                            {
                                const {
                                    seriesDom: e
                                } = this.queryCurrentContainer() || {};
                                if (!e) throw "seriesDom is undefined for blur/sharpen";this.layoutView.topTools.blurAndSharpenTool(c.toolTag, c.toolType, e);
                                break
                            }
                        case "series":
                            this.layoutView.createSeriesCellLayout(e, "series", (({
                                x: e,
                                y: t
                            }) => {
                                (0, r.triggerEvent)(r.events, "tool_series_layout", {
                                    ptCell: {
                                        x: e,
                                        y: t
                                    }
                                })
                            }), {
                                x: 3,
                                y: 3
                            }, this.seriesCount);
                            break;
                        case "image":
                            {
                                const {
                                    imgRow: t = 1,
                                    imgColumn: o = 1
                                } = (null === (n = this.queryCurrentContainer()) || void 0 === n ? void 0 : n.seriesDom.dataset) || {};this.layoutView.createSeriesCellLayout(e, "image", (({
                                    x: e,
                                    y: t
                                }) => {
                                    (0, r.triggerEvent)(r.events, "tool_series_image_layout", {
                                        ptCell: {
                                            x: e,
                                            y: t
                                        }
                                    })
                                }), f.A.isMobile ? {
                                    x: 3,
                                    y: 3
                                } : {
                                    x: 5,
                                    y: 5
                                }, {
                                    x: Number(o),
                                    y: Number(t)
                                });
                                break
                            }
                        case "pan":
                            this.layoutView.topTools.panTool();
                            break;
                        case "zoom":
                            this.layoutView.topTools.zoomTool(), c.select && this.layoutView.createScaleLayout(e);
                            break;
                        case "rotate":
                            this.layoutView.topTools.rotateTool(), c.select && this.layoutView.createRotateLayout(e);
                            break;
                        case "invert":
                            this.invertTool();
                            break;
                        case "colorMap":
                            this.layoutView.createColorMapLayout(e);
                            break;
                        case "referenceLine":
                            this.referenceLineTool(m);
                            break;
                        case "crosshairs":
                            this.crosshairsTool(!0);
                            break;
                        case "imageStitching":
                            {
                                const e = yield __webpack_require__.e(107).then(__webpack_require__.bind(__webpack_require__, 2466));
                                if (this.webDicomViewStitching = e.default, !this.webDicomViewStitching) return E().error({
                                    title: this.toastDict.unModule
                                });yield null === (o = this.webDicomViewPrint) || void 0 === o ? void 0 : o.close(),
                                this.webDicomViewStitching[this.webDicomViewStitching.isInit ? "close" : "initLayout"]();
                                break
                            }
                        case "print":
                            {
                                const e = yield Promise.all([__webpack_require__.e(746), __webpack_require__.e(83)]).then(__webpack_require__.bind(__webpack_require__, 912));
                                if (this.webDicomViewPrint = e.default, !this.webDicomViewPrint) return E().error({
                                    title: this.toastDict.unModule
                                });
                                if (yield null === (a = this.webDicomViewStitching) || void 0 === a ? void 0 : a.close(), this.webDicomViewPrint.isInit) this.webDicomViewPrint.close();
                                else {
                                    const {
                                        x: e,
                                        y: t
                                    } = this.studyArr[0].getSeriesLayoutCount();
                                    this.webDicomViewPrint.initLayout({
                                        layout: `${e}*${t}`
                                    })
                                }
                                break
                            }
                        case "DICOMMetaInfo":
                            {
                                const {
                                    seriesUID: e,
                                    seriesDom: t
                                } = this.queryCurrentContainer() || {};
                                if (!e || !t) throw "seriesUID and seriesDom is undefined for DICOMMetaInfo";
                                if (!t.querySelector("canvas")) return E().error({
                                    title: this.toastDict.noSerise
                                });
                                const n = this.querySeries(e),
                                    o = r.metaData.get("_originModule", (0, r.getImage)(t).imageId),
                                    {
                                        age: a,
                                        name: i,
                                        patientID: s,
                                        studydate: l,
                                        studyID: c,
                                        orgname: u
                                    } = this.queryStudy(n.studyUID) || {};this.layoutView.createDICOMMetaInfoLayout(Object.assign(Object.assign({}, o), {
                                    age: a,
                                    name: i,
                                    patientID: s,
                                    studydate: l,
                                    studyID: c,
                                    orgname: u
                                }));
                                break
                            }
                        case "cavanAroundInfo":
                            f.A.cavanAroundInfo = !f.A.cavanAroundInfo, this.layoutView.toggleCavanAroundInfoStyle(m);
                            break;
                        case "magnify":
                            this.magnifyTool();
                            break;
                        case "angle":
                            this.layoutView.topTools.angleTools();
                            break;
                        case "cobbAngle":
                            this.layoutView.topTools.cobbAngleTools();
                            break;
                        case "length":
                            this.layoutView.topTools.lengthTools();
                            break;
                        case "rectangleRoi":
                            this.layoutView.topTools.rectangleRoiTools();
                            break;
                        case "ellipticalRoi":
                            this.layoutView.topTools.ellipticalRoiTools();
                            break;
                        case "circleRoi":
                            this.layoutView.topTools.circleRoiTools();
                            break;
                        case "freehandRoi":
                            this.layoutView.topTools.freehandRoiTool();
                            break;
                        case "player":
                            {
                                const {
                                    seriesDom: e,
                                    seriesUID: t
                                } = this.queryCurrentContainer() || {};
                                if (!e || !t) throw "container and seriesUID are required for player";
                                const n = this.querySeries(t),
                                    o = null === (i = n.loadIds) || void 0 === i ? void 0 : i.length;
                                if (v = !1, o >= 1) {
                                    const t = null === (s = e.parentElement) || void 0 === s ? void 0 : s.querySelector("div.player-bar");
                                    yield this.layoutView.iconPlayer.playerAllPauseAndRemove(), t || (this.layoutView.iconPlayer.createPlayer(e, n), o > 1 && this.layoutView.iconPlayer.playerStart())
                                }
                                break
                            }
                        case "probeCT":
                            this.layoutView.topTools.probeCTTool();
                            break;
                        case "annotateArrow":
                            this.layoutView.topTools.arrowAnnotateTool();
                            break;
                        case "annotateText":
                            this.layoutView.topTools.annotateTool();
                            break;
                        case "markerL":
                            this.layoutView.topTools.LRMarkerTool("L");
                            break;
                        case "markerR":
                            this.layoutView.topTools.LRMarkerTool("R");
                            break;
                        case "CTR":
                            this.layoutView.topTools.heartratioTool();
                            break;
                        case "cancelToolAndDefaultViewport":
                            this.cancelToolAndDefaultViewport();
                            break;
                        case "cancelToolState":
                            {
                                const {
                                    seriesDom: e
                                } = this.queryCurrentContainer() || {};
                                if (!e) throw "cannot find series for cancelToolState";this.layoutView.topTools.cancelTool(e);
                                const t = (0, re.er)(e);t && this.layoutView.topTools.cancelTool(t);
                                break
                            }
                        case "saveLabels":
                            ! function() {
                                Re(this, void 0, void 0, (function*() {
                                    try {
                                        if (!f.A.instanceOptions.syncLabels) return;
                                        const e = M.globalImageIdSpecificToolStateManager.saveToolState(),
                                            t = {};
                                        for (const [n, o] of Object.entries(e)) {
                                            const {
                                                baseInfo: e
                                            } = o || {}, {
                                                studyUID: r
                                            } = e || {};
                                            Object.prototype.hasOwnProperty.call(t, r) || (t[r] = {}), t[r][n] = o
                                        }
                                        const {
                                            studyArr: n
                                        } = f.A.webDicomView, {
                                            wado: o,
                                            hospID: r,
                                            departCode: a
                                        } = f.A.instanceOptions;
                                        for (const e of n) try {
                                            const {
                                                studyUID: n
                                            } = e || {}, i = t[n] || {};
                                            yield(0, Me.a9)(o, n, {
                                                departCode: a,
                                                hospID: r,
                                                markJson: JSON.stringify(i)
                                            }), E().success({
                                                title: (0, g.Tl)("toast.saveSuccess")
                                            })
                                        } catch (e) {
                                            console.error(e), E().error({
                                                title: (0, g.Tl)("toast.saveFail")
                                            })
                                        }
                                    } catch (e) {
                                        E().error({
                                            title: (0, S.u$)(e).message
                                        }), console.error(e)
                                    }
                                }))
                            }();
                            break;
                        case "visibilityLabels":
                            (0, kt.q)(!m);
                            break;
                        case "eraser":
                            this.layoutView.topTools.eraserTools();
                            break;
                        case "saveImage":
                            this.saveImageTool();
                            break;
                        case "markersImage":
                            ! function() {
                                De(this, void 0, void 0, (function*() {
                                    try {
                                        if (!f.A.instanceOptions.syncMarkersImage) return;
                                        const {
                                            studyArr: e
                                        } = f.A.webDicomView, {
                                            wado: t,
                                            hospID: n,
                                            departCode: o
                                        } = f.A.instanceOptions;
                                        for (const r of e) try {
                                            const {
                                                studyUID: e
                                            } = r || {}, a = Pe[e] || {};
                                            yield(0, Me.NZ)(t, e, {
                                                departCode: o,
                                                hospID: n,
                                                markKeyJson: JSON.stringify(a)
                                            }), E().success({
                                                title: (0, g.Tl)("toast.saveSuccess")
                                            })
                                        } catch (e) {
                                            console.error(e), E().error({
                                                title: (0, g.Tl)("toast.saveFail")
                                            })
                                        }
                                    } catch (e) {
                                        E().error({
                                            title: (0, S.u$)(e).message
                                        }), console.error(e)
                                    }
                                }))
                            }();
                            break;
                        case "disSeries":
                            this.disableSeriesTool();
                            break;
                        case "useCacheImage":
                            if ((0, C.Sl)([], {
                                    forceCancelAll: !0
                                }), !m) {
                                let e = this.toastDict.disCacheImage.reconfirm;
                                if (Ht.fullLoad) {
                                    e = this.toastDict.disCacheImage.reconfirmForAllLoad;
                                    if (!(yield(0, Lt.A)(e))) {
                                        p = !1;
                                        break
                                    }
                                } else yield(0, u.uk)(), E().info({
                                    title: e,
                                    timeout: 1e4
                                });
                                (0, r.triggerEvent)(r.events, "tool_imageType", {
                                    custom: !0
                                })
                            }
                            Ft.enable = m;
                            break;
                        case "imageCacheType":
                            if (m) E().info({
                                title: this.toastDict.speedPriority,
                                timeout: 1e4
                            });
                            else if (!Ft.enable) {
                                const e = this.layoutView.toolsContainer.querySelector(".select-popup-item.useCacheImage");
                                null == e || e.click()
                            }
                            f.A.imageCacheTypeDefault = m ? 1 : 0, (0, t.r)("imageCacheType");
                            break;
                        case "setLanguage":
                            try {
                                if (!m) return;
                                const {
                                    toolType: e
                                } = c;
                                if (!confirm((0, g.Tl)("toast.setLanguage", e))) return;
                                (0, g.xC)(e), window.close(), window.history.back()
                            } catch (e) {}
                            break;
                        case "aboutUs":
                            this.layoutView.createAboutUsLayout(f.A.aboutUs)
                    }
                    p && this.layoutView.toggleToolStyle(c), v && this.layoutView.iconPlayer.playerPause()
                })))), r.events.addEventNamespaceListener(`images_viewport.${e}`, (e => {
                    const {
                        element: t,
                        viewport: {
                            voi: {
                                windowWidth: n,
                                windowCenter: o
                            },
                            scale: r
                        }
                    } = e.detail, a = t.querySelector(".wwWMarker"), i = t.querySelector(".wwHMarker"), s = t.querySelector(".scaleMarker");
                    a && (a.innerText = (0, u.gV)(a.innerText, null == n ? void 0 : n.toFixed(2), "")), i && (i.innerText = (0, u.gV)(i.innerText, null == o ? void 0 : o.toFixed(2), "")), s && (s.innerText = (0, u.gV)(s.innerText, null == r ? void 0 : r.toFixed(2), ""))
                })), r.events.addEventNamespaceListener(`iconplayer_series.${e}`, (e => {
                    let t = e.detail;
                    this.layoutView.iconPlayer.playerBarClickHandle(t)
                })), r.events.addEventNamespaceListener(`series_synchronizer_add.${e}`, (e => {
                    const {
                        element: t
                    } = e.detail;
                    fe.add(t), ot.lY.add(t), this.seriesLayoutState.setSynchronizerStatus(t.dataset.seriesIndex, !0)
                })), r.events.addEventNamespaceListener(`series_synchronizer_remove.${e}`, (e => {
                    const {
                        element: t,
                        setSynchronizerStatus: n = !0
                    } = e.detail;
                    fe.remove(t), ot.lY.remove(t), n && this.seriesLayoutState.setSynchronizerStatus(t.dataset.seriesIndex, !1)
                })), r.events.addEventNamespaceListener(`${r.EVENTS.IMAGE_CACHE_FULL}.${e}`, (e => {
                    0 !== e.detail.maximumSizeInBytes && console.error("Insufficient image cache", e)
                })), r.events.addEventNamespaceListener(`${r.EVENTS.WEBGL_TEXTURE_CACHE_FULL}.${e}`, (e => {
                    0 !== e.detail.maximumSizeInBytes && console.error("Insufficient WEBGL cache", e)
                }))
            }
            removeEventListener() {
                const e = this.eventNamespace,
                    t = ["tool_series_layout", "tool_series_image_layout", "study_scroll", "series_scroll", "tool_imageType", "tool_WwWc", "tool_scale", "tool_rotate", "tool_colorMap", "window_resize", "navigator_dbClick_drag", "first_active", "image_active", "navigator_active", "canvas_active", "canvas_active.player", "tool_event", "tool_event.VRT", "layout_area_focus", "images_viewport", "iconplayer_series", "series_synchronizer_add", "series_synchronizer_remove"];
                window.onresize = null;
                for (let n of t) n.indexOf(".") <= 0 && (n += `.${e}`), r.events.removeEventNamespaceListener(n)
            }
            destroy() {
                return Rt(this, void 0, void 0, (function*() {
                    var e, n, o;
                    if (this.isDestroy) throw new Error(this.toastDict.reDestroy);
                    yield this.layoutView.iconPlayer.playerAllPauseAndRemove(), J(), (0, je.FK)(), (0, St.dZ)(), Q.clear(), window.removeEventListener("keydown", $), null === (e = this.webDicomViewMPR) || void 0 === e || e.MPRDestroy(), null === (n = this.webDicomViewPrint) || void 0 === n || n.destory(), null === (o = this.webDicomViewStitching) || void 0 === o || o.destory(), Tt(), (0, C.O$)(!0), (0, t.r)("destroy", !0), (0, C.Sl)([], {
                        forceCancelAll: !0
                    }), (0, x.configure)({
                        parent: "body"
                    }), this.layoutView.seriesLayout.seriesLayouts = [], this.studyUIDArr = [], this.studyArr = [], this.selectSeries = {}, this.removeEventListener(), (0, u.bE)(this.layoutView.canvasContainer), (0, u.bE)(this.globalContainer), (0, u.wf)(this.globalContainer, !1, "dicomView"), pe(), fe = he(), ot.zr(), Pt(), E().destroy(), (0, t.OU)(), this.seriesLayoutState = null, this.layoutView = null, this.globalContainer = null, this.isDestroy = !0
                }))
            }
        }
        jt.i18n = {
            getLanguage: g.Z0,
            translate: g.Tl
        };
        const zt = jt
    })(), __webpack_exports__ = __webpack_exports__.default, __webpack_exports__
})()));